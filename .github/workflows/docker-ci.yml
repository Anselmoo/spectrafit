name: ğŸ³ CI - Docker Image
on:
  push:
    branches: [main]
  pull_request:
    branches: [main, develop]
  repository_dispatch:
    types: [create-pull-request]

jobs:
  docker:
    if: github.repository == 'Anselmoo/spectrafit'
    # Only if Dockerfile is changed
    name: ğŸ³ Docker Image Build
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ›ï¸ Checkout repository
        uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd # v6
      - name: ğŸ—‚ï¸ Filter Dockerfile changes
        uses: dorny/paths-filter@de90cc6fb38fc0963ad72b210f1f284cd68cea36 # v3.0.2
        id: filter
        with:
          filters: |
            docker:
              - 'Dockerfile'
      - name: ğŸ—ï¸ Build the Docker image for AMD64
        run: |
          docker build . --file Dockerfile --tag spectrafit:$(date +%s)
      # - name: ğŸ—ï¸ Build the Docker image for ARM64
      #   run: |
      #     docker build . --file Dockerfile --tag spectrafit-arm64:$(date +%s) --platform linux/arm64
