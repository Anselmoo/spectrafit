<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Technical documentation for SpectraFit, a Python package for fitting"><meta name=author content="Anselm Hahn"><link href=https://Anselmoo.github.io/spectrafit/develop/api/modelling_api/ rel=canonical><link href=../notebook_api/ rel=prev><link href=../reporting_api/ rel=next><link rel=icon href=../../images/logo.svg><meta name=generator content="mkdocs-1.4.2, mkdocs-material-9.1.5"><title>Modelling - SpectraFit</title><link rel=stylesheet href=../../assets/stylesheets/main.7a7fce14.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.a0c5b2b5.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#spectrafit.models class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=SpectraFit class="md-header__button md-logo" aria-label=SpectraFit data-md-component=logo> <img src=../../images/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SpectraFit </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Modelling </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=deep-purple data-md-color-accent=deep-purple aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/Anselmoo/spectrafit title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg> </div> <div class=md-source__repository> Anselmoo/SpectraFit </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../interface/installation/ class=md-tabs__link> Getting started </a> </li> <li class=md-tabs__item> <a href=../../examples/example1/ class=md-tabs__link> Examples </a> </li> <li class=md-tabs__item> <a href=../../doc/models/ class=md-tabs__link> Documentation </a> </li> <li class=md-tabs__item> <a href=../../plugins/file-converter/ class=md-tabs__link> Plugins </a> </li> <li class=md-tabs__item> <a href=../spectrafit_api/ class="md-tabs__link md-tabs__link--active"> API </a> </li> <li class=md-tabs__item> <a href=../../contact/ class=md-tabs__link> Support </a> </li> <li class=md-tabs__item> <a href=../../changelog/ class=md-tabs__link> Releases </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=SpectraFit class="md-nav__button md-logo" aria-label=SpectraFit data-md-component=logo> <img src=../../images/logo.svg alt=logo> </a> SpectraFit </label> <div class=md-nav__source> <a href=https://github.com/Anselmoo/spectrafit title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg> </div> <div class=md-source__repository> Anselmoo/SpectraFit </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> Getting started <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../interface/installation/ class=md-nav__link> Installation </a> </li> <li class=md-nav__item> <a href=../../interface/usage/ class=md-nav__link> Usage </a> </li> <li class=md-nav__item> <a href=../../interface/features/ class=md-nav__link> Features </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> Examples <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_1> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex=0> Working via CMD <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> Working via CMD </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/example1/ class=md-nav__link> Fitting of a Single Feature via Command-Line </a> </li> <li class=md-nav__item> <a href=../../examples/example2/ class=md-nav__link> JSON, TOML, YAML Inputs </a> </li> <li class=md-nav__item> <a href=../../examples/example3/ class=md-nav__link> Multi Peak Fitting </a> </li> <li class=md-nav__item> <a href=../../examples/example4/ class=md-nav__link> Working with Real Life Data </a> </li> <li class=md-nav__item> <a href=../../examples/example5/ class=md-nav__link> Working with Expressions </a> </li> <li class=md-nav__item> <a href=../../examples/example6/ class=md-nav__link> Global Fitting </a> </li> <li class=md-nav__item> <a href=../../examples/example7/ class=md-nav__link> Automatic Fitting </a> </li> <li class=md-nav__item> <a href=../../examples/example8/ class=md-nav__link> Working with Athena Data </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> Working in Jupyter Notebooks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Working in Jupyter Notebooks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/example9_1/ class=md-nav__link> Default Plot </a> </li> <li class=md-nav__item> <a href=../../examples/example9_2/ class=md-nav__link> Dark Theme </a> </li> <li class=md-nav__item> <a href=../../examples/example9_3/ class=md-nav__link> Export Results </a> </li> <li class=md-nav__item> <a href=../../examples/example9_4/ class=md-nav__link> RIXS Map Visualization </a> </li> <li class=md-nav__item> <a href=../../examples/example9_5/ class=md-nav__link> Using Converters as Module </a> </li> <li class=md-nav__item> <a href=../../examples/example9_6/ class=md-nav__link> RIXS Global-Fitting in Jupyter </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> Documentation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Documentation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../doc/models/ class=md-nav__link> Models </a> </li> <li class=md-nav__item> <a href=../../doc/expression/ class=md-nav__link> Expression </a> </li> <li class=md-nav__item> <a href=../../doc/solver/ class=md-nav__link> Solvers </a> </li> <li class=md-nav__item> <a href=../../doc/fitting/ class=md-nav__link> Fitting </a> </li> <li class=md-nav__item> <a href=../../doc/statistics/ class=md-nav__link> Statistics </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> Plugins <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Plugins </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../plugins/file-converter/ class=md-nav__link> File-Format-Conversion </a> </li> <li class=md-nav__item> <a href=../../plugins/data-converter/ class=md-nav__link> Data-Format-Conversion </a> </li> <li class=md-nav__item> <a href=../../plugins/jupyter-interface/ class=md-nav__link> Jupyter-Notebook-Integration </a> </li> <li class=md-nav__item> <a href=../../plugins/rixs-visualization/ class=md-nav__link> RIXS-Visualization </a> </li> <li class=md-nav__item> <a href=../../plugins/rixs-converter/ class=md-nav__link> RIXS-Converter </a> </li> <li class=md-nav__item> <a href=../../plugins/pkl-converter_visualization/ class=md-nav__link> PKL-Converter and Visualizer </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> API <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../spectrafit_api/ class=md-nav__link> SpectraFit </a> </li> <li class=md-nav__item> <a href=../plotting_api/ class=md-nav__link> Plotting </a> </li> <li class=md-nav__item> <a href=../notebook_api/ class=md-nav__link> Jupyter-Notebook </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Modelling <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Modelling </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#spectrafit.models class=md-nav__link> spectrafit.models </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection class=md-nav__link> AutoPeakDetection </a> <nav class=md-nav aria-label=AutoPeakDetection> <ul class=md-nav__list> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimate_distance class=md-nav__link> estimate_distance </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimate_height class=md-nav__link> estimate_height </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimate_prominence class=md-nav__link> estimate_prominence </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimate_threshold class=md-nav__link> estimate_threshold </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimated_plateau_size class=md-nav__link> estimated_plateau_size </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimated_rel_height class=md-nav__link> estimated_rel_height </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimated_width class=md-nav__link> estimated_width </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimated_wlen class=md-nav__link> estimated_wlen </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.__autodetect__ class=md-nav__link> __autodetect__() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.__init__ class=md-nav__link> __init__() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.check_key_exists class=md-nav__link> check_key_exists() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.default_values class=md-nav__link> default_values() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.initialize_peak_detection class=md-nav__link> initialize_peak_detection() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#spectrafit.models.Constants class=md-nav__link> Constants </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels class=md-nav__link> DistributionModels </a> <nav class=md-nav aria-label=DistributionModels> <ul class=md-nav__list> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.atan class=md-nav__link> atan() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.cgaussian class=md-nav__link> cgaussian() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.clorentzian class=md-nav__link> clorentzian() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.constant class=md-nav__link> constant() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.cvoigt class=md-nav__link> cvoigt() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.erf class=md-nav__link> erf() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.exponential class=md-nav__link> exponential() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.gaussian class=md-nav__link> gaussian() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.heaviside class=md-nav__link> heaviside() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.linear class=md-nav__link> linear() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.log class=md-nav__link> log() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.lorentzian class=md-nav__link> lorentzian() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.power class=md-nav__link> power() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.pseudovoigt class=md-nav__link> pseudovoigt() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.voigt class=md-nav__link> voigt() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters class=md-nav__link> ModelParameters </a> <nav class=md-nav aria-label=ModelParameters> <ul class=md-nav__list> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.return_params class=md-nav__link> return_params </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.__init__ class=md-nav__link> __init__() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.__perform__ class=md-nav__link> __perform__() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.__str__ class=md-nav__link> __str__() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.define_parameters class=md-nav__link> define_parameters() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.define_parameters_auto class=md-nav__link> define_parameters_auto() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.define_parameters_global class=md-nav__link> define_parameters_global() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.define_parameters_global_pre class=md-nav__link> define_parameters_global_pre() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.define_parameters_loop class=md-nav__link> define_parameters_loop() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.define_parameters_loop_2 class=md-nav__link> define_parameters_loop_2() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.define_parameters_loop_3 class=md-nav__link> define_parameters_loop_3() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.df_to_numvalues class=md-nav__link> df_to_numvalues() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#spectrafit.models.ReferenceKeys class=md-nav__link> ReferenceKeys </a> <nav class=md-nav aria-label=ReferenceKeys> <ul class=md-nav__list> <li class=md-nav__item> <a href=#spectrafit.models.ReferenceKeys.automodel_check class=md-nav__link> automodel_check() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ReferenceKeys.detection_check class=md-nav__link> detection_check() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ReferenceKeys.model_check class=md-nav__link> model_check() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#spectrafit.models.SolverModels class=md-nav__link> SolverModels </a> <nav class=md-nav aria-label=SolverModels> <ul class=md-nav__list> <li class=md-nav__item> <a href=#spectrafit.models.SolverModels.__call__ class=md-nav__link> __call__() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.SolverModels.__init__ class=md-nav__link> __init__() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.SolverModels.solve_global_fitting class=md-nav__link> solve_global_fitting() </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.SolverModels.solve_local_fitting class=md-nav__link> solve_local_fitting() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#spectrafit.models.calculated_model class=md-nav__link> calculated_model() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../reporting_api/ class=md-nav__link> Reporting </a> </li> <li class=md-nav__item> <a href=../tools_api/ class=md-nav__link> Tools </a> </li> <li class=md-nav__item> <a href=../data_model_api/ class=md-nav__link> Data Model </a> </li> <li class=md-nav__item> <a href=../converter_api/ class=md-nav__link> Converters and Visualizer </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> Support <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Support </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../contact/ class=md-nav__link> Contact </a> </li> <li class=md-nav__item> <a href=../../license/ class=md-nav__link> License </a> </li> <li class=md-nav__item> <a href=../../contributing/ class=md-nav__link> Contributing </a> </li> <li class=md-nav__item> <a href=../../code_of_conduct/ class=md-nav__link> Code of Conduct </a> </li> <li class=md-nav__item> <a href=../../security/ class=md-nav__link> Security </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> Releases <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Releases </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8_1> <label class=md-nav__link for=__nav_8_1 id=__nav_8_1_label tabindex=0> Changelog <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_8_1_label aria-expanded=false> <label class=md-nav__title for=__nav_8_1> <span class="md-nav__icon md-icon"></span> Changelog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../changelog/ class=md-nav__link> v1.x.x </a> </li> <li class=md-nav__item> <a href=../../changelogs/v0.x.x/ class=md-nav__link> v0.x.x </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../contributors/ class=md-nav__link> Contributors </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Modelling</h1> <div class="doc doc-object doc-module"> <a id=spectrafit.models></a> <div class="doc doc-contents first"> <p>Minimization models for curve fitting.</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=spectrafit.models.AutoPeakDetection class="doc doc-heading"> <code>AutoPeakDetection</code> <a href=#spectrafit.models.AutoPeakDetection class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p>Automatic detection of peaks in a spectrum.</p> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>642</span>
<span class=normal>643</span>
<span class=normal>644</span>
<span class=normal>645</span>
<span class=normal>646</span>
<span class=normal>647</span>
<span class=normal>648</span>
<span class=normal>649</span>
<span class=normal>650</span>
<span class=normal>651</span>
<span class=normal>652</span>
<span class=normal>653</span>
<span class=normal>654</span>
<span class=normal>655</span>
<span class=normal>656</span>
<span class=normal>657</span>
<span class=normal>658</span>
<span class=normal>659</span>
<span class=normal>660</span>
<span class=normal>661</span>
<span class=normal>662</span>
<span class=normal>663</span>
<span class=normal>664</span>
<span class=normal>665</span>
<span class=normal>666</span>
<span class=normal>667</span>
<span class=normal>668</span>
<span class=normal>669</span>
<span class=normal>670</span>
<span class=normal>671</span>
<span class=normal>672</span>
<span class=normal>673</span>
<span class=normal>674</span>
<span class=normal>675</span>
<span class=normal>676</span>
<span class=normal>677</span>
<span class=normal>678</span>
<span class=normal>679</span>
<span class=normal>680</span>
<span class=normal>681</span>
<span class=normal>682</span>
<span class=normal>683</span>
<span class=normal>684</span>
<span class=normal>685</span>
<span class=normal>686</span>
<span class=normal>687</span>
<span class=normal>688</span>
<span class=normal>689</span>
<span class=normal>690</span>
<span class=normal>691</span>
<span class=normal>692</span>
<span class=normal>693</span>
<span class=normal>694</span>
<span class=normal>695</span>
<span class=normal>696</span>
<span class=normal>697</span>
<span class=normal>698</span>
<span class=normal>699</span>
<span class=normal>700</span>
<span class=normal>701</span>
<span class=normal>702</span>
<span class=normal>703</span>
<span class=normal>704</span>
<span class=normal>705</span>
<span class=normal>706</span>
<span class=normal>707</span>
<span class=normal>708</span>
<span class=normal>709</span>
<span class=normal>710</span>
<span class=normal>711</span>
<span class=normal>712</span>
<span class=normal>713</span>
<span class=normal>714</span>
<span class=normal>715</span>
<span class=normal>716</span>
<span class=normal>717</span>
<span class=normal>718</span>
<span class=normal>719</span>
<span class=normal>720</span>
<span class=normal>721</span>
<span class=normal>722</span>
<span class=normal>723</span>
<span class=normal>724</span>
<span class=normal>725</span>
<span class=normal>726</span>
<span class=normal>727</span>
<span class=normal>728</span>
<span class=normal>729</span>
<span class=normal>730</span>
<span class=normal>731</span>
<span class=normal>732</span>
<span class=normal>733</span>
<span class=normal>734</span>
<span class=normal>735</span>
<span class=normal>736</span>
<span class=normal>737</span>
<span class=normal>738</span>
<span class=normal>739</span>
<span class=normal>740</span>
<span class=normal>741</span>
<span class=normal>742</span>
<span class=normal>743</span>
<span class=normal>744</span>
<span class=normal>745</span>
<span class=normal>746</span>
<span class=normal>747</span>
<span class=normal>748</span>
<span class=normal>749</span>
<span class=normal>750</span>
<span class=normal>751</span>
<span class=normal>752</span>
<span class=normal>753</span>
<span class=normal>754</span>
<span class=normal>755</span>
<span class=normal>756</span>
<span class=normal>757</span>
<span class=normal>758</span>
<span class=normal>759</span>
<span class=normal>760</span>
<span class=normal>761</span>
<span class=normal>762</span>
<span class=normal>763</span>
<span class=normal>764</span>
<span class=normal>765</span>
<span class=normal>766</span>
<span class=normal>767</span>
<span class=normal>768</span>
<span class=normal>769</span>
<span class=normal>770</span>
<span class=normal>771</span>
<span class=normal>772</span>
<span class=normal>773</span>
<span class=normal>774</span>
<span class=normal>775</span>
<span class=normal>776</span>
<span class=normal>777</span>
<span class=normal>778</span>
<span class=normal>779</span>
<span class=normal>780</span>
<span class=normal>781</span>
<span class=normal>782</span>
<span class=normal>783</span>
<span class=normal>784</span>
<span class=normal>785</span>
<span class=normal>786</span>
<span class=normal>787</span>
<span class=normal>788</span>
<span class=normal>789</span>
<span class=normal>790</span>
<span class=normal>791</span>
<span class=normal>792</span>
<span class=normal>793</span>
<span class=normal>794</span>
<span class=normal>795</span>
<span class=normal>796</span>
<span class=normal>797</span>
<span class=normal>798</span>
<span class=normal>799</span>
<span class=normal>800</span>
<span class=normal>801</span>
<span class=normal>802</span>
<span class=normal>803</span>
<span class=normal>804</span>
<span class=normal>805</span>
<span class=normal>806</span>
<span class=normal>807</span>
<span class=normal>808</span>
<span class=normal>809</span>
<span class=normal>810</span>
<span class=normal>811</span>
<span class=normal>812</span>
<span class=normal>813</span>
<span class=normal>814</span>
<span class=normal>815</span>
<span class=normal>816</span>
<span class=normal>817</span>
<span class=normal>818</span>
<span class=normal>819</span>
<span class=normal>820</span>
<span class=normal>821</span>
<span class=normal>822</span>
<span class=normal>823</span>
<span class=normal>824</span>
<span class=normal>825</span>
<span class=normal>826</span>
<span class=normal>827</span>
<span class=normal>828</span>
<span class=normal>829</span>
<span class=normal>830</span>
<span class=normal>831</span>
<span class=normal>832</span>
<span class=normal>833</span>
<span class=normal>834</span>
<span class=normal>835</span>
<span class=normal>836</span>
<span class=normal>837</span>
<span class=normal>838</span>
<span class=normal>839</span>
<span class=normal>840</span>
<span class=normal>841</span>
<span class=normal>842</span>
<span class=normal>843</span>
<span class=normal>844</span>
<span class=normal>845</span>
<span class=normal>846</span>
<span class=normal>847</span>
<span class=normal>848</span>
<span class=normal>849</span>
<span class=normal>850</span>
<span class=normal>851</span>
<span class=normal>852</span>
<span class=normal>853</span>
<span class=normal>854</span>
<span class=normal>855</span>
<span class=normal>856</span>
<span class=normal>857</span>
<span class=normal>858</span>
<span class=normal>859</span>
<span class=normal>860</span>
<span class=normal>861</span>
<span class=normal>862</span>
<span class=normal>863</span>
<span class=normal>864</span>
<span class=normal>865</span>
<span class=normal>866</span>
<span class=normal>867</span>
<span class=normal>868</span>
<span class=normal>869</span>
<span class=normal>870</span>
<span class=normal>871</span>
<span class=normal>872</span>
<span class=normal>873</span>
<span class=normal>874</span>
<span class=normal>875</span>
<span class=normal>876</span>
<span class=normal>877</span>
<span class=normal>878</span>
<span class=normal>879</span>
<span class=normal>880</span>
<span class=normal>881</span>
<span class=normal>882</span>
<span class=normal>883</span>
<span class=normal>884</span>
<span class=normal>885</span>
<span class=normal>886</span>
<span class=normal>887</span>
<span class=normal>888</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span> <span class=nc>AutoPeakDetection</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Automatic detection of peaks in a spectrum.&quot;&quot;&quot;</span>

    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>data</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Initialize the AutoPeakDetection class.</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            data (NDArray[np.float64]): `y`-values of the data as 1d-array.</span>
<span class=sd>            args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<span class=sd>                 additional information beyond the command line arguments.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>=</span> <span class=n>x</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=n>data</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_args</span> <span class=o>=</span> <span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>check_key_exists</span><span class=p>(</span>
        <span class=n>key</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=n>value</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>Any</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Check if a key exists in a dictionary.</span>

<span class=sd>        Please check for the reference key also [scipy.signal.find_peaks][1].</span>

<span class=sd>        [1]:</span>
<span class=sd>            https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.find_peaks.html</span>


<span class=sd>        Args:</span>
<span class=sd>            key (str): Reference key of `scipy.signal.find_peaks`.</span>
<span class=sd>            args (Dict[str, Any]): Reference values of `scipy.signal.find_peaks`, if not</span>
<span class=sd>                 defined will be set to estimated default values.</span>
<span class=sd>            value (Union[float, Tuple[float,float]]): Default value for the reference</span>
<span class=sd>                 key.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Any: The reference value for `scipy.signal.find_peaks`.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>estimate_height</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
<span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Estimate the initial height based on an inverse noise ratio of a signal.</span>

<span class=sd>        !!! info &quot;About the estimation of the height&quot;</span>

<span class=sd>            The lower end of the height is the inverse noise ratio of the `data`, and</span>
<span class=sd>            upper limit is the maximum value of the `data`. The noise ratio of the</span>
<span class=sd>            `data` is based on the original implementation by `SciPy`:</span>

<span class=sd>            ```python</span>
<span class=sd>            def signaltonoise(a, axis=0, ddof=0):</span>
<span class=sd>                a = np.asanyarray(a)</span>
<span class=sd>                m = a.mean(axis)</span>
<span class=sd>                sd = a.std(axis=axis, ddof=ddof)</span>
<span class=sd>                return np.where(sd == 0, 0, m / sd)</span>
<span class=sd>            ```</span>

<span class=sd>        Returns:</span>
<span class=sd>            Tuple[float, float]: Tuple of the inverse signal to noise ratio and</span>
<span class=sd>                 the maximum value of the `data`.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=mi>1</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>std</span><span class=p>(),</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>estimate_threshold</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Estimate the threshold value for the peak detection.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Tuple[float, float]: Minimum and maximum value of the spectrum `data`,</span>
<span class=sd>                 respectively, `intensity`.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>estimate_distance</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Estimate the initial distance between peaks.</span>

<span class=sd>        Returns:</span>
<span class=sd>            float: Estimated distance between peaks.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>min_step</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>diff</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>)</span><span class=o>.</span><span class=n>min</span><span class=p>()</span>
        <span class=k>return</span> <span class=nb>max</span><span class=p>(</span><span class=n>min_step</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>)</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>estimate_prominence</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Estimate the prominence of a peak.</span>

<span class=sd>        !!! info &quot;About the estimation of the prominence&quot;</span>

<span class=sd>            The prominence is the difference between the height of the peak and the</span>
<span class=sd>            bottom. To get a estimate of the prominence, the height of the peak is</span>
<span class=sd>            calculated by maximum value of the `data` and the bottom is calculated by</span>
<span class=sd>            the harmonic mean of the `data`.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Tuple[float, float]: Tuple of the harmonic-mean and maximum value of `data`.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>hmean</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>),</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
        <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>exc</span><span class=p>:</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>exc</span><span class=si>}</span><span class=s2>: Using standard arithmetic mean of NumPy.</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>mean</span><span class=p>(),</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>estimated_width</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Estimate the width of a peak.</span>

<span class=sd>        !!! info &quot;About the estimation of the width&quot;</span>

<span class=sd>            The width of a peak is estimated for a lower and an upper end. For the lower</span>
<span class=sd>            end, the minimum stepsize is used. For the upper end, the stepsize between</span>
<span class=sd>            the half maximum and the minimum value of the `data` is used as the width.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Tuple[float, float]: Estimated width lower and uper end of the peaks.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=p>(</span>
            <span class=n>np</span><span class=o>.</span><span class=n>diff</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>)</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span>
            <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>argmax</span><span class=p>()]</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>argmin</span><span class=p>()])</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span>
        <span class=p>)</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>estimated_rel_height</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Estimate the relative height of a peak.</span>

<span class=sd>        !!! info &quot;About the estimation of the relative height&quot;</span>

<span class=sd>            The relative height of a peak is approximated by the difference of the</span>
<span class=sd>            harmonic mean value of the `data` and the minimum value of the `data`</span>
<span class=sd>            divided by the factor of `4`. In case of negative ratios, the value will be</span>
<span class=sd>            set to `Zero`.</span>

<span class=sd>        Returns:</span>
<span class=sd>            float: Estimated relative height of a peak.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>rel_height</span> <span class=o>=</span> <span class=p>(</span><span class=n>hmean</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>)</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>min</span><span class=p>())</span> <span class=o>/</span> <span class=mi>4</span>
        <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>exc</span><span class=p>:</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>exc</span><span class=si>}</span><span class=s2>: Using standard arithmetic mean of NumPy.</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
            <span class=n>rel_height</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>min</span><span class=p>())</span> <span class=o>/</span> <span class=mi>4</span>
        <span class=k>return</span> <span class=n>rel_height</span> <span class=k>if</span> <span class=n>rel_height</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mf>0.0</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>estimated_wlen</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
<span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Estimate the window length for the peak detection.</span>

<span class=sd>        !!! info &quot;About the estimation of the window length&quot;</span>

<span class=sd>            The window length is the length of the window for the peak detection is</span>
<span class=sd>            defined to be 1% of the length of the `data`, consequently the len of the</span>
<span class=sd>            `data` is divided by 100. In case of a window length smaller than 1, the</span>
<span class=sd>            window length will be set to numerical value of 1, which is defined by</span>
<span class=sd>            `1 + 1e-9`.</span>

<span class=sd>        Returns:</span>
<span class=sd>            float: Estimated window length is set to the numeric value of &gt; 1.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>wlen</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>size</span> <span class=o>/</span> <span class=mi>100</span>
        <span class=k>return</span> <span class=n>wlen</span> <span class=k>if</span> <span class=n>wlen</span> <span class=o>&gt;</span> <span class=mf>1.0</span> <span class=k>else</span> <span class=mi>1</span> <span class=o>+</span> <span class=mf>1e-9</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>estimated_plateau_size</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Estimate the plateau size for the peak detection.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Tuple[float, float]: Estimated plateau size is set to `zero` for the lower</span>
<span class=sd>                 end and the maximum value of the `x` for the upper end.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=mf>0.0</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>

    <span class=k>def</span> <span class=nf>initialize_peak_detection</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Initialize the peak detection.</span>

<span class=sd>        !!! note &quot;Initialize the peak detection&quot;</span>

<span class=sd>            This method is used to initialize the peak detection. The initialization can</span>
<span class=sd>            be activated by setting the `initialize` attribute to `True`, which will</span>
<span class=sd>            automatically estimate the default parameters for the peak detection. In</span>
<span class=sd>            case of the `initialize` attribute is defined as dictionary, the proposed</span>
<span class=sd>            values are taken from the dictionary if th</span>

<span class=sd>        Raise:</span>
<span class=sd>            TypeError: If the `initialize` attribute is not of type `bool` or `dict`.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>default_values</span><span class=p>()</span>
        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
            <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>detection_check</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;height&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_height</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>threshold</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;threshold&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_threshold</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>distance</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;distance&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_distance</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>prominence</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;prominence&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_prominence</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>width</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;width&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimated_width</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>wlen</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;wlen&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimated_wlen</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>rel_height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;rel_height&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimated_rel_height</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>plateau_size</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;plateau_size&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=mf>0.0</span>
            <span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;The type of the `args` is not supported: </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
            <span class=p>)</span>

    <span class=k>def</span> <span class=nf>default_values</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Set the default values for the peak detection.&quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_height</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>threshold</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_threshold</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>distance</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_distance</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>prominence</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_prominence</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>width</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimated_width</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>wlen</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimated_wlen</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>rel_height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimated_rel_height</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>plateau_size</span> <span class=o>=</span> <span class=mi>0</span>

    <span class=k>def</span> <span class=nf>__autodetect__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return peak positions and properties.&quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=n>find_peaks</span><span class=p>(</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>,</span>
            <span class=n>height</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>height</span><span class=p>,</span>
            <span class=n>threshold</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>threshold</span><span class=p>,</span>
            <span class=n>distance</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>distance</span><span class=p>,</span>
            <span class=n>prominence</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>prominence</span><span class=p>,</span>
            <span class=n>width</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>width</span><span class=p>,</span>
            <span class=n>wlen</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>wlen</span><span class=p>,</span>
            <span class=n>rel_height</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>rel_height</span><span class=p>,</span>
            <span class=n>plateau_size</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>plateau_size</span><span class=p>,</span>
        <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimate_distance class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimate_distance</span><span class=p>:</span> <span class=nb>float</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimate_distance class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the initial distance between peaks.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>float</code></td> <td> <code>float</code> </td> <td><p>Estimated distance between peaks.</p></td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimate_height class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimate_height</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimate_height class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the initial height based on an inverse noise ratio of a signal.</p> <div class="admonition info"> <p class=admonition-title>About the estimation of the height</p> <p>The lower end of the height is the inverse noise ratio of the <code>data</code>, and upper limit is the maximum value of the <code>data</code>. The noise ratio of the <code>data</code> is based on the original implementation by <code>SciPy</code>:</p> <div class="language-python highlight"><pre><span></span><code><span class=k>def</span> <span class=nf>signaltonoise</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>ddof</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>
    <span class=n>a</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>asanyarray</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
    <span class=n>m</span> <span class=o>=</span> <span class=n>a</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>axis</span><span class=p>)</span>
    <span class=n>sd</span> <span class=o>=</span> <span class=n>a</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=n>axis</span><span class=p>,</span> <span class=n>ddof</span><span class=o>=</span><span class=n>ddof</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>sd</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>m</span> <span class=o>/</span> <span class=n>sd</span><span class=p>)</span>
</code></pre></div> </div> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=typing.Tuple>Tuple</span>[float, float]</code> </td> <td><p>Tuple[float, float]: Tuple of the inverse signal to noise ratio and the maximum value of the <code>data</code>.</p></td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimate_prominence class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimate_prominence</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimate_prominence class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the prominence of a peak.</p> <div class="admonition info"> <p class=admonition-title>About the estimation of the prominence</p> <p>The prominence is the difference between the height of the peak and the bottom. To get a estimate of the prominence, the height of the peak is calculated by maximum value of the <code>data</code> and the bottom is calculated by the harmonic mean of the <code>data</code>.</p> </div> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=typing.Tuple>Tuple</span>[float, float]</code> </td> <td><p>Tuple[float, float]: Tuple of the harmonic-mean and maximum value of <code>data</code>.</p></td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimate_threshold class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimate_threshold</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimate_threshold class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the threshold value for the peak detection.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=typing.Tuple>Tuple</span>[float, float]</code> </td> <td><p>Tuple[float, float]: Minimum and maximum value of the spectrum <code>data</code>, respectively, <code>intensity</code>.</p></td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimated_plateau_size class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimated_plateau_size</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimated_plateau_size class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the plateau size for the peak detection.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=typing.Tuple>Tuple</span>[float, float]</code> </td> <td><p>Tuple[float, float]: Estimated plateau size is set to <code>zero</code> for the lower end and the maximum value of the <code>x</code> for the upper end.</p></td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimated_rel_height class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimated_rel_height</span><span class=p>:</span> <span class=nb>float</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimated_rel_height class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the relative height of a peak.</p> <div class="admonition info"> <p class=admonition-title>About the estimation of the relative height</p> <p>The relative height of a peak is approximated by the difference of the harmonic mean value of the <code>data</code> and the minimum value of the <code>data</code> divided by the factor of <code>4</code>. In case of negative ratios, the value will be set to <code>Zero</code>.</p> </div> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>float</code></td> <td> <code>float</code> </td> <td><p>Estimated relative height of a peak.</p></td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimated_width class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimated_width</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimated_width class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the width of a peak.</p> <div class="admonition info"> <p class=admonition-title>About the estimation of the width</p> <p>The width of a peak is estimated for a lower and an upper end. For the lower end, the minimum stepsize is used. For the upper end, the stepsize between the half maximum and the minimum value of the <code>data</code> is used as the width.</p> </div> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=typing.Tuple>Tuple</span>[float, float]</code> </td> <td><p>Tuple[float, float]: Estimated width lower and uper end of the peaks.</p></td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimated_wlen class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimated_wlen</span><span class=p>:</span> <span class=nb>float</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimated_wlen class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the window length for the peak detection.</p> <div class="admonition info"> <p class=admonition-title>About the estimation of the window length</p> <p>The window length is the length of the window for the peak detection is defined to be 1% of the length of the <code>data</code>, consequently the len of the <code>data</code> is divided by 100. In case of a window length smaller than 1, the window length will be set to numerical value of 1, which is defined by <code>1 + 1e-9</code>.</p> </div> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>float</code></td> <td> <code>float</code> </td> <td><p>Estimated window length is set to the numeric value of &gt; 1.</p></td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.AutoPeakDetection.__autodetect__ class="doc doc-heading"> <code class="highlight language-python"><span class=n>__autodetect__</span><span class=p>()</span></code> <a href=#spectrafit.models.AutoPeakDetection.__autodetect__ class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return peak positions and properties.</p> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>876</span>
<span class=normal>877</span>
<span class=normal>878</span>
<span class=normal>879</span>
<span class=normal>880</span>
<span class=normal>881</span>
<span class=normal>882</span>
<span class=normal>883</span>
<span class=normal>884</span>
<span class=normal>885</span>
<span class=normal>886</span>
<span class=normal>887</span>
<span class=normal>888</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>__autodetect__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return peak positions and properties.&quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>find_peaks</span><span class=p>(</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>,</span>
        <span class=n>height</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>height</span><span class=p>,</span>
        <span class=n>threshold</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>threshold</span><span class=p>,</span>
        <span class=n>distance</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>distance</span><span class=p>,</span>
        <span class=n>prominence</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>prominence</span><span class=p>,</span>
        <span class=n>width</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>width</span><span class=p>,</span>
        <span class=n>wlen</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>wlen</span><span class=p>,</span>
        <span class=n>rel_height</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>rel_height</span><span class=p>,</span>
        <span class=n>plateau_size</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>plateau_size</span><span class=p>,</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.AutoPeakDetection.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>data</span><span class=p>,</span> <span class=n>args</span><span class=p>)</span></code> <a href=#spectrafit.models.AutoPeakDetection.__init__ class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Initialize the AutoPeakDetection class.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>data</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>y</code>-values of the data as 1d-array.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>args</code></td> <td> <code><span title=typing.Dict>Dict</span>[str, <span title=typing.Any>Any</span>]</code> </td> <td><p>The input file arguments as a dictionary with additional information beyond the command line arguments.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>645</span>
<span class=normal>646</span>
<span class=normal>647</span>
<span class=normal>648</span>
<span class=normal>649</span>
<span class=normal>650</span>
<span class=normal>651</span>
<span class=normal>652</span>
<span class=normal>653</span>
<span class=normal>654</span>
<span class=normal>655</span>
<span class=normal>656</span>
<span class=normal>657</span>
<span class=normal>658</span>
<span class=normal>659</span>
<span class=normal>660</span>
<span class=normal>661</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>data</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the AutoPeakDetection class.</span>

<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        data (NDArray[np.float64]): `y`-values of the data as 1d-array.</span>
<span class=sd>        args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<span class=sd>             additional information beyond the command line arguments.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>=</span> <span class=n>x</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=n>data</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_args</span> <span class=o>=</span> <span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.AutoPeakDetection.check_key_exists class="doc doc-heading"> <code class="highlight language-python"><span class=n>check_key_exists</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>args</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.check_key_exists class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Check if a key exists in a dictionary.</p> <p>Please check for the reference key also <a href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.find_peaks.html>scipy.signal.find_peaks</a>.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>key</code></td> <td> <code>str</code> </td> <td><p>Reference key of <code>scipy.signal.find_peaks</code>.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>args</code></td> <td> <code><span title=typing.Dict>Dict</span>[str, <span title=typing.Any>Any</span>]</code> </td> <td><p>Reference values of <code>scipy.signal.find_peaks</code>, if not defined will be set to estimated default values.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>value</code></td> <td> <code><span title=typing.Union>Union</span>[float, <span title=typing.Tuple>Tuple</span>[float, float]]</code> </td> <td><p>Default value for the reference key.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Any</code></td> <td> <code><span title=typing.Any>Any</span></code> </td> <td><p>The reference value for <code>scipy.signal.find_peaks</code>.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>663</span>
<span class=normal>664</span>
<span class=normal>665</span>
<span class=normal>666</span>
<span class=normal>667</span>
<span class=normal>668</span>
<span class=normal>669</span>
<span class=normal>670</span>
<span class=normal>671</span>
<span class=normal>672</span>
<span class=normal>673</span>
<span class=normal>674</span>
<span class=normal>675</span>
<span class=normal>676</span>
<span class=normal>677</span>
<span class=normal>678</span>
<span class=normal>679</span>
<span class=normal>680</span>
<span class=normal>681</span>
<span class=normal>682</span>
<span class=normal>683</span>
<span class=normal>684</span>
<span class=normal>685</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>check_key_exists</span><span class=p>(</span>
    <span class=n>key</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=n>value</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>Any</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Check if a key exists in a dictionary.</span>

<span class=sd>    Please check for the reference key also [scipy.signal.find_peaks][1].</span>

<span class=sd>    [1]:</span>
<span class=sd>        https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.find_peaks.html</span>


<span class=sd>    Args:</span>
<span class=sd>        key (str): Reference key of `scipy.signal.find_peaks`.</span>
<span class=sd>        args (Dict[str, Any]): Reference values of `scipy.signal.find_peaks`, if not</span>
<span class=sd>             defined will be set to estimated default values.</span>
<span class=sd>        value (Union[float, Tuple[float,float]]): Default value for the reference</span>
<span class=sd>             key.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Any: The reference value for `scipy.signal.find_peaks`.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.AutoPeakDetection.default_values class="doc doc-heading"> <code class="highlight language-python"><span class=n>default_values</span><span class=p>()</span></code> <a href=#spectrafit.models.AutoPeakDetection.default_values class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Set the default values for the peak detection.</p> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>865</span>
<span class=normal>866</span>
<span class=normal>867</span>
<span class=normal>868</span>
<span class=normal>869</span>
<span class=normal>870</span>
<span class=normal>871</span>
<span class=normal>872</span>
<span class=normal>873</span>
<span class=normal>874</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>default_values</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Set the default values for the peak detection.&quot;&quot;&quot;</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_height</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>threshold</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_threshold</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>distance</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_distance</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>prominence</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_prominence</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>width</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimated_width</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>wlen</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimated_wlen</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>rel_height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimated_rel_height</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>plateau_size</span> <span class=o>=</span> <span class=mi>0</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.AutoPeakDetection.initialize_peak_detection class="doc doc-heading"> <code class="highlight language-python"><span class=n>initialize_peak_detection</span><span class=p>()</span></code> <a href=#spectrafit.models.AutoPeakDetection.initialize_peak_detection class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Initialize the peak detection.</p> <div class="admonition note"> <p class=admonition-title>Initialize the peak detection</p> <p>This method is used to initialize the peak detection. The initialization can be activated by setting the <code>initialize</code> attribute to <code>True</code>, which will automatically estimate the default parameters for the peak detection. In case of the <code>initialize</code> attribute is defined as dictionary, the proposed values are taken from the dictionary if th</p> </div> <details class=raise> <summary>Raise</summary> </details> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>818</span>
<span class=normal>819</span>
<span class=normal>820</span>
<span class=normal>821</span>
<span class=normal>822</span>
<span class=normal>823</span>
<span class=normal>824</span>
<span class=normal>825</span>
<span class=normal>826</span>
<span class=normal>827</span>
<span class=normal>828</span>
<span class=normal>829</span>
<span class=normal>830</span>
<span class=normal>831</span>
<span class=normal>832</span>
<span class=normal>833</span>
<span class=normal>834</span>
<span class=normal>835</span>
<span class=normal>836</span>
<span class=normal>837</span>
<span class=normal>838</span>
<span class=normal>839</span>
<span class=normal>840</span>
<span class=normal>841</span>
<span class=normal>842</span>
<span class=normal>843</span>
<span class=normal>844</span>
<span class=normal>845</span>
<span class=normal>846</span>
<span class=normal>847</span>
<span class=normal>848</span>
<span class=normal>849</span>
<span class=normal>850</span>
<span class=normal>851</span>
<span class=normal>852</span>
<span class=normal>853</span>
<span class=normal>854</span>
<span class=normal>855</span>
<span class=normal>856</span>
<span class=normal>857</span>
<span class=normal>858</span>
<span class=normal>859</span>
<span class=normal>860</span>
<span class=normal>861</span>
<span class=normal>862</span>
<span class=normal>863</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>initialize_peak_detection</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the peak detection.</span>

<span class=sd>    !!! note &quot;Initialize the peak detection&quot;</span>

<span class=sd>        This method is used to initialize the peak detection. The initialization can</span>
<span class=sd>        be activated by setting the `initialize` attribute to `True`, which will</span>
<span class=sd>        automatically estimate the default parameters for the peak detection. In</span>
<span class=sd>        case of the `initialize` attribute is defined as dictionary, the proposed</span>
<span class=sd>        values are taken from the dictionary if th</span>

<span class=sd>    Raise:</span>
<span class=sd>        TypeError: If the `initialize` attribute is not of type `bool` or `dict`.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>default_values</span><span class=p>()</span>
    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
        <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>detection_check</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;height&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_height</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>threshold</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;threshold&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_threshold</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>distance</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;distance&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_distance</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>prominence</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;prominence&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_prominence</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>width</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;width&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimated_width</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>wlen</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;wlen&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimated_wlen</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>rel_height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;rel_height&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimated_rel_height</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>plateau_size</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;plateau_size&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=mf>0.0</span>
        <span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
            <span class=sa>f</span><span class=s2>&quot;The type of the `args` is not supported: </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
        <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=spectrafit.models.Constants class="doc doc-heading"> <code>Constants</code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small> </span> <a href=#spectrafit.models.Constants class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p>Mathematical constants for the curve models.</p> <div class="admonition info"> <p class=admonition-title>Constants</p> <ol> <li> <p>Natural logarithm of 2</p> <div class=arithmatex>\[ ln2 = \log{2} \]</div> </li> <li> <p>Square root of 2 times pi</p> <div class=arithmatex>\[ sq2pi = \sqrt{2 \pi} \]</div> </li> <li> <p>Square root of pi</p> <div class=arithmatex>\[ sqpi = \sqrt{ \pi} \]</div> </li> <li> <p>Square root of 2</p> <div class=arithmatex>\[ sq2 = \sqrt{2} \]</div> </li> <li> <p>Full width at half maximum to sigma for Gaussian</p> <div class=arithmatex>\[ fwhmg2sig = \frac{1}{ 2 \sqrt{2\log{2}}} \]</div> </li> <li> <p>Full width at half maximum to sigma for Lorentzian</p> <div class=arithmatex>\[ fwhml2sig = \frac{1}{2} \]</div> </li> <li> <p>Full width at half maximum to sigma for Voigt according to the article by Olivero and Longbothum<sup id=spectrafit.models.Constants--fnref:1><a class=footnote-ref href=#spectrafit.models.Constants--fn:1>1</a></sup>, check also <a href=https://xpslibrary.com/voigt-peak-shape/ >XPSLibary website</a>.</p> <p>$$ fwhm_{\text{Voigt}} \approx 0.5346 \cdot fwhm_{\text{Gaussian}} + \sqrt{ 0.2166 fwhm_{\text{Lorentzian}}^2 + fwhm_{\text{Gaussian}}^2 }</p> <p>$$</p> <p>In case of equal FWHM for Gaussian and Lorentzian, the Voigt FWHM can be defined as:</p> <div class=arithmatex>\[ fwhm_{\text{Voigt}} \approx 1.0692 + 2 \sqrt{0.2166 + 2 \ln{2}} \cdot \sigma \]</div> <div class=arithmatex>\[ fwhmv2sig = \frac{1}{fwhm_{\text{Voigt}}} \]</div> </li> </ol> </div> <div class=footnote> <hr> <ol> <li id=spectrafit.models.Constants--fn:1> <p>J.J. Olivero, R.L. Longbothum, <em>Empirical fits to the Voigt line width: A brief review</em>, <strong>Journal of Quantitative Spectroscopy and Radiative Transfer</strong>, Volume 17, Issue 2, 1977, Pages 233-236, ISSN 0022-4073, <a href=https://doi.org/10.1016/0022-4073(77)90161-3>https://doi.org/10.1016/0022-4073(77)90161-3</a>.&#160;<a class=footnote-backref href=#spectrafit.models.Constants--fnref:1 title="Jump back to footnote 1 in the text">&#8617;</a></p> </li> </ol> </div> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>562</span>
<span class=normal>563</span>
<span class=normal>564</span>
<span class=normal>565</span>
<span class=normal>566</span>
<span class=normal>567</span>
<span class=normal>568</span>
<span class=normal>569</span>
<span class=normal>570</span>
<span class=normal>571</span>
<span class=normal>572</span>
<span class=normal>573</span>
<span class=normal>574</span>
<span class=normal>575</span>
<span class=normal>576</span>
<span class=normal>577</span>
<span class=normal>578</span>
<span class=normal>579</span>
<span class=normal>580</span>
<span class=normal>581</span>
<span class=normal>582</span>
<span class=normal>583</span>
<span class=normal>584</span>
<span class=normal>585</span>
<span class=normal>586</span>
<span class=normal>587</span>
<span class=normal>588</span>
<span class=normal>589</span>
<span class=normal>590</span>
<span class=normal>591</span>
<span class=normal>592</span>
<span class=normal>593</span>
<span class=normal>594</span>
<span class=normal>595</span>
<span class=normal>596</span>
<span class=normal>597</span>
<span class=normal>598</span>
<span class=normal>599</span>
<span class=normal>600</span>
<span class=normal>601</span>
<span class=normal>602</span>
<span class=normal>603</span>
<span class=normal>604</span>
<span class=normal>605</span>
<span class=normal>606</span>
<span class=normal>607</span>
<span class=normal>608</span>
<span class=normal>609</span>
<span class=normal>610</span>
<span class=normal>611</span>
<span class=normal>612</span>
<span class=normal>613</span>
<span class=normal>614</span>
<span class=normal>615</span>
<span class=normal>616</span>
<span class=normal>617</span>
<span class=normal>618</span>
<span class=normal>619</span>
<span class=normal>620</span>
<span class=normal>621</span>
<span class=normal>622</span>
<span class=normal>623</span>
<span class=normal>624</span>
<span class=normal>625</span>
<span class=normal>626</span>
<span class=normal>627</span>
<span class=normal>628</span>
<span class=normal>629</span>
<span class=normal>630</span>
<span class=normal>631</span>
<span class=normal>632</span>
<span class=normal>633</span>
<span class=normal>634</span>
<span class=normal>635</span>
<span class=normal>636</span>
<span class=normal>637</span>
<span class=normal>638</span>
<span class=normal>639</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@dataclass</span><span class=p>(</span><span class=n>frozen</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=k>class</span> <span class=nc>Constants</span><span class=p>:</span>
<span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Mathematical constants for the curve models.</span>

<span class=sd>    !!! info &quot;Constants&quot;</span>

<span class=sd>        1. Natural logarithm of 2</span>

<span class=sd>            $$</span>
<span class=sd>            ln2 = \log{2}</span>
<span class=sd>            $$</span>

<span class=sd>        2. Square root of 2 times pi</span>

<span class=sd>            $$</span>
<span class=sd>            sq2pi = \sqrt{2 \pi}</span>
<span class=sd>            $$</span>

<span class=sd>        3. Square root of pi</span>

<span class=sd>            $$</span>
<span class=sd>            sqpi = \sqrt{ \pi}</span>
<span class=sd>            $$</span>

<span class=sd>        4. Square root of 2</span>

<span class=sd>            $$</span>
<span class=sd>            sq2 = \sqrt{2}</span>
<span class=sd>            $$</span>

<span class=sd>        5. Full width at half maximum to sigma for Gaussian</span>

<span class=sd>            $$</span>
<span class=sd>            fwhmg2sig = \frac{1}{ 2 \sqrt{2\log{2}}}</span>
<span class=sd>            $$</span>

<span class=sd>        6. Full width at half maximum to sigma for Lorentzian</span>

<span class=sd>            $$</span>
<span class=sd>            fwhml2sig = \frac{1}{2}</span>
<span class=sd>            $$</span>

<span class=sd>        7. Full width at half maximum to sigma for Voigt according to the article by</span>
<span class=sd>            Olivero and Longbothum[^1], check also</span>
<span class=sd>            [XPSLibary website](https://xpslibrary.com/voigt-peak-shape/).</span>

<span class=sd>            $$</span>
<span class=sd>            fwhm_{\text{Voigt}} \approx 0.5346 \cdot fwhm_{\text{Gaussian}} +</span>
<span class=sd>              \sqrt{ 0.2166 fwhm_{\text{Lorentzian}}^2  + fwhm_{\text{Gaussian}}^2 }</span>

<span class=sd>            $$</span>

<span class=sd>            In case of equal FWHM for Gaussian and Lorentzian, the Voigt FWHM can be</span>
<span class=sd>            defined as:</span>

<span class=sd>            $$</span>
<span class=sd>            fwhm_{\text{Voigt}} \approx 1.0692 + 2 \sqrt{0.2166 + 2 \ln{2}} \cdot \sigma</span>
<span class=sd>            $$</span>

<span class=sd>            $$</span>
<span class=sd>            fwhmv2sig = \frac{1}{fwhm_{\text{Voigt}}}</span>
<span class=sd>            $$</span>

<span class=sd>        [^1]:</span>
<span class=sd>            J.J. Olivero, R.L. Longbothum,</span>
<span class=sd>            _Empirical fits to the Voigt line width: A brief review_,</span>
<span class=sd>            **Journal of Quantitative Spectroscopy and Radiative Transfer**,</span>
<span class=sd>            Volume 17, Issue 2, 1977, Pages 233-236, ISSN 0022-4073,</span>
<span class=sd>            https://doi.org/10.1016/0022-4073(77)90161-3.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>ln2</span> <span class=o>=</span> <span class=n>log</span><span class=p>(</span><span class=mf>2.0</span><span class=p>)</span>
    <span class=n>sq2pi</span> <span class=o>=</span> <span class=n>sqrt</span><span class=p>(</span><span class=mf>2.0</span> <span class=o>*</span> <span class=n>pi</span><span class=p>)</span>
    <span class=n>sqpi</span> <span class=o>=</span> <span class=n>sqrt</span><span class=p>(</span><span class=n>pi</span><span class=p>)</span>
    <span class=n>sq2</span> <span class=o>=</span> <span class=n>sqrt</span><span class=p>(</span><span class=mf>2.0</span><span class=p>)</span>
    <span class=n>fwhmg2sig</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=p>(</span><span class=mf>2.0</span> <span class=o>*</span> <span class=n>sqrt</span><span class=p>(</span><span class=mf>2.0</span> <span class=o>*</span> <span class=n>log</span><span class=p>(</span><span class=mf>2.0</span><span class=p>)))</span>
    <span class=n>fwhml2sig</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=mf>2.0</span>
    <span class=n>fwhmv2sig</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=mf>0.5346</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>sqrt</span><span class=p>(</span><span class=mf>0.2166</span> <span class=o>+</span> <span class=n>log</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span><span class=p>))</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=spectrafit.models.DistributionModels class="doc doc-heading"> <code>DistributionModels</code> <a href=#spectrafit.models.DistributionModels class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p>Distribution models for the fit.</p> <div class="admonition note"> <p class=admonition-title>About distribution models</p> <p><code>DistributionModels</code> are wrapper functions for the distribution models. The overall goal is to extract from the best parameters the single contributions in the model. The superposition of the single contributions is the final model.</p> </div> <div class="admonition note"> <p class=admonition-title>About the cumulative distribution</p> <p>The cumulative distribution is the sum of the single contributions. The cumulative distribution is the model that is fitted to the data. In contrast to the single contributions, the cumulative distribution is not normalized and therefore the amplitude of the single contributions is not directly comparable to the amplitude of the cumulative distribution. Also, the cumulative distributions are consquently using the <code>fwhm</code> parameter instead of the <code>sigma</code> parameter.</p> </div> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span>
<span class=normal>150</span>
<span class=normal>151</span>
<span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span>
<span class=normal>164</span>
<span class=normal>165</span>
<span class=normal>166</span>
<span class=normal>167</span>
<span class=normal>168</span>
<span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span>
<span class=normal>172</span>
<span class=normal>173</span>
<span class=normal>174</span>
<span class=normal>175</span>
<span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span>
<span class=normal>200</span>
<span class=normal>201</span>
<span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span>
<span class=normal>242</span>
<span class=normal>243</span>
<span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span>
<span class=normal>288</span>
<span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span>
<span class=normal>295</span>
<span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span>
<span class=normal>366</span>
<span class=normal>367</span>
<span class=normal>368</span>
<span class=normal>369</span>
<span class=normal>370</span>
<span class=normal>371</span>
<span class=normal>372</span>
<span class=normal>373</span>
<span class=normal>374</span>
<span class=normal>375</span>
<span class=normal>376</span>
<span class=normal>377</span>
<span class=normal>378</span>
<span class=normal>379</span>
<span class=normal>380</span>
<span class=normal>381</span>
<span class=normal>382</span>
<span class=normal>383</span>
<span class=normal>384</span>
<span class=normal>385</span>
<span class=normal>386</span>
<span class=normal>387</span>
<span class=normal>388</span>
<span class=normal>389</span>
<span class=normal>390</span>
<span class=normal>391</span>
<span class=normal>392</span>
<span class=normal>393</span>
<span class=normal>394</span>
<span class=normal>395</span>
<span class=normal>396</span>
<span class=normal>397</span>
<span class=normal>398</span>
<span class=normal>399</span>
<span class=normal>400</span>
<span class=normal>401</span>
<span class=normal>402</span>
<span class=normal>403</span>
<span class=normal>404</span>
<span class=normal>405</span>
<span class=normal>406</span>
<span class=normal>407</span>
<span class=normal>408</span>
<span class=normal>409</span>
<span class=normal>410</span>
<span class=normal>411</span>
<span class=normal>412</span>
<span class=normal>413</span>
<span class=normal>414</span>
<span class=normal>415</span>
<span class=normal>416</span>
<span class=normal>417</span>
<span class=normal>418</span>
<span class=normal>419</span>
<span class=normal>420</span>
<span class=normal>421</span>
<span class=normal>422</span>
<span class=normal>423</span>
<span class=normal>424</span>
<span class=normal>425</span>
<span class=normal>426</span>
<span class=normal>427</span>
<span class=normal>428</span>
<span class=normal>429</span>
<span class=normal>430</span>
<span class=normal>431</span>
<span class=normal>432</span>
<span class=normal>433</span>
<span class=normal>434</span>
<span class=normal>435</span>
<span class=normal>436</span>
<span class=normal>437</span>
<span class=normal>438</span>
<span class=normal>439</span>
<span class=normal>440</span>
<span class=normal>441</span>
<span class=normal>442</span>
<span class=normal>443</span>
<span class=normal>444</span>
<span class=normal>445</span>
<span class=normal>446</span>
<span class=normal>447</span>
<span class=normal>448</span>
<span class=normal>449</span>
<span class=normal>450</span>
<span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span>
<span class=normal>464</span>
<span class=normal>465</span>
<span class=normal>466</span>
<span class=normal>467</span>
<span class=normal>468</span>
<span class=normal>469</span>
<span class=normal>470</span>
<span class=normal>471</span>
<span class=normal>472</span>
<span class=normal>473</span>
<span class=normal>474</span>
<span class=normal>475</span>
<span class=normal>476</span>
<span class=normal>477</span>
<span class=normal>478</span>
<span class=normal>479</span>
<span class=normal>480</span>
<span class=normal>481</span>
<span class=normal>482</span>
<span class=normal>483</span>
<span class=normal>484</span>
<span class=normal>485</span>
<span class=normal>486</span>
<span class=normal>487</span>
<span class=normal>488</span>
<span class=normal>489</span>
<span class=normal>490</span>
<span class=normal>491</span>
<span class=normal>492</span>
<span class=normal>493</span>
<span class=normal>494</span>
<span class=normal>495</span>
<span class=normal>496</span>
<span class=normal>497</span>
<span class=normal>498</span>
<span class=normal>499</span>
<span class=normal>500</span>
<span class=normal>501</span>
<span class=normal>502</span>
<span class=normal>503</span>
<span class=normal>504</span>
<span class=normal>505</span>
<span class=normal>506</span>
<span class=normal>507</span>
<span class=normal>508</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span> <span class=nc>DistributionModels</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Distribution models for the fit.</span>

<span class=sd>    !!! note &quot;About distribution models&quot;</span>

<span class=sd>        `DistributionModels` are wrapper functions for the distribution models. The</span>
<span class=sd>        overall goal is to extract from the best parameters the single contributions in</span>
<span class=sd>        the model. The superposition of the single contributions is the final model.</span>

<span class=sd>    !!! note &quot;About the cumulative distribution&quot;</span>

<span class=sd>        The cumulative distribution is the sum of the single contributions. The</span>
<span class=sd>        cumulative distribution is the model that is fitted to the data. In contrast to</span>
<span class=sd>        the single contributions, the cumulative distribution is not normalized and</span>
<span class=sd>        therefore the amplitude of the single contributions is not directly comparable</span>
<span class=sd>        to the amplitude of the cumulative distribution. Also, the cumulative</span>
<span class=sd>        distributions are consquently using the `fwhm` parameter instead of the</span>
<span class=sd>        `sigma` parameter.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>gaussian</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
        <span class=n>fwhmg</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Gaussian distribution.</span>

<span class=sd>        $$</span>
<span class=sd>        {\displaystyle g(x)={\frac {1}{\sigma {\sqrt {2\pi }}}}\exp</span>
<span class=sd>        (  -{\frac {1}{2}}{\frac {(x-\mu )^{2}}{\sigma ^{2}}} ) }</span>
<span class=sd>        $$</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            amplitude (float, optional): Amplitude of the Gaussian distribution.</span>
<span class=sd>                 Defaults to 1.0.</span>
<span class=sd>            center (float, optional): Center of the Gaussian distribution.</span>
<span class=sd>                 Defaults to 0.0.</span>
<span class=sd>            fwhmg (float, optional): Full width at half maximum (FWHM) of the Gaussian</span>
<span class=sd>                distribution. Defaults to 1.0.</span>

<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: Gaussian distribution of `x` given.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmg</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmg2sig</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>/</span> <span class=p>(</span><span class=n>Constants</span><span class=o>.</span><span class=n>sq2pi</span> <span class=o>*</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span>
            <span class=o>-</span><span class=p>((</span><span class=mf>1.0</span> <span class=o>*</span> <span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>sigma</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
        <span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>lorentzian</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
        <span class=n>fwhml</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Lorentzian distribution.</span>

<span class=sd>        $$</span>
<span class=sd>        f(x;x_{0},\gamma )={\frac  {1}{\pi \gamma</span>
<span class=sd>        [ 1+ ( {\frac  {x-x_{0}}{\gamma }})^{2} ]</span>
<span class=sd>        }} ={1 \over \pi \gamma } [ {\gamma ^{2} \over (x-x_{0})^{2}+\gamma ^{2}} ]</span>
<span class=sd>        $$</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            amplitude (float, optional): Amplitude of the Lorentzian distribution.</span>
<span class=sd>                Defaults to 1.0.</span>
<span class=sd>            center (float, optional): Center of the Lorentzian distribution. Defaults to</span>
<span class=sd>                0.0.</span>
<span class=sd>            fwhml (float, optional): Full width at half maximum (FWHM) of the Lorentzian</span>
<span class=sd>                distribution. Defaults to 1.0.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Union[NDArray[np.float64], float]: Lorentzian distribution of `x` given.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhml</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhml2sig</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=p>((</span><span class=mf>1.0</span> <span class=o>*</span> <span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span> <span class=o>/</span> <span class=p>(</span>
            <span class=n>pi</span> <span class=o>*</span> <span class=n>sigma</span>
        <span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>voigt</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
        <span class=n>fwhmv</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>gamma</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Voigt distribution.</span>

<span class=sd>        $$</span>
<span class=sd>        {\displaystyle V(x;\sigma ,\gamma )\equiv</span>
<span class=sd>        \int_{-\infty }^{\infty }G(x&#39;;\sigma )</span>
<span class=sd>        L(x-x&#39;;\gamma )\,dx&#39;}</span>
<span class=sd>        $$</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            center (float, optional): Center of the Voigt distribution. Defaults to 0.0.</span>
<span class=sd>            fwhmv (float, optional): Full width at half maximum (FWHM) of the Lorentzian</span>
<span class=sd>                distribution. Defaults to 1.0.</span>
<span class=sd>            gamma (float, optional): Scaling factor of the complex part of the</span>
<span class=sd>                [Faddeeva Function](https://en.wikipedia.org/wiki/Faddeeva_function).</span>
<span class=sd>                Defaults to None.</span>

<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: Voigt distribution of `x` given.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmv</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmv2sig</span>
        <span class=k>if</span> <span class=n>gamma</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>gamma</span> <span class=o>=</span> <span class=n>sigma</span>
        <span class=n>z</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span> <span class=o>+</span> <span class=mi>1</span><span class=n>j</span> <span class=o>*</span> <span class=n>gamma</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>sq2</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>wofz</span><span class=p>(</span><span class=n>z</span><span class=p>)</span><span class=o>.</span><span class=n>real</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>sq2pi</span><span class=p>))</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>pseudovoigt</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
        <span class=n>fwhmg</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>fwhml</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Pseudo-Voigt distribution.</span>

<span class=sd>        !!! note &quot;See also:&quot;</span>

<span class=sd>            J. Appl. Cryst. (2000). 33, 1311-1316</span>
<span class=sd>            https://doi.org/10.1107/S0021889800010219</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]):  `x`-values of the data.</span>
<span class=sd>            amplitude (float, optional): Amplitude of the Pseudo-Voigt distribution.</span>
<span class=sd>                Defaults to 1.0.</span>
<span class=sd>            center (float, optional): Center of the Pseudo-Voigt distribution.</span>
<span class=sd>                Defaults to 0.0.</span>
<span class=sd>            fwhmg (float, optional): Full width half maximum of the Gaussian</span>
<span class=sd>                distribution in the Pseudo-Voigt distribution. Defaults to 1.0.</span>
<span class=sd>            fwhml (float, optional): Full width half maximum of the Lorentzian</span>
<span class=sd>                distribution in the Pseudo-Voigt distribution. Defaults to 1.0.</span>

<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: Pseudo-Voigt distribution of `x` given.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>f</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span>
            <span class=n>fwhmg</span><span class=o>**</span><span class=mi>5</span>
            <span class=o>+</span> <span class=mf>2.69269</span> <span class=o>*</span> <span class=n>fwhmg</span><span class=o>**</span><span class=mi>4</span> <span class=o>*</span> <span class=n>fwhml</span>
            <span class=o>+</span> <span class=mf>2.42843</span> <span class=o>*</span> <span class=n>fwhmg</span><span class=o>**</span><span class=mi>3</span> <span class=o>*</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>2</span>
            <span class=o>+</span> <span class=mf>4.47163</span> <span class=o>*</span> <span class=n>fwhmg</span><span class=o>**</span><span class=mi>2</span> <span class=o>*</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>3</span>
            <span class=o>+</span> <span class=mf>0.07842</span> <span class=o>*</span> <span class=n>fwhmg</span> <span class=o>*</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>4</span>
            <span class=o>+</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>5</span><span class=p>,</span>
            <span class=mf>0.2</span><span class=p>,</span>
        <span class=p>)</span>
        <span class=n>n</span> <span class=o>=</span> <span class=p>(</span>
            <span class=mf>1.36603</span> <span class=o>*</span> <span class=p>(</span><span class=n>fwhml</span> <span class=o>/</span> <span class=n>f</span><span class=p>)</span>
            <span class=o>-</span> <span class=mf>0.47719</span> <span class=o>*</span> <span class=p>(</span><span class=n>fwhml</span> <span class=o>/</span> <span class=n>f</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span>
            <span class=o>+</span> <span class=mf>0.11116</span> <span class=o>*</span> <span class=p>(</span><span class=n>fwhml</span> <span class=o>/</span> <span class=n>f</span><span class=p>)</span> <span class=o>**</span> <span class=mi>3</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
            <span class=n>n</span>
            <span class=o>*</span> <span class=n>DistributionModels</span><span class=o>.</span><span class=n>lorentzian</span><span class=p>(</span>
                <span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=n>amplitude</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=n>center</span><span class=p>,</span> <span class=n>fwhml</span><span class=o>=</span><span class=n>fwhml</span>
            <span class=p>)</span>
            <span class=o>+</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>n</span><span class=p>)</span>
            <span class=o>*</span> <span class=n>DistributionModels</span><span class=o>.</span><span class=n>gaussian</span><span class=p>(</span>
                <span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=n>amplitude</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=n>center</span><span class=p>,</span> <span class=n>fwhmg</span><span class=o>=</span><span class=n>fwhmg</span>
            <span class=p>)</span>
        <span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>exponential</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>decay</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>intercept</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional exponential decay.</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            amplitude (float, optional): Amplitude of the exponential function.</span>
<span class=sd>                 Defaults to 1.0.</span>
<span class=sd>            decay (float, optional): Decay of the exponential function. Defaults to 1.0.</span>
<span class=sd>            intercept (float, optional): Intercept of the exponential function.</span>
<span class=sd>                 Defaults to 0.0.</span>

<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: Exponential decay of `x` given.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=n>x</span> <span class=o>/</span> <span class=n>decay</span><span class=p>)</span> <span class=o>+</span> <span class=n>intercept</span><span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>power</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>exponent</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>intercept</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional power function.</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            amplitude (float, optional): Amplitude of the power function. Defaults to</span>
<span class=sd>                1.0.</span>
<span class=sd>            exponent (float, optional): Exponent of the power function. Defaults to 1.0.</span>
<span class=sd>            intercept (float, optional): Intercept of the power function. Defaults to</span>
<span class=sd>                0.0.</span>

<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: power function of `x` given.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>exponent</span><span class=p>)</span> <span class=o>+</span> <span class=n>intercept</span><span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>linear</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>slope</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>intercept</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional linear function.</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            slope (float, optional): Slope of the linear function. Defaults to 1.0.</span>
<span class=sd>            intercept (float, optional): Intercept of the linear function.</span>
<span class=sd>                 Defaults to 0.0.</span>

<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: Linear function of `x` given.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>slope</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=n>intercept</span><span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>constant</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional constant value.</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            amplitude (float, optional): Amplitude of the constant. Defaults to 1.0.</span>

<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: Constant value of `x` given.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>amplitude</span><span class=p>,</span> <span class=n>amplitude</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)))</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>_norm</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span> <span class=n>center</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Normalize the data for step functions.</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            center (float): Center of the step function.</span>
<span class=sd>            sigma (float): Sigma of the step function.</span>

<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: Normalized data.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>sigma</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mf>1.0e-13</span><span class=p>:</span>
            <span class=n>sigma</span> <span class=o>=</span> <span class=mf>1.0e-13</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>subtract</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>erf</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
        <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional error function.</span>

<span class=sd>        $$</span>
<span class=sd>        f(x) = \frac{2}{\sqrt{\pi}} \int_{0}^{x} e^{-t^2} dt</span>
<span class=sd>        $$</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            amplitude (float, optional): Amplitude of the error function.</span>
<span class=sd>                    Defaults to 1.0.</span>
<span class=sd>            center (float, optional): Center of the error function. Defaults to 0.0.</span>
<span class=sd>            sigma (float, optional): Sigma of the error function. Defaults to 1.0.</span>

<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: Error function of `x` given.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
            <span class=n>amplitude</span> <span class=o>*</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>erf</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)))</span>
        <span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>heaviside</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
        <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Heaviside step function.</span>

<span class=sd>        $$</span>
<span class=sd>        f(x) = \begin{cases}</span>
<span class=sd>        0 &amp; x &lt; 0 \\</span>
<span class=sd>        0.5 &amp; x = 0 \\</span>
<span class=sd>        1 &amp; x &gt; 0</span>
<span class=sd>        \end{cases}</span>
<span class=sd>        $$</span>
<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            amplitude (float, optional): Amplitude of the Heaviside step function.</span>
<span class=sd>                    Defaults to 1.0.</span>
<span class=sd>            center (float, optional): Center of the Heaviside step function.</span>
<span class=sd>                 Defaults to 0.0.</span>
<span class=sd>            sigma (float, optional): Sigma of the Heaviside step function.</span>
<span class=sd>                 Defaults to 1.0.</span>


<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: Heaviside step function of `x` given.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
            <span class=n>amplitude</span> <span class=o>*</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>sign</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)))</span>
        <span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>atan</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
        <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional arctan step function.</span>

<span class=sd>        $$</span>
<span class=sd>        f(x) = \frac{1}{\pi} \arctan(\frac{x - c}{s})</span>
<span class=sd>        $$</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            amplitude (float, optional): Amplitude of the arctan step function.</span>
<span class=sd>                    Defaults to 1.0.</span>
<span class=sd>            center (float, optional): Center of the arctan step function.</span>
<span class=sd>                 Defaults to 0.0.</span>
<span class=sd>            sigma (float, optional): Sigma of the arctan step function.</span>
<span class=sd>                 Defaults to 1.0.</span>

<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: Arctan step function of `x` given.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
            <span class=n>amplitude</span>
            <span class=o>*</span> <span class=mf>0.5</span>
            <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>/</span> <span class=n>pi</span><span class=p>)</span>
        <span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>log</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
        <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional logarithmic step function.</span>

<span class=sd>        $$</span>
<span class=sd>        f(x) = \frac{1}{1 + e^{-\frac{x - c}{s}}}</span>
<span class=sd>        $$</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            amplitude (float, optional): Amplitude of the logarithmic step function.</span>
<span class=sd>                    Defaults to 1.0.</span>
<span class=sd>            center (float, optional): Center of the logarithmic step function.</span>
<span class=sd>                 Defaults to 0.0.</span>
<span class=sd>            sigma (float, optional): Sigma of the logarithmic step function.</span>
<span class=sd>                 Defaults to 1.0.</span>

<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: Logarithmic step function of `x` given.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
            <span class=n>amplitude</span>
            <span class=o>*</span> <span class=mf>0.5</span>
            <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>/</span> <span class=n>pi</span><span class=p>)</span>
        <span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>cgaussian</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
        <span class=n>fwhmg</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional cumulative Gaussian function.</span>

<span class=sd>        $$</span>
<span class=sd>        f(x) = \frac{1}{2} \left[1 + erf\left(\frac{x - c}{s \sqrt{2}}\right)\right]</span>
<span class=sd>        $$</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            amplitude (float, optional): Amplitude of the Gaussian function. Defaults to</span>
<span class=sd>                1.0.</span>
<span class=sd>            center (float, optional): Center of the Gaussian function. Defaults to 0.0.</span>
<span class=sd>            fwhmg (float, optional): Full width at half maximum of the Gaussian</span>
<span class=sd>                 function. Defaults to 1.0.</span>


<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: Cumulative Gaussian function of `x` given.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmg</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmg2sig</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
            <span class=n>amplitude</span> <span class=o>*</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>erf</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mf>2.0</span><span class=p>))))</span>
        <span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>clorentzian</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
        <span class=n>fwhml</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional cumulative Lorentzian function.</span>

<span class=sd>        $$</span>
<span class=sd>        f(x) = \frac{1}{\pi} \arctan\left(\frac{x - c}{s}\right) + \frac{1}{2}</span>
<span class=sd>        $$</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            amplitude (float, optional): Amplitude of the Lorentzian function.</span>
<span class=sd>                    Defaults to 1.0.</span>
<span class=sd>            center (float, optional): Center of the Lorentzian function.</span>
<span class=sd>                 Defaults to 0.0.</span>
<span class=sd>            fwhml (float, optional): Full width at half maximum of the Lorentzian</span>
<span class=sd>                function. Defaults to 1.0.</span>

<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: Cumulative Lorentzian function of `x` given.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhml</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhml2sig</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>*</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>)</span> <span class=o>/</span> <span class=n>pi</span><span class=p>)</span> <span class=o>+</span> <span class=mf>0.5</span><span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>cvoigt</span><span class=p>(</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
        <span class=n>fwhmv</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
        <span class=n>gamma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional cumulative Voigt function.</span>

<span class=sd>        $$</span>
<span class=sd>        f(x) = \frac{1}{2} \left[1 + erf\left(\frac{x - c}{s \sqrt{2}}\right)\right]</span>
<span class=sd>        $$</span>

<span class=sd>        Args:</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            amplitude (float, optional): Amplitude of the Voigt function. Defaults to</span>
<span class=sd>                1.0.</span>
<span class=sd>            center (float, optional): Center of the Voigt function. Defaults to 0.0.</span>
<span class=sd>            fwhmv (float, optional): Full width at half maximum of the Voigt function.</span>
<span class=sd>                Defaults to 1.0.</span>
<span class=sd>            gamma (float, optional): Gamma of the Voigt function. Defaults to 1.0.</span>

<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: Cumulative Voigt function of `x` given.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmv</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmv2sig</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
            <span class=n>amplitude</span>
            <span class=o>*</span> <span class=mf>0.5</span>
            <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>erf</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mf>2.0</span><span class=p>))))</span>
            <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=p>(((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>gamma</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
        <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.atan class="doc doc-heading"> <code class="highlight language-python"><span class=n>atan</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.atan class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional arctan step function.</p> <div class=arithmatex>\[ f(x) = \frac{1}{\pi} \arctan(\frac{x - c}{s}) \]</div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>amplitude</code></td> <td> <code>float</code> </td> <td><p>Amplitude of the arctan step function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>center</code></td> <td> <code>float</code> </td> <td><p>Center of the arctan step function. Defaults to 0.0.</p></td> <td> <code>0.0</code> </td> </tr> <tr> <td><code>sigma</code></td> <td> <code>float</code> </td> <td><p>Sigma of the arctan step function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: Arctan step function of <code>x</code> given.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span>
<span class=normal>366</span>
<span class=normal>367</span>
<span class=normal>368</span>
<span class=normal>369</span>
<span class=normal>370</span>
<span class=normal>371</span>
<span class=normal>372</span>
<span class=normal>373</span>
<span class=normal>374</span>
<span class=normal>375</span>
<span class=normal>376</span>
<span class=normal>377</span>
<span class=normal>378</span>
<span class=normal>379</span>
<span class=normal>380</span>
<span class=normal>381</span>
<span class=normal>382</span>
<span class=normal>383</span>
<span class=normal>384</span>
<span class=normal>385</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>atan</span><span class=p>(</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
    <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional arctan step function.</span>

<span class=sd>    $$</span>
<span class=sd>    f(x) = \frac{1}{\pi} \arctan(\frac{x - c}{s})</span>
<span class=sd>    $$</span>

<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        amplitude (float, optional): Amplitude of the arctan step function.</span>
<span class=sd>                Defaults to 1.0.</span>
<span class=sd>        center (float, optional): Center of the arctan step function.</span>
<span class=sd>             Defaults to 0.0.</span>
<span class=sd>        sigma (float, optional): Sigma of the arctan step function.</span>
<span class=sd>             Defaults to 1.0.</span>

<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: Arctan step function of `x` given.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
        <span class=n>amplitude</span>
        <span class=o>*</span> <span class=mf>0.5</span>
        <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>/</span> <span class=n>pi</span><span class=p>)</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.cgaussian class="doc doc-heading"> <code class="highlight language-python"><span class=n>cgaussian</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>fwhmg</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.cgaussian class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional cumulative Gaussian function.</p> <div class=arithmatex>\[ f(x) = \frac{1}{2} \left[1 + erf\left(\frac{x - c}{s \sqrt{2}}\right)\right] \]</div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>amplitude</code></td> <td> <code>float</code> </td> <td><p>Amplitude of the Gaussian function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>center</code></td> <td> <code>float</code> </td> <td><p>Center of the Gaussian function. Defaults to 0.0.</p></td> <td> <code>0.0</code> </td> </tr> <tr> <td><code>fwhmg</code></td> <td> <code>float</code> </td> <td><p>Full width at half maximum of the Gaussian function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: Cumulative Gaussian function of <code>x</code> given.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>418</span>
<span class=normal>419</span>
<span class=normal>420</span>
<span class=normal>421</span>
<span class=normal>422</span>
<span class=normal>423</span>
<span class=normal>424</span>
<span class=normal>425</span>
<span class=normal>426</span>
<span class=normal>427</span>
<span class=normal>428</span>
<span class=normal>429</span>
<span class=normal>430</span>
<span class=normal>431</span>
<span class=normal>432</span>
<span class=normal>433</span>
<span class=normal>434</span>
<span class=normal>435</span>
<span class=normal>436</span>
<span class=normal>437</span>
<span class=normal>438</span>
<span class=normal>439</span>
<span class=normal>440</span>
<span class=normal>441</span>
<span class=normal>442</span>
<span class=normal>443</span>
<span class=normal>444</span>
<span class=normal>445</span>
<span class=normal>446</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>cgaussian</span><span class=p>(</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
    <span class=n>fwhmg</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional cumulative Gaussian function.</span>

<span class=sd>    $$</span>
<span class=sd>    f(x) = \frac{1}{2} \left[1 + erf\left(\frac{x - c}{s \sqrt{2}}\right)\right]</span>
<span class=sd>    $$</span>

<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        amplitude (float, optional): Amplitude of the Gaussian function. Defaults to</span>
<span class=sd>            1.0.</span>
<span class=sd>        center (float, optional): Center of the Gaussian function. Defaults to 0.0.</span>
<span class=sd>        fwhmg (float, optional): Full width at half maximum of the Gaussian</span>
<span class=sd>             function. Defaults to 1.0.</span>


<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: Cumulative Gaussian function of `x` given.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmg</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmg2sig</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
        <span class=n>amplitude</span> <span class=o>*</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>erf</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mf>2.0</span><span class=p>))))</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.clorentzian class="doc doc-heading"> <code class="highlight language-python"><span class=n>clorentzian</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>fwhml</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.clorentzian class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional cumulative Lorentzian function.</p> <div class=arithmatex>\[ f(x) = \frac{1}{\pi} \arctan\left(\frac{x - c}{s}\right) + \frac{1}{2} \]</div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>amplitude</code></td> <td> <code>float</code> </td> <td><p>Amplitude of the Lorentzian function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>center</code></td> <td> <code>float</code> </td> <td><p>Center of the Lorentzian function. Defaults to 0.0.</p></td> <td> <code>0.0</code> </td> </tr> <tr> <td><code>fwhml</code></td> <td> <code>float</code> </td> <td><p>Full width at half maximum of the Lorentzian function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: Cumulative Lorentzian function of <code>x</code> given.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>448</span>
<span class=normal>449</span>
<span class=normal>450</span>
<span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span>
<span class=normal>464</span>
<span class=normal>465</span>
<span class=normal>466</span>
<span class=normal>467</span>
<span class=normal>468</span>
<span class=normal>469</span>
<span class=normal>470</span>
<span class=normal>471</span>
<span class=normal>472</span>
<span class=normal>473</span>
<span class=normal>474</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>clorentzian</span><span class=p>(</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
    <span class=n>fwhml</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional cumulative Lorentzian function.</span>

<span class=sd>    $$</span>
<span class=sd>    f(x) = \frac{1}{\pi} \arctan\left(\frac{x - c}{s}\right) + \frac{1}{2}</span>
<span class=sd>    $$</span>

<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        amplitude (float, optional): Amplitude of the Lorentzian function.</span>
<span class=sd>                Defaults to 1.0.</span>
<span class=sd>        center (float, optional): Center of the Lorentzian function.</span>
<span class=sd>             Defaults to 0.0.</span>
<span class=sd>        fwhml (float, optional): Full width at half maximum of the Lorentzian</span>
<span class=sd>            function. Defaults to 1.0.</span>

<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: Cumulative Lorentzian function of `x` given.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhml</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhml2sig</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>*</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>)</span> <span class=o>/</span> <span class=n>pi</span><span class=p>)</span> <span class=o>+</span> <span class=mf>0.5</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.constant class="doc doc-heading"> <code class="highlight language-python"><span class=n>constant</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.constant class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional constant value.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>amplitude</code></td> <td> <code>float</code> </td> <td><p>Amplitude of the constant. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: Constant value of <code>x</code> given.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>constant</span><span class=p>(</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional constant value.</span>

<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        amplitude (float, optional): Amplitude of the constant. Defaults to 1.0.</span>

<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: Constant value of `x` given.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>amplitude</span><span class=p>,</span> <span class=n>amplitude</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)))</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.cvoigt class="doc doc-heading"> <code class="highlight language-python"><span class=n>cvoigt</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>fwhmv</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>gamma</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.cvoigt class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional cumulative Voigt function.</p> <div class=arithmatex>\[ f(x) = \frac{1}{2} \left[1 + erf\left(\frac{x - c}{s \sqrt{2}}\right)\right] \]</div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>amplitude</code></td> <td> <code>float</code> </td> <td><p>Amplitude of the Voigt function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>center</code></td> <td> <code>float</code> </td> <td><p>Center of the Voigt function. Defaults to 0.0.</p></td> <td> <code>0.0</code> </td> </tr> <tr> <td><code>fwhmv</code></td> <td> <code>float</code> </td> <td><p>Full width at half maximum of the Voigt function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>gamma</code></td> <td> <code>float</code> </td> <td><p>Gamma of the Voigt function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: Cumulative Voigt function of <code>x</code> given.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>476</span>
<span class=normal>477</span>
<span class=normal>478</span>
<span class=normal>479</span>
<span class=normal>480</span>
<span class=normal>481</span>
<span class=normal>482</span>
<span class=normal>483</span>
<span class=normal>484</span>
<span class=normal>485</span>
<span class=normal>486</span>
<span class=normal>487</span>
<span class=normal>488</span>
<span class=normal>489</span>
<span class=normal>490</span>
<span class=normal>491</span>
<span class=normal>492</span>
<span class=normal>493</span>
<span class=normal>494</span>
<span class=normal>495</span>
<span class=normal>496</span>
<span class=normal>497</span>
<span class=normal>498</span>
<span class=normal>499</span>
<span class=normal>500</span>
<span class=normal>501</span>
<span class=normal>502</span>
<span class=normal>503</span>
<span class=normal>504</span>
<span class=normal>505</span>
<span class=normal>506</span>
<span class=normal>507</span>
<span class=normal>508</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>cvoigt</span><span class=p>(</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
    <span class=n>fwhmv</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>gamma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional cumulative Voigt function.</span>

<span class=sd>    $$</span>
<span class=sd>    f(x) = \frac{1}{2} \left[1 + erf\left(\frac{x - c}{s \sqrt{2}}\right)\right]</span>
<span class=sd>    $$</span>

<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        amplitude (float, optional): Amplitude of the Voigt function. Defaults to</span>
<span class=sd>            1.0.</span>
<span class=sd>        center (float, optional): Center of the Voigt function. Defaults to 0.0.</span>
<span class=sd>        fwhmv (float, optional): Full width at half maximum of the Voigt function.</span>
<span class=sd>            Defaults to 1.0.</span>
<span class=sd>        gamma (float, optional): Gamma of the Voigt function. Defaults to 1.0.</span>

<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: Cumulative Voigt function of `x` given.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmv</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmv2sig</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
        <span class=n>amplitude</span>
        <span class=o>*</span> <span class=mf>0.5</span>
        <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>erf</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mf>2.0</span><span class=p>))))</span>
        <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=p>(((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>gamma</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.erf class="doc doc-heading"> <code class="highlight language-python"><span class=n>erf</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.erf class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional error function.</p> <div class=arithmatex>\[ f(x) = \frac{2}{\sqrt{\pi}} \int_{0}^{x} e^{-t^2} dt \]</div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>amplitude</code></td> <td> <code>float</code> </td> <td><p>Amplitude of the error function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>center</code></td> <td> <code>float</code> </td> <td><p>Center of the error function. Defaults to 0.0.</p></td> <td> <code>0.0</code> </td> </tr> <tr> <td><code>sigma</code></td> <td> <code>float</code> </td> <td><p>Sigma of the error function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: Error function of <code>x</code> given.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>erf</span><span class=p>(</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
    <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional error function.</span>

<span class=sd>    $$</span>
<span class=sd>    f(x) = \frac{2}{\sqrt{\pi}} \int_{0}^{x} e^{-t^2} dt</span>
<span class=sd>    $$</span>

<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        amplitude (float, optional): Amplitude of the error function.</span>
<span class=sd>                Defaults to 1.0.</span>
<span class=sd>        center (float, optional): Center of the error function. Defaults to 0.0.</span>
<span class=sd>        sigma (float, optional): Sigma of the error function. Defaults to 1.0.</span>

<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: Error function of `x` given.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
        <span class=n>amplitude</span> <span class=o>*</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>erf</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)))</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.exponential class="doc doc-heading"> <code class="highlight language-python"><span class=n>exponential</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>decay</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>intercept</span><span class=o>=</span><span class=mf>0.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.exponential class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional exponential decay.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>amplitude</code></td> <td> <code>float</code> </td> <td><p>Amplitude of the exponential function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>decay</code></td> <td> <code>float</code> </td> <td><p>Decay of the exponential function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>intercept</code></td> <td> <code>float</code> </td> <td><p>Intercept of the exponential function. Defaults to 0.0.</p></td> <td> <code>0.0</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: Exponential decay of <code>x</code> given.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>199</span>
<span class=normal>200</span>
<span class=normal>201</span>
<span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>exponential</span><span class=p>(</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>decay</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>intercept</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional exponential decay.</span>

<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        amplitude (float, optional): Amplitude of the exponential function.</span>
<span class=sd>             Defaults to 1.0.</span>
<span class=sd>        decay (float, optional): Decay of the exponential function. Defaults to 1.0.</span>
<span class=sd>        intercept (float, optional): Intercept of the exponential function.</span>
<span class=sd>             Defaults to 0.0.</span>

<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: Exponential decay of `x` given.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=n>x</span> <span class=o>/</span> <span class=n>decay</span><span class=p>)</span> <span class=o>+</span> <span class=n>intercept</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.gaussian class="doc doc-heading"> <code class="highlight language-python"><span class=n>gaussian</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>fwhmg</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.gaussian class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional Gaussian distribution.</p> <div class=arithmatex>\[ {\displaystyle g(x)={\frac {1}{\sigma {\sqrt {2\pi }}}}\exp ( -{\frac {1}{2}}{\frac {(x-\mu )^{2}}{\sigma ^{2}}} ) } \]</div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>amplitude</code></td> <td> <code>float</code> </td> <td><p>Amplitude of the Gaussian distribution. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>center</code></td> <td> <code>float</code> </td> <td><p>Center of the Gaussian distribution. Defaults to 0.0.</p></td> <td> <code>0.0</code> </td> </tr> <tr> <td><code>fwhmg</code></td> <td> <code>float</code> </td> <td><p>Full width at half maximum (FWHM) of the Gaussian distribution. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: Gaussian distribution of <code>x</code> given.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span>
<span class=normal>63</span>
<span class=normal>64</span>
<span class=normal>65</span>
<span class=normal>66</span>
<span class=normal>67</span>
<span class=normal>68</span>
<span class=normal>69</span>
<span class=normal>70</span>
<span class=normal>71</span>
<span class=normal>72</span>
<span class=normal>73</span>
<span class=normal>74</span>
<span class=normal>75</span>
<span class=normal>76</span>
<span class=normal>77</span>
<span class=normal>78</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>gaussian</span><span class=p>(</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
    <span class=n>fwhmg</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Gaussian distribution.</span>

<span class=sd>    $$</span>
<span class=sd>    {\displaystyle g(x)={\frac {1}{\sigma {\sqrt {2\pi }}}}\exp</span>
<span class=sd>    (  -{\frac {1}{2}}{\frac {(x-\mu )^{2}}{\sigma ^{2}}} ) }</span>
<span class=sd>    $$</span>

<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        amplitude (float, optional): Amplitude of the Gaussian distribution.</span>
<span class=sd>             Defaults to 1.0.</span>
<span class=sd>        center (float, optional): Center of the Gaussian distribution.</span>
<span class=sd>             Defaults to 0.0.</span>
<span class=sd>        fwhmg (float, optional): Full width at half maximum (FWHM) of the Gaussian</span>
<span class=sd>            distribution. Defaults to 1.0.</span>

<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: Gaussian distribution of `x` given.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmg</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmg2sig</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>/</span> <span class=p>(</span><span class=n>Constants</span><span class=o>.</span><span class=n>sq2pi</span> <span class=o>*</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span>
        <span class=o>-</span><span class=p>((</span><span class=mf>1.0</span> <span class=o>*</span> <span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>sigma</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.heaviside class="doc doc-heading"> <code class="highlight language-python"><span class=n>heaviside</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.heaviside class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional Heaviside step function.</p> <div class=arithmatex>\[ f(x) = \begin{cases} 0 &amp; x &lt; 0 \\ 0.5 &amp; x = 0 \\ 1 &amp; x &gt; 0 \end{cases} \]</div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>amplitude</code></td> <td> <code>float</code> </td> <td><p>Amplitude of the Heaviside step function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>center</code></td> <td> <code>float</code> </td> <td><p>Center of the Heaviside step function. Defaults to 0.0.</p></td> <td> <code>0.0</code> </td> </tr> <tr> <td><code>sigma</code></td> <td> <code>float</code> </td> <td><p>Sigma of the Heaviside step function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: Heaviside step function of <code>x</code> given.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>heaviside</span><span class=p>(</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
    <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Heaviside step function.</span>

<span class=sd>    $$</span>
<span class=sd>    f(x) = \begin{cases}</span>
<span class=sd>    0 &amp; x &lt; 0 \\</span>
<span class=sd>    0.5 &amp; x = 0 \\</span>
<span class=sd>    1 &amp; x &gt; 0</span>
<span class=sd>    \end{cases}</span>
<span class=sd>    $$</span>
<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        amplitude (float, optional): Amplitude of the Heaviside step function.</span>
<span class=sd>                Defaults to 1.0.</span>
<span class=sd>        center (float, optional): Center of the Heaviside step function.</span>
<span class=sd>             Defaults to 0.0.</span>
<span class=sd>        sigma (float, optional): Sigma of the Heaviside step function.</span>
<span class=sd>             Defaults to 1.0.</span>


<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: Heaviside step function of `x` given.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
        <span class=n>amplitude</span> <span class=o>*</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>sign</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)))</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.linear class="doc doc-heading"> <code class="highlight language-python"><span class=n>linear</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>slope</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>intercept</span><span class=o>=</span><span class=mf>0.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.linear class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional linear function.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>slope</code></td> <td> <code>float</code> </td> <td><p>Slope of the linear function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>intercept</code></td> <td> <code>float</code> </td> <td><p>Intercept of the linear function. Defaults to 0.0.</p></td> <td> <code>0.0</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: Linear function of <code>x</code> given.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>243</span>
<span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>linear</span><span class=p>(</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>slope</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>intercept</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional linear function.</span>

<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        slope (float, optional): Slope of the linear function. Defaults to 1.0.</span>
<span class=sd>        intercept (float, optional): Intercept of the linear function.</span>
<span class=sd>             Defaults to 0.0.</span>

<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: Linear function of `x` given.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>slope</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=n>intercept</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.log class="doc doc-heading"> <code class="highlight language-python"><span class=n>log</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.log class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional logarithmic step function.</p> <div class=arithmatex>\[ f(x) = \frac{1}{1 + e^{-\frac{x - c}{s}}} \]</div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>amplitude</code></td> <td> <code>float</code> </td> <td><p>Amplitude of the logarithmic step function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>center</code></td> <td> <code>float</code> </td> <td><p>Center of the logarithmic step function. Defaults to 0.0.</p></td> <td> <code>0.0</code> </td> </tr> <tr> <td><code>sigma</code></td> <td> <code>float</code> </td> <td><p>Sigma of the logarithmic step function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: Logarithmic step function of <code>x</code> given.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>387</span>
<span class=normal>388</span>
<span class=normal>389</span>
<span class=normal>390</span>
<span class=normal>391</span>
<span class=normal>392</span>
<span class=normal>393</span>
<span class=normal>394</span>
<span class=normal>395</span>
<span class=normal>396</span>
<span class=normal>397</span>
<span class=normal>398</span>
<span class=normal>399</span>
<span class=normal>400</span>
<span class=normal>401</span>
<span class=normal>402</span>
<span class=normal>403</span>
<span class=normal>404</span>
<span class=normal>405</span>
<span class=normal>406</span>
<span class=normal>407</span>
<span class=normal>408</span>
<span class=normal>409</span>
<span class=normal>410</span>
<span class=normal>411</span>
<span class=normal>412</span>
<span class=normal>413</span>
<span class=normal>414</span>
<span class=normal>415</span>
<span class=normal>416</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>log</span><span class=p>(</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
    <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional logarithmic step function.</span>

<span class=sd>    $$</span>
<span class=sd>    f(x) = \frac{1}{1 + e^{-\frac{x - c}{s}}}</span>
<span class=sd>    $$</span>

<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        amplitude (float, optional): Amplitude of the logarithmic step function.</span>
<span class=sd>                Defaults to 1.0.</span>
<span class=sd>        center (float, optional): Center of the logarithmic step function.</span>
<span class=sd>             Defaults to 0.0.</span>
<span class=sd>        sigma (float, optional): Sigma of the logarithmic step function.</span>
<span class=sd>             Defaults to 1.0.</span>

<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: Logarithmic step function of `x` given.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
        <span class=n>amplitude</span>
        <span class=o>*</span> <span class=mf>0.5</span>
        <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>/</span> <span class=n>pi</span><span class=p>)</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.lorentzian class="doc doc-heading"> <code class="highlight language-python"><span class=n>lorentzian</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>fwhml</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.lorentzian class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional Lorentzian distribution.</p> <div class=arithmatex>\[ f(x;x_{0},\gamma )={\frac {1}{\pi \gamma [ 1+ ( {\frac {x-x_{0}}{\gamma }})^{2} ] }} ={1 \over \pi \gamma } [ {\gamma ^{2} \over (x-x_{0})^{2}+\gamma ^{2}} ] \]</div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>amplitude</code></td> <td> <code>float</code> </td> <td><p>Amplitude of the Lorentzian distribution. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>center</code></td> <td> <code>float</code> </td> <td><p>Center of the Lorentzian distribution. Defaults to 0.0.</p></td> <td> <code>0.0</code> </td> </tr> <tr> <td><code>fwhml</code></td> <td> <code>float</code> </td> <td><p>Full width at half maximum (FWHM) of the Lorentzian distribution. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>Union[NDArray[np.float64], float]: Lorentzian distribution of <code>x</code> given.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>lorentzian</span><span class=p>(</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
    <span class=n>fwhml</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Lorentzian distribution.</span>

<span class=sd>    $$</span>
<span class=sd>    f(x;x_{0},\gamma )={\frac  {1}{\pi \gamma</span>
<span class=sd>    [ 1+ ( {\frac  {x-x_{0}}{\gamma }})^{2} ]</span>
<span class=sd>    }} ={1 \over \pi \gamma } [ {\gamma ^{2} \over (x-x_{0})^{2}+\gamma ^{2}} ]</span>
<span class=sd>    $$</span>

<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        amplitude (float, optional): Amplitude of the Lorentzian distribution.</span>
<span class=sd>            Defaults to 1.0.</span>
<span class=sd>        center (float, optional): Center of the Lorentzian distribution. Defaults to</span>
<span class=sd>            0.0.</span>
<span class=sd>        fwhml (float, optional): Full width at half maximum (FWHM) of the Lorentzian</span>
<span class=sd>            distribution. Defaults to 1.0.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Union[NDArray[np.float64], float]: Lorentzian distribution of `x` given.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhml</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhml2sig</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=p>((</span><span class=mf>1.0</span> <span class=o>*</span> <span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span> <span class=o>/</span> <span class=p>(</span>
        <span class=n>pi</span> <span class=o>*</span> <span class=n>sigma</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.power class="doc doc-heading"> <code class="highlight language-python"><span class=n>power</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>exponent</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>intercept</span><span class=o>=</span><span class=mf>0.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.power class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional power function.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>amplitude</code></td> <td> <code>float</code> </td> <td><p>Amplitude of the power function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>exponent</code></td> <td> <code>float</code> </td> <td><p>Exponent of the power function. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>intercept</code></td> <td> <code>float</code> </td> <td><p>Intercept of the power function. Defaults to 0.0.</p></td> <td> <code>0.0</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: power function of <code>x</code> given.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>power</span><span class=p>(</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>exponent</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>intercept</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional power function.</span>

<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        amplitude (float, optional): Amplitude of the power function. Defaults to</span>
<span class=sd>            1.0.</span>
<span class=sd>        exponent (float, optional): Exponent of the power function. Defaults to 1.0.</span>
<span class=sd>        intercept (float, optional): Intercept of the power function. Defaults to</span>
<span class=sd>            0.0.</span>

<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: power function of `x` given.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>exponent</span><span class=p>)</span> <span class=o>+</span> <span class=n>intercept</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.pseudovoigt class="doc doc-heading"> <code class="highlight language-python"><span class=n>pseudovoigt</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>fwhmg</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>fwhml</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.pseudovoigt class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional Pseudo-Voigt distribution.</p> <div class="admonition note"> <p class=admonition-title>See also:</p> <p>J. Appl. Cryst. (2000). 33, 1311-1316 <a href=https://doi.org/10.1107/S0021889800010219>https://doi.org/10.1107/S0021889800010219</a></p> </div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>amplitude</code></td> <td> <code>float</code> </td> <td><p>Amplitude of the Pseudo-Voigt distribution. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>center</code></td> <td> <code>float</code> </td> <td><p>Center of the Pseudo-Voigt distribution. Defaults to 0.0.</p></td> <td> <code>0.0</code> </td> </tr> <tr> <td><code>fwhmg</code></td> <td> <code>float</code> </td> <td><p>Full width half maximum of the Gaussian distribution in the Pseudo-Voigt distribution. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>fwhml</code></td> <td> <code>float</code> </td> <td><p>Full width half maximum of the Lorentzian distribution in the Pseudo-Voigt distribution. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: Pseudo-Voigt distribution of <code>x</code> given.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span>
<span class=normal>150</span>
<span class=normal>151</span>
<span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span>
<span class=normal>164</span>
<span class=normal>165</span>
<span class=normal>166</span>
<span class=normal>167</span>
<span class=normal>168</span>
<span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span>
<span class=normal>172</span>
<span class=normal>173</span>
<span class=normal>174</span>
<span class=normal>175</span>
<span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>pseudovoigt</span><span class=p>(</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
    <span class=n>fwhmg</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>fwhml</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Pseudo-Voigt distribution.</span>

<span class=sd>    !!! note &quot;See also:&quot;</span>

<span class=sd>        J. Appl. Cryst. (2000). 33, 1311-1316</span>
<span class=sd>        https://doi.org/10.1107/S0021889800010219</span>

<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]):  `x`-values of the data.</span>
<span class=sd>        amplitude (float, optional): Amplitude of the Pseudo-Voigt distribution.</span>
<span class=sd>            Defaults to 1.0.</span>
<span class=sd>        center (float, optional): Center of the Pseudo-Voigt distribution.</span>
<span class=sd>            Defaults to 0.0.</span>
<span class=sd>        fwhmg (float, optional): Full width half maximum of the Gaussian</span>
<span class=sd>            distribution in the Pseudo-Voigt distribution. Defaults to 1.0.</span>
<span class=sd>        fwhml (float, optional): Full width half maximum of the Lorentzian</span>
<span class=sd>            distribution in the Pseudo-Voigt distribution. Defaults to 1.0.</span>

<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: Pseudo-Voigt distribution of `x` given.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>f</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span>
        <span class=n>fwhmg</span><span class=o>**</span><span class=mi>5</span>
        <span class=o>+</span> <span class=mf>2.69269</span> <span class=o>*</span> <span class=n>fwhmg</span><span class=o>**</span><span class=mi>4</span> <span class=o>*</span> <span class=n>fwhml</span>
        <span class=o>+</span> <span class=mf>2.42843</span> <span class=o>*</span> <span class=n>fwhmg</span><span class=o>**</span><span class=mi>3</span> <span class=o>*</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>2</span>
        <span class=o>+</span> <span class=mf>4.47163</span> <span class=o>*</span> <span class=n>fwhmg</span><span class=o>**</span><span class=mi>2</span> <span class=o>*</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>3</span>
        <span class=o>+</span> <span class=mf>0.07842</span> <span class=o>*</span> <span class=n>fwhmg</span> <span class=o>*</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>4</span>
        <span class=o>+</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>5</span><span class=p>,</span>
        <span class=mf>0.2</span><span class=p>,</span>
    <span class=p>)</span>
    <span class=n>n</span> <span class=o>=</span> <span class=p>(</span>
        <span class=mf>1.36603</span> <span class=o>*</span> <span class=p>(</span><span class=n>fwhml</span> <span class=o>/</span> <span class=n>f</span><span class=p>)</span>
        <span class=o>-</span> <span class=mf>0.47719</span> <span class=o>*</span> <span class=p>(</span><span class=n>fwhml</span> <span class=o>/</span> <span class=n>f</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span>
        <span class=o>+</span> <span class=mf>0.11116</span> <span class=o>*</span> <span class=p>(</span><span class=n>fwhml</span> <span class=o>/</span> <span class=n>f</span><span class=p>)</span> <span class=o>**</span> <span class=mi>3</span>
    <span class=p>)</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
        <span class=n>n</span>
        <span class=o>*</span> <span class=n>DistributionModels</span><span class=o>.</span><span class=n>lorentzian</span><span class=p>(</span>
            <span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=n>amplitude</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=n>center</span><span class=p>,</span> <span class=n>fwhml</span><span class=o>=</span><span class=n>fwhml</span>
        <span class=p>)</span>
        <span class=o>+</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>n</span><span class=p>)</span>
        <span class=o>*</span> <span class=n>DistributionModels</span><span class=o>.</span><span class=n>gaussian</span><span class=p>(</span>
            <span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=n>amplitude</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=n>center</span><span class=p>,</span> <span class=n>fwhmg</span><span class=o>=</span><span class=n>fwhmg</span>
        <span class=p>)</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.voigt class="doc doc-heading"> <code class="highlight language-python"><span class=n>voigt</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>fwhmv</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>gamma</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.voigt class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional Voigt distribution.</p> <div class=arithmatex>\[ {\displaystyle V(x;\sigma ,\gamma )\equiv \int_{-\infty }^{\infty }G(x';\sigma ) L(x-x';\gamma )\,dx'} \]</div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>center</code></td> <td> <code>float</code> </td> <td><p>Center of the Voigt distribution. Defaults to 0.0.</p></td> <td> <code>0.0</code> </td> </tr> <tr> <td><code>fwhmv</code></td> <td> <code>float</code> </td> <td><p>Full width at half maximum (FWHM) of the Lorentzian distribution. Defaults to 1.0.</p></td> <td> <code>1.0</code> </td> </tr> <tr> <td><code>gamma</code></td> <td> <code>float</code> </td> <td><p>Scaling factor of the complex part of the <a href=https://en.wikipedia.org/wiki/Faddeeva_function>Faddeeva Function</a>. Defaults to None.</p></td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: Voigt distribution of <code>x</code> given.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>voigt</span><span class=p>(</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
    <span class=n>fwhmv</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
    <span class=n>gamma</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Voigt distribution.</span>

<span class=sd>    $$</span>
<span class=sd>    {\displaystyle V(x;\sigma ,\gamma )\equiv</span>
<span class=sd>    \int_{-\infty }^{\infty }G(x&#39;;\sigma )</span>
<span class=sd>    L(x-x&#39;;\gamma )\,dx&#39;}</span>
<span class=sd>    $$</span>

<span class=sd>    Args:</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        center (float, optional): Center of the Voigt distribution. Defaults to 0.0.</span>
<span class=sd>        fwhmv (float, optional): Full width at half maximum (FWHM) of the Lorentzian</span>
<span class=sd>            distribution. Defaults to 1.0.</span>
<span class=sd>        gamma (float, optional): Scaling factor of the complex part of the</span>
<span class=sd>            [Faddeeva Function](https://en.wikipedia.org/wiki/Faddeeva_function).</span>
<span class=sd>            Defaults to None.</span>

<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: Voigt distribution of `x` given.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmv</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmv2sig</span>
    <span class=k>if</span> <span class=n>gamma</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>gamma</span> <span class=o>=</span> <span class=n>sigma</span>
    <span class=n>z</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span> <span class=o>+</span> <span class=mi>1</span><span class=n>j</span> <span class=o>*</span> <span class=n>gamma</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>sq2</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>wofz</span><span class=p>(</span><span class=n>z</span><span class=p>)</span><span class=o>.</span><span class=n>real</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>sq2pi</span><span class=p>))</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=spectrafit.models.ModelParameters class="doc doc-heading"> <code>ModelParameters</code> <a href=#spectrafit.models.ModelParameters class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title=spectrafit.models.AutoPeakDetection href=#spectrafit.models.AutoPeakDetection>AutoPeakDetection</a></code></p> <p>Class to define the model parameters.</p> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 891</span>
<span class=normal> 892</span>
<span class=normal> 893</span>
<span class=normal> 894</span>
<span class=normal> 895</span>
<span class=normal> 896</span>
<span class=normal> 897</span>
<span class=normal> 898</span>
<span class=normal> 899</span>
<span class=normal> 900</span>
<span class=normal> 901</span>
<span class=normal> 902</span>
<span class=normal> 903</span>
<span class=normal> 904</span>
<span class=normal> 905</span>
<span class=normal> 906</span>
<span class=normal> 907</span>
<span class=normal> 908</span>
<span class=normal> 909</span>
<span class=normal> 910</span>
<span class=normal> 911</span>
<span class=normal> 912</span>
<span class=normal> 913</span>
<span class=normal> 914</span>
<span class=normal> 915</span>
<span class=normal> 916</span>
<span class=normal> 917</span>
<span class=normal> 918</span>
<span class=normal> 919</span>
<span class=normal> 920</span>
<span class=normal> 921</span>
<span class=normal> 922</span>
<span class=normal> 923</span>
<span class=normal> 924</span>
<span class=normal> 925</span>
<span class=normal> 926</span>
<span class=normal> 927</span>
<span class=normal> 928</span>
<span class=normal> 929</span>
<span class=normal> 930</span>
<span class=normal> 931</span>
<span class=normal> 932</span>
<span class=normal> 933</span>
<span class=normal> 934</span>
<span class=normal> 935</span>
<span class=normal> 936</span>
<span class=normal> 937</span>
<span class=normal> 938</span>
<span class=normal> 939</span>
<span class=normal> 940</span>
<span class=normal> 941</span>
<span class=normal> 942</span>
<span class=normal> 943</span>
<span class=normal> 944</span>
<span class=normal> 945</span>
<span class=normal> 946</span>
<span class=normal> 947</span>
<span class=normal> 948</span>
<span class=normal> 949</span>
<span class=normal> 950</span>
<span class=normal> 951</span>
<span class=normal> 952</span>
<span class=normal> 953</span>
<span class=normal> 954</span>
<span class=normal> 955</span>
<span class=normal> 956</span>
<span class=normal> 957</span>
<span class=normal> 958</span>
<span class=normal> 959</span>
<span class=normal> 960</span>
<span class=normal> 961</span>
<span class=normal> 962</span>
<span class=normal> 963</span>
<span class=normal> 964</span>
<span class=normal> 965</span>
<span class=normal> 966</span>
<span class=normal> 967</span>
<span class=normal> 968</span>
<span class=normal> 969</span>
<span class=normal> 970</span>
<span class=normal> 971</span>
<span class=normal> 972</span>
<span class=normal> 973</span>
<span class=normal> 974</span>
<span class=normal> 975</span>
<span class=normal> 976</span>
<span class=normal> 977</span>
<span class=normal> 978</span>
<span class=normal> 979</span>
<span class=normal> 980</span>
<span class=normal> 981</span>
<span class=normal> 982</span>
<span class=normal> 983</span>
<span class=normal> 984</span>
<span class=normal> 985</span>
<span class=normal> 986</span>
<span class=normal> 987</span>
<span class=normal> 988</span>
<span class=normal> 989</span>
<span class=normal> 990</span>
<span class=normal> 991</span>
<span class=normal> 992</span>
<span class=normal> 993</span>
<span class=normal> 994</span>
<span class=normal> 995</span>
<span class=normal> 996</span>
<span class=normal> 997</span>
<span class=normal> 998</span>
<span class=normal> 999</span>
<span class=normal>1000</span>
<span class=normal>1001</span>
<span class=normal>1002</span>
<span class=normal>1003</span>
<span class=normal>1004</span>
<span class=normal>1005</span>
<span class=normal>1006</span>
<span class=normal>1007</span>
<span class=normal>1008</span>
<span class=normal>1009</span>
<span class=normal>1010</span>
<span class=normal>1011</span>
<span class=normal>1012</span>
<span class=normal>1013</span>
<span class=normal>1014</span>
<span class=normal>1015</span>
<span class=normal>1016</span>
<span class=normal>1017</span>
<span class=normal>1018</span>
<span class=normal>1019</span>
<span class=normal>1020</span>
<span class=normal>1021</span>
<span class=normal>1022</span>
<span class=normal>1023</span>
<span class=normal>1024</span>
<span class=normal>1025</span>
<span class=normal>1026</span>
<span class=normal>1027</span>
<span class=normal>1028</span>
<span class=normal>1029</span>
<span class=normal>1030</span>
<span class=normal>1031</span>
<span class=normal>1032</span>
<span class=normal>1033</span>
<span class=normal>1034</span>
<span class=normal>1035</span>
<span class=normal>1036</span>
<span class=normal>1037</span>
<span class=normal>1038</span>
<span class=normal>1039</span>
<span class=normal>1040</span>
<span class=normal>1041</span>
<span class=normal>1042</span>
<span class=normal>1043</span>
<span class=normal>1044</span>
<span class=normal>1045</span>
<span class=normal>1046</span>
<span class=normal>1047</span>
<span class=normal>1048</span>
<span class=normal>1049</span>
<span class=normal>1050</span>
<span class=normal>1051</span>
<span class=normal>1052</span>
<span class=normal>1053</span>
<span class=normal>1054</span>
<span class=normal>1055</span>
<span class=normal>1056</span>
<span class=normal>1057</span>
<span class=normal>1058</span>
<span class=normal>1059</span>
<span class=normal>1060</span>
<span class=normal>1061</span>
<span class=normal>1062</span>
<span class=normal>1063</span>
<span class=normal>1064</span>
<span class=normal>1065</span>
<span class=normal>1066</span>
<span class=normal>1067</span>
<span class=normal>1068</span>
<span class=normal>1069</span>
<span class=normal>1070</span>
<span class=normal>1071</span>
<span class=normal>1072</span>
<span class=normal>1073</span>
<span class=normal>1074</span>
<span class=normal>1075</span>
<span class=normal>1076</span>
<span class=normal>1077</span>
<span class=normal>1078</span>
<span class=normal>1079</span>
<span class=normal>1080</span>
<span class=normal>1081</span>
<span class=normal>1082</span>
<span class=normal>1083</span>
<span class=normal>1084</span>
<span class=normal>1085</span>
<span class=normal>1086</span>
<span class=normal>1087</span>
<span class=normal>1088</span>
<span class=normal>1089</span>
<span class=normal>1090</span>
<span class=normal>1091</span>
<span class=normal>1092</span>
<span class=normal>1093</span>
<span class=normal>1094</span>
<span class=normal>1095</span>
<span class=normal>1096</span>
<span class=normal>1097</span>
<span class=normal>1098</span>
<span class=normal>1099</span>
<span class=normal>1100</span>
<span class=normal>1101</span>
<span class=normal>1102</span>
<span class=normal>1103</span>
<span class=normal>1104</span>
<span class=normal>1105</span>
<span class=normal>1106</span>
<span class=normal>1107</span>
<span class=normal>1108</span>
<span class=normal>1109</span>
<span class=normal>1110</span>
<span class=normal>1111</span>
<span class=normal>1112</span>
<span class=normal>1113</span>
<span class=normal>1114</span>
<span class=normal>1115</span>
<span class=normal>1116</span>
<span class=normal>1117</span>
<span class=normal>1118</span>
<span class=normal>1119</span>
<span class=normal>1120</span>
<span class=normal>1121</span>
<span class=normal>1122</span>
<span class=normal>1123</span>
<span class=normal>1124</span>
<span class=normal>1125</span>
<span class=normal>1126</span>
<span class=normal>1127</span>
<span class=normal>1128</span>
<span class=normal>1129</span>
<span class=normal>1130</span>
<span class=normal>1131</span>
<span class=normal>1132</span>
<span class=normal>1133</span>
<span class=normal>1134</span>
<span class=normal>1135</span>
<span class=normal>1136</span>
<span class=normal>1137</span>
<span class=normal>1138</span>
<span class=normal>1139</span>
<span class=normal>1140</span>
<span class=normal>1141</span>
<span class=normal>1142</span>
<span class=normal>1143</span>
<span class=normal>1144</span>
<span class=normal>1145</span>
<span class=normal>1146</span>
<span class=normal>1147</span>
<span class=normal>1148</span>
<span class=normal>1149</span>
<span class=normal>1150</span>
<span class=normal>1151</span>
<span class=normal>1152</span>
<span class=normal>1153</span>
<span class=normal>1154</span>
<span class=normal>1155</span>
<span class=normal>1156</span>
<span class=normal>1157</span>
<span class=normal>1158</span>
<span class=normal>1159</span>
<span class=normal>1160</span>
<span class=normal>1161</span>
<span class=normal>1162</span>
<span class=normal>1163</span>
<span class=normal>1164</span>
<span class=normal>1165</span>
<span class=normal>1166</span>
<span class=normal>1167</span>
<span class=normal>1168</span>
<span class=normal>1169</span>
<span class=normal>1170</span>
<span class=normal>1171</span>
<span class=normal>1172</span>
<span class=normal>1173</span>
<span class=normal>1174</span>
<span class=normal>1175</span>
<span class=normal>1176</span>
<span class=normal>1177</span>
<span class=normal>1178</span>
<span class=normal>1179</span>
<span class=normal>1180</span>
<span class=normal>1181</span>
<span class=normal>1182</span>
<span class=normal>1183</span>
<span class=normal>1184</span>
<span class=normal>1185</span>
<span class=normal>1186</span>
<span class=normal>1187</span>
<span class=normal>1188</span>
<span class=normal>1189</span>
<span class=normal>1190</span>
<span class=normal>1191</span>
<span class=normal>1192</span>
<span class=normal>1193</span>
<span class=normal>1194</span>
<span class=normal>1195</span>
<span class=normal>1196</span>
<span class=normal>1197</span>
<span class=normal>1198</span>
<span class=normal>1199</span>
<span class=normal>1200</span>
<span class=normal>1201</span>
<span class=normal>1202</span>
<span class=normal>1203</span>
<span class=normal>1204</span>
<span class=normal>1205</span>
<span class=normal>1206</span>
<span class=normal>1207</span>
<span class=normal>1208</span>
<span class=normal>1209</span>
<span class=normal>1210</span>
<span class=normal>1211</span>
<span class=normal>1212</span>
<span class=normal>1213</span>
<span class=normal>1214</span>
<span class=normal>1215</span>
<span class=normal>1216</span>
<span class=normal>1217</span>
<span class=normal>1218</span>
<span class=normal>1219</span>
<span class=normal>1220</span>
<span class=normal>1221</span>
<span class=normal>1222</span>
<span class=normal>1223</span>
<span class=normal>1224</span>
<span class=normal>1225</span>
<span class=normal>1226</span>
<span class=normal>1227</span>
<span class=normal>1228</span>
<span class=normal>1229</span>
<span class=normal>1230</span>
<span class=normal>1231</span>
<span class=normal>1232</span>
<span class=normal>1233</span>
<span class=normal>1234</span>
<span class=normal>1235</span>
<span class=normal>1236</span>
<span class=normal>1237</span>
<span class=normal>1238</span>
<span class=normal>1239</span>
<span class=normal>1240</span>
<span class=normal>1241</span>
<span class=normal>1242</span>
<span class=normal>1243</span>
<span class=normal>1244</span>
<span class=normal>1245</span>
<span class=normal>1246</span>
<span class=normal>1247</span>
<span class=normal>1248</span>
<span class=normal>1249</span>
<span class=normal>1250</span>
<span class=normal>1251</span>
<span class=normal>1252</span>
<span class=normal>1253</span>
<span class=normal>1254</span>
<span class=normal>1255</span>
<span class=normal>1256</span>
<span class=normal>1257</span>
<span class=normal>1258</span>
<span class=normal>1259</span>
<span class=normal>1260</span>
<span class=normal>1261</span>
<span class=normal>1262</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span> <span class=nc>ModelParameters</span><span class=p>(</span><span class=n>AutoPeakDetection</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Class to define the model parameters.&quot;&quot;&quot;</span>

    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Initialize the model parameters.</span>

<span class=sd>        Args:</span>
<span class=sd>            df (pd.DataFrame): DataFrame containing the input data (`x` and `data`).</span>
<span class=sd>            args (Dict[str, Any]):</span>
<span class=sd>                 Nested arguments dictionary for the model based on **one** or **two**</span>
<span class=sd>                 `int` keys depending if global fitting parameters, will explicit</span>
<span class=sd>                 defined or not.</span>

<span class=sd>        !!! note &quot;About `args` for models&quot;</span>

<span class=sd>            The `args` dictionary is used to define the model parameters. And the total</span>
<span class=sd>            nested dictionary structure is as follows:</span>

<span class=sd>            ```python</span>
<span class=sd>            args: Dict[str, Dict[int, Dict[str, Dict[str, Union[str, int, float]]]]]</span>
<span class=sd>            ```</span>

<span class=sd>        !!! info &quot;About the fitting options&quot;</span>

<span class=sd>            In general, there are two option for the fitting possible:</span>

<span class=sd>            1. `Classic fitting` or `local fitting`, where the parameters are defined</span>
<span class=sd>                for a 2D spectrum.</span>
<span class=sd>            2. `Global fitting`, where the parameters are defined for a 3D spectrum.</span>
<span class=sd>                Here, the parameters can be automatically defined for each column on the</span>
<span class=sd>                basis of the initial parameters or they can be completley defined by the</span>
<span class=sd>                user. The `global fitting` definition starts at `1` similiar to the</span>
<span class=sd>                peaks attributes notation.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>col_len</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>args</span> <span class=o>=</span> <span class=n>args</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>params</span> <span class=o>=</span> <span class=n>Parameters</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>df_to_numvalues</span><span class=p>(</span><span class=n>df</span><span class=o>=</span><span class=n>df</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=n>args</span><span class=p>)</span>

        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>)</span>

    <span class=k>def</span> <span class=nf>df_to_numvalues</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Transform the dataframe to numeric values of `x` and `data`.</span>

<span class=sd>        !!! note &quot;About the dataframe to numeric values&quot;</span>

<span class=sd>            The transformation is done by the `value` property of pandas. The dataframe</span>
<span class=sd>            is separated into the `x` and `data` columns and the `x` column is</span>
<span class=sd>            transformed to the energy values and the `data` column is transformed to</span>
<span class=sd>            the intensity values depending on the `args` dictionary. In terms of global</span>
<span class=sd>            fitting, the `data` contains the intensity values for each column.</span>

<span class=sd>        Args:</span>
<span class=sd>            df (pd.DataFrame): DataFrame containing the input data (`x` and `data`).</span>
<span class=sd>            args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<span class=sd>                 additional information beyond the command line arguments.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Tuple[NDArray[np.float64], NDArray[np.float64]]: Tuple of `x` and</span>
<span class=sd>                 `data` as numpy arrays.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]:</span>
            <span class=k>return</span> <span class=p>(</span>
                <span class=n>df</span><span class=p>[</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(),</span>
                <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span> <span class=o>!=</span> <span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(),</span>
            <span class=p>)</span>
        <span class=k>return</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(),</span> <span class=n>df</span><span class=p>[</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>1</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>())</span>

    <span class=nd>@property</span>
    <span class=k>def</span> <span class=nf>return_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Parameters</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return the `class` representation of the model parameters.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Parameters: Model parameters class.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>__perform__</span><span class=p>()</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span>

    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return the `string` representation of the model parameters.</span>

<span class=sd>        Returns:</span>
<span class=sd>            str: String representation of the model parameters.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>__perform__</span><span class=p>()</span>
        <span class=k>return</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>)</span>

    <span class=k>def</span> <span class=nf>__perform__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Perform the model parameter definition.</span>

<span class=sd>        Raises:</span>
<span class=sd>            KeyError: Global fitting is combination with automatic peak detection is</span>
<span class=sd>                 not implemented yet.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters</span><span class=p>()</span>
        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span> <span class=ow>and</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_global</span><span class=p>()</span>
        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>2</span> <span class=ow>and</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_global_pre</span><span class=p>()</span>
        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>initialize_peak_detection</span><span class=p>()</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_auto</span><span class=p>()</span>
        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]:</span>
            <span class=k>raise</span> <span class=ne>KeyError</span><span class=p>(</span>
                <span class=s2>&quot;Global fitting mode with automatic peak detection &quot;</span>
                <span class=s2>&quot;is not supported yet.&quot;</span>
            <span class=p>)</span>

    <span class=k>def</span> <span class=nf>define_parameters_auto</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Auto define the model parameters for local fitting.&quot;&quot;&quot;</span>
        <span class=n>positions</span><span class=p>,</span> <span class=n>properties</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>__autodetect__</span><span class=p>()</span>
        <span class=k>if</span> <span class=p>(</span>
            <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>],</span> <span class=nb>bool</span><span class=p>)</span>
            <span class=ow>and</span> <span class=s2>&quot;model_type&quot;</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]</span>
        <span class=p>):</span>
            <span class=n>_model</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>][</span><span class=s2>&quot;model_type&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
            <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>automodel_check</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>_model</span><span class=p>)</span>
            <span class=n>models</span> <span class=o>=</span> <span class=n>_model</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>models</span> <span class=o>=</span> <span class=s2>&quot;gaussian&quot;</span>

        <span class=k>if</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;gaussian&quot;</span><span class=p>:</span>
            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
                <span class=nb>zip</span><span class=p>(</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
                <span class=p>),</span>
                <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
            <span class=p>):</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
                    <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                    <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
                    <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhmg_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=n>value</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
                    <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=p>)</span>
        <span class=k>elif</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;lorentzian&quot;</span><span class=p>:</span>
            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
                <span class=nb>zip</span><span class=p>(</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
                <span class=p>),</span>
                <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
            <span class=p>):</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
                    <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                    <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
                    <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhml_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=n>value</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
                    <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=p>)</span>
        <span class=k>elif</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;voigt&quot;</span><span class=p>:</span>
            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
                <span class=nb>zip</span><span class=p>(</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
                <span class=p>),</span>
                <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
            <span class=p>):</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
                    <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                    <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
                    <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhmv_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=n>value</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
                    <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=p>)</span>
        <span class=k>elif</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;pseudovoigt&quot;</span><span class=p>:</span>
            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
                <span class=nb>zip</span><span class=p>(</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
                <span class=p>),</span>
                <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
            <span class=p>):</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
                    <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                    <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
                    <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhmg_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=n>value</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
                    <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
                    <span class=nb>max</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhml_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=n>value</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
                    <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=p>)</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;auto_generated_models&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;models&quot;</span><span class=p>:</span> <span class=p>{</span>
                <span class=n>key</span><span class=p>:</span> <span class=p>{</span>
                    <span class=s2>&quot;value&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
                    <span class=s2>&quot;min&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>,</span>
                    <span class=s2>&quot;max&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>,</span>
                    <span class=s2>&quot;vary&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>vary</span><span class=p>,</span>
                <span class=p>}</span>
                <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span>
            <span class=p>},</span>
            <span class=s2>&quot;positions&quot;</span><span class=p>:</span> <span class=n>positions</span><span class=o>.</span><span class=n>tolist</span><span class=p>(),</span>
            <span class=s2>&quot;properties&quot;</span><span class=p>:</span> <span class=p>{</span><span class=n>key</span><span class=p>:</span> <span class=n>value</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>properties</span><span class=o>.</span><span class=n>items</span><span class=p>()},</span>
        <span class=p>}</span>

    <span class=k>def</span> <span class=nf>define_parameters</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Define the input parameters for a `params`-dictionary for classic fitting.&quot;&quot;&quot;</span>
        <span class=k>for</span> <span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;peaks&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_loop</span><span class=p>(</span><span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span><span class=o>=</span><span class=n>value_1</span><span class=p>)</span>

    <span class=k>def</span> <span class=nf>define_parameters_loop</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key_1</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value_1</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Loop through the input parameters for a `params`-dictionary.</span>

<span class=sd>        Args:</span>
<span class=sd>            key_1 (str): The key of the first level of the input dictionary.</span>
<span class=sd>            value_1 (Dict[str, Any]): The value of the first level of the input</span>
<span class=sd>                 dictionary.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>for</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span> <span class=ow>in</span> <span class=n>value_1</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_loop_2</span><span class=p>(</span><span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span> <span class=n>key_2</span><span class=o>=</span><span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span><span class=o>=</span><span class=n>value_2</span><span class=p>)</span>

    <span class=k>def</span> <span class=nf>define_parameters_loop_2</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>key_1</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_2</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value_2</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Loop through the input parameters for a `params`-dictionary.</span>

<span class=sd>        Args:</span>
<span class=sd>            key_1 (str): The key of the first level of the input dictionary.</span>
<span class=sd>            key_2 (str): The key of the second level of the input dictionary.</span>
<span class=sd>            value_2 (Dict[str, Any]): The value of the second level of the input</span>
<span class=sd>                 dictionary.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>for</span> <span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span> <span class=ow>in</span> <span class=n>value_2</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_loop_3</span><span class=p>(</span>
                <span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span> <span class=n>key_2</span><span class=o>=</span><span class=n>key_2</span><span class=p>,</span> <span class=n>key_3</span><span class=o>=</span><span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span><span class=o>=</span><span class=n>value_3</span>
            <span class=p>)</span>

    <span class=k>def</span> <span class=nf>define_parameters_loop_3</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>key_1</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_2</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_3</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value_3</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Loop through the input parameters for a `params`-dictionary.</span>

<span class=sd>        Args:</span>
<span class=sd>            key_1 (str): The key of the first level of the input dictionary.</span>
<span class=sd>            key_2 (str): The key of the second level of the input dictionary.</span>
<span class=sd>            key_3 (str): The key of the third level of the input dictionary.</span>
<span class=sd>            value_3 (Dict[str, Any]): The value of the third level of the input</span>
<span class=sd>                 dictionary.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>value_3</span><span class=p>)</span>

    <span class=k>def</span> <span class=nf>define_parameters_global</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Define the input parameters for a `params`-dictionary for global fitting.&quot;&quot;&quot;</span>
        <span class=k>for</span> <span class=n>col_i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>col_len</span><span class=p>):</span>
            <span class=k>for</span> <span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;peaks&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                <span class=k>for</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span> <span class=ow>in</span> <span class=n>value_1</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                    <span class=k>for</span> <span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span> <span class=ow>in</span> <span class=n>value_2</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                        <span class=bp>self</span><span class=o>.</span><span class=n>_define_parameter</span><span class=p>(</span>
                            <span class=n>col_i</span><span class=o>=</span><span class=n>col_i</span><span class=p>,</span>
                            <span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span>
                            <span class=n>key_2</span><span class=o>=</span><span class=n>key_2</span><span class=p>,</span>
                            <span class=n>key_3</span><span class=o>=</span><span class=n>key_3</span><span class=p>,</span>
                            <span class=n>value_3</span><span class=o>=</span><span class=n>value_3</span><span class=p>,</span>
                        <span class=p>)</span>

    <span class=k>def</span> <span class=nf>_define_parameter</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>col_i</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>key_1</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_2</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_3</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value_3</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Define the input parameters for a `params`-dictionary for global fitting.</span>

<span class=sd>        Args:</span>
<span class=sd>            col_i (int): The column index.</span>
<span class=sd>            key_1 (str): The key of the first level of the input dictionary.</span>
<span class=sd>            key_2 (str): The key of the second level of the input dictionary.</span>
<span class=sd>            key_3 (str): The key of the third level of the input dictionary.</span>
<span class=sd>            value_3 (Dict[str, Any]): The value of the third level of the input</span>
<span class=sd>                 dictionary.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>col_i</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>key_3</span> <span class=o>!=</span> <span class=s2>&quot;amplitude&quot;</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>col_i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=n>expr</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>_1&quot;</span><span class=p>,</span>
                <span class=p>)</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>col_i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=o>**</span><span class=n>value_3</span><span class=p>,</span>
                <span class=p>)</span>

        <span class=k>else</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>_1&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>value_3</span><span class=p>)</span>

    <span class=k>def</span> <span class=nf>define_parameters_global_pre</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Define the input parameters for a `params`-dictionary for global fitting.</span>

<span class=sd>        !!! warning &quot;About `params` for global fitting&quot;</span>

<span class=sd>            `define_parameters_global_pre` requires fully defined `params`-dictionary</span>
<span class=sd>            in the json, toml, or yaml file input. This means:</span>

<span class=sd>            1. Number of the spectra must be defined.</span>
<span class=sd>            2. Number of the peaks must be defined.</span>
<span class=sd>            3. Number of the parameters must be defined.</span>
<span class=sd>            4. The parameters must be defined.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>for</span> <span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;peaks&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=k>for</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span> <span class=ow>in</span> <span class=n>value_1</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                <span class=k>for</span> <span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span> <span class=ow>in</span> <span class=n>value_2</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                    <span class=k>for</span> <span class=n>key_4</span><span class=p>,</span> <span class=n>value_4</span> <span class=ow>in</span> <span class=n>value_3</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                        <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_4</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>value_4</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.ModelParameters.return_params class="doc doc-heading"> <code class="highlight language-python"><span class=n>return_params</span><span class=p>:</span> <span class=n>Parameters</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.ModelParameters.return_params class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return the <code>class</code> representation of the model parameters.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Parameters</code></td> <td> <code><span title=lmfit.Parameters>Parameters</span></code> </td> <td><p>Model parameters class.</p></td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>args</span><span class=p>)</span></code> <a href=#spectrafit.models.ModelParameters.__init__ class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Initialize the model parameters.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>df</code></td> <td> <code><span title=pandas>pd</span>.<span title=pandas.DataFrame>DataFrame</span></code> </td> <td><p>DataFrame containing the input data (<code>x</code> and <code>data</code>).</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>args</code></td> <td> <code><span title=typing.Dict>Dict</span>[str, <span title=typing.Any>Any</span>]</code> </td> <td><p>Nested arguments dictionary for the model based on <strong>one</strong> or <strong>two</strong> <code>int</code> keys depending if global fitting parameters, will explicit defined or not.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <div class="admonition note"> <p class=admonition-title>About <code>args</code> for models</p> <p>The <code>args</code> dictionary is used to define the model parameters. And the total nested dictionary structure is as follows:</p> <div class="language-python highlight"><pre><span></span><code><span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>,</span> <span class=nb>float</span><span class=p>]]]]]</span>
</code></pre></div> </div> <div class="admonition info"> <p class=admonition-title>About the fitting options</p> <p>In general, there are two option for the fitting possible:</p> <ol> <li><code>Classic fitting</code> or <code>local fitting</code>, where the parameters are defined for a 2D spectrum.</li> <li><code>Global fitting</code>, where the parameters are defined for a 3D spectrum. Here, the parameters can be automatically defined for each column on the basis of the initial parameters or they can be completley defined by the user. The <code>global fitting</code> definition starts at <code>1</code> similiar to the peaks attributes notation.</li> </ol> </div> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>894</span>
<span class=normal>895</span>
<span class=normal>896</span>
<span class=normal>897</span>
<span class=normal>898</span>
<span class=normal>899</span>
<span class=normal>900</span>
<span class=normal>901</span>
<span class=normal>902</span>
<span class=normal>903</span>
<span class=normal>904</span>
<span class=normal>905</span>
<span class=normal>906</span>
<span class=normal>907</span>
<span class=normal>908</span>
<span class=normal>909</span>
<span class=normal>910</span>
<span class=normal>911</span>
<span class=normal>912</span>
<span class=normal>913</span>
<span class=normal>914</span>
<span class=normal>915</span>
<span class=normal>916</span>
<span class=normal>917</span>
<span class=normal>918</span>
<span class=normal>919</span>
<span class=normal>920</span>
<span class=normal>921</span>
<span class=normal>922</span>
<span class=normal>923</span>
<span class=normal>924</span>
<span class=normal>925</span>
<span class=normal>926</span>
<span class=normal>927</span>
<span class=normal>928</span>
<span class=normal>929</span>
<span class=normal>930</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the model parameters.</span>

<span class=sd>    Args:</span>
<span class=sd>        df (pd.DataFrame): DataFrame containing the input data (`x` and `data`).</span>
<span class=sd>        args (Dict[str, Any]):</span>
<span class=sd>             Nested arguments dictionary for the model based on **one** or **two**</span>
<span class=sd>             `int` keys depending if global fitting parameters, will explicit</span>
<span class=sd>             defined or not.</span>

<span class=sd>    !!! note &quot;About `args` for models&quot;</span>

<span class=sd>        The `args` dictionary is used to define the model parameters. And the total</span>
<span class=sd>        nested dictionary structure is as follows:</span>

<span class=sd>        ```python</span>
<span class=sd>        args: Dict[str, Dict[int, Dict[str, Dict[str, Union[str, int, float]]]]]</span>
<span class=sd>        ```</span>

<span class=sd>    !!! info &quot;About the fitting options&quot;</span>

<span class=sd>        In general, there are two option for the fitting possible:</span>

<span class=sd>        1. `Classic fitting` or `local fitting`, where the parameters are defined</span>
<span class=sd>            for a 2D spectrum.</span>
<span class=sd>        2. `Global fitting`, where the parameters are defined for a 3D spectrum.</span>
<span class=sd>            Here, the parameters can be automatically defined for each column on the</span>
<span class=sd>            basis of the initial parameters or they can be completley defined by the</span>
<span class=sd>            user. The `global fitting` definition starts at `1` similiar to the</span>
<span class=sd>            peaks attributes notation.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>col_len</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>args</span> <span class=o>=</span> <span class=n>args</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>params</span> <span class=o>=</span> <span class=n>Parameters</span><span class=p>()</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>df_to_numvalues</span><span class=p>(</span><span class=n>df</span><span class=o>=</span><span class=n>df</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=n>args</span><span class=p>)</span>

    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.__perform__ class="doc doc-heading"> <code class="highlight language-python"><span class=n>__perform__</span><span class=p>()</span></code> <a href=#spectrafit.models.ModelParameters.__perform__ class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Perform the model parameter definition.</p> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code>KeyError</code> </td> <td><p>Global fitting is combination with automatic peak detection is not implemented yet.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 980</span>
<span class=normal> 981</span>
<span class=normal> 982</span>
<span class=normal> 983</span>
<span class=normal> 984</span>
<span class=normal> 985</span>
<span class=normal> 986</span>
<span class=normal> 987</span>
<span class=normal> 988</span>
<span class=normal> 989</span>
<span class=normal> 990</span>
<span class=normal> 991</span>
<span class=normal> 992</span>
<span class=normal> 993</span>
<span class=normal> 994</span>
<span class=normal> 995</span>
<span class=normal> 996</span>
<span class=normal> 997</span>
<span class=normal> 998</span>
<span class=normal> 999</span>
<span class=normal>1000</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>__perform__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Perform the model parameter definition.</span>

<span class=sd>    Raises:</span>
<span class=sd>        KeyError: Global fitting is combination with automatic peak detection is</span>
<span class=sd>             not implemented yet.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters</span><span class=p>()</span>
    <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span> <span class=ow>and</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_global</span><span class=p>()</span>
    <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>2</span> <span class=ow>and</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_global_pre</span><span class=p>()</span>
    <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>initialize_peak_detection</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_auto</span><span class=p>()</span>
    <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]:</span>
        <span class=k>raise</span> <span class=ne>KeyError</span><span class=p>(</span>
            <span class=s2>&quot;Global fitting mode with automatic peak detection &quot;</span>
            <span class=s2>&quot;is not supported yet.&quot;</span>
        <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.__str__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__str__</span><span class=p>()</span></code> <a href=#spectrafit.models.ModelParameters.__str__ class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return the <code>string</code> representation of the model parameters.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>str</code></td> <td> <code>str</code> </td> <td><p>String representation of the model parameters.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>971</span>
<span class=normal>972</span>
<span class=normal>973</span>
<span class=normal>974</span>
<span class=normal>975</span>
<span class=normal>976</span>
<span class=normal>977</span>
<span class=normal>978</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return the `string` representation of the model parameters.</span>

<span class=sd>    Returns:</span>
<span class=sd>        str: String representation of the model parameters.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>__perform__</span><span class=p>()</span>
    <span class=k>return</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.define_parameters class="doc doc-heading"> <code class="highlight language-python"><span class=n>define_parameters</span><span class=p>()</span></code> <a href=#spectrafit.models.ModelParameters.define_parameters class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Define the input parameters for a <code>params</code>-dictionary for classic fitting.</p> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1157</span>
<span class=normal>1158</span>
<span class=normal>1159</span>
<span class=normal>1160</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>define_parameters</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Define the input parameters for a `params`-dictionary for classic fitting.&quot;&quot;&quot;</span>
    <span class=k>for</span> <span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;peaks&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_loop</span><span class=p>(</span><span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span><span class=o>=</span><span class=n>value_1</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.define_parameters_auto class="doc doc-heading"> <code class="highlight language-python"><span class=n>define_parameters_auto</span><span class=p>()</span></code> <a href=#spectrafit.models.ModelParameters.define_parameters_auto class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Auto define the model parameters for local fitting.</p> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1002</span>
<span class=normal>1003</span>
<span class=normal>1004</span>
<span class=normal>1005</span>
<span class=normal>1006</span>
<span class=normal>1007</span>
<span class=normal>1008</span>
<span class=normal>1009</span>
<span class=normal>1010</span>
<span class=normal>1011</span>
<span class=normal>1012</span>
<span class=normal>1013</span>
<span class=normal>1014</span>
<span class=normal>1015</span>
<span class=normal>1016</span>
<span class=normal>1017</span>
<span class=normal>1018</span>
<span class=normal>1019</span>
<span class=normal>1020</span>
<span class=normal>1021</span>
<span class=normal>1022</span>
<span class=normal>1023</span>
<span class=normal>1024</span>
<span class=normal>1025</span>
<span class=normal>1026</span>
<span class=normal>1027</span>
<span class=normal>1028</span>
<span class=normal>1029</span>
<span class=normal>1030</span>
<span class=normal>1031</span>
<span class=normal>1032</span>
<span class=normal>1033</span>
<span class=normal>1034</span>
<span class=normal>1035</span>
<span class=normal>1036</span>
<span class=normal>1037</span>
<span class=normal>1038</span>
<span class=normal>1039</span>
<span class=normal>1040</span>
<span class=normal>1041</span>
<span class=normal>1042</span>
<span class=normal>1043</span>
<span class=normal>1044</span>
<span class=normal>1045</span>
<span class=normal>1046</span>
<span class=normal>1047</span>
<span class=normal>1048</span>
<span class=normal>1049</span>
<span class=normal>1050</span>
<span class=normal>1051</span>
<span class=normal>1052</span>
<span class=normal>1053</span>
<span class=normal>1054</span>
<span class=normal>1055</span>
<span class=normal>1056</span>
<span class=normal>1057</span>
<span class=normal>1058</span>
<span class=normal>1059</span>
<span class=normal>1060</span>
<span class=normal>1061</span>
<span class=normal>1062</span>
<span class=normal>1063</span>
<span class=normal>1064</span>
<span class=normal>1065</span>
<span class=normal>1066</span>
<span class=normal>1067</span>
<span class=normal>1068</span>
<span class=normal>1069</span>
<span class=normal>1070</span>
<span class=normal>1071</span>
<span class=normal>1072</span>
<span class=normal>1073</span>
<span class=normal>1074</span>
<span class=normal>1075</span>
<span class=normal>1076</span>
<span class=normal>1077</span>
<span class=normal>1078</span>
<span class=normal>1079</span>
<span class=normal>1080</span>
<span class=normal>1081</span>
<span class=normal>1082</span>
<span class=normal>1083</span>
<span class=normal>1084</span>
<span class=normal>1085</span>
<span class=normal>1086</span>
<span class=normal>1087</span>
<span class=normal>1088</span>
<span class=normal>1089</span>
<span class=normal>1090</span>
<span class=normal>1091</span>
<span class=normal>1092</span>
<span class=normal>1093</span>
<span class=normal>1094</span>
<span class=normal>1095</span>
<span class=normal>1096</span>
<span class=normal>1097</span>
<span class=normal>1098</span>
<span class=normal>1099</span>
<span class=normal>1100</span>
<span class=normal>1101</span>
<span class=normal>1102</span>
<span class=normal>1103</span>
<span class=normal>1104</span>
<span class=normal>1105</span>
<span class=normal>1106</span>
<span class=normal>1107</span>
<span class=normal>1108</span>
<span class=normal>1109</span>
<span class=normal>1110</span>
<span class=normal>1111</span>
<span class=normal>1112</span>
<span class=normal>1113</span>
<span class=normal>1114</span>
<span class=normal>1115</span>
<span class=normal>1116</span>
<span class=normal>1117</span>
<span class=normal>1118</span>
<span class=normal>1119</span>
<span class=normal>1120</span>
<span class=normal>1121</span>
<span class=normal>1122</span>
<span class=normal>1123</span>
<span class=normal>1124</span>
<span class=normal>1125</span>
<span class=normal>1126</span>
<span class=normal>1127</span>
<span class=normal>1128</span>
<span class=normal>1129</span>
<span class=normal>1130</span>
<span class=normal>1131</span>
<span class=normal>1132</span>
<span class=normal>1133</span>
<span class=normal>1134</span>
<span class=normal>1135</span>
<span class=normal>1136</span>
<span class=normal>1137</span>
<span class=normal>1138</span>
<span class=normal>1139</span>
<span class=normal>1140</span>
<span class=normal>1141</span>
<span class=normal>1142</span>
<span class=normal>1143</span>
<span class=normal>1144</span>
<span class=normal>1145</span>
<span class=normal>1146</span>
<span class=normal>1147</span>
<span class=normal>1148</span>
<span class=normal>1149</span>
<span class=normal>1150</span>
<span class=normal>1151</span>
<span class=normal>1152</span>
<span class=normal>1153</span>
<span class=normal>1154</span>
<span class=normal>1155</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>define_parameters_auto</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Auto define the model parameters for local fitting.&quot;&quot;&quot;</span>
    <span class=n>positions</span><span class=p>,</span> <span class=n>properties</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>__autodetect__</span><span class=p>()</span>
    <span class=k>if</span> <span class=p>(</span>
        <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>],</span> <span class=nb>bool</span><span class=p>)</span>
        <span class=ow>and</span> <span class=s2>&quot;model_type&quot;</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]</span>
    <span class=p>):</span>
        <span class=n>_model</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>][</span><span class=s2>&quot;model_type&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
        <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>automodel_check</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>_model</span><span class=p>)</span>
        <span class=n>models</span> <span class=o>=</span> <span class=n>_model</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>models</span> <span class=o>=</span> <span class=s2>&quot;gaussian&quot;</span>

    <span class=k>if</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;gaussian&quot;</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
            <span class=nb>zip</span><span class=p>(</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
            <span class=p>),</span>
            <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
        <span class=p>):</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
                <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
                <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhmg_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                <span class=n>value</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
                <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=p>)</span>
    <span class=k>elif</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;lorentzian&quot;</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
            <span class=nb>zip</span><span class=p>(</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
            <span class=p>),</span>
            <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
        <span class=p>):</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
                <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
                <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhml_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                <span class=n>value</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
                <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=p>)</span>
    <span class=k>elif</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;voigt&quot;</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
            <span class=nb>zip</span><span class=p>(</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
            <span class=p>),</span>
            <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
        <span class=p>):</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
                <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
                <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhmv_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                <span class=n>value</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
                <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=p>)</span>
    <span class=k>elif</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;pseudovoigt&quot;</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
            <span class=nb>zip</span><span class=p>(</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
            <span class=p>),</span>
            <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
        <span class=p>):</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
                <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
                <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhmg_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                <span class=n>value</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
                <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
                <span class=nb>max</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhml_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                <span class=n>value</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
                <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=p>)</span>

    <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;auto_generated_models&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;models&quot;</span><span class=p>:</span> <span class=p>{</span>
            <span class=n>key</span><span class=p>:</span> <span class=p>{</span>
                <span class=s2>&quot;value&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
                <span class=s2>&quot;min&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>,</span>
                <span class=s2>&quot;max&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>,</span>
                <span class=s2>&quot;vary&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>vary</span><span class=p>,</span>
            <span class=p>}</span>
            <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span>
        <span class=p>},</span>
        <span class=s2>&quot;positions&quot;</span><span class=p>:</span> <span class=n>positions</span><span class=o>.</span><span class=n>tolist</span><span class=p>(),</span>
        <span class=s2>&quot;properties&quot;</span><span class=p>:</span> <span class=p>{</span><span class=n>key</span><span class=p>:</span> <span class=n>value</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>properties</span><span class=o>.</span><span class=n>items</span><span class=p>()},</span>
    <span class=p>}</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.define_parameters_global class="doc doc-heading"> <code class="highlight language-python"><span class=n>define_parameters_global</span><span class=p>()</span></code> <a href=#spectrafit.models.ModelParameters.define_parameters_global class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Define the input parameters for a <code>params</code>-dictionary for global fitting.</p> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1203</span>
<span class=normal>1204</span>
<span class=normal>1205</span>
<span class=normal>1206</span>
<span class=normal>1207</span>
<span class=normal>1208</span>
<span class=normal>1209</span>
<span class=normal>1210</span>
<span class=normal>1211</span>
<span class=normal>1212</span>
<span class=normal>1213</span>
<span class=normal>1214</span>
<span class=normal>1215</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>define_parameters_global</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Define the input parameters for a `params`-dictionary for global fitting.&quot;&quot;&quot;</span>
    <span class=k>for</span> <span class=n>col_i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>col_len</span><span class=p>):</span>
        <span class=k>for</span> <span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;peaks&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=k>for</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span> <span class=ow>in</span> <span class=n>value_1</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                <span class=k>for</span> <span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span> <span class=ow>in</span> <span class=n>value_2</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>_define_parameter</span><span class=p>(</span>
                        <span class=n>col_i</span><span class=o>=</span><span class=n>col_i</span><span class=p>,</span>
                        <span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span>
                        <span class=n>key_2</span><span class=o>=</span><span class=n>key_2</span><span class=p>,</span>
                        <span class=n>key_3</span><span class=o>=</span><span class=n>key_3</span><span class=p>,</span>
                        <span class=n>value_3</span><span class=o>=</span><span class=n>value_3</span><span class=p>,</span>
                    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.define_parameters_global_pre class="doc doc-heading"> <code class="highlight language-python"><span class=n>define_parameters_global_pre</span><span class=p>()</span></code> <a href=#spectrafit.models.ModelParameters.define_parameters_global_pre class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Define the input parameters for a <code>params</code>-dictionary for global fitting.</p> <div class="admonition warning"> <p class=admonition-title>About <code>params</code> for global fitting</p> <p><code>define_parameters_global_pre</code> requires fully defined <code>params</code>-dictionary in the json, toml, or yaml file input. This means:</p> <ol> <li>Number of the spectra must be defined.</li> <li>Number of the peaks must be defined.</li> <li>Number of the parameters must be defined.</li> <li>The parameters must be defined.</li> </ol> </div> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1245</span>
<span class=normal>1246</span>
<span class=normal>1247</span>
<span class=normal>1248</span>
<span class=normal>1249</span>
<span class=normal>1250</span>
<span class=normal>1251</span>
<span class=normal>1252</span>
<span class=normal>1253</span>
<span class=normal>1254</span>
<span class=normal>1255</span>
<span class=normal>1256</span>
<span class=normal>1257</span>
<span class=normal>1258</span>
<span class=normal>1259</span>
<span class=normal>1260</span>
<span class=normal>1261</span>
<span class=normal>1262</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>define_parameters_global_pre</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Define the input parameters for a `params`-dictionary for global fitting.</span>

<span class=sd>    !!! warning &quot;About `params` for global fitting&quot;</span>

<span class=sd>        `define_parameters_global_pre` requires fully defined `params`-dictionary</span>
<span class=sd>        in the json, toml, or yaml file input. This means:</span>

<span class=sd>        1. Number of the spectra must be defined.</span>
<span class=sd>        2. Number of the peaks must be defined.</span>
<span class=sd>        3. Number of the parameters must be defined.</span>
<span class=sd>        4. The parameters must be defined.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>for</span> <span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;peaks&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=k>for</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span> <span class=ow>in</span> <span class=n>value_1</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=k>for</span> <span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span> <span class=ow>in</span> <span class=n>value_2</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                <span class=k>for</span> <span class=n>key_4</span><span class=p>,</span> <span class=n>value_4</span> <span class=ow>in</span> <span class=n>value_3</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_4</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>value_4</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.define_parameters_loop class="doc doc-heading"> <code class="highlight language-python"><span class=n>define_parameters_loop</span><span class=p>(</span><span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span><span class=p>)</span></code> <a href=#spectrafit.models.ModelParameters.define_parameters_loop class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Loop through the input parameters for a <code>params</code>-dictionary.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>key_1</code></td> <td> <code>str</code> </td> <td><p>The key of the first level of the input dictionary.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>value_1</code></td> <td> <code><span title=typing.Dict>Dict</span>[str, <span title=typing.Any>Any</span>]</code> </td> <td><p>The value of the first level of the input dictionary.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1162</span>
<span class=normal>1163</span>
<span class=normal>1164</span>
<span class=normal>1165</span>
<span class=normal>1166</span>
<span class=normal>1167</span>
<span class=normal>1168</span>
<span class=normal>1169</span>
<span class=normal>1170</span>
<span class=normal>1171</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>define_parameters_loop</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key_1</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value_1</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Loop through the input parameters for a `params`-dictionary.</span>

<span class=sd>    Args:</span>
<span class=sd>        key_1 (str): The key of the first level of the input dictionary.</span>
<span class=sd>        value_1 (Dict[str, Any]): The value of the first level of the input</span>
<span class=sd>             dictionary.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>for</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span> <span class=ow>in</span> <span class=n>value_1</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_loop_2</span><span class=p>(</span><span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span> <span class=n>key_2</span><span class=o>=</span><span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span><span class=o>=</span><span class=n>value_2</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.define_parameters_loop_2 class="doc doc-heading"> <code class="highlight language-python"><span class=n>define_parameters_loop_2</span><span class=p>(</span><span class=n>key_1</span><span class=p>,</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span><span class=p>)</span></code> <a href=#spectrafit.models.ModelParameters.define_parameters_loop_2 class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Loop through the input parameters for a <code>params</code>-dictionary.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>key_1</code></td> <td> <code>str</code> </td> <td><p>The key of the first level of the input dictionary.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>key_2</code></td> <td> <code>str</code> </td> <td><p>The key of the second level of the input dictionary.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>value_2</code></td> <td> <code><span title=typing.Dict>Dict</span>[str, <span title=typing.Any>Any</span>]</code> </td> <td><p>The value of the second level of the input dictionary.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1173</span>
<span class=normal>1174</span>
<span class=normal>1175</span>
<span class=normal>1176</span>
<span class=normal>1177</span>
<span class=normal>1178</span>
<span class=normal>1179</span>
<span class=normal>1180</span>
<span class=normal>1181</span>
<span class=normal>1182</span>
<span class=normal>1183</span>
<span class=normal>1184</span>
<span class=normal>1185</span>
<span class=normal>1186</span>
<span class=normal>1187</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>define_parameters_loop_2</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>key_1</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_2</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value_2</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Loop through the input parameters for a `params`-dictionary.</span>

<span class=sd>    Args:</span>
<span class=sd>        key_1 (str): The key of the first level of the input dictionary.</span>
<span class=sd>        key_2 (str): The key of the second level of the input dictionary.</span>
<span class=sd>        value_2 (Dict[str, Any]): The value of the second level of the input</span>
<span class=sd>             dictionary.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>for</span> <span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span> <span class=ow>in</span> <span class=n>value_2</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_loop_3</span><span class=p>(</span>
            <span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span> <span class=n>key_2</span><span class=o>=</span><span class=n>key_2</span><span class=p>,</span> <span class=n>key_3</span><span class=o>=</span><span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span><span class=o>=</span><span class=n>value_3</span>
        <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.define_parameters_loop_3 class="doc doc-heading"> <code class="highlight language-python"><span class=n>define_parameters_loop_3</span><span class=p>(</span><span class=n>key_1</span><span class=p>,</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span><span class=p>)</span></code> <a href=#spectrafit.models.ModelParameters.define_parameters_loop_3 class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Loop through the input parameters for a <code>params</code>-dictionary.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>key_1</code></td> <td> <code>str</code> </td> <td><p>The key of the first level of the input dictionary.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>key_2</code></td> <td> <code>str</code> </td> <td><p>The key of the second level of the input dictionary.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>key_3</code></td> <td> <code>str</code> </td> <td><p>The key of the third level of the input dictionary.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>value_3</code></td> <td> <code><span title=typing.Dict>Dict</span>[str, <span title=typing.Any>Any</span>]</code> </td> <td><p>The value of the third level of the input dictionary.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1189</span>
<span class=normal>1190</span>
<span class=normal>1191</span>
<span class=normal>1192</span>
<span class=normal>1193</span>
<span class=normal>1194</span>
<span class=normal>1195</span>
<span class=normal>1196</span>
<span class=normal>1197</span>
<span class=normal>1198</span>
<span class=normal>1199</span>
<span class=normal>1200</span>
<span class=normal>1201</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>define_parameters_loop_3</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>key_1</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_2</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_3</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value_3</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Loop through the input parameters for a `params`-dictionary.</span>

<span class=sd>    Args:</span>
<span class=sd>        key_1 (str): The key of the first level of the input dictionary.</span>
<span class=sd>        key_2 (str): The key of the second level of the input dictionary.</span>
<span class=sd>        key_3 (str): The key of the third level of the input dictionary.</span>
<span class=sd>        value_3 (Dict[str, Any]): The value of the third level of the input</span>
<span class=sd>             dictionary.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>value_3</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.df_to_numvalues class="doc doc-heading"> <code class="highlight language-python"><span class=n>df_to_numvalues</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>args</span><span class=p>)</span></code> <a href=#spectrafit.models.ModelParameters.df_to_numvalues class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Transform the dataframe to numeric values of <code>x</code> and <code>data</code>.</p> <div class="admonition note"> <p class=admonition-title>About the dataframe to numeric values</p> <p>The transformation is done by the <code>value</code> property of pandas. The dataframe is separated into the <code>x</code> and <code>data</code> columns and the <code>x</code> column is transformed to the energy values and the <code>data</code> column is transformed to the intensity values depending on the <code>args</code> dictionary. In terms of global fitting, the <code>data</code> contains the intensity values for each column.</p> </div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>df</code></td> <td> <code><span title=pandas>pd</span>.<span title=pandas.DataFrame>DataFrame</span></code> </td> <td><p>DataFrame containing the input data (<code>x</code> and <code>data</code>).</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>args</code></td> <td> <code><span title=typing.Dict>Dict</span>[str, <span title=typing.Any>Any</span>]</code> </td> <td><p>The input file arguments as a dictionary with additional information beyond the command line arguments.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=typing.Tuple>Tuple</span>[<span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>], <span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]]</code> </td> <td><p>Tuple[NDArray[np.float64], NDArray[np.float64]]: Tuple of <code>x</code> and <code>data</code> as numpy arrays.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>932</span>
<span class=normal>933</span>
<span class=normal>934</span>
<span class=normal>935</span>
<span class=normal>936</span>
<span class=normal>937</span>
<span class=normal>938</span>
<span class=normal>939</span>
<span class=normal>940</span>
<span class=normal>941</span>
<span class=normal>942</span>
<span class=normal>943</span>
<span class=normal>944</span>
<span class=normal>945</span>
<span class=normal>946</span>
<span class=normal>947</span>
<span class=normal>948</span>
<span class=normal>949</span>
<span class=normal>950</span>
<span class=normal>951</span>
<span class=normal>952</span>
<span class=normal>953</span>
<span class=normal>954</span>
<span class=normal>955</span>
<span class=normal>956</span>
<span class=normal>957</span>
<span class=normal>958</span>
<span class=normal>959</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>df_to_numvalues</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Transform the dataframe to numeric values of `x` and `data`.</span>

<span class=sd>    !!! note &quot;About the dataframe to numeric values&quot;</span>

<span class=sd>        The transformation is done by the `value` property of pandas. The dataframe</span>
<span class=sd>        is separated into the `x` and `data` columns and the `x` column is</span>
<span class=sd>        transformed to the energy values and the `data` column is transformed to</span>
<span class=sd>        the intensity values depending on the `args` dictionary. In terms of global</span>
<span class=sd>        fitting, the `data` contains the intensity values for each column.</span>

<span class=sd>    Args:</span>
<span class=sd>        df (pd.DataFrame): DataFrame containing the input data (`x` and `data`).</span>
<span class=sd>        args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<span class=sd>             additional information beyond the command line arguments.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Tuple[NDArray[np.float64], NDArray[np.float64]]: Tuple of `x` and</span>
<span class=sd>             `data` as numpy arrays.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]:</span>
        <span class=k>return</span> <span class=p>(</span>
            <span class=n>df</span><span class=p>[</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(),</span>
            <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span> <span class=o>!=</span> <span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(),</span>
        <span class=p>)</span>
    <span class=k>return</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(),</span> <span class=n>df</span><span class=p>[</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>1</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>())</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=spectrafit.models.ReferenceKeys class="doc doc-heading"> <code>ReferenceKeys</code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small> </span> <a href=#spectrafit.models.ReferenceKeys class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p>Reference keys for model fitting and peak detection.</p> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>511</span>
<span class=normal>512</span>
<span class=normal>513</span>
<span class=normal>514</span>
<span class=normal>515</span>
<span class=normal>516</span>
<span class=normal>517</span>
<span class=normal>518</span>
<span class=normal>519</span>
<span class=normal>520</span>
<span class=normal>521</span>
<span class=normal>522</span>
<span class=normal>523</span>
<span class=normal>524</span>
<span class=normal>525</span>
<span class=normal>526</span>
<span class=normal>527</span>
<span class=normal>528</span>
<span class=normal>529</span>
<span class=normal>530</span>
<span class=normal>531</span>
<span class=normal>532</span>
<span class=normal>533</span>
<span class=normal>534</span>
<span class=normal>535</span>
<span class=normal>536</span>
<span class=normal>537</span>
<span class=normal>538</span>
<span class=normal>539</span>
<span class=normal>540</span>
<span class=normal>541</span>
<span class=normal>542</span>
<span class=normal>543</span>
<span class=normal>544</span>
<span class=normal>545</span>
<span class=normal>546</span>
<span class=normal>547</span>
<span class=normal>548</span>
<span class=normal>549</span>
<span class=normal>550</span>
<span class=normal>551</span>
<span class=normal>552</span>
<span class=normal>553</span>
<span class=normal>554</span>
<span class=normal>555</span>
<span class=normal>556</span>
<span class=normal>557</span>
<span class=normal>558</span>
<span class=normal>559</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@dataclass</span><span class=p>(</span><span class=n>frozen</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=k>class</span> <span class=nc>ReferenceKeys</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Reference keys for model fitting and peak detection.&quot;&quot;&quot;</span>

    <span class=n>__models__</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>DistributionModelAPI</span><span class=o>.</span><span class=n>schema</span><span class=p>()[</span><span class=s2>&quot;properties&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>

    <span class=n>__automodels__</span> <span class=o>=</span> <span class=p>[</span>
        <span class=s2>&quot;gaussian&quot;</span><span class=p>,</span>
        <span class=s2>&quot;lorentzian&quot;</span><span class=p>,</span>
        <span class=s2>&quot;voigt&quot;</span><span class=p>,</span>
        <span class=s2>&quot;pseudovoigt&quot;</span><span class=p>,</span>
    <span class=p>]</span>

    <span class=k>def</span> <span class=nf>model_check</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Check if model is available.</span>

<span class=sd>        Args:</span>
<span class=sd>            model (str): Model name.</span>

<span class=sd>        Raises:</span>
<span class=sd>            KeyError: If the model is not supported.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>model</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;_&quot;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>__models__</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>NotImplementedError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>model</span><span class=si>}</span><span class=s2> is not supported!&quot;</span><span class=p>)</span>

    <span class=k>def</span> <span class=nf>automodel_check</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Check if model is available.</span>

<span class=sd>        Args:</span>
<span class=sd>            model (str): Auto Model name (gaussian, lorentzian, voigt, or pseudovoigt).</span>

<span class=sd>        Raises:</span>
<span class=sd>            KeyError: If the model is not supported.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>model</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>__automodels__</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>KeyError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>model</span><span class=si>}</span><span class=s2> is not supported!&quot;</span><span class=p>)</span>

    <span class=k>def</span> <span class=nf>detection_check</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Check if detection is available.</span>

<span class=sd>        Args:</span>
<span class=sd>            args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<span class=sd>                 additional information beyond the command line arguments.</span>

<span class=sd>        Raises:</span>
<span class=sd>            KeyError: If the key is not parameter of the `scipy.signal.find_peaks`</span>
<span class=sd>                function. This will be checked via `pydantic` in `spectrafit.api`.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>AutopeakAPI</span><span class=p>(</span><span class=o>**</span><span class=n>args</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ReferenceKeys.automodel_check class="doc doc-heading"> <code class="highlight language-python"><span class=n>automodel_check</span><span class=p>(</span><span class=n>model</span><span class=p>)</span></code> <a href=#spectrafit.models.ReferenceKeys.automodel_check class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Check if model is available.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>model</code></td> <td> <code>str</code> </td> <td><p>Auto Model name (gaussian, lorentzian, voigt, or pseudovoigt).</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code>KeyError</code> </td> <td><p>If the model is not supported.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>536</span>
<span class=normal>537</span>
<span class=normal>538</span>
<span class=normal>539</span>
<span class=normal>540</span>
<span class=normal>541</span>
<span class=normal>542</span>
<span class=normal>543</span>
<span class=normal>544</span>
<span class=normal>545</span>
<span class=normal>546</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>automodel_check</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Check if model is available.</span>

<span class=sd>    Args:</span>
<span class=sd>        model (str): Auto Model name (gaussian, lorentzian, voigt, or pseudovoigt).</span>

<span class=sd>    Raises:</span>
<span class=sd>        KeyError: If the model is not supported.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>model</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>__automodels__</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>KeyError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>model</span><span class=si>}</span><span class=s2> is not supported!&quot;</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ReferenceKeys.detection_check class="doc doc-heading"> <code class="highlight language-python"><span class=n>detection_check</span><span class=p>(</span><span class=n>args</span><span class=p>)</span></code> <a href=#spectrafit.models.ReferenceKeys.detection_check class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Check if detection is available.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>args</code></td> <td> <code><span title=typing.Dict>Dict</span>[str, <span title=typing.Any>Any</span>]</code> </td> <td><p>The input file arguments as a dictionary with additional information beyond the command line arguments.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code>KeyError</code> </td> <td><p>If the key is not parameter of the <code>scipy.signal.find_peaks</code> function. This will be checked via <code>pydantic</code> in <code>spectrafit.api</code>.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>548</span>
<span class=normal>549</span>
<span class=normal>550</span>
<span class=normal>551</span>
<span class=normal>552</span>
<span class=normal>553</span>
<span class=normal>554</span>
<span class=normal>555</span>
<span class=normal>556</span>
<span class=normal>557</span>
<span class=normal>558</span>
<span class=normal>559</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>detection_check</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Check if detection is available.</span>

<span class=sd>    Args:</span>
<span class=sd>        args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<span class=sd>             additional information beyond the command line arguments.</span>

<span class=sd>    Raises:</span>
<span class=sd>        KeyError: If the key is not parameter of the `scipy.signal.find_peaks`</span>
<span class=sd>            function. This will be checked via `pydantic` in `spectrafit.api`.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>AutopeakAPI</span><span class=p>(</span><span class=o>**</span><span class=n>args</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ReferenceKeys.model_check class="doc doc-heading"> <code class="highlight language-python"><span class=n>model_check</span><span class=p>(</span><span class=n>model</span><span class=p>)</span></code> <a href=#spectrafit.models.ReferenceKeys.model_check class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Check if model is available.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>model</code></td> <td> <code>str</code> </td> <td><p>Model name.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code>KeyError</code> </td> <td><p>If the model is not supported.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>524</span>
<span class=normal>525</span>
<span class=normal>526</span>
<span class=normal>527</span>
<span class=normal>528</span>
<span class=normal>529</span>
<span class=normal>530</span>
<span class=normal>531</span>
<span class=normal>532</span>
<span class=normal>533</span>
<span class=normal>534</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>model_check</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Check if model is available.</span>

<span class=sd>    Args:</span>
<span class=sd>        model (str): Model name.</span>

<span class=sd>    Raises:</span>
<span class=sd>        KeyError: If the model is not supported.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>model</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;_&quot;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>__models__</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>NotImplementedError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>model</span><span class=si>}</span><span class=s2> is not supported!&quot;</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=spectrafit.models.SolverModels class="doc doc-heading"> <code>SolverModels</code> <a href=#spectrafit.models.SolverModels class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title=spectrafit.models.ModelParameters href=#spectrafit.models.ModelParameters>ModelParameters</a></code></p> <p>Solving models for 2D and 3D data sets.</p> <div class="admonition hint"> <p class=admonition-title>Solver Modes</p> <ul> <li><code>"2D"</code>: Solve 2D models via the classic <code>lmfit</code> function.</li> <li><code>"3D"</code>: Solve 3D models via global git. For the <code>global-fitting</code> procedure, the <code>lmfit</code> function is used to solve the models with an extended set of parameters. the <code>lmfit</code> function is used.</li> </ul> </div> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1265</span>
<span class=normal>1266</span>
<span class=normal>1267</span>
<span class=normal>1268</span>
<span class=normal>1269</span>
<span class=normal>1270</span>
<span class=normal>1271</span>
<span class=normal>1272</span>
<span class=normal>1273</span>
<span class=normal>1274</span>
<span class=normal>1275</span>
<span class=normal>1276</span>
<span class=normal>1277</span>
<span class=normal>1278</span>
<span class=normal>1279</span>
<span class=normal>1280</span>
<span class=normal>1281</span>
<span class=normal>1282</span>
<span class=normal>1283</span>
<span class=normal>1284</span>
<span class=normal>1285</span>
<span class=normal>1286</span>
<span class=normal>1287</span>
<span class=normal>1288</span>
<span class=normal>1289</span>
<span class=normal>1290</span>
<span class=normal>1291</span>
<span class=normal>1292</span>
<span class=normal>1293</span>
<span class=normal>1294</span>
<span class=normal>1295</span>
<span class=normal>1296</span>
<span class=normal>1297</span>
<span class=normal>1298</span>
<span class=normal>1299</span>
<span class=normal>1300</span>
<span class=normal>1301</span>
<span class=normal>1302</span>
<span class=normal>1303</span>
<span class=normal>1304</span>
<span class=normal>1305</span>
<span class=normal>1306</span>
<span class=normal>1307</span>
<span class=normal>1308</span>
<span class=normal>1309</span>
<span class=normal>1310</span>
<span class=normal>1311</span>
<span class=normal>1312</span>
<span class=normal>1313</span>
<span class=normal>1314</span>
<span class=normal>1315</span>
<span class=normal>1316</span>
<span class=normal>1317</span>
<span class=normal>1318</span>
<span class=normal>1319</span>
<span class=normal>1320</span>
<span class=normal>1321</span>
<span class=normal>1322</span>
<span class=normal>1323</span>
<span class=normal>1324</span>
<span class=normal>1325</span>
<span class=normal>1326</span>
<span class=normal>1327</span>
<span class=normal>1328</span>
<span class=normal>1329</span>
<span class=normal>1330</span>
<span class=normal>1331</span>
<span class=normal>1332</span>
<span class=normal>1333</span>
<span class=normal>1334</span>
<span class=normal>1335</span>
<span class=normal>1336</span>
<span class=normal>1337</span>
<span class=normal>1338</span>
<span class=normal>1339</span>
<span class=normal>1340</span>
<span class=normal>1341</span>
<span class=normal>1342</span>
<span class=normal>1343</span>
<span class=normal>1344</span>
<span class=normal>1345</span>
<span class=normal>1346</span>
<span class=normal>1347</span>
<span class=normal>1348</span>
<span class=normal>1349</span>
<span class=normal>1350</span>
<span class=normal>1351</span>
<span class=normal>1352</span>
<span class=normal>1353</span>
<span class=normal>1354</span>
<span class=normal>1355</span>
<span class=normal>1356</span>
<span class=normal>1357</span>
<span class=normal>1358</span>
<span class=normal>1359</span>
<span class=normal>1360</span>
<span class=normal>1361</span>
<span class=normal>1362</span>
<span class=normal>1363</span>
<span class=normal>1364</span>
<span class=normal>1365</span>
<span class=normal>1366</span>
<span class=normal>1367</span>
<span class=normal>1368</span>
<span class=normal>1369</span>
<span class=normal>1370</span>
<span class=normal>1371</span>
<span class=normal>1372</span>
<span class=normal>1373</span>
<span class=normal>1374</span>
<span class=normal>1375</span>
<span class=normal>1376</span>
<span class=normal>1377</span>
<span class=normal>1378</span>
<span class=normal>1379</span>
<span class=normal>1380</span>
<span class=normal>1381</span>
<span class=normal>1382</span>
<span class=normal>1383</span>
<span class=normal>1384</span>
<span class=normal>1385</span>
<span class=normal>1386</span>
<span class=normal>1387</span>
<span class=normal>1388</span>
<span class=normal>1389</span>
<span class=normal>1390</span>
<span class=normal>1391</span>
<span class=normal>1392</span>
<span class=normal>1393</span>
<span class=normal>1394</span>
<span class=normal>1395</span>
<span class=normal>1396</span>
<span class=normal>1397</span>
<span class=normal>1398</span>
<span class=normal>1399</span>
<span class=normal>1400</span>
<span class=normal>1401</span>
<span class=normal>1402</span>
<span class=normal>1403</span>
<span class=normal>1404</span>
<span class=normal>1405</span>
<span class=normal>1406</span>
<span class=normal>1407</span>
<span class=normal>1408</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span> <span class=nc>SolverModels</span><span class=p>(</span><span class=n>ModelParameters</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Solving models for 2D and 3D data sets.</span>

<span class=sd>    !!! hint &quot;Solver Modes&quot;</span>
<span class=sd>        * `&quot;2D&quot;`: Solve 2D models via the classic `lmfit` function.</span>
<span class=sd>        * `&quot;3D&quot;`: Solve 3D models via global git. For the `global-fitting` procedure,</span>
<span class=sd>             the `lmfit` function is used to solve the models with an extended set of</span>
<span class=sd>             parameters.</span>
<span class=sd>          the `lmfit` function is used.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Initialize the solver modes.</span>

<span class=sd>        Args:</span>
<span class=sd>            df (pd.DataFrame): DataFrame containing the input data (`x` and `data`).</span>
<span class=sd>            args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<span class=sd>                 additional information beyond the command line arguments.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>df</span><span class=o>=</span><span class=n>df</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=n>args</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span> <span class=o>=</span> <span class=n>SolverModelsAPI</span><span class=p>(</span><span class=o>**</span><span class=n>args</span><span class=p>)</span><span class=o>.</span><span class=n>dict</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>args_global</span> <span class=o>=</span> <span class=n>GlobalFittingAPI</span><span class=p>(</span><span class=o>**</span><span class=n>args</span><span class=p>)</span><span class=o>.</span><span class=n>dict</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>return_params</span>

    <span class=k>def</span> <span class=fm>__call__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>Minimizer</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Solve the fitting model.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Tuple[Minimizer, Any]: Minimizer class and the fitting results.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>args_global</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]:</span>
            <span class=n>minimizer</span> <span class=o>=</span> <span class=n>Minimizer</span><span class=p>(</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>solve_global_fitting</span><span class=p>,</span>
                <span class=n>params</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>,</span>
                <span class=n>fcn_args</span><span class=o>=</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>),</span>
                <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span><span class=p>[</span><span class=s2>&quot;minimizer&quot;</span><span class=p>],</span>
            <span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>minimizer</span> <span class=o>=</span> <span class=n>Minimizer</span><span class=p>(</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>solve_local_fitting</span><span class=p>,</span>
                <span class=n>params</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>,</span>
                <span class=n>fcn_args</span><span class=o>=</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>),</span>
                <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span><span class=p>[</span><span class=s2>&quot;minimizer&quot;</span><span class=p>],</span>
            <span class=p>)</span>

        <span class=k>return</span> <span class=p>(</span><span class=n>minimizer</span><span class=p>,</span> <span class=n>minimizer</span><span class=o>.</span><span class=n>minimize</span><span class=p>(</span><span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span><span class=p>[</span><span class=s2>&quot;optimizer&quot;</span><span class=p>]))</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>solve_local_fitting</span><span class=p>(</span>
        <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Parameters</span><span class=p>],</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>data</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Solving the fitting problem.</span>

<span class=sd>        !!! note &quot;About implemented models&quot;</span>
<span class=sd>            `solve_local_fitting` is a wrapper function for the calling the implemented</span>
<span class=sd>            moldels. Based on the `params` dictionary, the function calls the</span>
<span class=sd>            corresponding models and merge them to the general model with will be</span>
<span class=sd>            optimized by the `lmfit`-optimizer.</span>
<span class=sd>            Currently the following models are supported:</span>

<span class=sd>            - [Gaussian](https://en.wikipedia.org/wiki/Gaussian_function)</span>
<span class=sd>            - [Lorentzian](https://en.wikipedia.org/wiki/Cauchy_distribution)</span>
<span class=sd>                also known as Cauchy distribution</span>
<span class=sd>            - [Voigt](https://en.wikipedia.org/wiki/Voigt_profile)</span>
<span class=sd>            - [Pseudo Voigt][1]</span>
<span class=sd>            - Exponential</span>
<span class=sd>            - [power][2] (also known as Log-parabola or just power)</span>
<span class=sd>            - Linear</span>
<span class=sd>            - Constant</span>
<span class=sd>            - [Error Function](https://en.wikipedia.org/wiki/Error_function)</span>
<span class=sd>            - [Arcus Tangens][3]</span>
<span class=sd>            - Logarithmic</span>

<span class=sd>            [1]: https://en.wikipedia.org/wiki/Voigt_profile#Pseudo-Voigt_approximation</span>
<span class=sd>            [2]: https://en.wikipedia.org/wiki/Power_law</span>
<span class=sd>            [3]: https://en.wikipedia.org/wiki/Inverse_trigonometric_functions</span>

<span class=sd>        Args:</span>
<span class=sd>            params (Dict[str, Parameters]): The best optimized parameters of the fit.</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            data (NDArray[np.float64]): `y`-values of the data as 1d-array.</span>

<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: The best-fitted data based on the proposed model.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>val</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
        <span class=n>peak_kwargs</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span> <span class=n>Parameters</span><span class=p>]</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>

        <span class=k>for</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>params</span><span class=p>:</span>
            <span class=n>model</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
            <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>model_check</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>)</span>
            <span class=n>c_name</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;_&quot;</span><span class=p>)</span>
            <span class=n>peak_kwargs</span><span class=p>[(</span><span class=n>c_name</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>c_name</span><span class=p>[</span><span class=mi>2</span><span class=p>])][</span><span class=n>c_name</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=n>model</span><span class=p>]</span>

        <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>_kwarg</span> <span class=ow>in</span> <span class=n>peak_kwargs</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=n>val</span> <span class=o>+=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>DistributionModels</span><span class=p>(),</span> <span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])(</span><span class=n>x</span><span class=p>,</span> <span class=o>**</span><span class=n>_kwarg</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>val</span> <span class=o>-</span> <span class=n>data</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>solve_global_fitting</span><span class=p>(</span>
        <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Parameters</span><span class=p>],</span>
        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
        <span class=n>data</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Solving the fitting for global problem.</span>

<span class=sd>        !!! note &quot;About implemented models&quot;</span>
<span class=sd>            `solve_global_fitting` is the global solution of `solve_local_fitting` a</span>
<span class=sd>            wrapper function for the calling the implemented moldels. For the kind of</span>
<span class=sd>            supported models see `solve_local_fitting`.</span>

<span class=sd>        !!! note &quot;About the global solution&quot;</span>
<span class=sd>            The global solution is a solution for the problem, where the `x`-values is</span>
<span class=sd>            the energy, but the y-values are the intensities, which has to be fitted as</span>
<span class=sd>            one unit. For this reason, the residual is calculated as the difference</span>
<span class=sd>            between all the y-values and the global proposed solution. Later the</span>
<span class=sd>            residual has to be flattened to a 1-dimensional array and minimized by the</span>
<span class=sd>            `lmfit`-optimizer.</span>


<span class=sd>        Args:</span>
<span class=sd>            params (Dict[str, Parameters]): The best optimized parameters of the fit.</span>
<span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>            data (NDArray[np.float64]): `y`-values of the data as 2D-array.</span>

<span class=sd>        Returns:</span>
<span class=sd>            NDArray[np.float64]: The best-fitted data based on the proposed model.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>val</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
        <span class=n>peak_kwargs</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span> <span class=n>Parameters</span><span class=p>]</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>

        <span class=k>for</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>params</span><span class=p>:</span>
            <span class=n>model</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
            <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>model_check</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>)</span>
            <span class=n>c_name</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;_&quot;</span><span class=p>)</span>
            <span class=n>peak_kwargs</span><span class=p>[(</span><span class=n>c_name</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>c_name</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=n>c_name</span><span class=p>[</span><span class=mi>3</span><span class=p>])][</span><span class=n>c_name</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=n>model</span><span class=p>]</span>
        <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>_kwarg</span> <span class=ow>in</span> <span class=n>peak_kwargs</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=n>i</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=o>-</span> <span class=mi>1</span>
            <span class=n>val</span><span class=p>[:,</span> <span class=n>i</span><span class=p>]</span> <span class=o>+=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>DistributionModels</span><span class=p>(),</span> <span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])(</span><span class=n>x</span><span class=p>,</span> <span class=o>**</span><span class=n>_kwarg</span><span class=p>)</span>

        <span class=n>val</span> <span class=o>-=</span> <span class=n>data</span>
        <span class=k>return</span> <span class=n>val</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.SolverModels.__call__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__call__</span><span class=p>()</span></code> <a href=#spectrafit.models.SolverModels.__call__ class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Solve the fitting model.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=typing.Tuple>Tuple</span>[<span title=lmfit.Minimizer>Minimizer</span>, <span title=typing.Any>Any</span>]</code> </td> <td><p>Tuple[Minimizer, Any]: Minimizer class and the fitting results.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1289</span>
<span class=normal>1290</span>
<span class=normal>1291</span>
<span class=normal>1292</span>
<span class=normal>1293</span>
<span class=normal>1294</span>
<span class=normal>1295</span>
<span class=normal>1296</span>
<span class=normal>1297</span>
<span class=normal>1298</span>
<span class=normal>1299</span>
<span class=normal>1300</span>
<span class=normal>1301</span>
<span class=normal>1302</span>
<span class=normal>1303</span>
<span class=normal>1304</span>
<span class=normal>1305</span>
<span class=normal>1306</span>
<span class=normal>1307</span>
<span class=normal>1308</span>
<span class=normal>1309</span>
<span class=normal>1310</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=fm>__call__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>Minimizer</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Solve the fitting model.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Tuple[Minimizer, Any]: Minimizer class and the fitting results.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>args_global</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]:</span>
        <span class=n>minimizer</span> <span class=o>=</span> <span class=n>Minimizer</span><span class=p>(</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>solve_global_fitting</span><span class=p>,</span>
            <span class=n>params</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>,</span>
            <span class=n>fcn_args</span><span class=o>=</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>),</span>
            <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span><span class=p>[</span><span class=s2>&quot;minimizer&quot;</span><span class=p>],</span>
        <span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>minimizer</span> <span class=o>=</span> <span class=n>Minimizer</span><span class=p>(</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>solve_local_fitting</span><span class=p>,</span>
            <span class=n>params</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>,</span>
            <span class=n>fcn_args</span><span class=o>=</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>),</span>
            <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span><span class=p>[</span><span class=s2>&quot;minimizer&quot;</span><span class=p>],</span>
        <span class=p>)</span>

    <span class=k>return</span> <span class=p>(</span><span class=n>minimizer</span><span class=p>,</span> <span class=n>minimizer</span><span class=o>.</span><span class=n>minimize</span><span class=p>(</span><span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span><span class=p>[</span><span class=s2>&quot;optimizer&quot;</span><span class=p>]))</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.SolverModels.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>args</span><span class=p>)</span></code> <a href=#spectrafit.models.SolverModels.__init__ class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Initialize the solver modes.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>df</code></td> <td> <code><span title=pandas>pd</span>.<span title=pandas.DataFrame>DataFrame</span></code> </td> <td><p>DataFrame containing the input data (<code>x</code> and <code>data</code>).</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>args</code></td> <td> <code><span title=typing.Dict>Dict</span>[str, <span title=typing.Any>Any</span>]</code> </td> <td><p>The input file arguments as a dictionary with additional information beyond the command line arguments.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1276</span>
<span class=normal>1277</span>
<span class=normal>1278</span>
<span class=normal>1279</span>
<span class=normal>1280</span>
<span class=normal>1281</span>
<span class=normal>1282</span>
<span class=normal>1283</span>
<span class=normal>1284</span>
<span class=normal>1285</span>
<span class=normal>1286</span>
<span class=normal>1287</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the solver modes.</span>

<span class=sd>    Args:</span>
<span class=sd>        df (pd.DataFrame): DataFrame containing the input data (`x` and `data`).</span>
<span class=sd>        args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<span class=sd>             additional information beyond the command line arguments.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>df</span><span class=o>=</span><span class=n>df</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=n>args</span><span class=p>)</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span> <span class=o>=</span> <span class=n>SolverModelsAPI</span><span class=p>(</span><span class=o>**</span><span class=n>args</span><span class=p>)</span><span class=o>.</span><span class=n>dict</span><span class=p>()</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>args_global</span> <span class=o>=</span> <span class=n>GlobalFittingAPI</span><span class=p>(</span><span class=o>**</span><span class=n>args</span><span class=p>)</span><span class=o>.</span><span class=n>dict</span><span class=p>()</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>return_params</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.SolverModels.solve_global_fitting class="doc doc-heading"> <code class="highlight language-python"><span class=n>solve_global_fitting</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.SolverModels.solve_global_fitting class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Solving the fitting for global problem.</p> <div class="admonition note"> <p class=admonition-title>About implemented models</p> <p><code>solve_global_fitting</code> is the global solution of <code>solve_local_fitting</code> a wrapper function for the calling the implemented moldels. For the kind of supported models see <code>solve_local_fitting</code>.</p> </div> <div class="admonition note"> <p class=admonition-title>About the global solution</p> <p>The global solution is a solution for the problem, where the <code>x</code>-values is the energy, but the y-values are the intensities, which has to be fitted as one unit. For this reason, the residual is calculated as the difference between all the y-values and the global proposed solution. Later the residual has to be flattened to a 1-dimensional array and minimized by the <code>lmfit</code>-optimizer.</p> </div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>params</code></td> <td> <code><span title=typing.Dict>Dict</span>[str, <span title=lmfit.Parameters>Parameters</span>]</code> </td> <td><p>The best optimized parameters of the fit.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>data</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>y</code>-values of the data as 2D-array.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: The best-fitted data based on the proposed model.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1365</span>
<span class=normal>1366</span>
<span class=normal>1367</span>
<span class=normal>1368</span>
<span class=normal>1369</span>
<span class=normal>1370</span>
<span class=normal>1371</span>
<span class=normal>1372</span>
<span class=normal>1373</span>
<span class=normal>1374</span>
<span class=normal>1375</span>
<span class=normal>1376</span>
<span class=normal>1377</span>
<span class=normal>1378</span>
<span class=normal>1379</span>
<span class=normal>1380</span>
<span class=normal>1381</span>
<span class=normal>1382</span>
<span class=normal>1383</span>
<span class=normal>1384</span>
<span class=normal>1385</span>
<span class=normal>1386</span>
<span class=normal>1387</span>
<span class=normal>1388</span>
<span class=normal>1389</span>
<span class=normal>1390</span>
<span class=normal>1391</span>
<span class=normal>1392</span>
<span class=normal>1393</span>
<span class=normal>1394</span>
<span class=normal>1395</span>
<span class=normal>1396</span>
<span class=normal>1397</span>
<span class=normal>1398</span>
<span class=normal>1399</span>
<span class=normal>1400</span>
<span class=normal>1401</span>
<span class=normal>1402</span>
<span class=normal>1403</span>
<span class=normal>1404</span>
<span class=normal>1405</span>
<span class=normal>1406</span>
<span class=normal>1407</span>
<span class=normal>1408</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>solve_global_fitting</span><span class=p>(</span>
    <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Parameters</span><span class=p>],</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>data</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Solving the fitting for global problem.</span>

<span class=sd>    !!! note &quot;About implemented models&quot;</span>
<span class=sd>        `solve_global_fitting` is the global solution of `solve_local_fitting` a</span>
<span class=sd>        wrapper function for the calling the implemented moldels. For the kind of</span>
<span class=sd>        supported models see `solve_local_fitting`.</span>

<span class=sd>    !!! note &quot;About the global solution&quot;</span>
<span class=sd>        The global solution is a solution for the problem, where the `x`-values is</span>
<span class=sd>        the energy, but the y-values are the intensities, which has to be fitted as</span>
<span class=sd>        one unit. For this reason, the residual is calculated as the difference</span>
<span class=sd>        between all the y-values and the global proposed solution. Later the</span>
<span class=sd>        residual has to be flattened to a 1-dimensional array and minimized by the</span>
<span class=sd>        `lmfit`-optimizer.</span>


<span class=sd>    Args:</span>
<span class=sd>        params (Dict[str, Parameters]): The best optimized parameters of the fit.</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        data (NDArray[np.float64]): `y`-values of the data as 2D-array.</span>

<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: The best-fitted data based on the proposed model.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>val</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
    <span class=n>peak_kwargs</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span> <span class=n>Parameters</span><span class=p>]</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>params</span><span class=p>:</span>
        <span class=n>model</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
        <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>model_check</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>)</span>
        <span class=n>c_name</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;_&quot;</span><span class=p>)</span>
        <span class=n>peak_kwargs</span><span class=p>[(</span><span class=n>c_name</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>c_name</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=n>c_name</span><span class=p>[</span><span class=mi>3</span><span class=p>])][</span><span class=n>c_name</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=n>model</span><span class=p>]</span>
    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>_kwarg</span> <span class=ow>in</span> <span class=n>peak_kwargs</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>i</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=o>-</span> <span class=mi>1</span>
        <span class=n>val</span><span class=p>[:,</span> <span class=n>i</span><span class=p>]</span> <span class=o>+=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>DistributionModels</span><span class=p>(),</span> <span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])(</span><span class=n>x</span><span class=p>,</span> <span class=o>**</span><span class=n>_kwarg</span><span class=p>)</span>

    <span class=n>val</span> <span class=o>-=</span> <span class=n>data</span>
    <span class=k>return</span> <span class=n>val</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.SolverModels.solve_local_fitting class="doc doc-heading"> <code class="highlight language-python"><span class=n>solve_local_fitting</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.SolverModels.solve_local_fitting class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Solving the fitting problem.</p> <div class="admonition note"> <p class=admonition-title>About implemented models</p> <p><code>solve_local_fitting</code> is a wrapper function for the calling the implemented moldels. Based on the <code>params</code> dictionary, the function calls the corresponding models and merge them to the general model with will be optimized by the <code>lmfit</code>-optimizer. Currently the following models are supported:</p> <ul> <li><a href=https://en.wikipedia.org/wiki/Gaussian_function>Gaussian</a></li> <li><a href=https://en.wikipedia.org/wiki/Cauchy_distribution>Lorentzian</a> also known as Cauchy distribution</li> <li><a href=https://en.wikipedia.org/wiki/Voigt_profile>Voigt</a></li> <li><a href=https://en.wikipedia.org/wiki/Voigt_profile#Pseudo-Voigt_approximation>Pseudo Voigt</a></li> <li>Exponential</li> <li><a href=https://en.wikipedia.org/wiki/Power_law>power</a> (also known as Log-parabola or just power)</li> <li>Linear</li> <li>Constant</li> <li><a href=https://en.wikipedia.org/wiki/Error_function>Error Function</a></li> <li><a href=https://en.wikipedia.org/wiki/Inverse_trigonometric_functions>Arcus Tangens</a></li> <li>Logarithmic</li> </ul> </div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>params</code></td> <td> <code><span title=typing.Dict>Dict</span>[str, <span title=lmfit.Parameters>Parameters</span>]</code> </td> <td><p>The best optimized parameters of the fit.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>data</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>y</code>-values of the data as 1d-array.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p>NDArray[np.float64]: The best-fitted data based on the proposed model.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1312</span>
<span class=normal>1313</span>
<span class=normal>1314</span>
<span class=normal>1315</span>
<span class=normal>1316</span>
<span class=normal>1317</span>
<span class=normal>1318</span>
<span class=normal>1319</span>
<span class=normal>1320</span>
<span class=normal>1321</span>
<span class=normal>1322</span>
<span class=normal>1323</span>
<span class=normal>1324</span>
<span class=normal>1325</span>
<span class=normal>1326</span>
<span class=normal>1327</span>
<span class=normal>1328</span>
<span class=normal>1329</span>
<span class=normal>1330</span>
<span class=normal>1331</span>
<span class=normal>1332</span>
<span class=normal>1333</span>
<span class=normal>1334</span>
<span class=normal>1335</span>
<span class=normal>1336</span>
<span class=normal>1337</span>
<span class=normal>1338</span>
<span class=normal>1339</span>
<span class=normal>1340</span>
<span class=normal>1341</span>
<span class=normal>1342</span>
<span class=normal>1343</span>
<span class=normal>1344</span>
<span class=normal>1345</span>
<span class=normal>1346</span>
<span class=normal>1347</span>
<span class=normal>1348</span>
<span class=normal>1349</span>
<span class=normal>1350</span>
<span class=normal>1351</span>
<span class=normal>1352</span>
<span class=normal>1353</span>
<span class=normal>1354</span>
<span class=normal>1355</span>
<span class=normal>1356</span>
<span class=normal>1357</span>
<span class=normal>1358</span>
<span class=normal>1359</span>
<span class=normal>1360</span>
<span class=normal>1361</span>
<span class=normal>1362</span>
<span class=normal>1363</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>solve_local_fitting</span><span class=p>(</span>
    <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Parameters</span><span class=p>],</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>data</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Solving the fitting problem.</span>

<span class=sd>    !!! note &quot;About implemented models&quot;</span>
<span class=sd>        `solve_local_fitting` is a wrapper function for the calling the implemented</span>
<span class=sd>        moldels. Based on the `params` dictionary, the function calls the</span>
<span class=sd>        corresponding models and merge them to the general model with will be</span>
<span class=sd>        optimized by the `lmfit`-optimizer.</span>
<span class=sd>        Currently the following models are supported:</span>

<span class=sd>        - [Gaussian](https://en.wikipedia.org/wiki/Gaussian_function)</span>
<span class=sd>        - [Lorentzian](https://en.wikipedia.org/wiki/Cauchy_distribution)</span>
<span class=sd>            also known as Cauchy distribution</span>
<span class=sd>        - [Voigt](https://en.wikipedia.org/wiki/Voigt_profile)</span>
<span class=sd>        - [Pseudo Voigt][1]</span>
<span class=sd>        - Exponential</span>
<span class=sd>        - [power][2] (also known as Log-parabola or just power)</span>
<span class=sd>        - Linear</span>
<span class=sd>        - Constant</span>
<span class=sd>        - [Error Function](https://en.wikipedia.org/wiki/Error_function)</span>
<span class=sd>        - [Arcus Tangens][3]</span>
<span class=sd>        - Logarithmic</span>

<span class=sd>        [1]: https://en.wikipedia.org/wiki/Voigt_profile#Pseudo-Voigt_approximation</span>
<span class=sd>        [2]: https://en.wikipedia.org/wiki/Power_law</span>
<span class=sd>        [3]: https://en.wikipedia.org/wiki/Inverse_trigonometric_functions</span>

<span class=sd>    Args:</span>
<span class=sd>        params (Dict[str, Parameters]): The best optimized parameters of the fit.</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        data (NDArray[np.float64]): `y`-values of the data as 1d-array.</span>

<span class=sd>    Returns:</span>
<span class=sd>        NDArray[np.float64]: The best-fitted data based on the proposed model.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>val</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
    <span class=n>peak_kwargs</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span> <span class=n>Parameters</span><span class=p>]</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>params</span><span class=p>:</span>
        <span class=n>model</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
        <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>model_check</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>)</span>
        <span class=n>c_name</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;_&quot;</span><span class=p>)</span>
        <span class=n>peak_kwargs</span><span class=p>[(</span><span class=n>c_name</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>c_name</span><span class=p>[</span><span class=mi>2</span><span class=p>])][</span><span class=n>c_name</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=n>model</span><span class=p>]</span>

    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>_kwarg</span> <span class=ow>in</span> <span class=n>peak_kwargs</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>val</span> <span class=o>+=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>DistributionModels</span><span class=p>(),</span> <span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])(</span><span class=n>x</span><span class=p>,</span> <span class=o>**</span><span class=n>_kwarg</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>val</span> <span class=o>-</span> <span class=n>data</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-function"> <h2 id=spectrafit.models.calculated_model class="doc doc-heading"> <code class="highlight language-python"><span class=n>calculated_model</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>df</span><span class=p>,</span> <span class=n>global_fit</span><span class=p>)</span></code> <a href=#spectrafit.models.calculated_model class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p>Calculate the single contributions of the models and add them to the dataframe.</p> <div class="admonition note"> <p class=admonition-title>About calculated models</p> <p><code>calculated_model</code> are also wrapper functions similar to <code>solve_model</code>. The overall goal is to extract from the best parameters the single contributions in the model. Currently, <code>lmfit</code> provides only a single model, so the best-fit.</p> </div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>params</code></td> <td> <code><span title=typing.Dict>Dict</span>[str, <span title=lmfit.Parameters>Parameters</span>]</code> </td> <td><p>The best optimized parameters of the fit.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>x</code></td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy>np</span>.<span title=numpy.float64>float64</span>]</code> </td> <td><p><code>x</code>-values of the data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>df</code></td> <td> <code><span title=pandas>pd</span>.<span title=pandas.DataFrame>DataFrame</span></code> </td> <td><p>DataFrame containing the input data (<code>x</code> and <code>data</code>), as well as the best fit and the corresponding residuum. Hence, it will be extended by the single contribution of the model.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>global_fit</code></td> <td> <code>int</code> </td> <td><p>If 1 or 2, the model is calculated for the global fit.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title=pandas>pd</span>.<span title=pandas.DataFrame>DataFrame</span></code> </td> <td><p>pd.DataFrame: Extended dataframe containing the single contributions of the models.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1411</span>
<span class=normal>1412</span>
<span class=normal>1413</span>
<span class=normal>1414</span>
<span class=normal>1415</span>
<span class=normal>1416</span>
<span class=normal>1417</span>
<span class=normal>1418</span>
<span class=normal>1419</span>
<span class=normal>1420</span>
<span class=normal>1421</span>
<span class=normal>1422</span>
<span class=normal>1423</span>
<span class=normal>1424</span>
<span class=normal>1425</span>
<span class=normal>1426</span>
<span class=normal>1427</span>
<span class=normal>1428</span>
<span class=normal>1429</span>
<span class=normal>1430</span>
<span class=normal>1431</span>
<span class=normal>1432</span>
<span class=normal>1433</span>
<span class=normal>1434</span>
<span class=normal>1435</span>
<span class=normal>1436</span>
<span class=normal>1437</span>
<span class=normal>1438</span>
<span class=normal>1439</span>
<span class=normal>1440</span>
<span class=normal>1441</span>
<span class=normal>1442</span>
<span class=normal>1443</span>
<span class=normal>1444</span>
<span class=normal>1445</span>
<span class=normal>1446</span>
<span class=normal>1447</span>
<span class=normal>1448</span>
<span class=normal>1449</span>
<span class=normal>1450</span>
<span class=normal>1451</span>
<span class=normal>1452</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>calculated_model</span><span class=p>(</span>
    <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Parameters</span><span class=p>],</span>
    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
    <span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span>
    <span class=n>global_fit</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
<span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Calculate the single contributions of the models and add them to the dataframe.</span>

<span class=sd>    !!! note &quot;About calculated models&quot;</span>
<span class=sd>        `calculated_model` are also wrapper functions similar to `solve_model`. The</span>
<span class=sd>        overall goal is to extract from the best parameters the single contributions in</span>
<span class=sd>        the model. Currently, `lmfit` provides only a single model, so the best-fit.</span>

<span class=sd>    Args:</span>
<span class=sd>        params (Dict[str, Parameters]): The best optimized parameters of the fit.</span>
<span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<span class=sd>        df (pd.DataFrame): DataFrame containing the input data (`x` and `data`),</span>
<span class=sd>             as well as the best fit and the corresponding residuum. Hence, it will be</span>
<span class=sd>             extended by the single contribution of the model.</span>
<span class=sd>        global_fit (int): If 1 or 2, the model is calculated for the global fit.</span>

<span class=sd>    Returns:</span>
<span class=sd>        pd.DataFrame: Extended dataframe containing the single contributions of the</span>
<span class=sd>            models.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>peak_kwargs</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=n>Any</span><span class=p>,</span> <span class=n>Parameters</span><span class=p>]</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>params</span><span class=p>:</span>
        <span class=n>model</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
        <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>model_check</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>)</span>
        <span class=n>p_name</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;_&quot;</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>global_fit</span><span class=p>:</span>
            <span class=n>peak_kwargs</span><span class=p>[(</span><span class=n>p_name</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>p_name</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=n>p_name</span><span class=p>[</span><span class=mi>3</span><span class=p>])][</span><span class=n>p_name</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=n>model</span><span class=p>]</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>peak_kwargs</span><span class=p>[(</span><span class=n>p_name</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>p_name</span><span class=p>[</span><span class=mi>2</span><span class=p>])][</span><span class=n>p_name</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=n>model</span><span class=p>]</span>

    <span class=n>_df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>_kwarg</span> <span class=ow>in</span> <span class=n>peak_kwargs</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>c_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>if</span> <span class=n>global_fit</span> <span class=k>else</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
        <span class=n>_df</span><span class=p>[</span><span class=n>c_name</span><span class=p>]</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>DistributionModels</span><span class=p>(),</span> <span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])(</span><span class=n>x</span><span class=p>,</span> <span class=o>**</span><span class=n>_kwarg</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>_df</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021 - 2023 Anselm Hahn </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/Anselmoo target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://pypi.org/project/spectrafit/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.expand", "content.code.annotate", "content.tabs.link", "header.autohide", "navigation.expand", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.integrate"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.407015b8.min.js></script> <script src=../../javascripts/config.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>