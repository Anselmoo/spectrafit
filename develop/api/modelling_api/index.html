<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Technical documentation for SpectraFit, a Python package for fitting spectroscopic data with a focus on X-ray spectroscopy techniques"><meta name=author content="Anselm Hahn"><link href=https://Anselmoo.github.io/spectrafit/develop/api/modelling_api/ rel=canonical><link href=../notebook_api/ rel=prev><link href=../reporting_api/ rel=next><link rel=icon href=../../images/logo.svg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.12"><title>Modelling - SpectraFit</title><link rel=stylesheet href=../../assets/stylesheets/main.2afb09e1.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../css/timeago.css><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../assets/css/custom.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#spectrafit.models class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=SpectraFit class="md-header__button md-logo" aria-label=SpectraFit data-md-component=logo> <img src=../../images/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SpectraFit </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Modelling </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9 2C5.13 2 2 5.13 2 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.87-3.13-7-7-7M6 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H6zm13-8h-2l-3.2 9h1.9l.7-2h3.2l.7 2h1.9zm-2.15 5.65L18 15l1.15 3.65z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/Anselmoo/spectrafit title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg> </div> <div class=md-source__repository> Anselmoo/SpectraFit </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../interface/ class=md-tabs__link> Getting started </a> </li> <li class=md-tabs__item> <a href=../../examples/ class=md-tabs__link> Examples </a> </li> <li class=md-tabs__item> <a href=../../doc/ class=md-tabs__link> Documentation </a> </li> <li class=md-tabs__item> <a href=../../plugins/ class=md-tabs__link> Plugins </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> API </a> </li> <li class=md-tabs__item> <a href=../../contact/ class=md-tabs__link> Support </a> </li> <li class=md-tabs__item> <a href=../../changelog/ class=md-tabs__link> Releases </a> </li> <li class=md-tabs__item> <a href=../../tags/ class=md-tabs__link> Tags </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=SpectraFit class="md-nav__button md-logo" aria-label=SpectraFit data-md-component=logo> <img src=../../images/logo.svg alt=logo> </a> SpectraFit </label> <div class=md-nav__source> <a href=https://github.com/Anselmoo/spectrafit title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg> </div> <div class=md-source__repository> Anselmoo/SpectraFit </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <div class="md-nav__link md-nav__container"> <a href=../../interface/ class="md-nav__link "> <span class=md-ellipsis> Getting started </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../interface/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../interface/usage/ class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> </li> <li class=md-nav__item> <a href=../../interface/features/ class=md-nav__link> <span class=md-ellipsis> Features </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../examples/ class="md-nav__link "> <span class=md-ellipsis> Examples </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Command-Line Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Command-Line Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/example1/ class=md-nav__link> <span class=md-ellipsis> Fitting of a Single Feature </span> </a> </li> <li class=md-nav__item> <a href=../../examples/example2/ class=md-nav__link> <span class=md-ellipsis> JSON, TOML, YAML Inputs </span> </a> </li> <li class=md-nav__item> <a href=../../examples/example3/ class=md-nav__link> <span class=md-ellipsis> Multi Peak Fitting </span> </a> </li> <li class=md-nav__item> <a href=../../examples/example4/ class=md-nav__link> <span class=md-ellipsis> Working with Real Life Data </span> </a> </li> <li class=md-nav__item> <a href=../../examples/example5/ class=md-nav__link> <span class=md-ellipsis> Working with Expressions </span> </a> </li> <li class=md-nav__item> <a href=../../examples/example6/ class=md-nav__link> <span class=md-ellipsis> Global Fitting </span> </a> </li> <li class=md-nav__item> <a href=../../examples/example7/ class=md-nav__link> <span class=md-ellipsis> Automatic Fitting </span> </a> </li> <li class=md-nav__item> <a href=../../examples/example8/ class=md-nav__link> <span class=md-ellipsis> Working with Athena Data </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> Jupyter Notebook Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Jupyter Notebook Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/example9_1/ class=md-nav__link> <span class=md-ellipsis> Default Plot </span> </a> </li> <li class=md-nav__item> <a href=../../examples/example9_2/ class=md-nav__link> <span class=md-ellipsis> Themes </span> </a> </li> <li class=md-nav__item> <a href=../../examples/example9_3/ class=md-nav__link> <span class=md-ellipsis> Export Results </span> </a> </li> <li class=md-nav__item> <a href=../../examples/example9_4/ class=md-nav__link> <span class=md-ellipsis> RIXS Map Visualization </span> </a> </li> <li class=md-nav__item> <a href=../../examples/example9_5/ class=md-nav__link> <span class=md-ellipsis> Using Converters as Module </span> </a> </li> <li class=md-nav__item> <a href=../../examples/example9_6/ class=md-nav__link> <span class=md-ellipsis> RIXS Global-Fitting in Jupyter </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../../doc/ class="md-nav__link "> <span class=md-ellipsis> Documentation </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Documentation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../doc/models/ class=md-nav__link> <span class=md-ellipsis> Models </span> </a> </li> <li class=md-nav__item> <a href=../../doc/expression/ class=md-nav__link> <span class=md-ellipsis> Expression </span> </a> </li> <li class=md-nav__item> <a href=../../doc/solver/ class=md-nav__link> <span class=md-ellipsis> Solvers </span> </a> </li> <li class=md-nav__item> <a href=../../doc/fitting/ class=md-nav__link> <span class=md-ellipsis> Fitting </span> </a> </li> <li class=md-nav__item> <a href=../../doc/statistics/ class=md-nav__link> <span class=md-ellipsis> Statistics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../plugins/ class="md-nav__link "> <span class=md-ellipsis> Plugins </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Plugins </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../plugins/file_converter/ class=md-nav__link> <span class=md-ellipsis> File-Format-Conversion </span> </a> </li> <li class=md-nav__item> <a href=../../plugins/data_converter/ class=md-nav__link> <span class=md-ellipsis> Data-Format-Conversion </span> </a> </li> <li class=md-nav__item> <a href=../../plugins/jupyter_interface/ class=md-nav__link> <span class=md-ellipsis> Jupyter-Notebook-Integration </span> </a> </li> <li class=md-nav__item> <a href=../../plugins/rixs_visualization/ class=md-nav__link> <span class=md-ellipsis> RIXS-Visualization </span> </a> </li> <li class=md-nav__item> <a href=../../plugins/rixs_converter/ class=md-nav__link> <span class=md-ellipsis> RIXS-Converter </span> </a> </li> <li class=md-nav__item> <a href=../../plugins/pkl_converter_visualization/ class=md-nav__link> <span class=md-ellipsis> PKL-Converter and Visualizer </span> </a> </li> <li class=md-nav__item> <a href=../../plugins/pptx_converter/ class=md-nav__link> <span class=md-ellipsis> PPTX-Converter </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> API </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../spectrafit_api/ class=md-nav__link> <span class=md-ellipsis> SpectraFit </span> </a> </li> <li class=md-nav__item> <a href=../plotting_api/ class=md-nav__link> <span class=md-ellipsis> Plotting </span> </a> </li> <li class=md-nav__item> <a href=../notebook_api/ class=md-nav__link> <span class=md-ellipsis> Jupyter-Notebook </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Modelling </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Modelling </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#spectrafit.models class=md-nav__link> <span class=md-ellipsis> models </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection class=md-nav__link> <span class=md-ellipsis> AutoPeakDetection </span> </a> <nav class=md-nav aria-label=AutoPeakDetection> <ul class=md-nav__list> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimate_distance class=md-nav__link> <span class=md-ellipsis> estimate_distance </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimate_height class=md-nav__link> <span class=md-ellipsis> estimate_height </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimate_prominence class=md-nav__link> <span class=md-ellipsis> estimate_prominence </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimate_threshold class=md-nav__link> <span class=md-ellipsis> estimate_threshold </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimated_plateau_size class=md-nav__link> <span class=md-ellipsis> estimated_plateau_size </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimated_rel_height class=md-nav__link> <span class=md-ellipsis> estimated_rel_height </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimated_width class=md-nav__link> <span class=md-ellipsis> estimated_width </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.estimated_wlen class=md-nav__link> <span class=md-ellipsis> estimated_wlen </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.__autodetect__ class=md-nav__link> <span class=md-ellipsis> __autodetect__ </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.__init__ class=md-nav__link> <span class=md-ellipsis> __init__ </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.check_key_exists class=md-nav__link> <span class=md-ellipsis> check_key_exists </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.default_values class=md-nav__link> <span class=md-ellipsis> default_values </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.AutoPeakDetection.initialize_peak_detection class=md-nav__link> <span class=md-ellipsis> initialize_peak_detection </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#spectrafit.models.Constants class=md-nav__link> <span class=md-ellipsis> Constants </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels class=md-nav__link> <span class=md-ellipsis> DistributionModels </span> </a> <nav class=md-nav aria-label=DistributionModels> <ul class=md-nav__list> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.atan class=md-nav__link> <span class=md-ellipsis> atan </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.cgaussian class=md-nav__link> <span class=md-ellipsis> cgaussian </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.clorentzian class=md-nav__link> <span class=md-ellipsis> clorentzian </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.constant class=md-nav__link> <span class=md-ellipsis> constant </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.cvoigt class=md-nav__link> <span class=md-ellipsis> cvoigt </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.erf class=md-nav__link> <span class=md-ellipsis> erf </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.exponential class=md-nav__link> <span class=md-ellipsis> exponential </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.gaussian class=md-nav__link> <span class=md-ellipsis> gaussian </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.heaviside class=md-nav__link> <span class=md-ellipsis> heaviside </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.linear class=md-nav__link> <span class=md-ellipsis> linear </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.log class=md-nav__link> <span class=md-ellipsis> log </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.lorentzian class=md-nav__link> <span class=md-ellipsis> lorentzian </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.orcagaussian class=md-nav__link> <span class=md-ellipsis> orcagaussian </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.pearson1 class=md-nav__link> <span class=md-ellipsis> pearson1 </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.pearson2 class=md-nav__link> <span class=md-ellipsis> pearson2 </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.pearson3 class=md-nav__link> <span class=md-ellipsis> pearson3 </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.pearson4 class=md-nav__link> <span class=md-ellipsis> pearson4 </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.polynom2 class=md-nav__link> <span class=md-ellipsis> polynom2 </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.polynom3 class=md-nav__link> <span class=md-ellipsis> polynom3 </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.power class=md-nav__link> <span class=md-ellipsis> power </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.pseudovoigt class=md-nav__link> <span class=md-ellipsis> pseudovoigt </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.DistributionModels.voigt class=md-nav__link> <span class=md-ellipsis> voigt </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters class=md-nav__link> <span class=md-ellipsis> ModelParameters </span> </a> <nav class=md-nav aria-label=ModelParameters> <ul class=md-nav__list> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.return_params class=md-nav__link> <span class=md-ellipsis> return_params </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.__init__ class=md-nav__link> <span class=md-ellipsis> __init__ </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.__perform__ class=md-nav__link> <span class=md-ellipsis> __perform__ </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.__str__ class=md-nav__link> <span class=md-ellipsis> __str__ </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.define_parameters class=md-nav__link> <span class=md-ellipsis> define_parameters </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.define_parameters_auto class=md-nav__link> <span class=md-ellipsis> define_parameters_auto </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.define_parameters_global class=md-nav__link> <span class=md-ellipsis> define_parameters_global </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.define_parameters_global_pre class=md-nav__link> <span class=md-ellipsis> define_parameters_global_pre </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.define_parameters_loop class=md-nav__link> <span class=md-ellipsis> define_parameters_loop </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.define_parameters_loop_2 class=md-nav__link> <span class=md-ellipsis> define_parameters_loop_2 </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.define_parameters_loop_3 class=md-nav__link> <span class=md-ellipsis> define_parameters_loop_3 </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ModelParameters.df_to_numvalues class=md-nav__link> <span class=md-ellipsis> df_to_numvalues </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#spectrafit.models.ReferenceKeys class=md-nav__link> <span class=md-ellipsis> ReferenceKeys </span> </a> <nav class=md-nav aria-label=ReferenceKeys> <ul class=md-nav__list> <li class=md-nav__item> <a href=#spectrafit.models.ReferenceKeys.automodel_check class=md-nav__link> <span class=md-ellipsis> automodel_check </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ReferenceKeys.detection_check class=md-nav__link> <span class=md-ellipsis> detection_check </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.ReferenceKeys.model_check class=md-nav__link> <span class=md-ellipsis> model_check </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#spectrafit.models.SolverModels class=md-nav__link> <span class=md-ellipsis> SolverModels </span> </a> <nav class=md-nav aria-label=SolverModels> <ul class=md-nav__list> <li class=md-nav__item> <a href=#spectrafit.models.SolverModels.__call__ class=md-nav__link> <span class=md-ellipsis> __call__ </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.SolverModels.__init__ class=md-nav__link> <span class=md-ellipsis> __init__ </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.SolverModels.solve_global_fitting class=md-nav__link> <span class=md-ellipsis> solve_global_fitting </span> </a> </li> <li class=md-nav__item> <a href=#spectrafit.models.SolverModels.solve_local_fitting class=md-nav__link> <span class=md-ellipsis> solve_local_fitting </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#spectrafit.models.calculated_model class=md-nav__link> <span class=md-ellipsis> calculated_model </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../reporting_api/ class=md-nav__link> <span class=md-ellipsis> Reporting </span> </a> </li> <li class=md-nav__item> <a href=../tools_api/ class=md-nav__link> <span class=md-ellipsis> Tools </span> </a> </li> <li class=md-nav__item> <a href=../data_model_api/ class=md-nav__link> <span class=md-ellipsis> Data Model </span> </a> </li> <li class=md-nav__item> <a href=../converter_api/ class=md-nav__link> <span class=md-ellipsis> Converters and Visualizer </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Support </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Support </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../contact/ class=md-nav__link> <span class=md-ellipsis> Contact </span> </a> </li> <li class=md-nav__item> <a href=../../license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class=md-nav__item> <a href=../../contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../../code_of_conduct/ class=md-nav__link> <span class=md-ellipsis> Code of Conduct </span> </a> </li> <li class=md-nav__item> <a href=../../security/ class=md-nav__link> <span class=md-ellipsis> Security </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Releases </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Releases </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8_1> <label class=md-nav__link for=__nav_8_1 id=__nav_8_1_label tabindex=0> <span class=md-ellipsis> Changelog </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_8_1_label aria-expanded=false> <label class=md-nav__title for=__nav_8_1> <span class="md-nav__icon md-icon"></span> Changelog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../changelog/ class=md-nav__link> <span class=md-ellipsis> v1.x.x </span> </a> </li> <li class=md-nav__item> <a href=../../changelogs/v0.x.x/ class=md-nav__link> <span class=md-ellipsis> v0.x.x </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../contributors/ class=md-nav__link> <span class=md-ellipsis> Contributors </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../tags/ class=md-nav__link> <span class=md-ellipsis> Tags </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/Anselmoo/spectrafit/tree/main/docs/api/modelling_api.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/Anselmoo/spectrafit/tree/main/docs/api/modelling_api.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1>Modelling</h1> <div class="doc doc-object doc-module"> <a id=spectrafit.models></a> <div class="doc doc-contents first"> <p>Minimization models for curve fitting.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=spectrafit.models.AutoPeakDetection class="doc doc-heading"> <code>AutoPeakDetection</code> <a href=#spectrafit.models.AutoPeakDetection class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p>Automatic detection of peaks in a spectrum.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-933 name=__codelineno-0-933></a><a href=#__codelineno-0-933><span class=linenos data-linenos=" 933 "></span></a><span class=k>class</span><span class=w> </span><span class=nc>AutoPeakDetection</span><span class=p>:</span>
<a id=__codelineno-0-934 name=__codelineno-0-934></a><a href=#__codelineno-0-934><span class=linenos data-linenos=" 934 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Automatic detection of peaks in a spectrum.&quot;&quot;&quot;</span>
<a id=__codelineno-0-935 name=__codelineno-0-935></a><a href=#__codelineno-0-935><span class=linenos data-linenos=" 935 "></span></a>
<a id=__codelineno-0-936 name=__codelineno-0-936></a><a href=#__codelineno-0-936><span class=linenos data-linenos=" 936 "></span></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
<a id=__codelineno-0-937 name=__codelineno-0-937></a><a href=#__codelineno-0-937><span class=linenos data-linenos=" 937 "></span></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-938 name=__codelineno-0-938></a><a href=#__codelineno-0-938><span class=linenos data-linenos=" 938 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-939 name=__codelineno-0-939></a><a href=#__codelineno-0-939><span class=linenos data-linenos=" 939 "></span></a>        <span class=n>data</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-940 name=__codelineno-0-940></a><a href=#__codelineno-0-940><span class=linenos data-linenos=" 940 "></span></a>        <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span>
<a id=__codelineno-0-941 name=__codelineno-0-941></a><a href=#__codelineno-0-941><span class=linenos data-linenos=" 941 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-942 name=__codelineno-0-942></a><a href=#__codelineno-0-942><span class=linenos data-linenos=" 942 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Initialize the AutoPeakDetection class.</span>
<a id=__codelineno-0-943 name=__codelineno-0-943></a><a href=#__codelineno-0-943><span class=linenos data-linenos=" 943 "></span></a>
<a id=__codelineno-0-944 name=__codelineno-0-944></a><a href=#__codelineno-0-944><span class=linenos data-linenos=" 944 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-945 name=__codelineno-0-945></a><a href=#__codelineno-0-945><span class=linenos data-linenos=" 945 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-946 name=__codelineno-0-946></a><a href=#__codelineno-0-946><span class=linenos data-linenos=" 946 "></span></a><span class=sd>            data (NDArray[np.float64]): `y`-values of the data as 1d-array.</span>
<a id=__codelineno-0-947 name=__codelineno-0-947></a><a href=#__codelineno-0-947><span class=linenos data-linenos=" 947 "></span></a><span class=sd>            args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<a id=__codelineno-0-948 name=__codelineno-0-948></a><a href=#__codelineno-0-948><span class=linenos data-linenos=" 948 "></span></a><span class=sd>                 additional information beyond the command line arguments.</span>
<a id=__codelineno-0-949 name=__codelineno-0-949></a><a href=#__codelineno-0-949><span class=linenos data-linenos=" 949 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-950 name=__codelineno-0-950></a><a href=#__codelineno-0-950><span class=linenos data-linenos=" 950 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>=</span> <span class=n>x</span>
<a id=__codelineno-0-951 name=__codelineno-0-951></a><a href=#__codelineno-0-951><span class=linenos data-linenos=" 951 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=n>data</span>
<a id=__codelineno-0-952 name=__codelineno-0-952></a><a href=#__codelineno-0-952><span class=linenos data-linenos=" 952 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_args</span> <span class=o>=</span> <span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]</span>
<a id=__codelineno-0-953 name=__codelineno-0-953></a><a href=#__codelineno-0-953><span class=linenos data-linenos=" 953 "></span></a>
<a id=__codelineno-0-954 name=__codelineno-0-954></a><a href=#__codelineno-0-954><span class=linenos data-linenos=" 954 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-955 name=__codelineno-0-955></a><a href=#__codelineno-0-955><span class=linenos data-linenos=" 955 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-956 name=__codelineno-0-956></a><a href=#__codelineno-0-956><span class=linenos data-linenos=" 956 "></span></a>        <span class=n>key</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=n>value</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>Any</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]</span>
<a id=__codelineno-0-957 name=__codelineno-0-957></a><a href=#__codelineno-0-957><span class=linenos data-linenos=" 957 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
<a id=__codelineno-0-958 name=__codelineno-0-958></a><a href=#__codelineno-0-958><span class=linenos data-linenos=" 958 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Check if a key exists in a dictionary.</span>
<a id=__codelineno-0-959 name=__codelineno-0-959></a><a href=#__codelineno-0-959><span class=linenos data-linenos=" 959 "></span></a>
<a id=__codelineno-0-960 name=__codelineno-0-960></a><a href=#__codelineno-0-960><span class=linenos data-linenos=" 960 "></span></a><span class=sd>        Please check for the reference key also [scipy.signal.find_peaks][1].</span>
<a id=__codelineno-0-961 name=__codelineno-0-961></a><a href=#__codelineno-0-961><span class=linenos data-linenos=" 961 "></span></a>
<a id=__codelineno-0-962 name=__codelineno-0-962></a><a href=#__codelineno-0-962><span class=linenos data-linenos=" 962 "></span></a><span class=sd>        [1]:</span>
<a id=__codelineno-0-963 name=__codelineno-0-963></a><a href=#__codelineno-0-963><span class=linenos data-linenos=" 963 "></span></a><span class=sd>            https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.find_peaks.html</span>
<a id=__codelineno-0-964 name=__codelineno-0-964></a><a href=#__codelineno-0-964><span class=linenos data-linenos=" 964 "></span></a>
<a id=__codelineno-0-965 name=__codelineno-0-965></a><a href=#__codelineno-0-965><span class=linenos data-linenos=" 965 "></span></a>
<a id=__codelineno-0-966 name=__codelineno-0-966></a><a href=#__codelineno-0-966><span class=linenos data-linenos=" 966 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-967 name=__codelineno-0-967></a><a href=#__codelineno-0-967><span class=linenos data-linenos=" 967 "></span></a><span class=sd>            key (str): Reference key of `scipy.signal.find_peaks`.</span>
<a id=__codelineno-0-968 name=__codelineno-0-968></a><a href=#__codelineno-0-968><span class=linenos data-linenos=" 968 "></span></a><span class=sd>            args (Dict[str, Any]): Reference values of `scipy.signal.find_peaks`, if not</span>
<a id=__codelineno-0-969 name=__codelineno-0-969></a><a href=#__codelineno-0-969><span class=linenos data-linenos=" 969 "></span></a><span class=sd>                 defined will be set to estimated default values.</span>
<a id=__codelineno-0-970 name=__codelineno-0-970></a><a href=#__codelineno-0-970><span class=linenos data-linenos=" 970 "></span></a><span class=sd>            value (Union[float, Tuple[float,float]]): Default value for the reference</span>
<a id=__codelineno-0-971 name=__codelineno-0-971></a><a href=#__codelineno-0-971><span class=linenos data-linenos=" 971 "></span></a><span class=sd>                 key.</span>
<a id=__codelineno-0-972 name=__codelineno-0-972></a><a href=#__codelineno-0-972><span class=linenos data-linenos=" 972 "></span></a>
<a id=__codelineno-0-973 name=__codelineno-0-973></a><a href=#__codelineno-0-973><span class=linenos data-linenos=" 973 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-974 name=__codelineno-0-974></a><a href=#__codelineno-0-974><span class=linenos data-linenos=" 974 "></span></a><span class=sd>            Any: The reference value for `scipy.signal.find_peaks`.</span>
<a id=__codelineno-0-975 name=__codelineno-0-975></a><a href=#__codelineno-0-975><span class=linenos data-linenos=" 975 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-976 name=__codelineno-0-976></a><a href=#__codelineno-0-976><span class=linenos data-linenos=" 976 "></span></a>        <span class=k>return</span> <span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
<a id=__codelineno-0-977 name=__codelineno-0-977></a><a href=#__codelineno-0-977><span class=linenos data-linenos=" 977 "></span></a>
<a id=__codelineno-0-978 name=__codelineno-0-978></a><a href=#__codelineno-0-978><span class=linenos data-linenos=" 978 "></span></a>    <span class=nd>@property</span>
<a id=__codelineno-0-979 name=__codelineno-0-979></a><a href=#__codelineno-0-979><span class=linenos data-linenos=" 979 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>estimate_height</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
<a id=__codelineno-0-980 name=__codelineno-0-980></a><a href=#__codelineno-0-980><span class=linenos data-linenos=" 980 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Estimate the initial height based on an inverse noise ratio of a signal.</span>
<a id=__codelineno-0-981 name=__codelineno-0-981></a><a href=#__codelineno-0-981><span class=linenos data-linenos=" 981 "></span></a>
<a id=__codelineno-0-982 name=__codelineno-0-982></a><a href=#__codelineno-0-982><span class=linenos data-linenos=" 982 "></span></a><span class=sd>        !!! info &quot;About the estimation of the height&quot;</span>
<a id=__codelineno-0-983 name=__codelineno-0-983></a><a href=#__codelineno-0-983><span class=linenos data-linenos=" 983 "></span></a>
<a id=__codelineno-0-984 name=__codelineno-0-984></a><a href=#__codelineno-0-984><span class=linenos data-linenos=" 984 "></span></a><span class=sd>            The lower end of the height is the inverse noise ratio of the `data`, and</span>
<a id=__codelineno-0-985 name=__codelineno-0-985></a><a href=#__codelineno-0-985><span class=linenos data-linenos=" 985 "></span></a><span class=sd>            upper limit is the maximum value of the `data`. The noise ratio of the</span>
<a id=__codelineno-0-986 name=__codelineno-0-986></a><a href=#__codelineno-0-986><span class=linenos data-linenos=" 986 "></span></a><span class=sd>            `data` is based on the original implementation by `SciPy`:</span>
<a id=__codelineno-0-987 name=__codelineno-0-987></a><a href=#__codelineno-0-987><span class=linenos data-linenos=" 987 "></span></a>
<a id=__codelineno-0-988 name=__codelineno-0-988></a><a href=#__codelineno-0-988><span class=linenos data-linenos=" 988 "></span></a><span class=sd>            ```python</span>
<a id=__codelineno-0-989 name=__codelineno-0-989></a><a href=#__codelineno-0-989><span class=linenos data-linenos=" 989 "></span></a><span class=sd>            def signaltonoise(a, axis=0, ddof=0):</span>
<a id=__codelineno-0-990 name=__codelineno-0-990></a><a href=#__codelineno-0-990><span class=linenos data-linenos=" 990 "></span></a><span class=sd>                a = np.asanyarray(a)</span>
<a id=__codelineno-0-991 name=__codelineno-0-991></a><a href=#__codelineno-0-991><span class=linenos data-linenos=" 991 "></span></a><span class=sd>                m = a.mean(axis)</span>
<a id=__codelineno-0-992 name=__codelineno-0-992></a><a href=#__codelineno-0-992><span class=linenos data-linenos=" 992 "></span></a><span class=sd>                sd = a.std(axis=axis, ddof=ddof)</span>
<a id=__codelineno-0-993 name=__codelineno-0-993></a><a href=#__codelineno-0-993><span class=linenos data-linenos=" 993 "></span></a><span class=sd>                return np.where(sd == 0, 0, m / sd)</span>
<a id=__codelineno-0-994 name=__codelineno-0-994></a><a href=#__codelineno-0-994><span class=linenos data-linenos=" 994 "></span></a><span class=sd>            ```</span>
<a id=__codelineno-0-995 name=__codelineno-0-995></a><a href=#__codelineno-0-995><span class=linenos data-linenos=" 995 "></span></a>
<a id=__codelineno-0-996 name=__codelineno-0-996></a><a href=#__codelineno-0-996><span class=linenos data-linenos=" 996 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-997 name=__codelineno-0-997></a><a href=#__codelineno-0-997><span class=linenos data-linenos=" 997 "></span></a><span class=sd>            Tuple[float, float]: Tuple of the inverse signal to noise ratio and</span>
<a id=__codelineno-0-998 name=__codelineno-0-998></a><a href=#__codelineno-0-998><span class=linenos data-linenos=" 998 "></span></a><span class=sd>                 the maximum value of the `data`.</span>
<a id=__codelineno-0-999 name=__codelineno-0-999></a><a href=#__codelineno-0-999><span class=linenos data-linenos=" 999 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1000 name=__codelineno-0-1000></a><a href=#__codelineno-0-1000><span class=linenos data-linenos="1000 "></span></a>        <span class=k>return</span> <span class=mi>1</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>std</span><span class=p>(),</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
<a id=__codelineno-0-1001 name=__codelineno-0-1001></a><a href=#__codelineno-0-1001><span class=linenos data-linenos="1001 "></span></a>
<a id=__codelineno-0-1002 name=__codelineno-0-1002></a><a href=#__codelineno-0-1002><span class=linenos data-linenos="1002 "></span></a>    <span class=nd>@property</span>
<a id=__codelineno-0-1003 name=__codelineno-0-1003></a><a href=#__codelineno-0-1003><span class=linenos data-linenos="1003 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>estimate_threshold</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
<a id=__codelineno-0-1004 name=__codelineno-0-1004></a><a href=#__codelineno-0-1004><span class=linenos data-linenos="1004 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Estimate the threshold value for the peak detection.</span>
<a id=__codelineno-0-1005 name=__codelineno-0-1005></a><a href=#__codelineno-0-1005><span class=linenos data-linenos="1005 "></span></a>
<a id=__codelineno-0-1006 name=__codelineno-0-1006></a><a href=#__codelineno-0-1006><span class=linenos data-linenos="1006 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-1007 name=__codelineno-0-1007></a><a href=#__codelineno-0-1007><span class=linenos data-linenos="1007 "></span></a><span class=sd>            Tuple[float, float]: Minimum and maximum value of the spectrum `data`,</span>
<a id=__codelineno-0-1008 name=__codelineno-0-1008></a><a href=#__codelineno-0-1008><span class=linenos data-linenos="1008 "></span></a><span class=sd>                 respectively, `intensity`.</span>
<a id=__codelineno-0-1009 name=__codelineno-0-1009></a><a href=#__codelineno-0-1009><span class=linenos data-linenos="1009 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1010 name=__codelineno-0-1010></a><a href=#__codelineno-0-1010><span class=linenos data-linenos="1010 "></span></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
<a id=__codelineno-0-1011 name=__codelineno-0-1011></a><a href=#__codelineno-0-1011><span class=linenos data-linenos="1011 "></span></a>
<a id=__codelineno-0-1012 name=__codelineno-0-1012></a><a href=#__codelineno-0-1012><span class=linenos data-linenos="1012 "></span></a>    <span class=nd>@property</span>
<a id=__codelineno-0-1013 name=__codelineno-0-1013></a><a href=#__codelineno-0-1013><span class=linenos data-linenos="1013 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>estimate_distance</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
<a id=__codelineno-0-1014 name=__codelineno-0-1014></a><a href=#__codelineno-0-1014><span class=linenos data-linenos="1014 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Estimate the initial distance between peaks.</span>
<a id=__codelineno-0-1015 name=__codelineno-0-1015></a><a href=#__codelineno-0-1015><span class=linenos data-linenos="1015 "></span></a>
<a id=__codelineno-0-1016 name=__codelineno-0-1016></a><a href=#__codelineno-0-1016><span class=linenos data-linenos="1016 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-1017 name=__codelineno-0-1017></a><a href=#__codelineno-0-1017><span class=linenos data-linenos="1017 "></span></a><span class=sd>            float: Estimated distance between peaks.</span>
<a id=__codelineno-0-1018 name=__codelineno-0-1018></a><a href=#__codelineno-0-1018><span class=linenos data-linenos="1018 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1019 name=__codelineno-0-1019></a><a href=#__codelineno-0-1019><span class=linenos data-linenos="1019 "></span></a>        <span class=n>min_step</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>diff</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>)</span><span class=o>.</span><span class=n>min</span><span class=p>()</span>
<a id=__codelineno-0-1020 name=__codelineno-0-1020></a><a href=#__codelineno-0-1020><span class=linenos data-linenos="1020 "></span></a>        <span class=k>return</span> <span class=nb>max</span><span class=p>(</span><span class=n>min_step</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>)</span>
<a id=__codelineno-0-1021 name=__codelineno-0-1021></a><a href=#__codelineno-0-1021><span class=linenos data-linenos="1021 "></span></a>
<a id=__codelineno-0-1022 name=__codelineno-0-1022></a><a href=#__codelineno-0-1022><span class=linenos data-linenos="1022 "></span></a>    <span class=nd>@property</span>
<a id=__codelineno-0-1023 name=__codelineno-0-1023></a><a href=#__codelineno-0-1023><span class=linenos data-linenos="1023 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>estimate_prominence</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
<a id=__codelineno-0-1024 name=__codelineno-0-1024></a><a href=#__codelineno-0-1024><span class=linenos data-linenos="1024 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Estimate the prominence of a peak.</span>
<a id=__codelineno-0-1025 name=__codelineno-0-1025></a><a href=#__codelineno-0-1025><span class=linenos data-linenos="1025 "></span></a>
<a id=__codelineno-0-1026 name=__codelineno-0-1026></a><a href=#__codelineno-0-1026><span class=linenos data-linenos="1026 "></span></a><span class=sd>        !!! info &quot;About the estimation of the prominence&quot;</span>
<a id=__codelineno-0-1027 name=__codelineno-0-1027></a><a href=#__codelineno-0-1027><span class=linenos data-linenos="1027 "></span></a>
<a id=__codelineno-0-1028 name=__codelineno-0-1028></a><a href=#__codelineno-0-1028><span class=linenos data-linenos="1028 "></span></a><span class=sd>            The prominence is the difference between the height of the peak and the</span>
<a id=__codelineno-0-1029 name=__codelineno-0-1029></a><a href=#__codelineno-0-1029><span class=linenos data-linenos="1029 "></span></a><span class=sd>            bottom. To get a estimate of the prominence, the height of the peak is</span>
<a id=__codelineno-0-1030 name=__codelineno-0-1030></a><a href=#__codelineno-0-1030><span class=linenos data-linenos="1030 "></span></a><span class=sd>            calculated by maximum value of the `data` and the bottom is calculated by</span>
<a id=__codelineno-0-1031 name=__codelineno-0-1031></a><a href=#__codelineno-0-1031><span class=linenos data-linenos="1031 "></span></a><span class=sd>            the harmonic mean of the `data`.</span>
<a id=__codelineno-0-1032 name=__codelineno-0-1032></a><a href=#__codelineno-0-1032><span class=linenos data-linenos="1032 "></span></a>
<a id=__codelineno-0-1033 name=__codelineno-0-1033></a><a href=#__codelineno-0-1033><span class=linenos data-linenos="1033 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-1034 name=__codelineno-0-1034></a><a href=#__codelineno-0-1034><span class=linenos data-linenos="1034 "></span></a><span class=sd>            Tuple[float, float]: Tuple of the harmonic-mean and maximum value of `data`.</span>
<a id=__codelineno-0-1035 name=__codelineno-0-1035></a><a href=#__codelineno-0-1035><span class=linenos data-linenos="1035 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1036 name=__codelineno-0-1036></a><a href=#__codelineno-0-1036><span class=linenos data-linenos="1036 "></span></a>        <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-0-1037 name=__codelineno-0-1037></a><a href=#__codelineno-0-1037><span class=linenos data-linenos="1037 "></span></a>            <span class=k>return</span> <span class=n>hmean</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>),</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
<a id=__codelineno-0-1038 name=__codelineno-0-1038></a><a href=#__codelineno-0-1038><span class=linenos data-linenos="1038 "></span></a>        <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>exc</span><span class=p>:</span>
<a id=__codelineno-0-1039 name=__codelineno-0-1039></a><a href=#__codelineno-0-1039><span class=linenos data-linenos="1039 "></span></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>exc</span><span class=si>}</span><span class=s2>: Using standard arithmetic mean of NumPy.</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-0-1040 name=__codelineno-0-1040></a><a href=#__codelineno-0-1040><span class=linenos data-linenos="1040 "></span></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>mean</span><span class=p>(),</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
<a id=__codelineno-0-1041 name=__codelineno-0-1041></a><a href=#__codelineno-0-1041><span class=linenos data-linenos="1041 "></span></a>
<a id=__codelineno-0-1042 name=__codelineno-0-1042></a><a href=#__codelineno-0-1042><span class=linenos data-linenos="1042 "></span></a>    <span class=nd>@property</span>
<a id=__codelineno-0-1043 name=__codelineno-0-1043></a><a href=#__codelineno-0-1043><span class=linenos data-linenos="1043 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>estimated_width</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
<a id=__codelineno-0-1044 name=__codelineno-0-1044></a><a href=#__codelineno-0-1044><span class=linenos data-linenos="1044 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Estimate the width of a peak.</span>
<a id=__codelineno-0-1045 name=__codelineno-0-1045></a><a href=#__codelineno-0-1045><span class=linenos data-linenos="1045 "></span></a>
<a id=__codelineno-0-1046 name=__codelineno-0-1046></a><a href=#__codelineno-0-1046><span class=linenos data-linenos="1046 "></span></a><span class=sd>        !!! info &quot;About the estimation of the width&quot;</span>
<a id=__codelineno-0-1047 name=__codelineno-0-1047></a><a href=#__codelineno-0-1047><span class=linenos data-linenos="1047 "></span></a>
<a id=__codelineno-0-1048 name=__codelineno-0-1048></a><a href=#__codelineno-0-1048><span class=linenos data-linenos="1048 "></span></a><span class=sd>            The width of a peak is estimated for a lower and an upper end. For the lower</span>
<a id=__codelineno-0-1049 name=__codelineno-0-1049></a><a href=#__codelineno-0-1049><span class=linenos data-linenos="1049 "></span></a><span class=sd>            end, the minimum stepsize is used. For the upper end, the stepsize between</span>
<a id=__codelineno-0-1050 name=__codelineno-0-1050></a><a href=#__codelineno-0-1050><span class=linenos data-linenos="1050 "></span></a><span class=sd>            the half maximum and the minimum value of the `data` is used as the width.</span>
<a id=__codelineno-0-1051 name=__codelineno-0-1051></a><a href=#__codelineno-0-1051><span class=linenos data-linenos="1051 "></span></a>
<a id=__codelineno-0-1052 name=__codelineno-0-1052></a><a href=#__codelineno-0-1052><span class=linenos data-linenos="1052 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-1053 name=__codelineno-0-1053></a><a href=#__codelineno-0-1053><span class=linenos data-linenos="1053 "></span></a><span class=sd>            Tuple[float, float]: Estimated width lower and uper end of the peaks.</span>
<a id=__codelineno-0-1054 name=__codelineno-0-1054></a><a href=#__codelineno-0-1054><span class=linenos data-linenos="1054 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1055 name=__codelineno-0-1055></a><a href=#__codelineno-0-1055><span class=linenos data-linenos="1055 "></span></a>        <span class=k>return</span> <span class=p>(</span>
<a id=__codelineno-0-1056 name=__codelineno-0-1056></a><a href=#__codelineno-0-1056><span class=linenos data-linenos="1056 "></span></a>            <span class=n>np</span><span class=o>.</span><span class=n>diff</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>)</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span>
<a id=__codelineno-0-1057 name=__codelineno-0-1057></a><a href=#__codelineno-0-1057><span class=linenos data-linenos="1057 "></span></a>            <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>argmax</span><span class=p>()]</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>argmin</span><span class=p>()])</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-0-1058 name=__codelineno-0-1058></a><a href=#__codelineno-0-1058><span class=linenos data-linenos="1058 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-1059 name=__codelineno-0-1059></a><a href=#__codelineno-0-1059><span class=linenos data-linenos="1059 "></span></a>
<a id=__codelineno-0-1060 name=__codelineno-0-1060></a><a href=#__codelineno-0-1060><span class=linenos data-linenos="1060 "></span></a>    <span class=nd>@property</span>
<a id=__codelineno-0-1061 name=__codelineno-0-1061></a><a href=#__codelineno-0-1061><span class=linenos data-linenos="1061 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>estimated_rel_height</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
<a id=__codelineno-0-1062 name=__codelineno-0-1062></a><a href=#__codelineno-0-1062><span class=linenos data-linenos="1062 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Estimate the relative height of a peak.</span>
<a id=__codelineno-0-1063 name=__codelineno-0-1063></a><a href=#__codelineno-0-1063><span class=linenos data-linenos="1063 "></span></a>
<a id=__codelineno-0-1064 name=__codelineno-0-1064></a><a href=#__codelineno-0-1064><span class=linenos data-linenos="1064 "></span></a><span class=sd>        !!! info &quot;About the estimation of the relative height&quot;</span>
<a id=__codelineno-0-1065 name=__codelineno-0-1065></a><a href=#__codelineno-0-1065><span class=linenos data-linenos="1065 "></span></a>
<a id=__codelineno-0-1066 name=__codelineno-0-1066></a><a href=#__codelineno-0-1066><span class=linenos data-linenos="1066 "></span></a><span class=sd>            The relative height of a peak is approximated by the difference of the</span>
<a id=__codelineno-0-1067 name=__codelineno-0-1067></a><a href=#__codelineno-0-1067><span class=linenos data-linenos="1067 "></span></a><span class=sd>            harmonic mean value of the `data` and the minimum value of the `data`</span>
<a id=__codelineno-0-1068 name=__codelineno-0-1068></a><a href=#__codelineno-0-1068><span class=linenos data-linenos="1068 "></span></a><span class=sd>            divided by the factor of `4`. In case of negative ratios, the value will be</span>
<a id=__codelineno-0-1069 name=__codelineno-0-1069></a><a href=#__codelineno-0-1069><span class=linenos data-linenos="1069 "></span></a><span class=sd>            set to `Zero`.</span>
<a id=__codelineno-0-1070 name=__codelineno-0-1070></a><a href=#__codelineno-0-1070><span class=linenos data-linenos="1070 "></span></a>
<a id=__codelineno-0-1071 name=__codelineno-0-1071></a><a href=#__codelineno-0-1071><span class=linenos data-linenos="1071 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-1072 name=__codelineno-0-1072></a><a href=#__codelineno-0-1072><span class=linenos data-linenos="1072 "></span></a><span class=sd>            float: Estimated relative height of a peak.</span>
<a id=__codelineno-0-1073 name=__codelineno-0-1073></a><a href=#__codelineno-0-1073><span class=linenos data-linenos="1073 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1074 name=__codelineno-0-1074></a><a href=#__codelineno-0-1074><span class=linenos data-linenos="1074 "></span></a>        <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-0-1075 name=__codelineno-0-1075></a><a href=#__codelineno-0-1075><span class=linenos data-linenos="1075 "></span></a>            <span class=n>rel_height</span> <span class=o>=</span> <span class=p>(</span><span class=n>hmean</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>)</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>min</span><span class=p>())</span> <span class=o>/</span> <span class=mi>4</span>
<a id=__codelineno-0-1076 name=__codelineno-0-1076></a><a href=#__codelineno-0-1076><span class=linenos data-linenos="1076 "></span></a>        <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>exc</span><span class=p>:</span>
<a id=__codelineno-0-1077 name=__codelineno-0-1077></a><a href=#__codelineno-0-1077><span class=linenos data-linenos="1077 "></span></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>exc</span><span class=si>}</span><span class=s2>: Using standard arithmetic mean of NumPy.</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-0-1078 name=__codelineno-0-1078></a><a href=#__codelineno-0-1078><span class=linenos data-linenos="1078 "></span></a>            <span class=n>rel_height</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>min</span><span class=p>())</span> <span class=o>/</span> <span class=mi>4</span>
<a id=__codelineno-0-1079 name=__codelineno-0-1079></a><a href=#__codelineno-0-1079><span class=linenos data-linenos="1079 "></span></a>        <span class=k>return</span> <span class=n>rel_height</span> <span class=k>if</span> <span class=n>rel_height</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mf>0.0</span>
<a id=__codelineno-0-1080 name=__codelineno-0-1080></a><a href=#__codelineno-0-1080><span class=linenos data-linenos="1080 "></span></a>
<a id=__codelineno-0-1081 name=__codelineno-0-1081></a><a href=#__codelineno-0-1081><span class=linenos data-linenos="1081 "></span></a>    <span class=nd>@property</span>
<a id=__codelineno-0-1082 name=__codelineno-0-1082></a><a href=#__codelineno-0-1082><span class=linenos data-linenos="1082 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>estimated_wlen</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
<a id=__codelineno-0-1083 name=__codelineno-0-1083></a><a href=#__codelineno-0-1083><span class=linenos data-linenos="1083 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Estimate the window length for the peak detection.</span>
<a id=__codelineno-0-1084 name=__codelineno-0-1084></a><a href=#__codelineno-0-1084><span class=linenos data-linenos="1084 "></span></a>
<a id=__codelineno-0-1085 name=__codelineno-0-1085></a><a href=#__codelineno-0-1085><span class=linenos data-linenos="1085 "></span></a><span class=sd>        !!! info &quot;About the estimation of the window length&quot;</span>
<a id=__codelineno-0-1086 name=__codelineno-0-1086></a><a href=#__codelineno-0-1086><span class=linenos data-linenos="1086 "></span></a>
<a id=__codelineno-0-1087 name=__codelineno-0-1087></a><a href=#__codelineno-0-1087><span class=linenos data-linenos="1087 "></span></a><span class=sd>            The window length is the length of the window for the peak detection is</span>
<a id=__codelineno-0-1088 name=__codelineno-0-1088></a><a href=#__codelineno-0-1088><span class=linenos data-linenos="1088 "></span></a><span class=sd>            defined to be 1% of the length of the `data`, consequently the len of the</span>
<a id=__codelineno-0-1089 name=__codelineno-0-1089></a><a href=#__codelineno-0-1089><span class=linenos data-linenos="1089 "></span></a><span class=sd>            `data` is divided by 100. In case of a window length smaller than 1, the</span>
<a id=__codelineno-0-1090 name=__codelineno-0-1090></a><a href=#__codelineno-0-1090><span class=linenos data-linenos="1090 "></span></a><span class=sd>            window length will be set to numerical value of 1, which is defined by</span>
<a id=__codelineno-0-1091 name=__codelineno-0-1091></a><a href=#__codelineno-0-1091><span class=linenos data-linenos="1091 "></span></a><span class=sd>            `1 + 1e-9`.</span>
<a id=__codelineno-0-1092 name=__codelineno-0-1092></a><a href=#__codelineno-0-1092><span class=linenos data-linenos="1092 "></span></a>
<a id=__codelineno-0-1093 name=__codelineno-0-1093></a><a href=#__codelineno-0-1093><span class=linenos data-linenos="1093 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-1094 name=__codelineno-0-1094></a><a href=#__codelineno-0-1094><span class=linenos data-linenos="1094 "></span></a><span class=sd>            float: Estimated window length is set to the numeric value of &gt; 1.</span>
<a id=__codelineno-0-1095 name=__codelineno-0-1095></a><a href=#__codelineno-0-1095><span class=linenos data-linenos="1095 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1096 name=__codelineno-0-1096></a><a href=#__codelineno-0-1096><span class=linenos data-linenos="1096 "></span></a>        <span class=n>wlen</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>size</span> <span class=o>/</span> <span class=mi>100</span>
<a id=__codelineno-0-1097 name=__codelineno-0-1097></a><a href=#__codelineno-0-1097><span class=linenos data-linenos="1097 "></span></a>        <span class=k>return</span> <span class=n>wlen</span> <span class=k>if</span> <span class=n>wlen</span> <span class=o>&gt;</span> <span class=mf>1.0</span> <span class=k>else</span> <span class=mi>1</span> <span class=o>+</span> <span class=mf>1e-9</span>
<a id=__codelineno-0-1098 name=__codelineno-0-1098></a><a href=#__codelineno-0-1098><span class=linenos data-linenos="1098 "></span></a>
<a id=__codelineno-0-1099 name=__codelineno-0-1099></a><a href=#__codelineno-0-1099><span class=linenos data-linenos="1099 "></span></a>    <span class=nd>@property</span>
<a id=__codelineno-0-1100 name=__codelineno-0-1100></a><a href=#__codelineno-0-1100><span class=linenos data-linenos="1100 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>estimated_plateau_size</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
<a id=__codelineno-0-1101 name=__codelineno-0-1101></a><a href=#__codelineno-0-1101><span class=linenos data-linenos="1101 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Estimate the plateau size for the peak detection.</span>
<a id=__codelineno-0-1102 name=__codelineno-0-1102></a><a href=#__codelineno-0-1102><span class=linenos data-linenos="1102 "></span></a>
<a id=__codelineno-0-1103 name=__codelineno-0-1103></a><a href=#__codelineno-0-1103><span class=linenos data-linenos="1103 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-1104 name=__codelineno-0-1104></a><a href=#__codelineno-0-1104><span class=linenos data-linenos="1104 "></span></a><span class=sd>            Tuple[float, float]: Estimated plateau size is set to `zero` for the lower</span>
<a id=__codelineno-0-1105 name=__codelineno-0-1105></a><a href=#__codelineno-0-1105><span class=linenos data-linenos="1105 "></span></a><span class=sd>                 end and the maximum value of the `x` for the upper end.</span>
<a id=__codelineno-0-1106 name=__codelineno-0-1106></a><a href=#__codelineno-0-1106><span class=linenos data-linenos="1106 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1107 name=__codelineno-0-1107></a><a href=#__codelineno-0-1107><span class=linenos data-linenos="1107 "></span></a>        <span class=k>return</span> <span class=mf>0.0</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
<a id=__codelineno-0-1108 name=__codelineno-0-1108></a><a href=#__codelineno-0-1108><span class=linenos data-linenos="1108 "></span></a>
<a id=__codelineno-0-1109 name=__codelineno-0-1109></a><a href=#__codelineno-0-1109><span class=linenos data-linenos="1109 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>initialize_peak_detection</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1110 name=__codelineno-0-1110></a><a href=#__codelineno-0-1110><span class=linenos data-linenos="1110 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Initialize the peak detection.</span>
<a id=__codelineno-0-1111 name=__codelineno-0-1111></a><a href=#__codelineno-0-1111><span class=linenos data-linenos="1111 "></span></a>
<a id=__codelineno-0-1112 name=__codelineno-0-1112></a><a href=#__codelineno-0-1112><span class=linenos data-linenos="1112 "></span></a><span class=sd>        !!! note &quot;Initialize the peak detection&quot;</span>
<a id=__codelineno-0-1113 name=__codelineno-0-1113></a><a href=#__codelineno-0-1113><span class=linenos data-linenos="1113 "></span></a>
<a id=__codelineno-0-1114 name=__codelineno-0-1114></a><a href=#__codelineno-0-1114><span class=linenos data-linenos="1114 "></span></a><span class=sd>            This method is used to initialize the peak detection. The initialization can</span>
<a id=__codelineno-0-1115 name=__codelineno-0-1115></a><a href=#__codelineno-0-1115><span class=linenos data-linenos="1115 "></span></a><span class=sd>            be activated by setting the `initialize` attribute to `True`, which will</span>
<a id=__codelineno-0-1116 name=__codelineno-0-1116></a><a href=#__codelineno-0-1116><span class=linenos data-linenos="1116 "></span></a><span class=sd>            automatically estimate the default parameters for the peak detection. In</span>
<a id=__codelineno-0-1117 name=__codelineno-0-1117></a><a href=#__codelineno-0-1117><span class=linenos data-linenos="1117 "></span></a><span class=sd>            case of the `initialize` attribute is defined as dictionary, the proposed</span>
<a id=__codelineno-0-1118 name=__codelineno-0-1118></a><a href=#__codelineno-0-1118><span class=linenos data-linenos="1118 "></span></a><span class=sd>            values are taken from the dictionary if th</span>
<a id=__codelineno-0-1119 name=__codelineno-0-1119></a><a href=#__codelineno-0-1119><span class=linenos data-linenos="1119 "></span></a>
<a id=__codelineno-0-1120 name=__codelineno-0-1120></a><a href=#__codelineno-0-1120><span class=linenos data-linenos="1120 "></span></a><span class=sd>        Raise:</span>
<a id=__codelineno-0-1121 name=__codelineno-0-1121></a><a href=#__codelineno-0-1121><span class=linenos data-linenos="1121 "></span></a><span class=sd>            TypeError: If the `initialize` attribute is not of type `bool` or `dict`.</span>
<a id=__codelineno-0-1122 name=__codelineno-0-1122></a><a href=#__codelineno-0-1122><span class=linenos data-linenos="1122 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1123 name=__codelineno-0-1123></a><a href=#__codelineno-0-1123><span class=linenos data-linenos="1123 "></span></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<a id=__codelineno-0-1124 name=__codelineno-0-1124></a><a href=#__codelineno-0-1124><span class=linenos data-linenos="1124 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>default_values</span><span class=p>()</span>
<a id=__codelineno-0-1125 name=__codelineno-0-1125></a><a href=#__codelineno-0-1125><span class=linenos data-linenos="1125 "></span></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
<a id=__codelineno-0-1126 name=__codelineno-0-1126></a><a href=#__codelineno-0-1126><span class=linenos data-linenos="1126 "></span></a>            <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>detection_check</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>)</span>
<a id=__codelineno-0-1127 name=__codelineno-0-1127></a><a href=#__codelineno-0-1127><span class=linenos data-linenos="1127 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1128 name=__codelineno-0-1128></a><a href=#__codelineno-0-1128><span class=linenos data-linenos="1128 "></span></a>                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;height&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_height</span>
<a id=__codelineno-0-1129 name=__codelineno-0-1129></a><a href=#__codelineno-0-1129><span class=linenos data-linenos="1129 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1130 name=__codelineno-0-1130></a><a href=#__codelineno-0-1130><span class=linenos data-linenos="1130 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>threshold</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1131 name=__codelineno-0-1131></a><a href=#__codelineno-0-1131><span class=linenos data-linenos="1131 "></span></a>                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;threshold&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_threshold</span>
<a id=__codelineno-0-1132 name=__codelineno-0-1132></a><a href=#__codelineno-0-1132><span class=linenos data-linenos="1132 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1133 name=__codelineno-0-1133></a><a href=#__codelineno-0-1133><span class=linenos data-linenos="1133 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>distance</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1134 name=__codelineno-0-1134></a><a href=#__codelineno-0-1134><span class=linenos data-linenos="1134 "></span></a>                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;distance&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_distance</span>
<a id=__codelineno-0-1135 name=__codelineno-0-1135></a><a href=#__codelineno-0-1135><span class=linenos data-linenos="1135 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1136 name=__codelineno-0-1136></a><a href=#__codelineno-0-1136><span class=linenos data-linenos="1136 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>prominence</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1137 name=__codelineno-0-1137></a><a href=#__codelineno-0-1137><span class=linenos data-linenos="1137 "></span></a>                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;prominence&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_prominence</span>
<a id=__codelineno-0-1138 name=__codelineno-0-1138></a><a href=#__codelineno-0-1138><span class=linenos data-linenos="1138 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1139 name=__codelineno-0-1139></a><a href=#__codelineno-0-1139><span class=linenos data-linenos="1139 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>width</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1140 name=__codelineno-0-1140></a><a href=#__codelineno-0-1140><span class=linenos data-linenos="1140 "></span></a>                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;width&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimated_width</span>
<a id=__codelineno-0-1141 name=__codelineno-0-1141></a><a href=#__codelineno-0-1141><span class=linenos data-linenos="1141 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1142 name=__codelineno-0-1142></a><a href=#__codelineno-0-1142><span class=linenos data-linenos="1142 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>wlen</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1143 name=__codelineno-0-1143></a><a href=#__codelineno-0-1143><span class=linenos data-linenos="1143 "></span></a>                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;wlen&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimated_wlen</span>
<a id=__codelineno-0-1144 name=__codelineno-0-1144></a><a href=#__codelineno-0-1144><span class=linenos data-linenos="1144 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1145 name=__codelineno-0-1145></a><a href=#__codelineno-0-1145><span class=linenos data-linenos="1145 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>rel_height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1146 name=__codelineno-0-1146></a><a href=#__codelineno-0-1146><span class=linenos data-linenos="1146 "></span></a>                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;rel_height&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimated_rel_height</span>
<a id=__codelineno-0-1147 name=__codelineno-0-1147></a><a href=#__codelineno-0-1147><span class=linenos data-linenos="1147 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1148 name=__codelineno-0-1148></a><a href=#__codelineno-0-1148><span class=linenos data-linenos="1148 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>plateau_size</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1149 name=__codelineno-0-1149></a><a href=#__codelineno-0-1149><span class=linenos data-linenos="1149 "></span></a>                <span class=n>key</span><span class=o>=</span><span class=s2>&quot;plateau_size&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=mf>0.0</span>
<a id=__codelineno-0-1150 name=__codelineno-0-1150></a><a href=#__codelineno-0-1150><span class=linenos data-linenos="1150 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1151 name=__codelineno-0-1151></a><a href=#__codelineno-0-1151><span class=linenos data-linenos="1151 "></span></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-1152 name=__codelineno-0-1152></a><a href=#__codelineno-0-1152><span class=linenos data-linenos="1152 "></span></a>            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
<a id=__codelineno-0-1153 name=__codelineno-0-1153></a><a href=#__codelineno-0-1153><span class=linenos data-linenos="1153 "></span></a>                <span class=sa>f</span><span class=s2>&quot;The type of the `args` is not supported: </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-0-1154 name=__codelineno-0-1154></a><a href=#__codelineno-0-1154><span class=linenos data-linenos="1154 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1155 name=__codelineno-0-1155></a><a href=#__codelineno-0-1155><span class=linenos data-linenos="1155 "></span></a>
<a id=__codelineno-0-1156 name=__codelineno-0-1156></a><a href=#__codelineno-0-1156><span class=linenos data-linenos="1156 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>default_values</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1157 name=__codelineno-0-1157></a><a href=#__codelineno-0-1157><span class=linenos data-linenos="1157 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Set the default values for the peak detection.&quot;&quot;&quot;</span>
<a id=__codelineno-0-1158 name=__codelineno-0-1158></a><a href=#__codelineno-0-1158><span class=linenos data-linenos="1158 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_height</span>
<a id=__codelineno-0-1159 name=__codelineno-0-1159></a><a href=#__codelineno-0-1159><span class=linenos data-linenos="1159 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>threshold</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_threshold</span>
<a id=__codelineno-0-1160 name=__codelineno-0-1160></a><a href=#__codelineno-0-1160><span class=linenos data-linenos="1160 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>distance</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_distance</span>
<a id=__codelineno-0-1161 name=__codelineno-0-1161></a><a href=#__codelineno-0-1161><span class=linenos data-linenos="1161 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>prominence</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_prominence</span>
<a id=__codelineno-0-1162 name=__codelineno-0-1162></a><a href=#__codelineno-0-1162><span class=linenos data-linenos="1162 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>width</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimated_width</span>
<a id=__codelineno-0-1163 name=__codelineno-0-1163></a><a href=#__codelineno-0-1163><span class=linenos data-linenos="1163 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>wlen</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimated_wlen</span>
<a id=__codelineno-0-1164 name=__codelineno-0-1164></a><a href=#__codelineno-0-1164><span class=linenos data-linenos="1164 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>rel_height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimated_rel_height</span>
<a id=__codelineno-0-1165 name=__codelineno-0-1165></a><a href=#__codelineno-0-1165><span class=linenos data-linenos="1165 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>plateau_size</span> <span class=o>=</span> <span class=mi>0</span>
<a id=__codelineno-0-1166 name=__codelineno-0-1166></a><a href=#__codelineno-0-1166><span class=linenos data-linenos="1166 "></span></a>
<a id=__codelineno-0-1167 name=__codelineno-0-1167></a><a href=#__codelineno-0-1167><span class=linenos data-linenos="1167 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>__autodetect__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
<a id=__codelineno-0-1168 name=__codelineno-0-1168></a><a href=#__codelineno-0-1168><span class=linenos data-linenos="1168 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Return peak positions and properties.&quot;&quot;&quot;</span>
<a id=__codelineno-0-1169 name=__codelineno-0-1169></a><a href=#__codelineno-0-1169><span class=linenos data-linenos="1169 "></span></a>        <span class=k>return</span> <span class=n>find_peaks</span><span class=p>(</span>
<a id=__codelineno-0-1170 name=__codelineno-0-1170></a><a href=#__codelineno-0-1170><span class=linenos data-linenos="1170 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>,</span>
<a id=__codelineno-0-1171 name=__codelineno-0-1171></a><a href=#__codelineno-0-1171><span class=linenos data-linenos="1171 "></span></a>            <span class=n>height</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>height</span><span class=p>,</span>
<a id=__codelineno-0-1172 name=__codelineno-0-1172></a><a href=#__codelineno-0-1172><span class=linenos data-linenos="1172 "></span></a>            <span class=n>threshold</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>threshold</span><span class=p>,</span>
<a id=__codelineno-0-1173 name=__codelineno-0-1173></a><a href=#__codelineno-0-1173><span class=linenos data-linenos="1173 "></span></a>            <span class=n>distance</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>distance</span><span class=p>,</span>
<a id=__codelineno-0-1174 name=__codelineno-0-1174></a><a href=#__codelineno-0-1174><span class=linenos data-linenos="1174 "></span></a>            <span class=n>prominence</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>prominence</span><span class=p>,</span>
<a id=__codelineno-0-1175 name=__codelineno-0-1175></a><a href=#__codelineno-0-1175><span class=linenos data-linenos="1175 "></span></a>            <span class=n>width</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>width</span><span class=p>,</span>
<a id=__codelineno-0-1176 name=__codelineno-0-1176></a><a href=#__codelineno-0-1176><span class=linenos data-linenos="1176 "></span></a>            <span class=n>wlen</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>wlen</span><span class=p>,</span>
<a id=__codelineno-0-1177 name=__codelineno-0-1177></a><a href=#__codelineno-0-1177><span class=linenos data-linenos="1177 "></span></a>            <span class=n>rel_height</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>rel_height</span><span class=p>,</span>
<a id=__codelineno-0-1178 name=__codelineno-0-1178></a><a href=#__codelineno-0-1178><span class=linenos data-linenos="1178 "></span></a>            <span class=n>plateau_size</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>plateau_size</span><span class=p>,</span>
<a id=__codelineno-0-1179 name=__codelineno-0-1179></a><a href=#__codelineno-0-1179><span class=linenos data-linenos="1179 "></span></a>        <span class=p>)</span>
</code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimate_distance class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimate_distance</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimate_distance class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the initial distance between peaks.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>float</code></td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Estimated distance between peaks.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimate_height class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimate_height</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimate_height class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the initial height based on an inverse noise ratio of a signal.</p> <div class="admonition info"> <p class=admonition-title>About the estimation of the height</p> <p>The lower end of the height is the inverse noise ratio of the <code class="language-text highlight">data</code>, and upper limit is the maximum value of the <code class="language-text highlight">data</code>. The noise ratio of the <code class="language-text highlight">data</code> is based on the original implementation by <code class="language-text highlight">SciPy</code>:</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="1 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>signaltonoise</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>ddof</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>
<a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos="2 "></span></a>    <span class=n>a</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>asanyarray</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
<a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos="3 "></span></a>    <span class=n>m</span> <span class=o>=</span> <span class=n>a</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>axis</span><span class=p>)</span>
<a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos="4 "></span></a>    <span class=n>sd</span> <span class=o>=</span> <span class=n>a</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=n>axis</span><span class=p>,</span> <span class=n>ddof</span><span class=o>=</span><span class=n>ddof</span><span class=p>)</span>
<a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos="5 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>sd</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>m</span> <span class=o>/</span> <span class=n>sd</span><span class=p>)</span>
</code></pre></div> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Tuple>Tuple</span>[<span title=float>float</span>, <span title=float>float</span>]</code> </td> <td> <div class=doc-md-description> <p>Tuple[float, float]: Tuple of the inverse signal to noise ratio and the maximum value of the <code class="language-text highlight">data</code>.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimate_prominence class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimate_prominence</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimate_prominence class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the prominence of a peak.</p> <div class="admonition info"> <p class=admonition-title>About the estimation of the prominence</p> <p>The prominence is the difference between the height of the peak and the bottom. To get a estimate of the prominence, the height of the peak is calculated by maximum value of the <code class="language-text highlight">data</code> and the bottom is calculated by the harmonic mean of the <code class="language-text highlight">data</code>.</p> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Tuple>Tuple</span>[<span title=float>float</span>, <span title=float>float</span>]</code> </td> <td> <div class=doc-md-description> <p>Tuple[float, float]: Tuple of the harmonic-mean and maximum value of <code class="language-text highlight">data</code>.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimate_threshold class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimate_threshold</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimate_threshold class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the threshold value for the peak detection.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Tuple>Tuple</span>[<span title=float>float</span>, <span title=float>float</span>]</code> </td> <td> <div class=doc-md-description> <p>Tuple[float, float]: Minimum and maximum value of the spectrum <code class="language-text highlight">data</code>, respectively, <code class="language-text highlight">intensity</code>.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimated_plateau_size class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimated_plateau_size</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimated_plateau_size class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the plateau size for the peak detection.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Tuple>Tuple</span>[<span title=float>float</span>, <span title=float>float</span>]</code> </td> <td> <div class=doc-md-description> <p>Tuple[float, float]: Estimated plateau size is set to <code class="language-text highlight">zero</code> for the lower end and the maximum value of the <code class="language-text highlight">x</code> for the upper end.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimated_rel_height class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimated_rel_height</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimated_rel_height class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the relative height of a peak.</p> <div class="admonition info"> <p class=admonition-title>About the estimation of the relative height</p> <p>The relative height of a peak is approximated by the difference of the harmonic mean value of the <code class="language-text highlight">data</code> and the minimum value of the <code class="language-text highlight">data</code> divided by the factor of <code class="language-cbmbas highlight"><span class=mf>4</span></code>. In case of negative ratios, the value will be set to <code class="language-text highlight">Zero</code>.</p> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>float</code></td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Estimated relative height of a peak.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimated_width class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimated_width</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimated_width class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the width of a peak.</p> <div class="admonition info"> <p class=admonition-title>About the estimation of the width</p> <p>The width of a peak is estimated for a lower and an upper end. For the lower end, the minimum stepsize is used. For the upper end, the stepsize between the half maximum and the minimum value of the <code class="language-text highlight">data</code> is used as the width.</p> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Tuple>Tuple</span>[<span title=float>float</span>, <span title=float>float</span>]</code> </td> <td> <div class=doc-md-description> <p>Tuple[float, float]: Estimated width lower and uper end of the peaks.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.AutoPeakDetection.estimated_wlen class="doc doc-heading"> <code class="highlight language-python"><span class=n>estimated_wlen</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.estimated_wlen class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Estimate the window length for the peak detection.</p> <div class="admonition info"> <p class=admonition-title>About the estimation of the window length</p> <p>The window length is the length of the window for the peak detection is defined to be 1% of the length of the <code class="language-text highlight">data</code>, consequently the len of the <code class="language-text highlight">data</code> is divided by 100. In case of a window length smaller than 1, the window length will be set to numerical value of 1, which is defined by <code class="language-cbmbas highlight"><span class=mf>1</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>1</span><span class=n>e</span><span class=o>-</span><span class=mf>9</span></code>.</p> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>float</code></td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Estimated window length is set to the numeric value of &gt; 1.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.AutoPeakDetection.__autodetect__ class="doc doc-heading"> <code class="highlight language-python"><span class=n>__autodetect__</span><span class=p>()</span></code> <a href=#spectrafit.models.AutoPeakDetection.__autodetect__ class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return peak positions and properties.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1167 name=__codelineno-0-1167></a><a href=#__codelineno-0-1167><span class=linenos data-linenos="1167 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>__autodetect__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
<a id=__codelineno-0-1168 name=__codelineno-0-1168></a><a href=#__codelineno-0-1168><span class=linenos data-linenos="1168 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return peak positions and properties.&quot;&quot;&quot;</span>
<a id=__codelineno-0-1169 name=__codelineno-0-1169></a><a href=#__codelineno-0-1169><span class=linenos data-linenos="1169 "></span></a>    <span class=k>return</span> <span class=n>find_peaks</span><span class=p>(</span>
<a id=__codelineno-0-1170 name=__codelineno-0-1170></a><a href=#__codelineno-0-1170><span class=linenos data-linenos="1170 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>,</span>
<a id=__codelineno-0-1171 name=__codelineno-0-1171></a><a href=#__codelineno-0-1171><span class=linenos data-linenos="1171 "></span></a>        <span class=n>height</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>height</span><span class=p>,</span>
<a id=__codelineno-0-1172 name=__codelineno-0-1172></a><a href=#__codelineno-0-1172><span class=linenos data-linenos="1172 "></span></a>        <span class=n>threshold</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>threshold</span><span class=p>,</span>
<a id=__codelineno-0-1173 name=__codelineno-0-1173></a><a href=#__codelineno-0-1173><span class=linenos data-linenos="1173 "></span></a>        <span class=n>distance</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>distance</span><span class=p>,</span>
<a id=__codelineno-0-1174 name=__codelineno-0-1174></a><a href=#__codelineno-0-1174><span class=linenos data-linenos="1174 "></span></a>        <span class=n>prominence</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>prominence</span><span class=p>,</span>
<a id=__codelineno-0-1175 name=__codelineno-0-1175></a><a href=#__codelineno-0-1175><span class=linenos data-linenos="1175 "></span></a>        <span class=n>width</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>width</span><span class=p>,</span>
<a id=__codelineno-0-1176 name=__codelineno-0-1176></a><a href=#__codelineno-0-1176><span class=linenos data-linenos="1176 "></span></a>        <span class=n>wlen</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>wlen</span><span class=p>,</span>
<a id=__codelineno-0-1177 name=__codelineno-0-1177></a><a href=#__codelineno-0-1177><span class=linenos data-linenos="1177 "></span></a>        <span class=n>rel_height</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>rel_height</span><span class=p>,</span>
<a id=__codelineno-0-1178 name=__codelineno-0-1178></a><a href=#__codelineno-0-1178><span class=linenos data-linenos="1178 "></span></a>        <span class=n>plateau_size</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>plateau_size</span><span class=p>,</span>
<a id=__codelineno-0-1179 name=__codelineno-0-1179></a><a href=#__codelineno-0-1179><span class=linenos data-linenos="1179 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.AutoPeakDetection.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>data</span><span class=p>,</span> <span class=n>args</span><span class=p>)</span></code> <a href=#spectrafit.models.AutoPeakDetection.__init__ class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Initialize the AutoPeakDetection class.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">y</code>-values of the data as 1d-array.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>args</code> </td> <td> <code><span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>The input file arguments as a dictionary with additional information beyond the command line arguments.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-936 name=__codelineno-0-936></a><a href=#__codelineno-0-936><span class=linenos data-linenos="936 "></span></a><span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
<a id=__codelineno-0-937 name=__codelineno-0-937></a><a href=#__codelineno-0-937><span class=linenos data-linenos="937 "></span></a>    <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-0-938 name=__codelineno-0-938></a><a href=#__codelineno-0-938><span class=linenos data-linenos="938 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-939 name=__codelineno-0-939></a><a href=#__codelineno-0-939><span class=linenos data-linenos="939 "></span></a>    <span class=n>data</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-940 name=__codelineno-0-940></a><a href=#__codelineno-0-940><span class=linenos data-linenos="940 "></span></a>    <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span>
<a id=__codelineno-0-941 name=__codelineno-0-941></a><a href=#__codelineno-0-941><span class=linenos data-linenos="941 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-942 name=__codelineno-0-942></a><a href=#__codelineno-0-942><span class=linenos data-linenos="942 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the AutoPeakDetection class.</span>
<a id=__codelineno-0-943 name=__codelineno-0-943></a><a href=#__codelineno-0-943><span class=linenos data-linenos="943 "></span></a>
<a id=__codelineno-0-944 name=__codelineno-0-944></a><a href=#__codelineno-0-944><span class=linenos data-linenos="944 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-945 name=__codelineno-0-945></a><a href=#__codelineno-0-945><span class=linenos data-linenos="945 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-946 name=__codelineno-0-946></a><a href=#__codelineno-0-946><span class=linenos data-linenos="946 "></span></a><span class=sd>        data (NDArray[np.float64]): `y`-values of the data as 1d-array.</span>
<a id=__codelineno-0-947 name=__codelineno-0-947></a><a href=#__codelineno-0-947><span class=linenos data-linenos="947 "></span></a><span class=sd>        args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<a id=__codelineno-0-948 name=__codelineno-0-948></a><a href=#__codelineno-0-948><span class=linenos data-linenos="948 "></span></a><span class=sd>             additional information beyond the command line arguments.</span>
<a id=__codelineno-0-949 name=__codelineno-0-949></a><a href=#__codelineno-0-949><span class=linenos data-linenos="949 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-950 name=__codelineno-0-950></a><a href=#__codelineno-0-950><span class=linenos data-linenos="950 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>=</span> <span class=n>x</span>
<a id=__codelineno-0-951 name=__codelineno-0-951></a><a href=#__codelineno-0-951><span class=linenos data-linenos="951 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=n>data</span>
<a id=__codelineno-0-952 name=__codelineno-0-952></a><a href=#__codelineno-0-952><span class=linenos data-linenos="952 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_args</span> <span class=o>=</span> <span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.AutoPeakDetection.check_key_exists class="doc doc-heading"> <code class="highlight language-python"><span class=n>check_key_exists</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>args</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.AutoPeakDetection.check_key_exists class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Check if a key exists in a dictionary.</p> <p>Please check for the reference key also <a href=https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.find_peaks.html>scipy.signal.find_peaks</a>.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>key</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Reference key of <code class="language-gdscript highlight"><span class=n>scipy</span><span class=o>.</span><span class=k>signal</span><span class=o>.</span><span class=n>find_peaks</span></code>.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>args</code> </td> <td> <code><span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>Reference values of <code class="language-gdscript highlight"><span class=n>scipy</span><span class=o>.</span><span class=k>signal</span><span class=o>.</span><span class=n>find_peaks</span></code>, if not defined will be set to estimated default values.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>value</code> </td> <td> <code><span title=typing.Union>Union</span>[<span title=float>float</span>, <span title=typing.Tuple>Tuple</span>[<span title=float>float</span>, <span title=float>float</span>]]</code> </td> <td> <div class=doc-md-description> <p>Default value for the reference key.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>Any</code></td> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>The reference value for <code class="language-gdscript highlight"><span class=n>scipy</span><span class=o>.</span><span class=k>signal</span><span class=o>.</span><span class=n>find_peaks</span></code>.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-954 name=__codelineno-0-954></a><a href=#__codelineno-0-954><span class=linenos data-linenos="954 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-955 name=__codelineno-0-955></a><a href=#__codelineno-0-955><span class=linenos data-linenos="955 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-956 name=__codelineno-0-956></a><a href=#__codelineno-0-956><span class=linenos data-linenos="956 "></span></a>    <span class=n>key</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=n>value</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>Any</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]</span>
<a id=__codelineno-0-957 name=__codelineno-0-957></a><a href=#__codelineno-0-957><span class=linenos data-linenos="957 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
<a id=__codelineno-0-958 name=__codelineno-0-958></a><a href=#__codelineno-0-958><span class=linenos data-linenos="958 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Check if a key exists in a dictionary.</span>
<a id=__codelineno-0-959 name=__codelineno-0-959></a><a href=#__codelineno-0-959><span class=linenos data-linenos="959 "></span></a>
<a id=__codelineno-0-960 name=__codelineno-0-960></a><a href=#__codelineno-0-960><span class=linenos data-linenos="960 "></span></a><span class=sd>    Please check for the reference key also [scipy.signal.find_peaks][1].</span>
<a id=__codelineno-0-961 name=__codelineno-0-961></a><a href=#__codelineno-0-961><span class=linenos data-linenos="961 "></span></a>
<a id=__codelineno-0-962 name=__codelineno-0-962></a><a href=#__codelineno-0-962><span class=linenos data-linenos="962 "></span></a><span class=sd>    [1]:</span>
<a id=__codelineno-0-963 name=__codelineno-0-963></a><a href=#__codelineno-0-963><span class=linenos data-linenos="963 "></span></a><span class=sd>        https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.find_peaks.html</span>
<a id=__codelineno-0-964 name=__codelineno-0-964></a><a href=#__codelineno-0-964><span class=linenos data-linenos="964 "></span></a>
<a id=__codelineno-0-965 name=__codelineno-0-965></a><a href=#__codelineno-0-965><span class=linenos data-linenos="965 "></span></a>
<a id=__codelineno-0-966 name=__codelineno-0-966></a><a href=#__codelineno-0-966><span class=linenos data-linenos="966 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-967 name=__codelineno-0-967></a><a href=#__codelineno-0-967><span class=linenos data-linenos="967 "></span></a><span class=sd>        key (str): Reference key of `scipy.signal.find_peaks`.</span>
<a id=__codelineno-0-968 name=__codelineno-0-968></a><a href=#__codelineno-0-968><span class=linenos data-linenos="968 "></span></a><span class=sd>        args (Dict[str, Any]): Reference values of `scipy.signal.find_peaks`, if not</span>
<a id=__codelineno-0-969 name=__codelineno-0-969></a><a href=#__codelineno-0-969><span class=linenos data-linenos="969 "></span></a><span class=sd>             defined will be set to estimated default values.</span>
<a id=__codelineno-0-970 name=__codelineno-0-970></a><a href=#__codelineno-0-970><span class=linenos data-linenos="970 "></span></a><span class=sd>        value (Union[float, Tuple[float,float]]): Default value for the reference</span>
<a id=__codelineno-0-971 name=__codelineno-0-971></a><a href=#__codelineno-0-971><span class=linenos data-linenos="971 "></span></a><span class=sd>             key.</span>
<a id=__codelineno-0-972 name=__codelineno-0-972></a><a href=#__codelineno-0-972><span class=linenos data-linenos="972 "></span></a>
<a id=__codelineno-0-973 name=__codelineno-0-973></a><a href=#__codelineno-0-973><span class=linenos data-linenos="973 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-974 name=__codelineno-0-974></a><a href=#__codelineno-0-974><span class=linenos data-linenos="974 "></span></a><span class=sd>        Any: The reference value for `scipy.signal.find_peaks`.</span>
<a id=__codelineno-0-975 name=__codelineno-0-975></a><a href=#__codelineno-0-975><span class=linenos data-linenos="975 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-976 name=__codelineno-0-976></a><a href=#__codelineno-0-976><span class=linenos data-linenos="976 "></span></a>    <span class=k>return</span> <span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.AutoPeakDetection.default_values class="doc doc-heading"> <code class="highlight language-python"><span class=n>default_values</span><span class=p>()</span></code> <a href=#spectrafit.models.AutoPeakDetection.default_values class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Set the default values for the peak detection.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1156 name=__codelineno-0-1156></a><a href=#__codelineno-0-1156><span class=linenos data-linenos="1156 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>default_values</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1157 name=__codelineno-0-1157></a><a href=#__codelineno-0-1157><span class=linenos data-linenos="1157 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Set the default values for the peak detection.&quot;&quot;&quot;</span>
<a id=__codelineno-0-1158 name=__codelineno-0-1158></a><a href=#__codelineno-0-1158><span class=linenos data-linenos="1158 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_height</span>
<a id=__codelineno-0-1159 name=__codelineno-0-1159></a><a href=#__codelineno-0-1159><span class=linenos data-linenos="1159 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>threshold</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_threshold</span>
<a id=__codelineno-0-1160 name=__codelineno-0-1160></a><a href=#__codelineno-0-1160><span class=linenos data-linenos="1160 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>distance</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_distance</span>
<a id=__codelineno-0-1161 name=__codelineno-0-1161></a><a href=#__codelineno-0-1161><span class=linenos data-linenos="1161 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>prominence</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_prominence</span>
<a id=__codelineno-0-1162 name=__codelineno-0-1162></a><a href=#__codelineno-0-1162><span class=linenos data-linenos="1162 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>width</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimated_width</span>
<a id=__codelineno-0-1163 name=__codelineno-0-1163></a><a href=#__codelineno-0-1163><span class=linenos data-linenos="1163 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>wlen</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimated_wlen</span>
<a id=__codelineno-0-1164 name=__codelineno-0-1164></a><a href=#__codelineno-0-1164><span class=linenos data-linenos="1164 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>rel_height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimated_rel_height</span>
<a id=__codelineno-0-1165 name=__codelineno-0-1165></a><a href=#__codelineno-0-1165><span class=linenos data-linenos="1165 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>plateau_size</span> <span class=o>=</span> <span class=mi>0</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.AutoPeakDetection.initialize_peak_detection class="doc doc-heading"> <code class="highlight language-python"><span class=n>initialize_peak_detection</span><span class=p>()</span></code> <a href=#spectrafit.models.AutoPeakDetection.initialize_peak_detection class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Initialize the peak detection.</p> <div class="admonition note"> <p class=admonition-title>Initialize the peak detection</p> <p>This method is used to initialize the peak detection. The initialization can be activated by setting the <code class="language-text highlight">initialize</code> attribute to <code class="language-text highlight">True</code>, which will automatically estimate the default parameters for the peak detection. In case of the <code class="language-text highlight">initialize</code> attribute is defined as dictionary, the proposed values are taken from the dictionary if th</p> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <details class=raise open> <summary><p>Raise</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --></summary> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </details> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1109 name=__codelineno-0-1109></a><a href=#__codelineno-0-1109><span class=linenos data-linenos="1109 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>initialize_peak_detection</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1110 name=__codelineno-0-1110></a><a href=#__codelineno-0-1110><span class=linenos data-linenos="1110 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the peak detection.</span>
<a id=__codelineno-0-1111 name=__codelineno-0-1111></a><a href=#__codelineno-0-1111><span class=linenos data-linenos="1111 "></span></a>
<a id=__codelineno-0-1112 name=__codelineno-0-1112></a><a href=#__codelineno-0-1112><span class=linenos data-linenos="1112 "></span></a><span class=sd>    !!! note &quot;Initialize the peak detection&quot;</span>
<a id=__codelineno-0-1113 name=__codelineno-0-1113></a><a href=#__codelineno-0-1113><span class=linenos data-linenos="1113 "></span></a>
<a id=__codelineno-0-1114 name=__codelineno-0-1114></a><a href=#__codelineno-0-1114><span class=linenos data-linenos="1114 "></span></a><span class=sd>        This method is used to initialize the peak detection. The initialization can</span>
<a id=__codelineno-0-1115 name=__codelineno-0-1115></a><a href=#__codelineno-0-1115><span class=linenos data-linenos="1115 "></span></a><span class=sd>        be activated by setting the `initialize` attribute to `True`, which will</span>
<a id=__codelineno-0-1116 name=__codelineno-0-1116></a><a href=#__codelineno-0-1116><span class=linenos data-linenos="1116 "></span></a><span class=sd>        automatically estimate the default parameters for the peak detection. In</span>
<a id=__codelineno-0-1117 name=__codelineno-0-1117></a><a href=#__codelineno-0-1117><span class=linenos data-linenos="1117 "></span></a><span class=sd>        case of the `initialize` attribute is defined as dictionary, the proposed</span>
<a id=__codelineno-0-1118 name=__codelineno-0-1118></a><a href=#__codelineno-0-1118><span class=linenos data-linenos="1118 "></span></a><span class=sd>        values are taken from the dictionary if th</span>
<a id=__codelineno-0-1119 name=__codelineno-0-1119></a><a href=#__codelineno-0-1119><span class=linenos data-linenos="1119 "></span></a>
<a id=__codelineno-0-1120 name=__codelineno-0-1120></a><a href=#__codelineno-0-1120><span class=linenos data-linenos="1120 "></span></a><span class=sd>    Raise:</span>
<a id=__codelineno-0-1121 name=__codelineno-0-1121></a><a href=#__codelineno-0-1121><span class=linenos data-linenos="1121 "></span></a><span class=sd>        TypeError: If the `initialize` attribute is not of type `bool` or `dict`.</span>
<a id=__codelineno-0-1122 name=__codelineno-0-1122></a><a href=#__codelineno-0-1122><span class=linenos data-linenos="1122 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1123 name=__codelineno-0-1123></a><a href=#__codelineno-0-1123><span class=linenos data-linenos="1123 "></span></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<a id=__codelineno-0-1124 name=__codelineno-0-1124></a><a href=#__codelineno-0-1124><span class=linenos data-linenos="1124 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>default_values</span><span class=p>()</span>
<a id=__codelineno-0-1125 name=__codelineno-0-1125></a><a href=#__codelineno-0-1125><span class=linenos data-linenos="1125 "></span></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
<a id=__codelineno-0-1126 name=__codelineno-0-1126></a><a href=#__codelineno-0-1126><span class=linenos data-linenos="1126 "></span></a>        <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>detection_check</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>)</span>
<a id=__codelineno-0-1127 name=__codelineno-0-1127></a><a href=#__codelineno-0-1127><span class=linenos data-linenos="1127 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1128 name=__codelineno-0-1128></a><a href=#__codelineno-0-1128><span class=linenos data-linenos="1128 "></span></a>            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;height&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_height</span>
<a id=__codelineno-0-1129 name=__codelineno-0-1129></a><a href=#__codelineno-0-1129><span class=linenos data-linenos="1129 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-1130 name=__codelineno-0-1130></a><a href=#__codelineno-0-1130><span class=linenos data-linenos="1130 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>threshold</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1131 name=__codelineno-0-1131></a><a href=#__codelineno-0-1131><span class=linenos data-linenos="1131 "></span></a>            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;threshold&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_threshold</span>
<a id=__codelineno-0-1132 name=__codelineno-0-1132></a><a href=#__codelineno-0-1132><span class=linenos data-linenos="1132 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-1133 name=__codelineno-0-1133></a><a href=#__codelineno-0-1133><span class=linenos data-linenos="1133 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>distance</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1134 name=__codelineno-0-1134></a><a href=#__codelineno-0-1134><span class=linenos data-linenos="1134 "></span></a>            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;distance&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_distance</span>
<a id=__codelineno-0-1135 name=__codelineno-0-1135></a><a href=#__codelineno-0-1135><span class=linenos data-linenos="1135 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-1136 name=__codelineno-0-1136></a><a href=#__codelineno-0-1136><span class=linenos data-linenos="1136 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>prominence</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1137 name=__codelineno-0-1137></a><a href=#__codelineno-0-1137><span class=linenos data-linenos="1137 "></span></a>            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;prominence&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimate_prominence</span>
<a id=__codelineno-0-1138 name=__codelineno-0-1138></a><a href=#__codelineno-0-1138><span class=linenos data-linenos="1138 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-1139 name=__codelineno-0-1139></a><a href=#__codelineno-0-1139><span class=linenos data-linenos="1139 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>width</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1140 name=__codelineno-0-1140></a><a href=#__codelineno-0-1140><span class=linenos data-linenos="1140 "></span></a>            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;width&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimated_width</span>
<a id=__codelineno-0-1141 name=__codelineno-0-1141></a><a href=#__codelineno-0-1141><span class=linenos data-linenos="1141 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-1142 name=__codelineno-0-1142></a><a href=#__codelineno-0-1142><span class=linenos data-linenos="1142 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>wlen</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1143 name=__codelineno-0-1143></a><a href=#__codelineno-0-1143><span class=linenos data-linenos="1143 "></span></a>            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;wlen&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimated_wlen</span>
<a id=__codelineno-0-1144 name=__codelineno-0-1144></a><a href=#__codelineno-0-1144><span class=linenos data-linenos="1144 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-1145 name=__codelineno-0-1145></a><a href=#__codelineno-0-1145><span class=linenos data-linenos="1145 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>rel_height</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1146 name=__codelineno-0-1146></a><a href=#__codelineno-0-1146><span class=linenos data-linenos="1146 "></span></a>            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;rel_height&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>estimated_rel_height</span>
<a id=__codelineno-0-1147 name=__codelineno-0-1147></a><a href=#__codelineno-0-1147><span class=linenos data-linenos="1147 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-1148 name=__codelineno-0-1148></a><a href=#__codelineno-0-1148><span class=linenos data-linenos="1148 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>plateau_size</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_key_exists</span><span class=p>(</span>
<a id=__codelineno-0-1149 name=__codelineno-0-1149></a><a href=#__codelineno-0-1149><span class=linenos data-linenos="1149 "></span></a>            <span class=n>key</span><span class=o>=</span><span class=s2>&quot;plateau_size&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=mf>0.0</span>
<a id=__codelineno-0-1150 name=__codelineno-0-1150></a><a href=#__codelineno-0-1150><span class=linenos data-linenos="1150 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-1151 name=__codelineno-0-1151></a><a href=#__codelineno-0-1151><span class=linenos data-linenos="1151 "></span></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-1152 name=__codelineno-0-1152></a><a href=#__codelineno-0-1152><span class=linenos data-linenos="1152 "></span></a>        <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
<a id=__codelineno-0-1153 name=__codelineno-0-1153></a><a href=#__codelineno-0-1153><span class=linenos data-linenos="1153 "></span></a>            <span class=sa>f</span><span class=s2>&quot;The type of the `args` is not supported: </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_args</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-0-1154 name=__codelineno-0-1154></a><a href=#__codelineno-0-1154><span class=linenos data-linenos="1154 "></span></a>        <span class=p>)</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=spectrafit.models.Constants class="doc doc-heading"> <code>Constants</code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small> </span> <a href=#spectrafit.models.Constants class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p>Mathematical constants for the curve models.</p> <div class="admonition info"> <p class=admonition-title>Constants</p> <ol> <li> <p>Natural logarithm of 2</p> <pre class=arithmatex>\[
ln2 = \log{2}
\]</pre> </li> <li> <p>Square root of 2 times pi</p> <pre class=arithmatex>\[
sq2pi = \sqrt{2 \pi}
\]</pre> </li> <li> <p>Square root of pi</p> <pre class=arithmatex>\[
sqpi = \sqrt{ \pi}
\]</pre> </li> <li> <p>Square root of 2</p> <pre class=arithmatex>\[
sq2 = \sqrt{2}
\]</pre> </li> <li> <p>Full width at half maximum to sigma for <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr></p> <pre class=arithmatex>\[
fwhmg2sig = \frac{1}{ 2 \sqrt{2\log{2}}}
\]</pre> </li> <li> <p>Full width at half maximum to sigma for <abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr></p> <pre class=arithmatex>\[
fwhml2sig = \frac{1}{2}
\]</pre> </li> <li> <p>Full width at half maximum to sigma for <abbr title="A peak function resulting from the Convolution of a Gaussian and a Lorentzian profile">Voigt</abbr> according to the article by Olivero and Longbothum<sup id=spectrafit.models.Constants--fnref:1><a class=footnote-ref href=#spectrafit.models.Constants--fn:1>1</a></sup>, check also <a href=https://xpslibrary.com/voigt-peak-shape/ >XPSLibary website</a>.</p> <p>$$ fwhm_{text{<abbr title="A peak function resulting from the Convolution of a Gaussian and a Lorentzian profile">Voigt</abbr>}} approx 0.5346 cdot fwhm_{text{<abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr>}} + sqrt{ 0.2166 fwhm_{text{<abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr>}}^2 + fwhm_{text{<abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr>}}^2 }</p> <p>$$</p> <p>In case of equal <abbr title="Full Width at Half Maximum; a measure of the width of a peak function (e.g., fwhmg, fwhml)">FWHM</abbr> for <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> and <abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr>, the <abbr title="A peak function resulting from the Convolution of a Gaussian and a Lorentzian profile">Voigt</abbr> <abbr title="Full Width at Half Maximum; a measure of the width of a peak function (e.g., fwhmg, fwhml)">FWHM</abbr> can be defined as:</p> <pre class=arithmatex>\[
fwhm_{\text{Voigt}} \approx 1.0692 + 2 \sqrt{0.2166 + 2 \ln{2}} \cdot \sigma
\]</pre> <pre class=arithmatex>\[
fwhmv2sig = \frac{1}{fwhm_{\text{Voigt}}}
\]</pre> </li> </ol> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <div class=footnote> <hr> <ol> <li id=spectrafit.models.Constants--fn:1> <p>J.J. Olivero, R.L. Longbothum, <em>Empirical fits to the <abbr title="A peak function resulting from the Convolution of a Gaussian and a Lorentzian profile">Voigt</abbr> line width: A brief review</em>, <strong>Journal of Quantitative <abbr title="Study of the interaction between matter and electromagnetic radiation as a function of wavelength or frequency">Spectroscopy</abbr> and Radiative Transfer</strong>, Volume 17, Issue 2, 1977, Pages 233-236, ISSN 0022-4073, <a href=https://doi.org/10.1016/0022-4073(77)90161-3>doi.org/10.1016/0022-4073(77)90161-3</a>.&#160;<a class=footnote-backref href=#spectrafit.models.Constants--fnref:1 title="Jump back to footnote 1 in the text">&#8617;</a></p> </li> </ol> </div> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-853 name=__codelineno-0-853></a><a href=#__codelineno-0-853><span class=linenos data-linenos="853 "></span></a><span class=nd>@dataclass</span><span class=p>(</span><span class=n>frozen</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-0-854 name=__codelineno-0-854></a><a href=#__codelineno-0-854><span class=linenos data-linenos="854 "></span></a><span class=k>class</span><span class=w> </span><span class=nc>Constants</span><span class=p>:</span>
<a id=__codelineno-0-855 name=__codelineno-0-855></a><a href=#__codelineno-0-855><span class=linenos data-linenos="855 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Mathematical constants for the curve models.</span>
<a id=__codelineno-0-856 name=__codelineno-0-856></a><a href=#__codelineno-0-856><span class=linenos data-linenos="856 "></span></a>
<a id=__codelineno-0-857 name=__codelineno-0-857></a><a href=#__codelineno-0-857><span class=linenos data-linenos="857 "></span></a><span class=sd>    !!! info &quot;Constants&quot;</span>
<a id=__codelineno-0-858 name=__codelineno-0-858></a><a href=#__codelineno-0-858><span class=linenos data-linenos="858 "></span></a>
<a id=__codelineno-0-859 name=__codelineno-0-859></a><a href=#__codelineno-0-859><span class=linenos data-linenos="859 "></span></a><span class=sd>        1. Natural logarithm of 2</span>
<a id=__codelineno-0-860 name=__codelineno-0-860></a><a href=#__codelineno-0-860><span class=linenos data-linenos="860 "></span></a>
<a id=__codelineno-0-861 name=__codelineno-0-861></a><a href=#__codelineno-0-861><span class=linenos data-linenos="861 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-862 name=__codelineno-0-862></a><a href=#__codelineno-0-862><span class=linenos data-linenos="862 "></span></a><span class=sd>            ln2 = \log{2}</span>
<a id=__codelineno-0-863 name=__codelineno-0-863></a><a href=#__codelineno-0-863><span class=linenos data-linenos="863 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-864 name=__codelineno-0-864></a><a href=#__codelineno-0-864><span class=linenos data-linenos="864 "></span></a>
<a id=__codelineno-0-865 name=__codelineno-0-865></a><a href=#__codelineno-0-865><span class=linenos data-linenos="865 "></span></a><span class=sd>        2. Square root of 2 times pi</span>
<a id=__codelineno-0-866 name=__codelineno-0-866></a><a href=#__codelineno-0-866><span class=linenos data-linenos="866 "></span></a>
<a id=__codelineno-0-867 name=__codelineno-0-867></a><a href=#__codelineno-0-867><span class=linenos data-linenos="867 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-868 name=__codelineno-0-868></a><a href=#__codelineno-0-868><span class=linenos data-linenos="868 "></span></a><span class=sd>            sq2pi = \sqrt{2 \pi}</span>
<a id=__codelineno-0-869 name=__codelineno-0-869></a><a href=#__codelineno-0-869><span class=linenos data-linenos="869 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-870 name=__codelineno-0-870></a><a href=#__codelineno-0-870><span class=linenos data-linenos="870 "></span></a>
<a id=__codelineno-0-871 name=__codelineno-0-871></a><a href=#__codelineno-0-871><span class=linenos data-linenos="871 "></span></a><span class=sd>        3. Square root of pi</span>
<a id=__codelineno-0-872 name=__codelineno-0-872></a><a href=#__codelineno-0-872><span class=linenos data-linenos="872 "></span></a>
<a id=__codelineno-0-873 name=__codelineno-0-873></a><a href=#__codelineno-0-873><span class=linenos data-linenos="873 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-874 name=__codelineno-0-874></a><a href=#__codelineno-0-874><span class=linenos data-linenos="874 "></span></a><span class=sd>            sqpi = \sqrt{ \pi}</span>
<a id=__codelineno-0-875 name=__codelineno-0-875></a><a href=#__codelineno-0-875><span class=linenos data-linenos="875 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-876 name=__codelineno-0-876></a><a href=#__codelineno-0-876><span class=linenos data-linenos="876 "></span></a>
<a id=__codelineno-0-877 name=__codelineno-0-877></a><a href=#__codelineno-0-877><span class=linenos data-linenos="877 "></span></a><span class=sd>        4. Square root of 2</span>
<a id=__codelineno-0-878 name=__codelineno-0-878></a><a href=#__codelineno-0-878><span class=linenos data-linenos="878 "></span></a>
<a id=__codelineno-0-879 name=__codelineno-0-879></a><a href=#__codelineno-0-879><span class=linenos data-linenos="879 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-880 name=__codelineno-0-880></a><a href=#__codelineno-0-880><span class=linenos data-linenos="880 "></span></a><span class=sd>            sq2 = \sqrt{2}</span>
<a id=__codelineno-0-881 name=__codelineno-0-881></a><a href=#__codelineno-0-881><span class=linenos data-linenos="881 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-882 name=__codelineno-0-882></a><a href=#__codelineno-0-882><span class=linenos data-linenos="882 "></span></a>
<a id=__codelineno-0-883 name=__codelineno-0-883></a><a href=#__codelineno-0-883><span class=linenos data-linenos="883 "></span></a><span class=sd>        5. Full width at half maximum to sigma for Gaussian</span>
<a id=__codelineno-0-884 name=__codelineno-0-884></a><a href=#__codelineno-0-884><span class=linenos data-linenos="884 "></span></a>
<a id=__codelineno-0-885 name=__codelineno-0-885></a><a href=#__codelineno-0-885><span class=linenos data-linenos="885 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-886 name=__codelineno-0-886></a><a href=#__codelineno-0-886><span class=linenos data-linenos="886 "></span></a><span class=sd>            fwhmg2sig = \frac{1}{ 2 \sqrt{2\log{2}}}</span>
<a id=__codelineno-0-887 name=__codelineno-0-887></a><a href=#__codelineno-0-887><span class=linenos data-linenos="887 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-888 name=__codelineno-0-888></a><a href=#__codelineno-0-888><span class=linenos data-linenos="888 "></span></a>
<a id=__codelineno-0-889 name=__codelineno-0-889></a><a href=#__codelineno-0-889><span class=linenos data-linenos="889 "></span></a><span class=sd>        6. Full width at half maximum to sigma for Lorentzian</span>
<a id=__codelineno-0-890 name=__codelineno-0-890></a><a href=#__codelineno-0-890><span class=linenos data-linenos="890 "></span></a>
<a id=__codelineno-0-891 name=__codelineno-0-891></a><a href=#__codelineno-0-891><span class=linenos data-linenos="891 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-892 name=__codelineno-0-892></a><a href=#__codelineno-0-892><span class=linenos data-linenos="892 "></span></a><span class=sd>            fwhml2sig = \frac{1}{2}</span>
<a id=__codelineno-0-893 name=__codelineno-0-893></a><a href=#__codelineno-0-893><span class=linenos data-linenos="893 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-894 name=__codelineno-0-894></a><a href=#__codelineno-0-894><span class=linenos data-linenos="894 "></span></a>
<a id=__codelineno-0-895 name=__codelineno-0-895></a><a href=#__codelineno-0-895><span class=linenos data-linenos="895 "></span></a><span class=sd>        7. Full width at half maximum to sigma for Voigt according to the article by</span>
<a id=__codelineno-0-896 name=__codelineno-0-896></a><a href=#__codelineno-0-896><span class=linenos data-linenos="896 "></span></a><span class=sd>            Olivero and Longbothum[^1], check also</span>
<a id=__codelineno-0-897 name=__codelineno-0-897></a><a href=#__codelineno-0-897><span class=linenos data-linenos="897 "></span></a><span class=sd>            [XPSLibary website](https://xpslibrary.com/voigt-peak-shape/).</span>
<a id=__codelineno-0-898 name=__codelineno-0-898></a><a href=#__codelineno-0-898><span class=linenos data-linenos="898 "></span></a>
<a id=__codelineno-0-899 name=__codelineno-0-899></a><a href=#__codelineno-0-899><span class=linenos data-linenos="899 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-900 name=__codelineno-0-900></a><a href=#__codelineno-0-900><span class=linenos data-linenos="900 "></span></a><span class=sd>            fwhm_{\text{Voigt}} \approx 0.5346 \cdot fwhm_{\text{Gaussian}} +</span>
<a id=__codelineno-0-901 name=__codelineno-0-901></a><a href=#__codelineno-0-901><span class=linenos data-linenos="901 "></span></a><span class=sd>              \sqrt{ 0.2166 fwhm_{\text{Lorentzian}}^2  + fwhm_{\text{Gaussian}}^2 }</span>
<a id=__codelineno-0-902 name=__codelineno-0-902></a><a href=#__codelineno-0-902><span class=linenos data-linenos="902 "></span></a>
<a id=__codelineno-0-903 name=__codelineno-0-903></a><a href=#__codelineno-0-903><span class=linenos data-linenos="903 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-904 name=__codelineno-0-904></a><a href=#__codelineno-0-904><span class=linenos data-linenos="904 "></span></a>
<a id=__codelineno-0-905 name=__codelineno-0-905></a><a href=#__codelineno-0-905><span class=linenos data-linenos="905 "></span></a><span class=sd>            In case of equal FWHM for Gaussian and Lorentzian, the Voigt FWHM can be</span>
<a id=__codelineno-0-906 name=__codelineno-0-906></a><a href=#__codelineno-0-906><span class=linenos data-linenos="906 "></span></a><span class=sd>            defined as:</span>
<a id=__codelineno-0-907 name=__codelineno-0-907></a><a href=#__codelineno-0-907><span class=linenos data-linenos="907 "></span></a>
<a id=__codelineno-0-908 name=__codelineno-0-908></a><a href=#__codelineno-0-908><span class=linenos data-linenos="908 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-909 name=__codelineno-0-909></a><a href=#__codelineno-0-909><span class=linenos data-linenos="909 "></span></a><span class=sd>            fwhm_{\text{Voigt}} \approx 1.0692 + 2 \sqrt{0.2166 + 2 \ln{2}} \cdot \sigma</span>
<a id=__codelineno-0-910 name=__codelineno-0-910></a><a href=#__codelineno-0-910><span class=linenos data-linenos="910 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-911 name=__codelineno-0-911></a><a href=#__codelineno-0-911><span class=linenos data-linenos="911 "></span></a>
<a id=__codelineno-0-912 name=__codelineno-0-912></a><a href=#__codelineno-0-912><span class=linenos data-linenos="912 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-913 name=__codelineno-0-913></a><a href=#__codelineno-0-913><span class=linenos data-linenos="913 "></span></a><span class=sd>            fwhmv2sig = \frac{1}{fwhm_{\text{Voigt}}}</span>
<a id=__codelineno-0-914 name=__codelineno-0-914></a><a href=#__codelineno-0-914><span class=linenos data-linenos="914 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-915 name=__codelineno-0-915></a><a href=#__codelineno-0-915><span class=linenos data-linenos="915 "></span></a>
<a id=__codelineno-0-916 name=__codelineno-0-916></a><a href=#__codelineno-0-916><span class=linenos data-linenos="916 "></span></a><span class=sd>        [^1]:</span>
<a id=__codelineno-0-917 name=__codelineno-0-917></a><a href=#__codelineno-0-917><span class=linenos data-linenos="917 "></span></a><span class=sd>            J.J. Olivero, R.L. Longbothum,</span>
<a id=__codelineno-0-918 name=__codelineno-0-918></a><a href=#__codelineno-0-918><span class=linenos data-linenos="918 "></span></a><span class=sd>            _Empirical fits to the Voigt line width: A brief review_,</span>
<a id=__codelineno-0-919 name=__codelineno-0-919></a><a href=#__codelineno-0-919><span class=linenos data-linenos="919 "></span></a><span class=sd>            **Journal of Quantitative Spectroscopy and Radiative Transfer**,</span>
<a id=__codelineno-0-920 name=__codelineno-0-920></a><a href=#__codelineno-0-920><span class=linenos data-linenos="920 "></span></a><span class=sd>            Volume 17, Issue 2, 1977, Pages 233-236, ISSN 0022-4073,</span>
<a id=__codelineno-0-921 name=__codelineno-0-921></a><a href=#__codelineno-0-921><span class=linenos data-linenos="921 "></span></a><span class=sd>            https://doi.org/10.1016/0022-4073(77)90161-3.</span>
<a id=__codelineno-0-922 name=__codelineno-0-922></a><a href=#__codelineno-0-922><span class=linenos data-linenos="922 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-923 name=__codelineno-0-923></a><a href=#__codelineno-0-923><span class=linenos data-linenos="923 "></span></a>
<a id=__codelineno-0-924 name=__codelineno-0-924></a><a href=#__codelineno-0-924><span class=linenos data-linenos="924 "></span></a>    <span class=n>ln2</span> <span class=o>=</span> <span class=n>log</span><span class=p>(</span><span class=mf>2.0</span><span class=p>)</span>
<a id=__codelineno-0-925 name=__codelineno-0-925></a><a href=#__codelineno-0-925><span class=linenos data-linenos="925 "></span></a>    <span class=n>sq2pi</span> <span class=o>=</span> <span class=n>sqrt</span><span class=p>(</span><span class=mf>2.0</span> <span class=o>*</span> <span class=n>pi</span><span class=p>)</span>
<a id=__codelineno-0-926 name=__codelineno-0-926></a><a href=#__codelineno-0-926><span class=linenos data-linenos="926 "></span></a>    <span class=n>sqpi</span> <span class=o>=</span> <span class=n>sqrt</span><span class=p>(</span><span class=n>pi</span><span class=p>)</span>
<a id=__codelineno-0-927 name=__codelineno-0-927></a><a href=#__codelineno-0-927><span class=linenos data-linenos="927 "></span></a>    <span class=n>sq2</span> <span class=o>=</span> <span class=n>sqrt</span><span class=p>(</span><span class=mf>2.0</span><span class=p>)</span>
<a id=__codelineno-0-928 name=__codelineno-0-928></a><a href=#__codelineno-0-928><span class=linenos data-linenos="928 "></span></a>    <span class=n>fwhmg2sig</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=p>(</span><span class=mf>2.0</span> <span class=o>*</span> <span class=n>sqrt</span><span class=p>(</span><span class=mf>2.0</span> <span class=o>*</span> <span class=n>log</span><span class=p>(</span><span class=mf>2.0</span><span class=p>)))</span>
<a id=__codelineno-0-929 name=__codelineno-0-929></a><a href=#__codelineno-0-929><span class=linenos data-linenos="929 "></span></a>    <span class=n>fwhml2sig</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=mf>2.0</span>
<a id=__codelineno-0-930 name=__codelineno-0-930></a><a href=#__codelineno-0-930><span class=linenos data-linenos="930 "></span></a>    <span class=n>fwhmv2sig</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=mf>0.5346</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>sqrt</span><span class=p>(</span><span class=mf>0.2166</span> <span class=o>+</span> <span class=n>log</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=o>*</span> <span class=mi>2</span><span class=p>))</span>
</code></pre></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=spectrafit.models.DistributionModels class="doc doc-heading"> <code>DistributionModels</code> <a href=#spectrafit.models.DistributionModels class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p>Distribution models for the fit.</p> <div class="admonition note"> <p class=admonition-title>About distribution models</p> <p><code class="language-text highlight">DistributionModels</code> are wrapper functions for the distribution models. The overall goal is to extract from the best parameters the single contributions in the model. The superposition of the single contributions is the final model.</p> </div> <div class="admonition note"> <p class=admonition-title>About the cumulative distribution</p> <p>The cumulative distribution is the sum of the single contributions. The cumulative distribution is the model that is fitted to the data. In contrast to the single contributions, the cumulative distribution is not normalized and therefore the amplitude of the single contributions is not directly comparable to the amplitude of the cumulative distribution. Also, the cumulative distributions are consquently using the <code class="language-text highlight">fwhm</code> parameter instead of the <code class="language-text highlight">sigma</code> parameter.</p> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos=" 22 "></span></a><span class=k>class</span><span class=w> </span><span class=nc>DistributionModels</span><span class=p>:</span>
<a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos=" 23 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Distribution models for the fit.</span>
<a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos=" 24 "></span></a>
<a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos=" 25 "></span></a><span class=sd>    !!! note &quot;About distribution models&quot;</span>
<a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos=" 26 "></span></a>
<a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos=" 27 "></span></a><span class=sd>        `DistributionModels` are wrapper functions for the distribution models. The</span>
<a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos=" 28 "></span></a><span class=sd>        overall goal is to extract from the best parameters the single contributions in</span>
<a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos=" 29 "></span></a><span class=sd>        the model. The superposition of the single contributions is the final model.</span>
<a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos=" 30 "></span></a>
<a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos=" 31 "></span></a><span class=sd>    !!! note &quot;About the cumulative distribution&quot;</span>
<a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos=" 32 "></span></a>
<a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos=" 33 "></span></a><span class=sd>        The cumulative distribution is the sum of the single contributions. The</span>
<a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a><span class=sd>        cumulative distribution is the model that is fitted to the data. In contrast to</span>
<a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a><span class=sd>        the single contributions, the cumulative distribution is not normalized and</span>
<a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a><span class=sd>        therefore the amplitude of the single contributions is not directly comparable</span>
<a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a><span class=sd>        to the amplitude of the cumulative distribution. Also, the cumulative</span>
<a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a><span class=sd>        distributions are consquently using the `fwhm` parameter instead of the</span>
<a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a><span class=sd>        `sigma` parameter.</span>
<a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a>
<a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>_gaussian_core</span><span class=p>(</span>
<a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
<a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
<a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a>        <span class=n>scale</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
<a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Core Gaussian calculation used by multiple staticmethods.</span>
<a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a>
<a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=sd>        !!! note &quot;About the core Gaussian calculation&quot;</span>
<a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a>
<a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=sd>            The core Gaussian calculation is used by the `gaussian`, `orca_gaussian`</span>
<a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=sd>            for avoiding code duplication. The core Gaussian calculation is not normalized and</span>
<a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a><span class=sd>            therefore the amplitude of the Gaussian is not directly comparable to the</span>
<a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=sd>            amplitude of the classical definition of the</span>
<a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a><span class=sd>            [Gaussian](https://en.wikipedia.org/wiki/Gaussian_function) function.</span>
<a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a>
<a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a>
<a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=sd>            Consequently, the core Gaussian calculation is defined as:</span>
<a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>
<a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=sd>            {\displaystyle g(x)={A \exp</span>
<a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=sd>            (  -{\frac {1}{2}}{\frac {(x-\mu )^{2}}{\sigma ^{2}}} ) }</span>
<a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=sd>            $$</span>
<a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a>
<a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=sd>            amplitude (float): Amplitude of the Gaussian distribution.</span>
<a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=sd>            center (float): Center of the Gaussian distribution.</span>
<a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=sd>            scale (float): Scale of the Gaussian distribution.</span>
<a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a>
<a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a><span class=sd>            NDArray[np.float64]: Gaussian distribution of `x` given.</span>
<a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=p>((</span><span class=mf>1.0</span> <span class=o>*</span> <span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>scale</span><span class=o>**</span><span class=mi>2</span><span class=p>)))</span>
<a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a>
<a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>gaussian</span><span class=p>(</span>
<a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>        <span class=n>fwhmg</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Gaussian distribution.</span>
<a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>
<a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>        {\displaystyle g(x)={\frac {1}{\sigma {\sqrt {2\pi }}}}\exp</span>
<a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>        (  -{\frac {1}{2}}{\frac {(x-\mu )^{2}}{\sigma ^{2}}} ) }</span>
<a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>
<a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the Gaussian distribution.</span>
<a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>                 Defaults to 1.0.</span>
<a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>            center (float, optional): Center of the Gaussian distribution.</span>
<a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>                 Defaults to 0.0.</span>
<a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>            fwhmg (float, optional): Full width at half maximum (FWHM) of the Gaussian</span>
<a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>                distribution. Defaults to 1.0.</span>
<a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>
<a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>            NDArray[np.float64]: Gaussian distribution of `x` given.</span>
<a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>        <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmg</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmg2sig</span>
<a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>        <span class=n>norm_factor</span> <span class=o>=</span> <span class=n>amplitude</span> <span class=o>/</span> <span class=p>(</span><span class=n>Constants</span><span class=o>.</span><span class=n>sq2pi</span> <span class=o>*</span> <span class=n>sigma</span><span class=p>)</span>
<a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>        <span class=k>return</span> <span class=n>norm_factor</span> <span class=o>*</span> <span class=n>DistributionModels</span><span class=o>.</span><span class=n>_gaussian_core</span><span class=p>(</span>
<a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>            <span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=n>center</span><span class=p>,</span> <span class=n>scale</span><span class=o>=</span><span class=n>sigma</span>
<a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a>
<a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>orcagaussian</span><span class=p>(</span>
<a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>        <span class=n>width</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Gaussian distribution as implemented in the ORCA program.</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
<a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>        {\displaystyle g(x)= A \cdot \exp</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>        (  -{\frac {(x-x_0)^{2}}{2 \cdot width^{2}}} ) }</span>
<a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>
<a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>        Unlike the standard gaussian function, this implementation uses the width parameter</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>        directly without conversion to sigma, which is consistent with the ORCA quantum</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>        chemistry program&#39;s approach[^1].</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>
<a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>        [^1]: https://www.faccts.de/docs/orca/6.0/manual/contents/detailed/utilities.html</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>
<a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the Gaussian distribution.</span>
<a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>                 Defaults to 1.0.</span>
<a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>            center (float, optional): Center of the Gaussian distribution.</span>
<a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>                 Defaults to 0.0.</span>
<a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>            width (float, optional): Width parameter of the Gaussian distribution as used</span>
<a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=sd>                 in the ORCA program. Defaults to 1.0.</span>
<a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>
<a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>            NDArray[np.float64]: Gaussian distribution of `x` given.</span>
<a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>        <span class=k>return</span> <span class=n>DistributionModels</span><span class=o>.</span><span class=n>_gaussian_core</span><span class=p>(</span>
<a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>            <span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=n>amplitude</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=n>center</span><span class=p>,</span> <span class=n>scale</span><span class=o>=</span><span class=n>width</span>
<a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a>
<a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>lorentzian</span><span class=p>(</span>
<a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>        <span class=n>fwhml</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Lorentzian distribution.</span>
<a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>
<a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a><span class=sd>        f(x;x_{0},\gamma )={\frac  {1}{\pi \gamma</span>
<a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a><span class=sd>        [ 1+ ( {\frac  {x-x_{0}}{\gamma }})^{2} ]</span>
<a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=sd>        }} ={1 \over \pi \gamma } [ {\gamma ^{2} \over (x-x_{0})^{2}+\gamma ^{2}} ]</span>
<a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>
<a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the Lorentzian distribution.</span>
<a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a><span class=sd>                Defaults to 1.0.</span>
<a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a><span class=sd>            center (float, optional): Center of the Lorentzian distribution. Defaults to</span>
<a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a><span class=sd>                0.0.</span>
<a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a><span class=sd>            fwhml (float, optional): Full width at half maximum (FWHM) of the Lorentzian</span>
<a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a><span class=sd>                distribution. Defaults to 1.0.</span>
<a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>
<a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a><span class=sd>            Union[NDArray[np.float64], float]: Lorentzian distribution of `x` given.</span>
<a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>        <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhml</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhml2sig</span>
<a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>            <span class=n>amplitude</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=p>((</span><span class=mf>1.0</span> <span class=o>*</span> <span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>pi</span> <span class=o>*</span> <span class=n>sigma</span><span class=p>),</span>
<a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>            <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span>
<a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-178 name=__codelineno-0-178></a><a href=#__codelineno-0-178><span class=linenos data-linenos="178 "></span></a>
<a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>voigt</span><span class=p>(</span>
<a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>        <span class=n>fwhmv</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>        <span class=n>gamma</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Voigt distribution.</span>
<a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>
<a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a><span class=sd>        {\displaystyle V(x;\sigma ,\gamma )\equiv</span>
<a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a><span class=sd>        \int_{-\infty }^{\infty }G(x&#39;;\sigma )</span>
<a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a><span class=sd>        L(x-x&#39;;\gamma )\,dx&#39;}</span>
<a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>
<a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a><span class=sd>            center (float, optional): Center of the Voigt distribution. Defaults to 0.0.</span>
<a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a><span class=sd>            fwhmv (float, optional): Full width at half maximum (FWHM) of the Lorentzian</span>
<a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a><span class=sd>                distribution. Defaults to 1.0.</span>
<a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a><span class=sd>            gamma (float, optional): Scaling factor of the complex part of the</span>
<a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a><span class=sd>                [Faddeeva Function](https://en.wikipedia.org/wiki/Faddeeva_function).</span>
<a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a><span class=sd>                Defaults to None.</span>
<a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>
<a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a><span class=sd>            NDArray[np.float64]: Voigt distribution of `x` given.</span>
<a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>        <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmv</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmv2sig</span>
<a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>        <span class=k>if</span> <span class=n>gamma</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>            <span class=n>gamma</span> <span class=o>=</span> <span class=n>sigma</span>
<a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>        <span class=n>z</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span> <span class=o>+</span> <span class=mi>1</span><span class=n>j</span> <span class=o>*</span> <span class=n>gamma</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>sq2</span><span class=p>)</span>
<a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>wofz</span><span class=p>(</span><span class=n>z</span><span class=p>)</span><span class=o>.</span><span class=n>real</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>sq2pi</span><span class=p>))</span>
<a id=__codelineno-0-211 name=__codelineno-0-211></a><a href=#__codelineno-0-211><span class=linenos data-linenos="211 "></span></a>
<a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>pseudovoigt</span><span class=p>(</span>
<a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>        <span class=n>fwhmg</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>        <span class=n>fwhml</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Pseudo-Voigt distribution.</span>
<a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>
<a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a><span class=sd>        !!! note &quot;See also:&quot;</span>
<a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>
<a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a><span class=sd>            J. Appl. Cryst. (2000). 33, 1311-1316</span>
<a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a><span class=sd>            https://doi.org/10.1107/S0021889800010219</span>
<a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>
<a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a><span class=sd>            x (NDArray[np.float64]):  `x`-values of the data.</span>
<a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the Pseudo-Voigt distribution.</span>
<a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a><span class=sd>                Defaults to 1.0.</span>
<a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a><span class=sd>            center (float, optional): Center of the Pseudo-Voigt distribution.</span>
<a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a><span class=sd>                Defaults to 0.0.</span>
<a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a><span class=sd>            fwhmg (float, optional): Full width half maximum of the Gaussian</span>
<a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a><span class=sd>                distribution in the Pseudo-Voigt distribution. Defaults to 1.0.</span>
<a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a><span class=sd>            fwhml (float, optional): Full width half maximum of the Lorentzian</span>
<a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a><span class=sd>                distribution in the Pseudo-Voigt distribution. Defaults to 1.0.</span>
<a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>
<a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a><span class=sd>            NDArray[np.float64]: Pseudo-Voigt distribution of `x` given.</span>
<a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>        <span class=n>f</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span>
<a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>            <span class=n>fwhmg</span><span class=o>**</span><span class=mi>5</span>
<a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>            <span class=o>+</span> <span class=mf>2.69269</span> <span class=o>*</span> <span class=n>fwhmg</span><span class=o>**</span><span class=mi>4</span> <span class=o>*</span> <span class=n>fwhml</span>
<a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>            <span class=o>+</span> <span class=mf>2.42843</span> <span class=o>*</span> <span class=n>fwhmg</span><span class=o>**</span><span class=mi>3</span> <span class=o>*</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>2</span>
<a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>            <span class=o>+</span> <span class=mf>4.47163</span> <span class=o>*</span> <span class=n>fwhmg</span><span class=o>**</span><span class=mi>2</span> <span class=o>*</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>3</span>
<a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>            <span class=o>+</span> <span class=mf>0.07842</span> <span class=o>*</span> <span class=n>fwhmg</span> <span class=o>*</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>4</span>
<a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>            <span class=o>+</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>5</span><span class=p>,</span>
<a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>            <span class=mf>0.2</span><span class=p>,</span>
<a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>        <span class=n>n</span> <span class=o>=</span> <span class=p>(</span>
<a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>            <span class=mf>1.36603</span> <span class=o>*</span> <span class=p>(</span><span class=n>fwhml</span> <span class=o>/</span> <span class=n>f</span><span class=p>)</span>
<a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>            <span class=o>-</span> <span class=mf>0.47719</span> <span class=o>*</span> <span class=p>(</span><span class=n>fwhml</span> <span class=o>/</span> <span class=n>f</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span>
<a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>            <span class=o>+</span> <span class=mf>0.11116</span> <span class=o>*</span> <span class=p>(</span><span class=n>fwhml</span> <span class=o>/</span> <span class=n>f</span><span class=p>)</span> <span class=o>**</span> <span class=mi>3</span>
<a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>            <span class=n>n</span>
<a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>            <span class=o>*</span> <span class=n>DistributionModels</span><span class=o>.</span><span class=n>lorentzian</span><span class=p>(</span>
<a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>                <span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=n>amplitude</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=n>center</span><span class=p>,</span> <span class=n>fwhml</span><span class=o>=</span><span class=n>fwhml</span>
<a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>            <span class=o>+</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>n</span><span class=p>)</span>
<a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>            <span class=o>*</span> <span class=n>DistributionModels</span><span class=o>.</span><span class=n>gaussian</span><span class=p>(</span>
<a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>                <span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=n>amplitude</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=n>center</span><span class=p>,</span> <span class=n>fwhmg</span><span class=o>=</span><span class=n>fwhmg</span>
<a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-265 name=__codelineno-0-265></a><a href=#__codelineno-0-265><span class=linenos data-linenos="265 "></span></a>
<a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>exponential</span><span class=p>(</span>
<a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>        <span class=n>decay</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>        <span class=n>intercept</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional exponential decay.</span>
<a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>
<a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the exponential function.</span>
<a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a><span class=sd>                 Defaults to 1.0.</span>
<a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a><span class=sd>            decay (float, optional): Decay of the exponential function. Defaults to 1.0.</span>
<a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a><span class=sd>            intercept (float, optional): Intercept of the exponential function.</span>
<a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a><span class=sd>                 Defaults to 0.0.</span>
<a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>
<a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a><span class=sd>            NDArray[np.float64]: Exponential decay of `x` given.</span>
<a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=n>x</span> <span class=o>/</span> <span class=n>decay</span><span class=p>)</span> <span class=o>+</span> <span class=n>intercept</span><span class=p>)</span>
<a id=__codelineno-0-287 name=__codelineno-0-287></a><a href=#__codelineno-0-287><span class=linenos data-linenos="287 "></span></a>
<a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>power</span><span class=p>(</span>
<a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>        <span class=n>exponent</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>        <span class=n>intercept</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional power function.</span>
<a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>
<a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the power function. Defaults to</span>
<a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a><span class=sd>                1.0.</span>
<a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a><span class=sd>            exponent (float, optional): Exponent of the power function. Defaults to 1.0.</span>
<a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a><span class=sd>            intercept (float, optional): Intercept of the power function. Defaults to</span>
<a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a><span class=sd>                0.0.</span>
<a id=__codelineno-0-304 name=__codelineno-0-304></a><a href=#__codelineno-0-304><span class=linenos data-linenos="304 "></span></a>
<a id=__codelineno-0-305 name=__codelineno-0-305></a><a href=#__codelineno-0-305><span class=linenos data-linenos="305 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a><span class=sd>            NDArray[np.float64]: power function of `x` given.</span>
<a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>exponent</span><span class=p>)</span> <span class=o>+</span> <span class=n>intercept</span><span class=p>)</span>
<a id=__codelineno-0-309 name=__codelineno-0-309></a><a href=#__codelineno-0-309><span class=linenos data-linenos="309 "></span></a>
<a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-311 name=__codelineno-0-311></a><a href=#__codelineno-0-311><span class=linenos data-linenos="311 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>linear</span><span class=p>(</span>
<a id=__codelineno-0-312 name=__codelineno-0-312></a><a href=#__codelineno-0-312><span class=linenos data-linenos="312 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-313 name=__codelineno-0-313></a><a href=#__codelineno-0-313><span class=linenos data-linenos="313 "></span></a>        <span class=n>slope</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-314 name=__codelineno-0-314></a><a href=#__codelineno-0-314><span class=linenos data-linenos="314 "></span></a>        <span class=n>intercept</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-315 name=__codelineno-0-315></a><a href=#__codelineno-0-315><span class=linenos data-linenos="315 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-316 name=__codelineno-0-316></a><a href=#__codelineno-0-316><span class=linenos data-linenos="316 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional linear function.</span>
<a id=__codelineno-0-317 name=__codelineno-0-317></a><a href=#__codelineno-0-317><span class=linenos data-linenos="317 "></span></a>
<a id=__codelineno-0-318 name=__codelineno-0-318></a><a href=#__codelineno-0-318><span class=linenos data-linenos="318 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-319 name=__codelineno-0-319></a><a href=#__codelineno-0-319><span class=linenos data-linenos="319 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-320 name=__codelineno-0-320></a><a href=#__codelineno-0-320><span class=linenos data-linenos="320 "></span></a><span class=sd>            slope (float, optional): Slope of the linear function. Defaults to 1.0.</span>
<a id=__codelineno-0-321 name=__codelineno-0-321></a><a href=#__codelineno-0-321><span class=linenos data-linenos="321 "></span></a><span class=sd>            intercept (float, optional): Intercept of the linear function.</span>
<a id=__codelineno-0-322 name=__codelineno-0-322></a><a href=#__codelineno-0-322><span class=linenos data-linenos="322 "></span></a><span class=sd>                 Defaults to 0.0.</span>
<a id=__codelineno-0-323 name=__codelineno-0-323></a><a href=#__codelineno-0-323><span class=linenos data-linenos="323 "></span></a>
<a id=__codelineno-0-324 name=__codelineno-0-324></a><a href=#__codelineno-0-324><span class=linenos data-linenos="324 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-325 name=__codelineno-0-325></a><a href=#__codelineno-0-325><span class=linenos data-linenos="325 "></span></a><span class=sd>            NDArray[np.float64]: Linear function of `x` given.</span>
<a id=__codelineno-0-326 name=__codelineno-0-326></a><a href=#__codelineno-0-326><span class=linenos data-linenos="326 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-327 name=__codelineno-0-327></a><a href=#__codelineno-0-327><span class=linenos data-linenos="327 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>slope</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=n>intercept</span><span class=p>)</span>
<a id=__codelineno-0-328 name=__codelineno-0-328></a><a href=#__codelineno-0-328><span class=linenos data-linenos="328 "></span></a>
<a id=__codelineno-0-329 name=__codelineno-0-329></a><a href=#__codelineno-0-329><span class=linenos data-linenos="329 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-330 name=__codelineno-0-330></a><a href=#__codelineno-0-330><span class=linenos data-linenos="330 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>constant</span><span class=p>(</span>
<a id=__codelineno-0-331 name=__codelineno-0-331></a><a href=#__codelineno-0-331><span class=linenos data-linenos="331 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-332 name=__codelineno-0-332></a><a href=#__codelineno-0-332><span class=linenos data-linenos="332 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-333 name=__codelineno-0-333></a><a href=#__codelineno-0-333><span class=linenos data-linenos="333 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-334 name=__codelineno-0-334></a><a href=#__codelineno-0-334><span class=linenos data-linenos="334 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional constant value.</span>
<a id=__codelineno-0-335 name=__codelineno-0-335></a><a href=#__codelineno-0-335><span class=linenos data-linenos="335 "></span></a>
<a id=__codelineno-0-336 name=__codelineno-0-336></a><a href=#__codelineno-0-336><span class=linenos data-linenos="336 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-337 name=__codelineno-0-337></a><a href=#__codelineno-0-337><span class=linenos data-linenos="337 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-338 name=__codelineno-0-338></a><a href=#__codelineno-0-338><span class=linenos data-linenos="338 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the constant. Defaults to 1.0.</span>
<a id=__codelineno-0-339 name=__codelineno-0-339></a><a href=#__codelineno-0-339><span class=linenos data-linenos="339 "></span></a>
<a id=__codelineno-0-340 name=__codelineno-0-340></a><a href=#__codelineno-0-340><span class=linenos data-linenos="340 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-341 name=__codelineno-0-341></a><a href=#__codelineno-0-341><span class=linenos data-linenos="341 "></span></a><span class=sd>            NDArray[np.float64]: Constant value of `x` given.</span>
<a id=__codelineno-0-342 name=__codelineno-0-342></a><a href=#__codelineno-0-342><span class=linenos data-linenos="342 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-343 name=__codelineno-0-343></a><a href=#__codelineno-0-343><span class=linenos data-linenos="343 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>amplitude</span><span class=p>,</span> <span class=n>amplitude</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)))</span>
<a id=__codelineno-0-344 name=__codelineno-0-344></a><a href=#__codelineno-0-344><span class=linenos data-linenos="344 "></span></a>
<a id=__codelineno-0-345 name=__codelineno-0-345></a><a href=#__codelineno-0-345><span class=linenos data-linenos="345 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-346 name=__codelineno-0-346></a><a href=#__codelineno-0-346><span class=linenos data-linenos="346 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>_norm</span><span class=p>(</span>
<a id=__codelineno-0-347 name=__codelineno-0-347></a><a href=#__codelineno-0-347><span class=linenos data-linenos="347 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span> <span class=n>center</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span>
<a id=__codelineno-0-348 name=__codelineno-0-348></a><a href=#__codelineno-0-348><span class=linenos data-linenos="348 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-349 name=__codelineno-0-349></a><a href=#__codelineno-0-349><span class=linenos data-linenos="349 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Normalize the data for step functions.</span>
<a id=__codelineno-0-350 name=__codelineno-0-350></a><a href=#__codelineno-0-350><span class=linenos data-linenos="350 "></span></a>
<a id=__codelineno-0-351 name=__codelineno-0-351></a><a href=#__codelineno-0-351><span class=linenos data-linenos="351 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-352 name=__codelineno-0-352></a><a href=#__codelineno-0-352><span class=linenos data-linenos="352 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-353 name=__codelineno-0-353></a><a href=#__codelineno-0-353><span class=linenos data-linenos="353 "></span></a><span class=sd>            center (float): Center of the step function.</span>
<a id=__codelineno-0-354 name=__codelineno-0-354></a><a href=#__codelineno-0-354><span class=linenos data-linenos="354 "></span></a><span class=sd>            sigma (float): Sigma of the step function.</span>
<a id=__codelineno-0-355 name=__codelineno-0-355></a><a href=#__codelineno-0-355><span class=linenos data-linenos="355 "></span></a>
<a id=__codelineno-0-356 name=__codelineno-0-356></a><a href=#__codelineno-0-356><span class=linenos data-linenos="356 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-357 name=__codelineno-0-357></a><a href=#__codelineno-0-357><span class=linenos data-linenos="357 "></span></a><span class=sd>            NDArray[np.float64]: Normalized data.</span>
<a id=__codelineno-0-358 name=__codelineno-0-358></a><a href=#__codelineno-0-358><span class=linenos data-linenos="358 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-359 name=__codelineno-0-359></a><a href=#__codelineno-0-359><span class=linenos data-linenos="359 "></span></a>        <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>sigma</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mf>1.0e-13</span><span class=p>:</span>
<a id=__codelineno-0-360 name=__codelineno-0-360></a><a href=#__codelineno-0-360><span class=linenos data-linenos="360 "></span></a>            <span class=n>sigma</span> <span class=o>=</span> <span class=mf>1.0e-13</span>
<a id=__codelineno-0-361 name=__codelineno-0-361></a><a href=#__codelineno-0-361><span class=linenos data-linenos="361 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>subtract</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>)</span>
<a id=__codelineno-0-362 name=__codelineno-0-362></a><a href=#__codelineno-0-362><span class=linenos data-linenos="362 "></span></a>
<a id=__codelineno-0-363 name=__codelineno-0-363></a><a href=#__codelineno-0-363><span class=linenos data-linenos="363 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-364 name=__codelineno-0-364></a><a href=#__codelineno-0-364><span class=linenos data-linenos="364 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>erf</span><span class=p>(</span>
<a id=__codelineno-0-365 name=__codelineno-0-365></a><a href=#__codelineno-0-365><span class=linenos data-linenos="365 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-366 name=__codelineno-0-366></a><a href=#__codelineno-0-366><span class=linenos data-linenos="366 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-367 name=__codelineno-0-367></a><a href=#__codelineno-0-367><span class=linenos data-linenos="367 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-368 name=__codelineno-0-368></a><a href=#__codelineno-0-368><span class=linenos data-linenos="368 "></span></a>        <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-369 name=__codelineno-0-369></a><a href=#__codelineno-0-369><span class=linenos data-linenos="369 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-370 name=__codelineno-0-370></a><a href=#__codelineno-0-370><span class=linenos data-linenos="370 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional error function.</span>
<a id=__codelineno-0-371 name=__codelineno-0-371></a><a href=#__codelineno-0-371><span class=linenos data-linenos="371 "></span></a>
<a id=__codelineno-0-372 name=__codelineno-0-372></a><a href=#__codelineno-0-372><span class=linenos data-linenos="372 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-373 name=__codelineno-0-373></a><a href=#__codelineno-0-373><span class=linenos data-linenos="373 "></span></a><span class=sd>        f(x) = \frac{2}{\sqrt{\pi}} \int_{0}^{x} e^{-t^2} dt</span>
<a id=__codelineno-0-374 name=__codelineno-0-374></a><a href=#__codelineno-0-374><span class=linenos data-linenos="374 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-375 name=__codelineno-0-375></a><a href=#__codelineno-0-375><span class=linenos data-linenos="375 "></span></a>
<a id=__codelineno-0-376 name=__codelineno-0-376></a><a href=#__codelineno-0-376><span class=linenos data-linenos="376 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-377 name=__codelineno-0-377></a><a href=#__codelineno-0-377><span class=linenos data-linenos="377 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-378 name=__codelineno-0-378></a><a href=#__codelineno-0-378><span class=linenos data-linenos="378 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the error function.</span>
<a id=__codelineno-0-379 name=__codelineno-0-379></a><a href=#__codelineno-0-379><span class=linenos data-linenos="379 "></span></a><span class=sd>                    Defaults to 1.0.</span>
<a id=__codelineno-0-380 name=__codelineno-0-380></a><a href=#__codelineno-0-380><span class=linenos data-linenos="380 "></span></a><span class=sd>            center (float, optional): Center of the error function. Defaults to 0.0.</span>
<a id=__codelineno-0-381 name=__codelineno-0-381></a><a href=#__codelineno-0-381><span class=linenos data-linenos="381 "></span></a><span class=sd>            sigma (float, optional): Sigma of the error function. Defaults to 1.0.</span>
<a id=__codelineno-0-382 name=__codelineno-0-382></a><a href=#__codelineno-0-382><span class=linenos data-linenos="382 "></span></a>
<a id=__codelineno-0-383 name=__codelineno-0-383></a><a href=#__codelineno-0-383><span class=linenos data-linenos="383 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-384 name=__codelineno-0-384></a><a href=#__codelineno-0-384><span class=linenos data-linenos="384 "></span></a><span class=sd>            NDArray[np.float64]: Error function of `x` given.</span>
<a id=__codelineno-0-385 name=__codelineno-0-385></a><a href=#__codelineno-0-385><span class=linenos data-linenos="385 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-386 name=__codelineno-0-386></a><a href=#__codelineno-0-386><span class=linenos data-linenos="386 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-387 name=__codelineno-0-387></a><a href=#__codelineno-0-387><span class=linenos data-linenos="387 "></span></a>            <span class=n>amplitude</span> <span class=o>*</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>erf</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)))</span>
<a id=__codelineno-0-388 name=__codelineno-0-388></a><a href=#__codelineno-0-388><span class=linenos data-linenos="388 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-389 name=__codelineno-0-389></a><a href=#__codelineno-0-389><span class=linenos data-linenos="389 "></span></a>
<a id=__codelineno-0-390 name=__codelineno-0-390></a><a href=#__codelineno-0-390><span class=linenos data-linenos="390 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-391 name=__codelineno-0-391></a><a href=#__codelineno-0-391><span class=linenos data-linenos="391 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>heaviside</span><span class=p>(</span>
<a id=__codelineno-0-392 name=__codelineno-0-392></a><a href=#__codelineno-0-392><span class=linenos data-linenos="392 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-393 name=__codelineno-0-393></a><a href=#__codelineno-0-393><span class=linenos data-linenos="393 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-394 name=__codelineno-0-394></a><a href=#__codelineno-0-394><span class=linenos data-linenos="394 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-395 name=__codelineno-0-395></a><a href=#__codelineno-0-395><span class=linenos data-linenos="395 "></span></a>        <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-396 name=__codelineno-0-396></a><a href=#__codelineno-0-396><span class=linenos data-linenos="396 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-397 name=__codelineno-0-397></a><a href=#__codelineno-0-397><span class=linenos data-linenos="397 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Heaviside step function.</span>
<a id=__codelineno-0-398 name=__codelineno-0-398></a><a href=#__codelineno-0-398><span class=linenos data-linenos="398 "></span></a>
<a id=__codelineno-0-399 name=__codelineno-0-399></a><a href=#__codelineno-0-399><span class=linenos data-linenos="399 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-400 name=__codelineno-0-400></a><a href=#__codelineno-0-400><span class=linenos data-linenos="400 "></span></a><span class=sd>        f(x) = \begin{cases}</span>
<a id=__codelineno-0-401 name=__codelineno-0-401></a><a href=#__codelineno-0-401><span class=linenos data-linenos="401 "></span></a><span class=sd>        0 &amp; x &lt; 0 \\</span>
<a id=__codelineno-0-402 name=__codelineno-0-402></a><a href=#__codelineno-0-402><span class=linenos data-linenos="402 "></span></a><span class=sd>        0.5 &amp; x = 0 \\</span>
<a id=__codelineno-0-403 name=__codelineno-0-403></a><a href=#__codelineno-0-403><span class=linenos data-linenos="403 "></span></a><span class=sd>        1 &amp; x &gt; 0</span>
<a id=__codelineno-0-404 name=__codelineno-0-404></a><a href=#__codelineno-0-404><span class=linenos data-linenos="404 "></span></a><span class=sd>        \end{cases}</span>
<a id=__codelineno-0-405 name=__codelineno-0-405></a><a href=#__codelineno-0-405><span class=linenos data-linenos="405 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-406 name=__codelineno-0-406></a><a href=#__codelineno-0-406><span class=linenos data-linenos="406 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-407 name=__codelineno-0-407></a><a href=#__codelineno-0-407><span class=linenos data-linenos="407 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-408 name=__codelineno-0-408></a><a href=#__codelineno-0-408><span class=linenos data-linenos="408 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the Heaviside step function.</span>
<a id=__codelineno-0-409 name=__codelineno-0-409></a><a href=#__codelineno-0-409><span class=linenos data-linenos="409 "></span></a><span class=sd>                    Defaults to 1.0.</span>
<a id=__codelineno-0-410 name=__codelineno-0-410></a><a href=#__codelineno-0-410><span class=linenos data-linenos="410 "></span></a><span class=sd>            center (float, optional): Center of the Heaviside step function.</span>
<a id=__codelineno-0-411 name=__codelineno-0-411></a><a href=#__codelineno-0-411><span class=linenos data-linenos="411 "></span></a><span class=sd>                 Defaults to 0.0.</span>
<a id=__codelineno-0-412 name=__codelineno-0-412></a><a href=#__codelineno-0-412><span class=linenos data-linenos="412 "></span></a><span class=sd>            sigma (float, optional): Sigma of the Heaviside step function.</span>
<a id=__codelineno-0-413 name=__codelineno-0-413></a><a href=#__codelineno-0-413><span class=linenos data-linenos="413 "></span></a><span class=sd>                 Defaults to 1.0.</span>
<a id=__codelineno-0-414 name=__codelineno-0-414></a><a href=#__codelineno-0-414><span class=linenos data-linenos="414 "></span></a>
<a id=__codelineno-0-415 name=__codelineno-0-415></a><a href=#__codelineno-0-415><span class=linenos data-linenos="415 "></span></a>
<a id=__codelineno-0-416 name=__codelineno-0-416></a><a href=#__codelineno-0-416><span class=linenos data-linenos="416 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-417 name=__codelineno-0-417></a><a href=#__codelineno-0-417><span class=linenos data-linenos="417 "></span></a><span class=sd>            NDArray[np.float64]: Heaviside step function of `x` given.</span>
<a id=__codelineno-0-418 name=__codelineno-0-418></a><a href=#__codelineno-0-418><span class=linenos data-linenos="418 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-419 name=__codelineno-0-419></a><a href=#__codelineno-0-419><span class=linenos data-linenos="419 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-420 name=__codelineno-0-420></a><a href=#__codelineno-0-420><span class=linenos data-linenos="420 "></span></a>            <span class=n>amplitude</span> <span class=o>*</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>sign</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)))</span>
<a id=__codelineno-0-421 name=__codelineno-0-421></a><a href=#__codelineno-0-421><span class=linenos data-linenos="421 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-422 name=__codelineno-0-422></a><a href=#__codelineno-0-422><span class=linenos data-linenos="422 "></span></a>
<a id=__codelineno-0-423 name=__codelineno-0-423></a><a href=#__codelineno-0-423><span class=linenos data-linenos="423 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-424 name=__codelineno-0-424></a><a href=#__codelineno-0-424><span class=linenos data-linenos="424 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>atan</span><span class=p>(</span>
<a id=__codelineno-0-425 name=__codelineno-0-425></a><a href=#__codelineno-0-425><span class=linenos data-linenos="425 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-426 name=__codelineno-0-426></a><a href=#__codelineno-0-426><span class=linenos data-linenos="426 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-427 name=__codelineno-0-427></a><a href=#__codelineno-0-427><span class=linenos data-linenos="427 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-428 name=__codelineno-0-428></a><a href=#__codelineno-0-428><span class=linenos data-linenos="428 "></span></a>        <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-429 name=__codelineno-0-429></a><a href=#__codelineno-0-429><span class=linenos data-linenos="429 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-430 name=__codelineno-0-430></a><a href=#__codelineno-0-430><span class=linenos data-linenos="430 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional arctan step function.</span>
<a id=__codelineno-0-431 name=__codelineno-0-431></a><a href=#__codelineno-0-431><span class=linenos data-linenos="431 "></span></a>
<a id=__codelineno-0-432 name=__codelineno-0-432></a><a href=#__codelineno-0-432><span class=linenos data-linenos="432 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-433 name=__codelineno-0-433></a><a href=#__codelineno-0-433><span class=linenos data-linenos="433 "></span></a><span class=sd>        f(x) = \frac{1}{\pi} \arctan(\frac{x - c}{s})</span>
<a id=__codelineno-0-434 name=__codelineno-0-434></a><a href=#__codelineno-0-434><span class=linenos data-linenos="434 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-435 name=__codelineno-0-435></a><a href=#__codelineno-0-435><span class=linenos data-linenos="435 "></span></a>
<a id=__codelineno-0-436 name=__codelineno-0-436></a><a href=#__codelineno-0-436><span class=linenos data-linenos="436 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-437 name=__codelineno-0-437></a><a href=#__codelineno-0-437><span class=linenos data-linenos="437 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-438 name=__codelineno-0-438></a><a href=#__codelineno-0-438><span class=linenos data-linenos="438 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the arctan step function.</span>
<a id=__codelineno-0-439 name=__codelineno-0-439></a><a href=#__codelineno-0-439><span class=linenos data-linenos="439 "></span></a><span class=sd>                    Defaults to 1.0.</span>
<a id=__codelineno-0-440 name=__codelineno-0-440></a><a href=#__codelineno-0-440><span class=linenos data-linenos="440 "></span></a><span class=sd>            center (float, optional): Center of the arctan step function.</span>
<a id=__codelineno-0-441 name=__codelineno-0-441></a><a href=#__codelineno-0-441><span class=linenos data-linenos="441 "></span></a><span class=sd>                 Defaults to 0.0.</span>
<a id=__codelineno-0-442 name=__codelineno-0-442></a><a href=#__codelineno-0-442><span class=linenos data-linenos="442 "></span></a><span class=sd>            sigma (float, optional): Sigma of the arctan step function.</span>
<a id=__codelineno-0-443 name=__codelineno-0-443></a><a href=#__codelineno-0-443><span class=linenos data-linenos="443 "></span></a><span class=sd>                 Defaults to 1.0.</span>
<a id=__codelineno-0-444 name=__codelineno-0-444></a><a href=#__codelineno-0-444><span class=linenos data-linenos="444 "></span></a>
<a id=__codelineno-0-445 name=__codelineno-0-445></a><a href=#__codelineno-0-445><span class=linenos data-linenos="445 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-446 name=__codelineno-0-446></a><a href=#__codelineno-0-446><span class=linenos data-linenos="446 "></span></a><span class=sd>            NDArray[np.float64]: Arctan step function of `x` given.</span>
<a id=__codelineno-0-447 name=__codelineno-0-447></a><a href=#__codelineno-0-447><span class=linenos data-linenos="447 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-448 name=__codelineno-0-448></a><a href=#__codelineno-0-448><span class=linenos data-linenos="448 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-449 name=__codelineno-0-449></a><a href=#__codelineno-0-449><span class=linenos data-linenos="449 "></span></a>            <span class=n>amplitude</span>
<a id=__codelineno-0-450 name=__codelineno-0-450></a><a href=#__codelineno-0-450><span class=linenos data-linenos="450 "></span></a>            <span class=o>*</span> <span class=mf>0.5</span>
<a id=__codelineno-0-451 name=__codelineno-0-451></a><a href=#__codelineno-0-451><span class=linenos data-linenos="451 "></span></a>            <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>/</span> <span class=n>pi</span><span class=p>)</span>
<a id=__codelineno-0-452 name=__codelineno-0-452></a><a href=#__codelineno-0-452><span class=linenos data-linenos="452 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-453 name=__codelineno-0-453></a><a href=#__codelineno-0-453><span class=linenos data-linenos="453 "></span></a>
<a id=__codelineno-0-454 name=__codelineno-0-454></a><a href=#__codelineno-0-454><span class=linenos data-linenos="454 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-455 name=__codelineno-0-455></a><a href=#__codelineno-0-455><span class=linenos data-linenos="455 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>log</span><span class=p>(</span>
<a id=__codelineno-0-456 name=__codelineno-0-456></a><a href=#__codelineno-0-456><span class=linenos data-linenos="456 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-457 name=__codelineno-0-457></a><a href=#__codelineno-0-457><span class=linenos data-linenos="457 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-458 name=__codelineno-0-458></a><a href=#__codelineno-0-458><span class=linenos data-linenos="458 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-459 name=__codelineno-0-459></a><a href=#__codelineno-0-459><span class=linenos data-linenos="459 "></span></a>        <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-460 name=__codelineno-0-460></a><a href=#__codelineno-0-460><span class=linenos data-linenos="460 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-461 name=__codelineno-0-461></a><a href=#__codelineno-0-461><span class=linenos data-linenos="461 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional logarithmic step function.</span>
<a id=__codelineno-0-462 name=__codelineno-0-462></a><a href=#__codelineno-0-462><span class=linenos data-linenos="462 "></span></a>
<a id=__codelineno-0-463 name=__codelineno-0-463></a><a href=#__codelineno-0-463><span class=linenos data-linenos="463 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-464 name=__codelineno-0-464></a><a href=#__codelineno-0-464><span class=linenos data-linenos="464 "></span></a><span class=sd>        f(x) = \frac{1}{1 + e^{-\frac{x - c}{s}}}</span>
<a id=__codelineno-0-465 name=__codelineno-0-465></a><a href=#__codelineno-0-465><span class=linenos data-linenos="465 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-466 name=__codelineno-0-466></a><a href=#__codelineno-0-466><span class=linenos data-linenos="466 "></span></a>
<a id=__codelineno-0-467 name=__codelineno-0-467></a><a href=#__codelineno-0-467><span class=linenos data-linenos="467 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-468 name=__codelineno-0-468></a><a href=#__codelineno-0-468><span class=linenos data-linenos="468 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-469 name=__codelineno-0-469></a><a href=#__codelineno-0-469><span class=linenos data-linenos="469 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the logarithmic step function.</span>
<a id=__codelineno-0-470 name=__codelineno-0-470></a><a href=#__codelineno-0-470><span class=linenos data-linenos="470 "></span></a><span class=sd>                    Defaults to 1.0.</span>
<a id=__codelineno-0-471 name=__codelineno-0-471></a><a href=#__codelineno-0-471><span class=linenos data-linenos="471 "></span></a><span class=sd>            center (float, optional): Center of the logarithmic step function.</span>
<a id=__codelineno-0-472 name=__codelineno-0-472></a><a href=#__codelineno-0-472><span class=linenos data-linenos="472 "></span></a><span class=sd>                 Defaults to 0.0.</span>
<a id=__codelineno-0-473 name=__codelineno-0-473></a><a href=#__codelineno-0-473><span class=linenos data-linenos="473 "></span></a><span class=sd>            sigma (float, optional): Sigma of the logarithmic step function.</span>
<a id=__codelineno-0-474 name=__codelineno-0-474></a><a href=#__codelineno-0-474><span class=linenos data-linenos="474 "></span></a><span class=sd>                 Defaults to 1.0.</span>
<a id=__codelineno-0-475 name=__codelineno-0-475></a><a href=#__codelineno-0-475><span class=linenos data-linenos="475 "></span></a>
<a id=__codelineno-0-476 name=__codelineno-0-476></a><a href=#__codelineno-0-476><span class=linenos data-linenos="476 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-477 name=__codelineno-0-477></a><a href=#__codelineno-0-477><span class=linenos data-linenos="477 "></span></a><span class=sd>            NDArray[np.float64]: Logarithmic step function of `x` given.</span>
<a id=__codelineno-0-478 name=__codelineno-0-478></a><a href=#__codelineno-0-478><span class=linenos data-linenos="478 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-479 name=__codelineno-0-479></a><a href=#__codelineno-0-479><span class=linenos data-linenos="479 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-480 name=__codelineno-0-480></a><a href=#__codelineno-0-480><span class=linenos data-linenos="480 "></span></a>            <span class=n>amplitude</span>
<a id=__codelineno-0-481 name=__codelineno-0-481></a><a href=#__codelineno-0-481><span class=linenos data-linenos="481 "></span></a>            <span class=o>*</span> <span class=mf>0.5</span>
<a id=__codelineno-0-482 name=__codelineno-0-482></a><a href=#__codelineno-0-482><span class=linenos data-linenos="482 "></span></a>            <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>/</span> <span class=n>pi</span><span class=p>)</span>
<a id=__codelineno-0-483 name=__codelineno-0-483></a><a href=#__codelineno-0-483><span class=linenos data-linenos="483 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-484 name=__codelineno-0-484></a><a href=#__codelineno-0-484><span class=linenos data-linenos="484 "></span></a>
<a id=__codelineno-0-485 name=__codelineno-0-485></a><a href=#__codelineno-0-485><span class=linenos data-linenos="485 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-486 name=__codelineno-0-486></a><a href=#__codelineno-0-486><span class=linenos data-linenos="486 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>cgaussian</span><span class=p>(</span>
<a id=__codelineno-0-487 name=__codelineno-0-487></a><a href=#__codelineno-0-487><span class=linenos data-linenos="487 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-488 name=__codelineno-0-488></a><a href=#__codelineno-0-488><span class=linenos data-linenos="488 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-489 name=__codelineno-0-489></a><a href=#__codelineno-0-489><span class=linenos data-linenos="489 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-490 name=__codelineno-0-490></a><a href=#__codelineno-0-490><span class=linenos data-linenos="490 "></span></a>        <span class=n>fwhmg</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-491 name=__codelineno-0-491></a><a href=#__codelineno-0-491><span class=linenos data-linenos="491 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-492 name=__codelineno-0-492></a><a href=#__codelineno-0-492><span class=linenos data-linenos="492 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional cumulative Gaussian function.</span>
<a id=__codelineno-0-493 name=__codelineno-0-493></a><a href=#__codelineno-0-493><span class=linenos data-linenos="493 "></span></a>
<a id=__codelineno-0-494 name=__codelineno-0-494></a><a href=#__codelineno-0-494><span class=linenos data-linenos="494 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-495 name=__codelineno-0-495></a><a href=#__codelineno-0-495><span class=linenos data-linenos="495 "></span></a><span class=sd>        f(x) = \frac{1}{2} \left[1 + erf\left(\frac{x - c}{s \sqrt{2}}\right)\right]</span>
<a id=__codelineno-0-496 name=__codelineno-0-496></a><a href=#__codelineno-0-496><span class=linenos data-linenos="496 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-497 name=__codelineno-0-497></a><a href=#__codelineno-0-497><span class=linenos data-linenos="497 "></span></a>
<a id=__codelineno-0-498 name=__codelineno-0-498></a><a href=#__codelineno-0-498><span class=linenos data-linenos="498 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-499 name=__codelineno-0-499></a><a href=#__codelineno-0-499><span class=linenos data-linenos="499 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-500 name=__codelineno-0-500></a><a href=#__codelineno-0-500><span class=linenos data-linenos="500 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the Gaussian function. Defaults to</span>
<a id=__codelineno-0-501 name=__codelineno-0-501></a><a href=#__codelineno-0-501><span class=linenos data-linenos="501 "></span></a><span class=sd>                1.0.</span>
<a id=__codelineno-0-502 name=__codelineno-0-502></a><a href=#__codelineno-0-502><span class=linenos data-linenos="502 "></span></a><span class=sd>            center (float, optional): Center of the Gaussian function. Defaults to 0.0.</span>
<a id=__codelineno-0-503 name=__codelineno-0-503></a><a href=#__codelineno-0-503><span class=linenos data-linenos="503 "></span></a><span class=sd>            fwhmg (float, optional): Full width at half maximum of the Gaussian</span>
<a id=__codelineno-0-504 name=__codelineno-0-504></a><a href=#__codelineno-0-504><span class=linenos data-linenos="504 "></span></a><span class=sd>                 function. Defaults to 1.0.</span>
<a id=__codelineno-0-505 name=__codelineno-0-505></a><a href=#__codelineno-0-505><span class=linenos data-linenos="505 "></span></a>
<a id=__codelineno-0-506 name=__codelineno-0-506></a><a href=#__codelineno-0-506><span class=linenos data-linenos="506 "></span></a>
<a id=__codelineno-0-507 name=__codelineno-0-507></a><a href=#__codelineno-0-507><span class=linenos data-linenos="507 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-508 name=__codelineno-0-508></a><a href=#__codelineno-0-508><span class=linenos data-linenos="508 "></span></a><span class=sd>            NDArray[np.float64]: Cumulative Gaussian function of `x` given.</span>
<a id=__codelineno-0-509 name=__codelineno-0-509></a><a href=#__codelineno-0-509><span class=linenos data-linenos="509 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-510 name=__codelineno-0-510></a><a href=#__codelineno-0-510><span class=linenos data-linenos="510 "></span></a>        <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmg</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmg2sig</span>
<a id=__codelineno-0-511 name=__codelineno-0-511></a><a href=#__codelineno-0-511><span class=linenos data-linenos="511 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-512 name=__codelineno-0-512></a><a href=#__codelineno-0-512><span class=linenos data-linenos="512 "></span></a>            <span class=n>amplitude</span> <span class=o>*</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>erf</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mf>2.0</span><span class=p>))))</span>
<a id=__codelineno-0-513 name=__codelineno-0-513></a><a href=#__codelineno-0-513><span class=linenos data-linenos="513 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-514 name=__codelineno-0-514></a><a href=#__codelineno-0-514><span class=linenos data-linenos="514 "></span></a>
<a id=__codelineno-0-515 name=__codelineno-0-515></a><a href=#__codelineno-0-515><span class=linenos data-linenos="515 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-516 name=__codelineno-0-516></a><a href=#__codelineno-0-516><span class=linenos data-linenos="516 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>clorentzian</span><span class=p>(</span>
<a id=__codelineno-0-517 name=__codelineno-0-517></a><a href=#__codelineno-0-517><span class=linenos data-linenos="517 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-518 name=__codelineno-0-518></a><a href=#__codelineno-0-518><span class=linenos data-linenos="518 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-519 name=__codelineno-0-519></a><a href=#__codelineno-0-519><span class=linenos data-linenos="519 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-520 name=__codelineno-0-520></a><a href=#__codelineno-0-520><span class=linenos data-linenos="520 "></span></a>        <span class=n>fwhml</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-521 name=__codelineno-0-521></a><a href=#__codelineno-0-521><span class=linenos data-linenos="521 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-522 name=__codelineno-0-522></a><a href=#__codelineno-0-522><span class=linenos data-linenos="522 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional cumulative Lorentzian function.</span>
<a id=__codelineno-0-523 name=__codelineno-0-523></a><a href=#__codelineno-0-523><span class=linenos data-linenos="523 "></span></a>
<a id=__codelineno-0-524 name=__codelineno-0-524></a><a href=#__codelineno-0-524><span class=linenos data-linenos="524 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-525 name=__codelineno-0-525></a><a href=#__codelineno-0-525><span class=linenos data-linenos="525 "></span></a><span class=sd>        f(x) = \frac{1}{\pi} \arctan\left(\frac{x - c}{s}\right) + \frac{1}{2}</span>
<a id=__codelineno-0-526 name=__codelineno-0-526></a><a href=#__codelineno-0-526><span class=linenos data-linenos="526 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-527 name=__codelineno-0-527></a><a href=#__codelineno-0-527><span class=linenos data-linenos="527 "></span></a>
<a id=__codelineno-0-528 name=__codelineno-0-528></a><a href=#__codelineno-0-528><span class=linenos data-linenos="528 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-529 name=__codelineno-0-529></a><a href=#__codelineno-0-529><span class=linenos data-linenos="529 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-530 name=__codelineno-0-530></a><a href=#__codelineno-0-530><span class=linenos data-linenos="530 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the Lorentzian function.</span>
<a id=__codelineno-0-531 name=__codelineno-0-531></a><a href=#__codelineno-0-531><span class=linenos data-linenos="531 "></span></a><span class=sd>                    Defaults to 1.0.</span>
<a id=__codelineno-0-532 name=__codelineno-0-532></a><a href=#__codelineno-0-532><span class=linenos data-linenos="532 "></span></a><span class=sd>            center (float, optional): Center of the Lorentzian function.</span>
<a id=__codelineno-0-533 name=__codelineno-0-533></a><a href=#__codelineno-0-533><span class=linenos data-linenos="533 "></span></a><span class=sd>                 Defaults to 0.0.</span>
<a id=__codelineno-0-534 name=__codelineno-0-534></a><a href=#__codelineno-0-534><span class=linenos data-linenos="534 "></span></a><span class=sd>            fwhml (float, optional): Full width at half maximum of the Lorentzian</span>
<a id=__codelineno-0-535 name=__codelineno-0-535></a><a href=#__codelineno-0-535><span class=linenos data-linenos="535 "></span></a><span class=sd>                function. Defaults to 1.0.</span>
<a id=__codelineno-0-536 name=__codelineno-0-536></a><a href=#__codelineno-0-536><span class=linenos data-linenos="536 "></span></a>
<a id=__codelineno-0-537 name=__codelineno-0-537></a><a href=#__codelineno-0-537><span class=linenos data-linenos="537 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-538 name=__codelineno-0-538></a><a href=#__codelineno-0-538><span class=linenos data-linenos="538 "></span></a><span class=sd>            NDArray[np.float64]: Cumulative Lorentzian function of `x` given.</span>
<a id=__codelineno-0-539 name=__codelineno-0-539></a><a href=#__codelineno-0-539><span class=linenos data-linenos="539 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-540 name=__codelineno-0-540></a><a href=#__codelineno-0-540><span class=linenos data-linenos="540 "></span></a>        <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhml</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhml2sig</span>
<a id=__codelineno-0-541 name=__codelineno-0-541></a><a href=#__codelineno-0-541><span class=linenos data-linenos="541 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>*</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>)</span> <span class=o>/</span> <span class=n>pi</span><span class=p>)</span> <span class=o>+</span> <span class=mf>0.5</span><span class=p>)</span>
<a id=__codelineno-0-542 name=__codelineno-0-542></a><a href=#__codelineno-0-542><span class=linenos data-linenos="542 "></span></a>
<a id=__codelineno-0-543 name=__codelineno-0-543></a><a href=#__codelineno-0-543><span class=linenos data-linenos="543 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-544 name=__codelineno-0-544></a><a href=#__codelineno-0-544><span class=linenos data-linenos="544 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>cvoigt</span><span class=p>(</span>
<a id=__codelineno-0-545 name=__codelineno-0-545></a><a href=#__codelineno-0-545><span class=linenos data-linenos="545 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-546 name=__codelineno-0-546></a><a href=#__codelineno-0-546><span class=linenos data-linenos="546 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-547 name=__codelineno-0-547></a><a href=#__codelineno-0-547><span class=linenos data-linenos="547 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-548 name=__codelineno-0-548></a><a href=#__codelineno-0-548><span class=linenos data-linenos="548 "></span></a>        <span class=n>fwhmv</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-549 name=__codelineno-0-549></a><a href=#__codelineno-0-549><span class=linenos data-linenos="549 "></span></a>        <span class=n>gamma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-550 name=__codelineno-0-550></a><a href=#__codelineno-0-550><span class=linenos data-linenos="550 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-551 name=__codelineno-0-551></a><a href=#__codelineno-0-551><span class=linenos data-linenos="551 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional cumulative Voigt function.</span>
<a id=__codelineno-0-552 name=__codelineno-0-552></a><a href=#__codelineno-0-552><span class=linenos data-linenos="552 "></span></a>
<a id=__codelineno-0-553 name=__codelineno-0-553></a><a href=#__codelineno-0-553><span class=linenos data-linenos="553 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-554 name=__codelineno-0-554></a><a href=#__codelineno-0-554><span class=linenos data-linenos="554 "></span></a><span class=sd>        f(x) = \frac{1}{2} \left[1 + erf\left(\frac{x - c}{s \sqrt{2}}\right)\right]</span>
<a id=__codelineno-0-555 name=__codelineno-0-555></a><a href=#__codelineno-0-555><span class=linenos data-linenos="555 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-556 name=__codelineno-0-556></a><a href=#__codelineno-0-556><span class=linenos data-linenos="556 "></span></a>
<a id=__codelineno-0-557 name=__codelineno-0-557></a><a href=#__codelineno-0-557><span class=linenos data-linenos="557 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-558 name=__codelineno-0-558></a><a href=#__codelineno-0-558><span class=linenos data-linenos="558 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-559 name=__codelineno-0-559></a><a href=#__codelineno-0-559><span class=linenos data-linenos="559 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the Voigt function. Defaults to</span>
<a id=__codelineno-0-560 name=__codelineno-0-560></a><a href=#__codelineno-0-560><span class=linenos data-linenos="560 "></span></a><span class=sd>                1.0.</span>
<a id=__codelineno-0-561 name=__codelineno-0-561></a><a href=#__codelineno-0-561><span class=linenos data-linenos="561 "></span></a><span class=sd>            center (float, optional): Center of the Voigt function. Defaults to 0.0.</span>
<a id=__codelineno-0-562 name=__codelineno-0-562></a><a href=#__codelineno-0-562><span class=linenos data-linenos="562 "></span></a><span class=sd>            fwhmv (float, optional): Full width at half maximum of the Voigt function.</span>
<a id=__codelineno-0-563 name=__codelineno-0-563></a><a href=#__codelineno-0-563><span class=linenos data-linenos="563 "></span></a><span class=sd>                Defaults to 1.0.</span>
<a id=__codelineno-0-564 name=__codelineno-0-564></a><a href=#__codelineno-0-564><span class=linenos data-linenos="564 "></span></a><span class=sd>            gamma (float, optional): Gamma of the Voigt function. Defaults to 1.0.</span>
<a id=__codelineno-0-565 name=__codelineno-0-565></a><a href=#__codelineno-0-565><span class=linenos data-linenos="565 "></span></a>
<a id=__codelineno-0-566 name=__codelineno-0-566></a><a href=#__codelineno-0-566><span class=linenos data-linenos="566 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-567 name=__codelineno-0-567></a><a href=#__codelineno-0-567><span class=linenos data-linenos="567 "></span></a><span class=sd>            NDArray[np.float64]: Cumulative Voigt function of `x` given.</span>
<a id=__codelineno-0-568 name=__codelineno-0-568></a><a href=#__codelineno-0-568><span class=linenos data-linenos="568 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-569 name=__codelineno-0-569></a><a href=#__codelineno-0-569><span class=linenos data-linenos="569 "></span></a>        <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmv</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmv2sig</span>
<a id=__codelineno-0-570 name=__codelineno-0-570></a><a href=#__codelineno-0-570><span class=linenos data-linenos="570 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-571 name=__codelineno-0-571></a><a href=#__codelineno-0-571><span class=linenos data-linenos="571 "></span></a>            <span class=n>amplitude</span>
<a id=__codelineno-0-572 name=__codelineno-0-572></a><a href=#__codelineno-0-572><span class=linenos data-linenos="572 "></span></a>            <span class=o>*</span> <span class=mf>0.5</span>
<a id=__codelineno-0-573 name=__codelineno-0-573></a><a href=#__codelineno-0-573><span class=linenos data-linenos="573 "></span></a>            <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>erf</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mf>2.0</span><span class=p>))))</span>
<a id=__codelineno-0-574 name=__codelineno-0-574></a><a href=#__codelineno-0-574><span class=linenos data-linenos="574 "></span></a>            <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=p>(((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>gamma</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
<a id=__codelineno-0-575 name=__codelineno-0-575></a><a href=#__codelineno-0-575><span class=linenos data-linenos="575 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-576 name=__codelineno-0-576></a><a href=#__codelineno-0-576><span class=linenos data-linenos="576 "></span></a>
<a id=__codelineno-0-577 name=__codelineno-0-577></a><a href=#__codelineno-0-577><span class=linenos data-linenos="577 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-578 name=__codelineno-0-578></a><a href=#__codelineno-0-578><span class=linenos data-linenos="578 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>polynom2</span><span class=p>(</span>
<a id=__codelineno-0-579 name=__codelineno-0-579></a><a href=#__codelineno-0-579><span class=linenos data-linenos="579 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-580 name=__codelineno-0-580></a><a href=#__codelineno-0-580><span class=linenos data-linenos="580 "></span></a>        <span class=n>coefficient0</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-581 name=__codelineno-0-581></a><a href=#__codelineno-0-581><span class=linenos data-linenos="581 "></span></a>        <span class=n>coefficient1</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-582 name=__codelineno-0-582></a><a href=#__codelineno-0-582><span class=linenos data-linenos="582 "></span></a>        <span class=n>coefficient2</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-583 name=__codelineno-0-583></a><a href=#__codelineno-0-583><span class=linenos data-linenos="583 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-584 name=__codelineno-0-584></a><a href=#__codelineno-0-584><span class=linenos data-linenos="584 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional second order polynomial function.</span>
<a id=__codelineno-0-585 name=__codelineno-0-585></a><a href=#__codelineno-0-585><span class=linenos data-linenos="585 "></span></a>
<a id=__codelineno-0-586 name=__codelineno-0-586></a><a href=#__codelineno-0-586><span class=linenos data-linenos="586 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-587 name=__codelineno-0-587></a><a href=#__codelineno-0-587><span class=linenos data-linenos="587 "></span></a><span class=sd>        f(x) = c_2 x^2 + c_1 x + c_0</span>
<a id=__codelineno-0-588 name=__codelineno-0-588></a><a href=#__codelineno-0-588><span class=linenos data-linenos="588 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-589 name=__codelineno-0-589></a><a href=#__codelineno-0-589><span class=linenos data-linenos="589 "></span></a>
<a id=__codelineno-0-590 name=__codelineno-0-590></a><a href=#__codelineno-0-590><span class=linenos data-linenos="590 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-591 name=__codelineno-0-591></a><a href=#__codelineno-0-591><span class=linenos data-linenos="591 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data</span>
<a id=__codelineno-0-592 name=__codelineno-0-592></a><a href=#__codelineno-0-592><span class=linenos data-linenos="592 "></span></a><span class=sd>            coefficient0 (float, optional): Zeroth coefficient of the</span>
<a id=__codelineno-0-593 name=__codelineno-0-593></a><a href=#__codelineno-0-593><span class=linenos data-linenos="593 "></span></a><span class=sd>                 polynomial function. Defaults to 1.0.</span>
<a id=__codelineno-0-594 name=__codelineno-0-594></a><a href=#__codelineno-0-594><span class=linenos data-linenos="594 "></span></a><span class=sd>            coefficient1 (float, optional): First coefficient of the</span>
<a id=__codelineno-0-595 name=__codelineno-0-595></a><a href=#__codelineno-0-595><span class=linenos data-linenos="595 "></span></a><span class=sd>                 polynomial function. Defaults to 1.0.</span>
<a id=__codelineno-0-596 name=__codelineno-0-596></a><a href=#__codelineno-0-596><span class=linenos data-linenos="596 "></span></a><span class=sd>            coefficient2 (float, optional): Second coefficient of the</span>
<a id=__codelineno-0-597 name=__codelineno-0-597></a><a href=#__codelineno-0-597><span class=linenos data-linenos="597 "></span></a><span class=sd>                 polynomial function. Defaults to 1.0.</span>
<a id=__codelineno-0-598 name=__codelineno-0-598></a><a href=#__codelineno-0-598><span class=linenos data-linenos="598 "></span></a>
<a id=__codelineno-0-599 name=__codelineno-0-599></a><a href=#__codelineno-0-599><span class=linenos data-linenos="599 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-600 name=__codelineno-0-600></a><a href=#__codelineno-0-600><span class=linenos data-linenos="600 "></span></a><span class=sd>            NDArray[np.float64]: Third order polynomial function of `x`</span>
<a id=__codelineno-0-601 name=__codelineno-0-601></a><a href=#__codelineno-0-601><span class=linenos data-linenos="601 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-602 name=__codelineno-0-602></a><a href=#__codelineno-0-602><span class=linenos data-linenos="602 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>coefficient0</span> <span class=o>+</span> <span class=n>coefficient1</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=n>coefficient2</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-0-603 name=__codelineno-0-603></a><a href=#__codelineno-0-603><span class=linenos data-linenos="603 "></span></a>
<a id=__codelineno-0-604 name=__codelineno-0-604></a><a href=#__codelineno-0-604><span class=linenos data-linenos="604 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-605 name=__codelineno-0-605></a><a href=#__codelineno-0-605><span class=linenos data-linenos="605 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>polynom3</span><span class=p>(</span>
<a id=__codelineno-0-606 name=__codelineno-0-606></a><a href=#__codelineno-0-606><span class=linenos data-linenos="606 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-607 name=__codelineno-0-607></a><a href=#__codelineno-0-607><span class=linenos data-linenos="607 "></span></a>        <span class=n>coefficient0</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-608 name=__codelineno-0-608></a><a href=#__codelineno-0-608><span class=linenos data-linenos="608 "></span></a>        <span class=n>coefficient1</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-609 name=__codelineno-0-609></a><a href=#__codelineno-0-609><span class=linenos data-linenos="609 "></span></a>        <span class=n>coefficient2</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-610 name=__codelineno-0-610></a><a href=#__codelineno-0-610><span class=linenos data-linenos="610 "></span></a>        <span class=n>coefficient3</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-611 name=__codelineno-0-611></a><a href=#__codelineno-0-611><span class=linenos data-linenos="611 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-612 name=__codelineno-0-612></a><a href=#__codelineno-0-612><span class=linenos data-linenos="612 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional third order polynomial function.</span>
<a id=__codelineno-0-613 name=__codelineno-0-613></a><a href=#__codelineno-0-613><span class=linenos data-linenos="613 "></span></a>
<a id=__codelineno-0-614 name=__codelineno-0-614></a><a href=#__codelineno-0-614><span class=linenos data-linenos="614 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-615 name=__codelineno-0-615></a><a href=#__codelineno-0-615><span class=linenos data-linenos="615 "></span></a><span class=sd>        f(x) = c_3 x^3 + c_2 x^2 + c_1 x + c_0</span>
<a id=__codelineno-0-616 name=__codelineno-0-616></a><a href=#__codelineno-0-616><span class=linenos data-linenos="616 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-617 name=__codelineno-0-617></a><a href=#__codelineno-0-617><span class=linenos data-linenos="617 "></span></a>
<a id=__codelineno-0-618 name=__codelineno-0-618></a><a href=#__codelineno-0-618><span class=linenos data-linenos="618 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-619 name=__codelineno-0-619></a><a href=#__codelineno-0-619><span class=linenos data-linenos="619 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data</span>
<a id=__codelineno-0-620 name=__codelineno-0-620></a><a href=#__codelineno-0-620><span class=linenos data-linenos="620 "></span></a><span class=sd>            coefficient0 (float, optional): Zeroth coefficient of the</span>
<a id=__codelineno-0-621 name=__codelineno-0-621></a><a href=#__codelineno-0-621><span class=linenos data-linenos="621 "></span></a><span class=sd>                 polynomial function. Defaults to 1.0.</span>
<a id=__codelineno-0-622 name=__codelineno-0-622></a><a href=#__codelineno-0-622><span class=linenos data-linenos="622 "></span></a><span class=sd>            coefficient1 (float, optional): First coefficient of the</span>
<a id=__codelineno-0-623 name=__codelineno-0-623></a><a href=#__codelineno-0-623><span class=linenos data-linenos="623 "></span></a><span class=sd>                 polynomial function. Defaults to 1.0.</span>
<a id=__codelineno-0-624 name=__codelineno-0-624></a><a href=#__codelineno-0-624><span class=linenos data-linenos="624 "></span></a><span class=sd>            coefficient2 (float, optional): Second coefficient of the</span>
<a id=__codelineno-0-625 name=__codelineno-0-625></a><a href=#__codelineno-0-625><span class=linenos data-linenos="625 "></span></a><span class=sd>                 polynomial function. Defaults to 1.0.</span>
<a id=__codelineno-0-626 name=__codelineno-0-626></a><a href=#__codelineno-0-626><span class=linenos data-linenos="626 "></span></a><span class=sd>            coefficient3 (float, optional): Third coefficient of the</span>
<a id=__codelineno-0-627 name=__codelineno-0-627></a><a href=#__codelineno-0-627><span class=linenos data-linenos="627 "></span></a><span class=sd>                 polynomial function. Defaults to 1.0.</span>
<a id=__codelineno-0-628 name=__codelineno-0-628></a><a href=#__codelineno-0-628><span class=linenos data-linenos="628 "></span></a>
<a id=__codelineno-0-629 name=__codelineno-0-629></a><a href=#__codelineno-0-629><span class=linenos data-linenos="629 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-630 name=__codelineno-0-630></a><a href=#__codelineno-0-630><span class=linenos data-linenos="630 "></span></a><span class=sd>            NDArray[np.float64]: Third order polynomial function of `x`</span>
<a id=__codelineno-0-631 name=__codelineno-0-631></a><a href=#__codelineno-0-631><span class=linenos data-linenos="631 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-632 name=__codelineno-0-632></a><a href=#__codelineno-0-632><span class=linenos data-linenos="632 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-633 name=__codelineno-0-633></a><a href=#__codelineno-0-633><span class=linenos data-linenos="633 "></span></a>            <span class=n>coefficient0</span> <span class=o>+</span> <span class=n>coefficient1</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=n>coefficient2</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span> <span class=o>+</span> <span class=n>coefficient3</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mi>3</span>
<a id=__codelineno-0-634 name=__codelineno-0-634></a><a href=#__codelineno-0-634><span class=linenos data-linenos="634 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-635 name=__codelineno-0-635></a><a href=#__codelineno-0-635><span class=linenos data-linenos="635 "></span></a>
<a id=__codelineno-0-636 name=__codelineno-0-636></a><a href=#__codelineno-0-636><span class=linenos data-linenos="636 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-637 name=__codelineno-0-637></a><a href=#__codelineno-0-637><span class=linenos data-linenos="637 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>pearson1</span><span class=p>(</span>
<a id=__codelineno-0-638 name=__codelineno-0-638></a><a href=#__codelineno-0-638><span class=linenos data-linenos="638 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-639 name=__codelineno-0-639></a><a href=#__codelineno-0-639><span class=linenos data-linenos="639 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-640 name=__codelineno-0-640></a><a href=#__codelineno-0-640><span class=linenos data-linenos="640 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-641 name=__codelineno-0-641></a><a href=#__codelineno-0-641><span class=linenos data-linenos="641 "></span></a>        <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-642 name=__codelineno-0-642></a><a href=#__codelineno-0-642><span class=linenos data-linenos="642 "></span></a>        <span class=n>exponent</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-643 name=__codelineno-0-643></a><a href=#__codelineno-0-643><span class=linenos data-linenos="643 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-644 name=__codelineno-0-644></a><a href=#__codelineno-0-644><span class=linenos data-linenos="644 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Pearson type I distribution.</span>
<a id=__codelineno-0-645 name=__codelineno-0-645></a><a href=#__codelineno-0-645><span class=linenos data-linenos="645 "></span></a>
<a id=__codelineno-0-646 name=__codelineno-0-646></a><a href=#__codelineno-0-646><span class=linenos data-linenos="646 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-647 name=__codelineno-0-647></a><a href=#__codelineno-0-647><span class=linenos data-linenos="647 "></span></a><span class=sd>        f(x) = \frac{A}{\sigma \sqrt{2 \pi}} \left[1 + \frac{(x - c)^2}{\sigma^2}</span>
<a id=__codelineno-0-648 name=__codelineno-0-648></a><a href=#__codelineno-0-648><span class=linenos data-linenos="648 "></span></a><span class=sd>        \right]^{-\frac{1}{\nu}}</span>
<a id=__codelineno-0-649 name=__codelineno-0-649></a><a href=#__codelineno-0-649><span class=linenos data-linenos="649 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-650 name=__codelineno-0-650></a><a href=#__codelineno-0-650><span class=linenos data-linenos="650 "></span></a>
<a id=__codelineno-0-651 name=__codelineno-0-651></a><a href=#__codelineno-0-651><span class=linenos data-linenos="651 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-652 name=__codelineno-0-652></a><a href=#__codelineno-0-652><span class=linenos data-linenos="652 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-653 name=__codelineno-0-653></a><a href=#__codelineno-0-653><span class=linenos data-linenos="653 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the Pearson type I function.</span>
<a id=__codelineno-0-654 name=__codelineno-0-654></a><a href=#__codelineno-0-654><span class=linenos data-linenos="654 "></span></a><span class=sd>                    Defaults to 1.0.</span>
<a id=__codelineno-0-655 name=__codelineno-0-655></a><a href=#__codelineno-0-655><span class=linenos data-linenos="655 "></span></a><span class=sd>            center (float, optional): Center of the Pearson type I function.</span>
<a id=__codelineno-0-656 name=__codelineno-0-656></a><a href=#__codelineno-0-656><span class=linenos data-linenos="656 "></span></a><span class=sd>                 Defaults to 0.0.</span>
<a id=__codelineno-0-657 name=__codelineno-0-657></a><a href=#__codelineno-0-657><span class=linenos data-linenos="657 "></span></a><span class=sd>            sigma (float, optional): Sigma of the Pearson type I function.</span>
<a id=__codelineno-0-658 name=__codelineno-0-658></a><a href=#__codelineno-0-658><span class=linenos data-linenos="658 "></span></a><span class=sd>                 Defaults to 1.0.</span>
<a id=__codelineno-0-659 name=__codelineno-0-659></a><a href=#__codelineno-0-659><span class=linenos data-linenos="659 "></span></a><span class=sd>            exponent (float, optional): Exponent of the Pearson type I function.</span>
<a id=__codelineno-0-660 name=__codelineno-0-660></a><a href=#__codelineno-0-660><span class=linenos data-linenos="660 "></span></a><span class=sd>                 Defaults to 1.0.</span>
<a id=__codelineno-0-661 name=__codelineno-0-661></a><a href=#__codelineno-0-661><span class=linenos data-linenos="661 "></span></a>
<a id=__codelineno-0-662 name=__codelineno-0-662></a><a href=#__codelineno-0-662><span class=linenos data-linenos="662 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-663 name=__codelineno-0-663></a><a href=#__codelineno-0-663><span class=linenos data-linenos="663 "></span></a><span class=sd>            NDArray[np.float64]: Pearson type I function of `x` given.</span>
<a id=__codelineno-0-664 name=__codelineno-0-664></a><a href=#__codelineno-0-664><span class=linenos data-linenos="664 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-665 name=__codelineno-0-665></a><a href=#__codelineno-0-665><span class=linenos data-linenos="665 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-666 name=__codelineno-0-666></a><a href=#__codelineno-0-666><span class=linenos data-linenos="666 "></span></a>            <span class=n>amplitude</span>
<a id=__codelineno-0-667 name=__codelineno-0-667></a><a href=#__codelineno-0-667><span class=linenos data-linenos="667 "></span></a>            <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>))</span>
<a id=__codelineno-0-668 name=__codelineno-0-668></a><a href=#__codelineno-0-668><span class=linenos data-linenos="668 "></span></a>            <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span> <span class=o>/</span> <span class=n>exponent</span><span class=p>)</span>
<a id=__codelineno-0-669 name=__codelineno-0-669></a><a href=#__codelineno-0-669><span class=linenos data-linenos="669 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-670 name=__codelineno-0-670></a><a href=#__codelineno-0-670><span class=linenos data-linenos="670 "></span></a>
<a id=__codelineno-0-671 name=__codelineno-0-671></a><a href=#__codelineno-0-671><span class=linenos data-linenos="671 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-672 name=__codelineno-0-672></a><a href=#__codelineno-0-672><span class=linenos data-linenos="672 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>pearson2</span><span class=p>(</span>
<a id=__codelineno-0-673 name=__codelineno-0-673></a><a href=#__codelineno-0-673><span class=linenos data-linenos="673 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-674 name=__codelineno-0-674></a><a href=#__codelineno-0-674><span class=linenos data-linenos="674 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-675 name=__codelineno-0-675></a><a href=#__codelineno-0-675><span class=linenos data-linenos="675 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-676 name=__codelineno-0-676></a><a href=#__codelineno-0-676><span class=linenos data-linenos="676 "></span></a>        <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-677 name=__codelineno-0-677></a><a href=#__codelineno-0-677><span class=linenos data-linenos="677 "></span></a>        <span class=n>exponent</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-678 name=__codelineno-0-678></a><a href=#__codelineno-0-678><span class=linenos data-linenos="678 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-679 name=__codelineno-0-679></a><a href=#__codelineno-0-679><span class=linenos data-linenos="679 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Pearson type II distribution.</span>
<a id=__codelineno-0-680 name=__codelineno-0-680></a><a href=#__codelineno-0-680><span class=linenos data-linenos="680 "></span></a>
<a id=__codelineno-0-681 name=__codelineno-0-681></a><a href=#__codelineno-0-681><span class=linenos data-linenos="681 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-682 name=__codelineno-0-682></a><a href=#__codelineno-0-682><span class=linenos data-linenos="682 "></span></a><span class=sd>        f(x) = \frac{A}{\sigma \sqrt{2 \pi}} \left[1 + \frac{(x - c)^2}{2 \sigma^2}</span>
<a id=__codelineno-0-683 name=__codelineno-0-683></a><a href=#__codelineno-0-683><span class=linenos data-linenos="683 "></span></a><span class=sd>        \right]^{-\nu}</span>
<a id=__codelineno-0-684 name=__codelineno-0-684></a><a href=#__codelineno-0-684><span class=linenos data-linenos="684 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-685 name=__codelineno-0-685></a><a href=#__codelineno-0-685><span class=linenos data-linenos="685 "></span></a>
<a id=__codelineno-0-686 name=__codelineno-0-686></a><a href=#__codelineno-0-686><span class=linenos data-linenos="686 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-687 name=__codelineno-0-687></a><a href=#__codelineno-0-687><span class=linenos data-linenos="687 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-688 name=__codelineno-0-688></a><a href=#__codelineno-0-688><span class=linenos data-linenos="688 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the Pearson type II function.</span>
<a id=__codelineno-0-689 name=__codelineno-0-689></a><a href=#__codelineno-0-689><span class=linenos data-linenos="689 "></span></a><span class=sd>                    Defaults to 1.0.</span>
<a id=__codelineno-0-690 name=__codelineno-0-690></a><a href=#__codelineno-0-690><span class=linenos data-linenos="690 "></span></a><span class=sd>            center (float, optional): Center of the Pearson type II function.</span>
<a id=__codelineno-0-691 name=__codelineno-0-691></a><a href=#__codelineno-0-691><span class=linenos data-linenos="691 "></span></a><span class=sd>                 Defaults to 0.0.</span>
<a id=__codelineno-0-692 name=__codelineno-0-692></a><a href=#__codelineno-0-692><span class=linenos data-linenos="692 "></span></a><span class=sd>            sigma (float, optional): Sigma of the Pearson type II function.</span>
<a id=__codelineno-0-693 name=__codelineno-0-693></a><a href=#__codelineno-0-693><span class=linenos data-linenos="693 "></span></a><span class=sd>                 Defaults to 1.0.</span>
<a id=__codelineno-0-694 name=__codelineno-0-694></a><a href=#__codelineno-0-694><span class=linenos data-linenos="694 "></span></a><span class=sd>            exponent (float, optional): Exponent of the Pearson type II function.</span>
<a id=__codelineno-0-695 name=__codelineno-0-695></a><a href=#__codelineno-0-695><span class=linenos data-linenos="695 "></span></a><span class=sd>                 Defaults to 1.0.</span>
<a id=__codelineno-0-696 name=__codelineno-0-696></a><a href=#__codelineno-0-696><span class=linenos data-linenos="696 "></span></a>
<a id=__codelineno-0-697 name=__codelineno-0-697></a><a href=#__codelineno-0-697><span class=linenos data-linenos="697 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-698 name=__codelineno-0-698></a><a href=#__codelineno-0-698><span class=linenos data-linenos="698 "></span></a><span class=sd>            NDArray[np.float64]: Pearson type II function of `x` given.</span>
<a id=__codelineno-0-699 name=__codelineno-0-699></a><a href=#__codelineno-0-699><span class=linenos data-linenos="699 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-700 name=__codelineno-0-700></a><a href=#__codelineno-0-700><span class=linenos data-linenos="700 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-701 name=__codelineno-0-701></a><a href=#__codelineno-0-701><span class=linenos data-linenos="701 "></span></a>            <span class=n>amplitude</span>
<a id=__codelineno-0-702 name=__codelineno-0-702></a><a href=#__codelineno-0-702><span class=linenos data-linenos="702 "></span></a>            <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span><span class=p>))</span>
<a id=__codelineno-0-703 name=__codelineno-0-703></a><a href=#__codelineno-0-703><span class=linenos data-linenos="703 "></span></a>            <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>**</span> <span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=n>exponent</span><span class=p>)</span>
<a id=__codelineno-0-704 name=__codelineno-0-704></a><a href=#__codelineno-0-704><span class=linenos data-linenos="704 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-705 name=__codelineno-0-705></a><a href=#__codelineno-0-705><span class=linenos data-linenos="705 "></span></a>
<a id=__codelineno-0-706 name=__codelineno-0-706></a><a href=#__codelineno-0-706><span class=linenos data-linenos="706 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-707 name=__codelineno-0-707></a><a href=#__codelineno-0-707><span class=linenos data-linenos="707 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>pearson3</span><span class=p>(</span>
<a id=__codelineno-0-708 name=__codelineno-0-708></a><a href=#__codelineno-0-708><span class=linenos data-linenos="708 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-709 name=__codelineno-0-709></a><a href=#__codelineno-0-709><span class=linenos data-linenos="709 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-710 name=__codelineno-0-710></a><a href=#__codelineno-0-710><span class=linenos data-linenos="710 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-711 name=__codelineno-0-711></a><a href=#__codelineno-0-711><span class=linenos data-linenos="711 "></span></a>        <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-712 name=__codelineno-0-712></a><a href=#__codelineno-0-712><span class=linenos data-linenos="712 "></span></a>        <span class=n>exponent</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-713 name=__codelineno-0-713></a><a href=#__codelineno-0-713><span class=linenos data-linenos="713 "></span></a>        <span class=n>skewness</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-714 name=__codelineno-0-714></a><a href=#__codelineno-0-714><span class=linenos data-linenos="714 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-715 name=__codelineno-0-715></a><a href=#__codelineno-0-715><span class=linenos data-linenos="715 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Pearson type III distribution.</span>
<a id=__codelineno-0-716 name=__codelineno-0-716></a><a href=#__codelineno-0-716><span class=linenos data-linenos="716 "></span></a>
<a id=__codelineno-0-717 name=__codelineno-0-717></a><a href=#__codelineno-0-717><span class=linenos data-linenos="717 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-718 name=__codelineno-0-718></a><a href=#__codelineno-0-718><span class=linenos data-linenos="718 "></span></a><span class=sd>        f(x) = \frac{A}{\sigma \sqrt{2 \pi}} \left[1 + \frac{(x - c)^2}{2 \sigma^2}</span>
<a id=__codelineno-0-719 name=__codelineno-0-719></a><a href=#__codelineno-0-719><span class=linenos data-linenos="719 "></span></a><span class=sd>        \right]^{-\nu} \left[1 + \frac{\gamma}{\nu}</span>
<a id=__codelineno-0-720 name=__codelineno-0-720></a><a href=#__codelineno-0-720><span class=linenos data-linenos="720 "></span></a><span class=sd>        \frac{x - c}{\sigma} \right]^{-\nu - 1}</span>
<a id=__codelineno-0-721 name=__codelineno-0-721></a><a href=#__codelineno-0-721><span class=linenos data-linenos="721 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-722 name=__codelineno-0-722></a><a href=#__codelineno-0-722><span class=linenos data-linenos="722 "></span></a>
<a id=__codelineno-0-723 name=__codelineno-0-723></a><a href=#__codelineno-0-723><span class=linenos data-linenos="723 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-724 name=__codelineno-0-724></a><a href=#__codelineno-0-724><span class=linenos data-linenos="724 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-725 name=__codelineno-0-725></a><a href=#__codelineno-0-725><span class=linenos data-linenos="725 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the Pearson type III function.</span>
<a id=__codelineno-0-726 name=__codelineno-0-726></a><a href=#__codelineno-0-726><span class=linenos data-linenos="726 "></span></a><span class=sd>                    Defaults to 1.0.</span>
<a id=__codelineno-0-727 name=__codelineno-0-727></a><a href=#__codelineno-0-727><span class=linenos data-linenos="727 "></span></a><span class=sd>            center (float, optional): Center of the Pearson type III function.</span>
<a id=__codelineno-0-728 name=__codelineno-0-728></a><a href=#__codelineno-0-728><span class=linenos data-linenos="728 "></span></a><span class=sd>                 Defaults to 0.0.</span>
<a id=__codelineno-0-729 name=__codelineno-0-729></a><a href=#__codelineno-0-729><span class=linenos data-linenos="729 "></span></a><span class=sd>            sigma (float, optional): Sigma of the Pearson type III function.</span>
<a id=__codelineno-0-730 name=__codelineno-0-730></a><a href=#__codelineno-0-730><span class=linenos data-linenos="730 "></span></a><span class=sd>                 Defaults to 1.0.</span>
<a id=__codelineno-0-731 name=__codelineno-0-731></a><a href=#__codelineno-0-731><span class=linenos data-linenos="731 "></span></a><span class=sd>            exponent (float, optional): Exponent of the Pearson type III function.</span>
<a id=__codelineno-0-732 name=__codelineno-0-732></a><a href=#__codelineno-0-732><span class=linenos data-linenos="732 "></span></a><span class=sd>                 Defaults to 1.0.</span>
<a id=__codelineno-0-733 name=__codelineno-0-733></a><a href=#__codelineno-0-733><span class=linenos data-linenos="733 "></span></a><span class=sd>            skewness (float, optional): Skewness of the Pearson type III function.</span>
<a id=__codelineno-0-734 name=__codelineno-0-734></a><a href=#__codelineno-0-734><span class=linenos data-linenos="734 "></span></a><span class=sd>                 Defaults to 0.0.</span>
<a id=__codelineno-0-735 name=__codelineno-0-735></a><a href=#__codelineno-0-735><span class=linenos data-linenos="735 "></span></a>
<a id=__codelineno-0-736 name=__codelineno-0-736></a><a href=#__codelineno-0-736><span class=linenos data-linenos="736 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-737 name=__codelineno-0-737></a><a href=#__codelineno-0-737><span class=linenos data-linenos="737 "></span></a><span class=sd>            NDArray[np.float64]: Pearson type III function of `x` given.</span>
<a id=__codelineno-0-738 name=__codelineno-0-738></a><a href=#__codelineno-0-738><span class=linenos data-linenos="738 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-739 name=__codelineno-0-739></a><a href=#__codelineno-0-739><span class=linenos data-linenos="739 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-740 name=__codelineno-0-740></a><a href=#__codelineno-0-740><span class=linenos data-linenos="740 "></span></a>            <span class=n>amplitude</span>
<a id=__codelineno-0-741 name=__codelineno-0-741></a><a href=#__codelineno-0-741><span class=linenos data-linenos="741 "></span></a>            <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span><span class=p>))</span>
<a id=__codelineno-0-742 name=__codelineno-0-742></a><a href=#__codelineno-0-742><span class=linenos data-linenos="742 "></span></a>            <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>**</span> <span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=n>exponent</span><span class=p>)</span>
<a id=__codelineno-0-743 name=__codelineno-0-743></a><a href=#__codelineno-0-743><span class=linenos data-linenos="743 "></span></a>            <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span>
<a id=__codelineno-0-744 name=__codelineno-0-744></a><a href=#__codelineno-0-744><span class=linenos data-linenos="744 "></span></a>                <span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>skewness</span> <span class=o>/</span> <span class=n>exponent</span><span class=p>)</span> <span class=o>*</span> <span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>),</span> <span class=o>-</span><span class=n>exponent</span> <span class=o>-</span> <span class=mi>1</span>
<a id=__codelineno-0-745 name=__codelineno-0-745></a><a href=#__codelineno-0-745><span class=linenos data-linenos="745 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-746 name=__codelineno-0-746></a><a href=#__codelineno-0-746><span class=linenos data-linenos="746 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-747 name=__codelineno-0-747></a><a href=#__codelineno-0-747><span class=linenos data-linenos="747 "></span></a>
<a id=__codelineno-0-748 name=__codelineno-0-748></a><a href=#__codelineno-0-748><span class=linenos data-linenos="748 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-749 name=__codelineno-0-749></a><a href=#__codelineno-0-749><span class=linenos data-linenos="749 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>pearson4</span><span class=p>(</span>
<a id=__codelineno-0-750 name=__codelineno-0-750></a><a href=#__codelineno-0-750><span class=linenos data-linenos="750 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-751 name=__codelineno-0-751></a><a href=#__codelineno-0-751><span class=linenos data-linenos="751 "></span></a>        <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-752 name=__codelineno-0-752></a><a href=#__codelineno-0-752><span class=linenos data-linenos="752 "></span></a>        <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-753 name=__codelineno-0-753></a><a href=#__codelineno-0-753><span class=linenos data-linenos="753 "></span></a>        <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-754 name=__codelineno-0-754></a><a href=#__codelineno-0-754><span class=linenos data-linenos="754 "></span></a>        <span class=n>exponent</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-755 name=__codelineno-0-755></a><a href=#__codelineno-0-755><span class=linenos data-linenos="755 "></span></a>        <span class=n>skewness</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-756 name=__codelineno-0-756></a><a href=#__codelineno-0-756><span class=linenos data-linenos="756 "></span></a>        <span class=n>kurtosis</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-757 name=__codelineno-0-757></a><a href=#__codelineno-0-757><span class=linenos data-linenos="757 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-758 name=__codelineno-0-758></a><a href=#__codelineno-0-758><span class=linenos data-linenos="758 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Pearson type IV distribution.</span>
<a id=__codelineno-0-759 name=__codelineno-0-759></a><a href=#__codelineno-0-759><span class=linenos data-linenos="759 "></span></a>
<a id=__codelineno-0-760 name=__codelineno-0-760></a><a href=#__codelineno-0-760><span class=linenos data-linenos="760 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-761 name=__codelineno-0-761></a><a href=#__codelineno-0-761><span class=linenos data-linenos="761 "></span></a><span class=sd>        f(x) = \frac{A}{\sigma \sqrt{2 \pi}} \left[1 + \frac{(x - c)^2}{2 \sigma^2}</span>
<a id=__codelineno-0-762 name=__codelineno-0-762></a><a href=#__codelineno-0-762><span class=linenos data-linenos="762 "></span></a><span class=sd>        \right]^{-\nu} \left[1 + \frac{\gamma}{\nu}</span>
<a id=__codelineno-0-763 name=__codelineno-0-763></a><a href=#__codelineno-0-763><span class=linenos data-linenos="763 "></span></a><span class=sd>        \frac{x - c}{\sigma} \right]^{-\nu - 1}</span>
<a id=__codelineno-0-764 name=__codelineno-0-764></a><a href=#__codelineno-0-764><span class=linenos data-linenos="764 "></span></a><span class=sd>        \left[1 + \frac{\delta}{\nu}</span>
<a id=__codelineno-0-765 name=__codelineno-0-765></a><a href=#__codelineno-0-765><span class=linenos data-linenos="765 "></span></a><span class=sd>        \left(\frac{x - c}{\sigma}\right)^2 \right]^{-\nu - 1/2}</span>
<a id=__codelineno-0-766 name=__codelineno-0-766></a><a href=#__codelineno-0-766><span class=linenos data-linenos="766 "></span></a><span class=sd>        $$</span>
<a id=__codelineno-0-767 name=__codelineno-0-767></a><a href=#__codelineno-0-767><span class=linenos data-linenos="767 "></span></a>
<a id=__codelineno-0-768 name=__codelineno-0-768></a><a href=#__codelineno-0-768><span class=linenos data-linenos="768 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-769 name=__codelineno-0-769></a><a href=#__codelineno-0-769><span class=linenos data-linenos="769 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-770 name=__codelineno-0-770></a><a href=#__codelineno-0-770><span class=linenos data-linenos="770 "></span></a><span class=sd>            amplitude (float, optional): Amplitude of the Pearson type IV function.</span>
<a id=__codelineno-0-771 name=__codelineno-0-771></a><a href=#__codelineno-0-771><span class=linenos data-linenos="771 "></span></a><span class=sd>                    Defaults to 1.0.</span>
<a id=__codelineno-0-772 name=__codelineno-0-772></a><a href=#__codelineno-0-772><span class=linenos data-linenos="772 "></span></a><span class=sd>            center (float, optional): Center of the Pearson type IV function.</span>
<a id=__codelineno-0-773 name=__codelineno-0-773></a><a href=#__codelineno-0-773><span class=linenos data-linenos="773 "></span></a><span class=sd>                 Defaults to 0.0.</span>
<a id=__codelineno-0-774 name=__codelineno-0-774></a><a href=#__codelineno-0-774><span class=linenos data-linenos="774 "></span></a><span class=sd>            sigma (float, optional): Sigma of the Pearson type IV function.</span>
<a id=__codelineno-0-775 name=__codelineno-0-775></a><a href=#__codelineno-0-775><span class=linenos data-linenos="775 "></span></a><span class=sd>                 Defaults to 1.0.</span>
<a id=__codelineno-0-776 name=__codelineno-0-776></a><a href=#__codelineno-0-776><span class=linenos data-linenos="776 "></span></a><span class=sd>            exponent (float, optional): Exponent of the Pearson type IV function.</span>
<a id=__codelineno-0-777 name=__codelineno-0-777></a><a href=#__codelineno-0-777><span class=linenos data-linenos="777 "></span></a><span class=sd>                 Defaults to 1.0.</span>
<a id=__codelineno-0-778 name=__codelineno-0-778></a><a href=#__codelineno-0-778><span class=linenos data-linenos="778 "></span></a><span class=sd>            skewness (float, optional): Skewness of the Pearson type IV function.</span>
<a id=__codelineno-0-779 name=__codelineno-0-779></a><a href=#__codelineno-0-779><span class=linenos data-linenos="779 "></span></a><span class=sd>                 Defaults to 0.0.</span>
<a id=__codelineno-0-780 name=__codelineno-0-780></a><a href=#__codelineno-0-780><span class=linenos data-linenos="780 "></span></a><span class=sd>            kurtosis (float, optional): Kurtosis of the Pearson type IV function.</span>
<a id=__codelineno-0-781 name=__codelineno-0-781></a><a href=#__codelineno-0-781><span class=linenos data-linenos="781 "></span></a><span class=sd>                 Defaults to 0.0.</span>
<a id=__codelineno-0-782 name=__codelineno-0-782></a><a href=#__codelineno-0-782><span class=linenos data-linenos="782 "></span></a>
<a id=__codelineno-0-783 name=__codelineno-0-783></a><a href=#__codelineno-0-783><span class=linenos data-linenos="783 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-784 name=__codelineno-0-784></a><a href=#__codelineno-0-784><span class=linenos data-linenos="784 "></span></a><span class=sd>            NDArray[np.float64]: Pearson type IV function of `x` given.</span>
<a id=__codelineno-0-785 name=__codelineno-0-785></a><a href=#__codelineno-0-785><span class=linenos data-linenos="785 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-786 name=__codelineno-0-786></a><a href=#__codelineno-0-786><span class=linenos data-linenos="786 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-787 name=__codelineno-0-787></a><a href=#__codelineno-0-787><span class=linenos data-linenos="787 "></span></a>            <span class=n>amplitude</span>
<a id=__codelineno-0-788 name=__codelineno-0-788></a><a href=#__codelineno-0-788><span class=linenos data-linenos="788 "></span></a>            <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span><span class=p>))</span>
<a id=__codelineno-0-789 name=__codelineno-0-789></a><a href=#__codelineno-0-789><span class=linenos data-linenos="789 "></span></a>            <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>**</span> <span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=n>exponent</span><span class=p>)</span>
<a id=__codelineno-0-790 name=__codelineno-0-790></a><a href=#__codelineno-0-790><span class=linenos data-linenos="790 "></span></a>            <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span>
<a id=__codelineno-0-791 name=__codelineno-0-791></a><a href=#__codelineno-0-791><span class=linenos data-linenos="791 "></span></a>                <span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>skewness</span> <span class=o>/</span> <span class=n>exponent</span><span class=p>)</span> <span class=o>*</span> <span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>),</span> <span class=o>-</span><span class=n>exponent</span> <span class=o>-</span> <span class=mi>1</span>
<a id=__codelineno-0-792 name=__codelineno-0-792></a><a href=#__codelineno-0-792><span class=linenos data-linenos="792 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-793 name=__codelineno-0-793></a><a href=#__codelineno-0-793><span class=linenos data-linenos="793 "></span></a>            <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span>
<a id=__codelineno-0-794 name=__codelineno-0-794></a><a href=#__codelineno-0-794><span class=linenos data-linenos="794 "></span></a>                <span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>kurtosis</span> <span class=o>/</span> <span class=n>exponent</span><span class=p>)</span> <span class=o>*</span> <span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-0-795 name=__codelineno-0-795></a><a href=#__codelineno-0-795><span class=linenos data-linenos="795 "></span></a>                <span class=o>-</span><span class=n>exponent</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-0-796 name=__codelineno-0-796></a><a href=#__codelineno-0-796><span class=linenos data-linenos="796 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-797 name=__codelineno-0-797></a><a href=#__codelineno-0-797><span class=linenos data-linenos="797 "></span></a>        <span class=p>)</span>
</code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.atan class="doc doc-heading"> <code class="highlight language-python"><span class=n>atan</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.atan class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional arctan step function.</p> <pre class=arithmatex>\[
f(x) = \frac{1}{\pi} \arctan(\frac{x - c}{s})
\]</pre> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the arctan step function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>center</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the arctan step function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>sigma</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Sigma of the arctan step function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Arctan step function of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-423 name=__codelineno-0-423></a><a href=#__codelineno-0-423><span class=linenos data-linenos="423 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-424 name=__codelineno-0-424></a><a href=#__codelineno-0-424><span class=linenos data-linenos="424 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>atan</span><span class=p>(</span>
<a id=__codelineno-0-425 name=__codelineno-0-425></a><a href=#__codelineno-0-425><span class=linenos data-linenos="425 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-426 name=__codelineno-0-426></a><a href=#__codelineno-0-426><span class=linenos data-linenos="426 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-427 name=__codelineno-0-427></a><a href=#__codelineno-0-427><span class=linenos data-linenos="427 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-428 name=__codelineno-0-428></a><a href=#__codelineno-0-428><span class=linenos data-linenos="428 "></span></a>    <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-429 name=__codelineno-0-429></a><a href=#__codelineno-0-429><span class=linenos data-linenos="429 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-430 name=__codelineno-0-430></a><a href=#__codelineno-0-430><span class=linenos data-linenos="430 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional arctan step function.</span>
<a id=__codelineno-0-431 name=__codelineno-0-431></a><a href=#__codelineno-0-431><span class=linenos data-linenos="431 "></span></a>
<a id=__codelineno-0-432 name=__codelineno-0-432></a><a href=#__codelineno-0-432><span class=linenos data-linenos="432 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-433 name=__codelineno-0-433></a><a href=#__codelineno-0-433><span class=linenos data-linenos="433 "></span></a><span class=sd>    f(x) = \frac{1}{\pi} \arctan(\frac{x - c}{s})</span>
<a id=__codelineno-0-434 name=__codelineno-0-434></a><a href=#__codelineno-0-434><span class=linenos data-linenos="434 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-435 name=__codelineno-0-435></a><a href=#__codelineno-0-435><span class=linenos data-linenos="435 "></span></a>
<a id=__codelineno-0-436 name=__codelineno-0-436></a><a href=#__codelineno-0-436><span class=linenos data-linenos="436 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-437 name=__codelineno-0-437></a><a href=#__codelineno-0-437><span class=linenos data-linenos="437 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-438 name=__codelineno-0-438></a><a href=#__codelineno-0-438><span class=linenos data-linenos="438 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the arctan step function.</span>
<a id=__codelineno-0-439 name=__codelineno-0-439></a><a href=#__codelineno-0-439><span class=linenos data-linenos="439 "></span></a><span class=sd>                Defaults to 1.0.</span>
<a id=__codelineno-0-440 name=__codelineno-0-440></a><a href=#__codelineno-0-440><span class=linenos data-linenos="440 "></span></a><span class=sd>        center (float, optional): Center of the arctan step function.</span>
<a id=__codelineno-0-441 name=__codelineno-0-441></a><a href=#__codelineno-0-441><span class=linenos data-linenos="441 "></span></a><span class=sd>             Defaults to 0.0.</span>
<a id=__codelineno-0-442 name=__codelineno-0-442></a><a href=#__codelineno-0-442><span class=linenos data-linenos="442 "></span></a><span class=sd>        sigma (float, optional): Sigma of the arctan step function.</span>
<a id=__codelineno-0-443 name=__codelineno-0-443></a><a href=#__codelineno-0-443><span class=linenos data-linenos="443 "></span></a><span class=sd>             Defaults to 1.0.</span>
<a id=__codelineno-0-444 name=__codelineno-0-444></a><a href=#__codelineno-0-444><span class=linenos data-linenos="444 "></span></a>
<a id=__codelineno-0-445 name=__codelineno-0-445></a><a href=#__codelineno-0-445><span class=linenos data-linenos="445 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-446 name=__codelineno-0-446></a><a href=#__codelineno-0-446><span class=linenos data-linenos="446 "></span></a><span class=sd>        NDArray[np.float64]: Arctan step function of `x` given.</span>
<a id=__codelineno-0-447 name=__codelineno-0-447></a><a href=#__codelineno-0-447><span class=linenos data-linenos="447 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-448 name=__codelineno-0-448></a><a href=#__codelineno-0-448><span class=linenos data-linenos="448 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-449 name=__codelineno-0-449></a><a href=#__codelineno-0-449><span class=linenos data-linenos="449 "></span></a>        <span class=n>amplitude</span>
<a id=__codelineno-0-450 name=__codelineno-0-450></a><a href=#__codelineno-0-450><span class=linenos data-linenos="450 "></span></a>        <span class=o>*</span> <span class=mf>0.5</span>
<a id=__codelineno-0-451 name=__codelineno-0-451></a><a href=#__codelineno-0-451><span class=linenos data-linenos="451 "></span></a>        <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>/</span> <span class=n>pi</span><span class=p>)</span>
<a id=__codelineno-0-452 name=__codelineno-0-452></a><a href=#__codelineno-0-452><span class=linenos data-linenos="452 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.cgaussian class="doc doc-heading"> <code class="highlight language-python"><span class=n>cgaussian</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>fwhmg</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.cgaussian class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional cumulative <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> function.</p> <pre class=arithmatex>\[
f(x) = \frac{1}{2} \left[1 + erf\left(\frac{x - c}{s \sqrt{2}}\right)\right]
\]</pre> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>center</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>fwhmg</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Full width at half maximum of the <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Cumulative <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> function of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-485 name=__codelineno-0-485></a><a href=#__codelineno-0-485><span class=linenos data-linenos="485 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-486 name=__codelineno-0-486></a><a href=#__codelineno-0-486><span class=linenos data-linenos="486 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>cgaussian</span><span class=p>(</span>
<a id=__codelineno-0-487 name=__codelineno-0-487></a><a href=#__codelineno-0-487><span class=linenos data-linenos="487 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-488 name=__codelineno-0-488></a><a href=#__codelineno-0-488><span class=linenos data-linenos="488 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-489 name=__codelineno-0-489></a><a href=#__codelineno-0-489><span class=linenos data-linenos="489 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-490 name=__codelineno-0-490></a><a href=#__codelineno-0-490><span class=linenos data-linenos="490 "></span></a>    <span class=n>fwhmg</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-491 name=__codelineno-0-491></a><a href=#__codelineno-0-491><span class=linenos data-linenos="491 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-492 name=__codelineno-0-492></a><a href=#__codelineno-0-492><span class=linenos data-linenos="492 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional cumulative Gaussian function.</span>
<a id=__codelineno-0-493 name=__codelineno-0-493></a><a href=#__codelineno-0-493><span class=linenos data-linenos="493 "></span></a>
<a id=__codelineno-0-494 name=__codelineno-0-494></a><a href=#__codelineno-0-494><span class=linenos data-linenos="494 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-495 name=__codelineno-0-495></a><a href=#__codelineno-0-495><span class=linenos data-linenos="495 "></span></a><span class=sd>    f(x) = \frac{1}{2} \left[1 + erf\left(\frac{x - c}{s \sqrt{2}}\right)\right]</span>
<a id=__codelineno-0-496 name=__codelineno-0-496></a><a href=#__codelineno-0-496><span class=linenos data-linenos="496 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-497 name=__codelineno-0-497></a><a href=#__codelineno-0-497><span class=linenos data-linenos="497 "></span></a>
<a id=__codelineno-0-498 name=__codelineno-0-498></a><a href=#__codelineno-0-498><span class=linenos data-linenos="498 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-499 name=__codelineno-0-499></a><a href=#__codelineno-0-499><span class=linenos data-linenos="499 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-500 name=__codelineno-0-500></a><a href=#__codelineno-0-500><span class=linenos data-linenos="500 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the Gaussian function. Defaults to</span>
<a id=__codelineno-0-501 name=__codelineno-0-501></a><a href=#__codelineno-0-501><span class=linenos data-linenos="501 "></span></a><span class=sd>            1.0.</span>
<a id=__codelineno-0-502 name=__codelineno-0-502></a><a href=#__codelineno-0-502><span class=linenos data-linenos="502 "></span></a><span class=sd>        center (float, optional): Center of the Gaussian function. Defaults to 0.0.</span>
<a id=__codelineno-0-503 name=__codelineno-0-503></a><a href=#__codelineno-0-503><span class=linenos data-linenos="503 "></span></a><span class=sd>        fwhmg (float, optional): Full width at half maximum of the Gaussian</span>
<a id=__codelineno-0-504 name=__codelineno-0-504></a><a href=#__codelineno-0-504><span class=linenos data-linenos="504 "></span></a><span class=sd>             function. Defaults to 1.0.</span>
<a id=__codelineno-0-505 name=__codelineno-0-505></a><a href=#__codelineno-0-505><span class=linenos data-linenos="505 "></span></a>
<a id=__codelineno-0-506 name=__codelineno-0-506></a><a href=#__codelineno-0-506><span class=linenos data-linenos="506 "></span></a>
<a id=__codelineno-0-507 name=__codelineno-0-507></a><a href=#__codelineno-0-507><span class=linenos data-linenos="507 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-508 name=__codelineno-0-508></a><a href=#__codelineno-0-508><span class=linenos data-linenos="508 "></span></a><span class=sd>        NDArray[np.float64]: Cumulative Gaussian function of `x` given.</span>
<a id=__codelineno-0-509 name=__codelineno-0-509></a><a href=#__codelineno-0-509><span class=linenos data-linenos="509 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-510 name=__codelineno-0-510></a><a href=#__codelineno-0-510><span class=linenos data-linenos="510 "></span></a>    <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmg</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmg2sig</span>
<a id=__codelineno-0-511 name=__codelineno-0-511></a><a href=#__codelineno-0-511><span class=linenos data-linenos="511 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-512 name=__codelineno-0-512></a><a href=#__codelineno-0-512><span class=linenos data-linenos="512 "></span></a>        <span class=n>amplitude</span> <span class=o>*</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>erf</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mf>2.0</span><span class=p>))))</span>
<a id=__codelineno-0-513 name=__codelineno-0-513></a><a href=#__codelineno-0-513><span class=linenos data-linenos="513 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.clorentzian class="doc doc-heading"> <code class="highlight language-python"><span class=n>clorentzian</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>fwhml</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.clorentzian class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional cumulative <abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr> function.</p> <pre class=arithmatex>\[
f(x) = \frac{1}{\pi} \arctan\left(\frac{x - c}{s}\right) + \frac{1}{2}
\]</pre> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the <abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr> function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>center</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the <abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr> function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>fwhml</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Full width at half maximum of the <abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr> function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Cumulative <abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr> function of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-515 name=__codelineno-0-515></a><a href=#__codelineno-0-515><span class=linenos data-linenos="515 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-516 name=__codelineno-0-516></a><a href=#__codelineno-0-516><span class=linenos data-linenos="516 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>clorentzian</span><span class=p>(</span>
<a id=__codelineno-0-517 name=__codelineno-0-517></a><a href=#__codelineno-0-517><span class=linenos data-linenos="517 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-518 name=__codelineno-0-518></a><a href=#__codelineno-0-518><span class=linenos data-linenos="518 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-519 name=__codelineno-0-519></a><a href=#__codelineno-0-519><span class=linenos data-linenos="519 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-520 name=__codelineno-0-520></a><a href=#__codelineno-0-520><span class=linenos data-linenos="520 "></span></a>    <span class=n>fwhml</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-521 name=__codelineno-0-521></a><a href=#__codelineno-0-521><span class=linenos data-linenos="521 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-522 name=__codelineno-0-522></a><a href=#__codelineno-0-522><span class=linenos data-linenos="522 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional cumulative Lorentzian function.</span>
<a id=__codelineno-0-523 name=__codelineno-0-523></a><a href=#__codelineno-0-523><span class=linenos data-linenos="523 "></span></a>
<a id=__codelineno-0-524 name=__codelineno-0-524></a><a href=#__codelineno-0-524><span class=linenos data-linenos="524 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-525 name=__codelineno-0-525></a><a href=#__codelineno-0-525><span class=linenos data-linenos="525 "></span></a><span class=sd>    f(x) = \frac{1}{\pi} \arctan\left(\frac{x - c}{s}\right) + \frac{1}{2}</span>
<a id=__codelineno-0-526 name=__codelineno-0-526></a><a href=#__codelineno-0-526><span class=linenos data-linenos="526 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-527 name=__codelineno-0-527></a><a href=#__codelineno-0-527><span class=linenos data-linenos="527 "></span></a>
<a id=__codelineno-0-528 name=__codelineno-0-528></a><a href=#__codelineno-0-528><span class=linenos data-linenos="528 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-529 name=__codelineno-0-529></a><a href=#__codelineno-0-529><span class=linenos data-linenos="529 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-530 name=__codelineno-0-530></a><a href=#__codelineno-0-530><span class=linenos data-linenos="530 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the Lorentzian function.</span>
<a id=__codelineno-0-531 name=__codelineno-0-531></a><a href=#__codelineno-0-531><span class=linenos data-linenos="531 "></span></a><span class=sd>                Defaults to 1.0.</span>
<a id=__codelineno-0-532 name=__codelineno-0-532></a><a href=#__codelineno-0-532><span class=linenos data-linenos="532 "></span></a><span class=sd>        center (float, optional): Center of the Lorentzian function.</span>
<a id=__codelineno-0-533 name=__codelineno-0-533></a><a href=#__codelineno-0-533><span class=linenos data-linenos="533 "></span></a><span class=sd>             Defaults to 0.0.</span>
<a id=__codelineno-0-534 name=__codelineno-0-534></a><a href=#__codelineno-0-534><span class=linenos data-linenos="534 "></span></a><span class=sd>        fwhml (float, optional): Full width at half maximum of the Lorentzian</span>
<a id=__codelineno-0-535 name=__codelineno-0-535></a><a href=#__codelineno-0-535><span class=linenos data-linenos="535 "></span></a><span class=sd>            function. Defaults to 1.0.</span>
<a id=__codelineno-0-536 name=__codelineno-0-536></a><a href=#__codelineno-0-536><span class=linenos data-linenos="536 "></span></a>
<a id=__codelineno-0-537 name=__codelineno-0-537></a><a href=#__codelineno-0-537><span class=linenos data-linenos="537 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-538 name=__codelineno-0-538></a><a href=#__codelineno-0-538><span class=linenos data-linenos="538 "></span></a><span class=sd>        NDArray[np.float64]: Cumulative Lorentzian function of `x` given.</span>
<a id=__codelineno-0-539 name=__codelineno-0-539></a><a href=#__codelineno-0-539><span class=linenos data-linenos="539 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-540 name=__codelineno-0-540></a><a href=#__codelineno-0-540><span class=linenos data-linenos="540 "></span></a>    <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhml</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhml2sig</span>
<a id=__codelineno-0-541 name=__codelineno-0-541></a><a href=#__codelineno-0-541><span class=linenos data-linenos="541 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>*</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>)</span> <span class=o>/</span> <span class=n>pi</span><span class=p>)</span> <span class=o>+</span> <span class=mf>0.5</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.constant class="doc doc-heading"> <code class="highlight language-python"><span class=n>constant</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.constant class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional constant value.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the constant. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Constant value of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-329 name=__codelineno-0-329></a><a href=#__codelineno-0-329><span class=linenos data-linenos="329 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-330 name=__codelineno-0-330></a><a href=#__codelineno-0-330><span class=linenos data-linenos="330 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>constant</span><span class=p>(</span>
<a id=__codelineno-0-331 name=__codelineno-0-331></a><a href=#__codelineno-0-331><span class=linenos data-linenos="331 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-332 name=__codelineno-0-332></a><a href=#__codelineno-0-332><span class=linenos data-linenos="332 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-333 name=__codelineno-0-333></a><a href=#__codelineno-0-333><span class=linenos data-linenos="333 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-334 name=__codelineno-0-334></a><a href=#__codelineno-0-334><span class=linenos data-linenos="334 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional constant value.</span>
<a id=__codelineno-0-335 name=__codelineno-0-335></a><a href=#__codelineno-0-335><span class=linenos data-linenos="335 "></span></a>
<a id=__codelineno-0-336 name=__codelineno-0-336></a><a href=#__codelineno-0-336><span class=linenos data-linenos="336 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-337 name=__codelineno-0-337></a><a href=#__codelineno-0-337><span class=linenos data-linenos="337 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-338 name=__codelineno-0-338></a><a href=#__codelineno-0-338><span class=linenos data-linenos="338 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the constant. Defaults to 1.0.</span>
<a id=__codelineno-0-339 name=__codelineno-0-339></a><a href=#__codelineno-0-339><span class=linenos data-linenos="339 "></span></a>
<a id=__codelineno-0-340 name=__codelineno-0-340></a><a href=#__codelineno-0-340><span class=linenos data-linenos="340 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-341 name=__codelineno-0-341></a><a href=#__codelineno-0-341><span class=linenos data-linenos="341 "></span></a><span class=sd>        NDArray[np.float64]: Constant value of `x` given.</span>
<a id=__codelineno-0-342 name=__codelineno-0-342></a><a href=#__codelineno-0-342><span class=linenos data-linenos="342 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-343 name=__codelineno-0-343></a><a href=#__codelineno-0-343><span class=linenos data-linenos="343 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>amplitude</span><span class=p>,</span> <span class=n>amplitude</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)))</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.cvoigt class="doc doc-heading"> <code class="highlight language-python"><span class=n>cvoigt</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>fwhmv</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>gamma</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.cvoigt class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional cumulative <abbr title="A peak function resulting from the Convolution of a Gaussian and a Lorentzian profile">Voigt</abbr> function.</p> <pre class=arithmatex>\[
f(x) = \frac{1}{2} \left[1 + erf\left(\frac{x - c}{s \sqrt{2}}\right)\right]
\]</pre> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the <abbr title="A peak function resulting from the Convolution of a Gaussian and a Lorentzian profile">Voigt</abbr> function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>center</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the <abbr title="A peak function resulting from the Convolution of a Gaussian and a Lorentzian profile">Voigt</abbr> function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>fwhmv</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Full width at half maximum of the <abbr title="A peak function resulting from the Convolution of a Gaussian and a Lorentzian profile">Voigt</abbr> function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>gamma</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Gamma of the <abbr title="A peak function resulting from the Convolution of a Gaussian and a Lorentzian profile">Voigt</abbr> function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Cumulative <abbr title="A peak function resulting from the Convolution of a Gaussian and a Lorentzian profile">Voigt</abbr> function of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-543 name=__codelineno-0-543></a><a href=#__codelineno-0-543><span class=linenos data-linenos="543 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-544 name=__codelineno-0-544></a><a href=#__codelineno-0-544><span class=linenos data-linenos="544 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>cvoigt</span><span class=p>(</span>
<a id=__codelineno-0-545 name=__codelineno-0-545></a><a href=#__codelineno-0-545><span class=linenos data-linenos="545 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-546 name=__codelineno-0-546></a><a href=#__codelineno-0-546><span class=linenos data-linenos="546 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-547 name=__codelineno-0-547></a><a href=#__codelineno-0-547><span class=linenos data-linenos="547 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-548 name=__codelineno-0-548></a><a href=#__codelineno-0-548><span class=linenos data-linenos="548 "></span></a>    <span class=n>fwhmv</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-549 name=__codelineno-0-549></a><a href=#__codelineno-0-549><span class=linenos data-linenos="549 "></span></a>    <span class=n>gamma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-550 name=__codelineno-0-550></a><a href=#__codelineno-0-550><span class=linenos data-linenos="550 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-551 name=__codelineno-0-551></a><a href=#__codelineno-0-551><span class=linenos data-linenos="551 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional cumulative Voigt function.</span>
<a id=__codelineno-0-552 name=__codelineno-0-552></a><a href=#__codelineno-0-552><span class=linenos data-linenos="552 "></span></a>
<a id=__codelineno-0-553 name=__codelineno-0-553></a><a href=#__codelineno-0-553><span class=linenos data-linenos="553 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-554 name=__codelineno-0-554></a><a href=#__codelineno-0-554><span class=linenos data-linenos="554 "></span></a><span class=sd>    f(x) = \frac{1}{2} \left[1 + erf\left(\frac{x - c}{s \sqrt{2}}\right)\right]</span>
<a id=__codelineno-0-555 name=__codelineno-0-555></a><a href=#__codelineno-0-555><span class=linenos data-linenos="555 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-556 name=__codelineno-0-556></a><a href=#__codelineno-0-556><span class=linenos data-linenos="556 "></span></a>
<a id=__codelineno-0-557 name=__codelineno-0-557></a><a href=#__codelineno-0-557><span class=linenos data-linenos="557 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-558 name=__codelineno-0-558></a><a href=#__codelineno-0-558><span class=linenos data-linenos="558 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-559 name=__codelineno-0-559></a><a href=#__codelineno-0-559><span class=linenos data-linenos="559 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the Voigt function. Defaults to</span>
<a id=__codelineno-0-560 name=__codelineno-0-560></a><a href=#__codelineno-0-560><span class=linenos data-linenos="560 "></span></a><span class=sd>            1.0.</span>
<a id=__codelineno-0-561 name=__codelineno-0-561></a><a href=#__codelineno-0-561><span class=linenos data-linenos="561 "></span></a><span class=sd>        center (float, optional): Center of the Voigt function. Defaults to 0.0.</span>
<a id=__codelineno-0-562 name=__codelineno-0-562></a><a href=#__codelineno-0-562><span class=linenos data-linenos="562 "></span></a><span class=sd>        fwhmv (float, optional): Full width at half maximum of the Voigt function.</span>
<a id=__codelineno-0-563 name=__codelineno-0-563></a><a href=#__codelineno-0-563><span class=linenos data-linenos="563 "></span></a><span class=sd>            Defaults to 1.0.</span>
<a id=__codelineno-0-564 name=__codelineno-0-564></a><a href=#__codelineno-0-564><span class=linenos data-linenos="564 "></span></a><span class=sd>        gamma (float, optional): Gamma of the Voigt function. Defaults to 1.0.</span>
<a id=__codelineno-0-565 name=__codelineno-0-565></a><a href=#__codelineno-0-565><span class=linenos data-linenos="565 "></span></a>
<a id=__codelineno-0-566 name=__codelineno-0-566></a><a href=#__codelineno-0-566><span class=linenos data-linenos="566 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-567 name=__codelineno-0-567></a><a href=#__codelineno-0-567><span class=linenos data-linenos="567 "></span></a><span class=sd>        NDArray[np.float64]: Cumulative Voigt function of `x` given.</span>
<a id=__codelineno-0-568 name=__codelineno-0-568></a><a href=#__codelineno-0-568><span class=linenos data-linenos="568 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-569 name=__codelineno-0-569></a><a href=#__codelineno-0-569><span class=linenos data-linenos="569 "></span></a>    <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmv</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmv2sig</span>
<a id=__codelineno-0-570 name=__codelineno-0-570></a><a href=#__codelineno-0-570><span class=linenos data-linenos="570 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-571 name=__codelineno-0-571></a><a href=#__codelineno-0-571><span class=linenos data-linenos="571 "></span></a>        <span class=n>amplitude</span>
<a id=__codelineno-0-572 name=__codelineno-0-572></a><a href=#__codelineno-0-572><span class=linenos data-linenos="572 "></span></a>        <span class=o>*</span> <span class=mf>0.5</span>
<a id=__codelineno-0-573 name=__codelineno-0-573></a><a href=#__codelineno-0-573><span class=linenos data-linenos="573 "></span></a>        <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>erf</span><span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mf>2.0</span><span class=p>))))</span>
<a id=__codelineno-0-574 name=__codelineno-0-574></a><a href=#__codelineno-0-574><span class=linenos data-linenos="574 "></span></a>        <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=p>(((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>gamma</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
<a id=__codelineno-0-575 name=__codelineno-0-575></a><a href=#__codelineno-0-575><span class=linenos data-linenos="575 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.erf class="doc doc-heading"> <code class="highlight language-python"><span class=n>erf</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.erf class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional error function.</p> <pre class=arithmatex>\[
f(x) = \frac{2}{\sqrt{\pi}} \int_{0}^{x} e^{-t^2} dt
\]</pre> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the error function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>center</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the error function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>sigma</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Sigma of the error function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Error function of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-363 name=__codelineno-0-363></a><a href=#__codelineno-0-363><span class=linenos data-linenos="363 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-364 name=__codelineno-0-364></a><a href=#__codelineno-0-364><span class=linenos data-linenos="364 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>erf</span><span class=p>(</span>
<a id=__codelineno-0-365 name=__codelineno-0-365></a><a href=#__codelineno-0-365><span class=linenos data-linenos="365 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-366 name=__codelineno-0-366></a><a href=#__codelineno-0-366><span class=linenos data-linenos="366 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-367 name=__codelineno-0-367></a><a href=#__codelineno-0-367><span class=linenos data-linenos="367 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-368 name=__codelineno-0-368></a><a href=#__codelineno-0-368><span class=linenos data-linenos="368 "></span></a>    <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-369 name=__codelineno-0-369></a><a href=#__codelineno-0-369><span class=linenos data-linenos="369 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-370 name=__codelineno-0-370></a><a href=#__codelineno-0-370><span class=linenos data-linenos="370 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional error function.</span>
<a id=__codelineno-0-371 name=__codelineno-0-371></a><a href=#__codelineno-0-371><span class=linenos data-linenos="371 "></span></a>
<a id=__codelineno-0-372 name=__codelineno-0-372></a><a href=#__codelineno-0-372><span class=linenos data-linenos="372 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-373 name=__codelineno-0-373></a><a href=#__codelineno-0-373><span class=linenos data-linenos="373 "></span></a><span class=sd>    f(x) = \frac{2}{\sqrt{\pi}} \int_{0}^{x} e^{-t^2} dt</span>
<a id=__codelineno-0-374 name=__codelineno-0-374></a><a href=#__codelineno-0-374><span class=linenos data-linenos="374 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-375 name=__codelineno-0-375></a><a href=#__codelineno-0-375><span class=linenos data-linenos="375 "></span></a>
<a id=__codelineno-0-376 name=__codelineno-0-376></a><a href=#__codelineno-0-376><span class=linenos data-linenos="376 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-377 name=__codelineno-0-377></a><a href=#__codelineno-0-377><span class=linenos data-linenos="377 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-378 name=__codelineno-0-378></a><a href=#__codelineno-0-378><span class=linenos data-linenos="378 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the error function.</span>
<a id=__codelineno-0-379 name=__codelineno-0-379></a><a href=#__codelineno-0-379><span class=linenos data-linenos="379 "></span></a><span class=sd>                Defaults to 1.0.</span>
<a id=__codelineno-0-380 name=__codelineno-0-380></a><a href=#__codelineno-0-380><span class=linenos data-linenos="380 "></span></a><span class=sd>        center (float, optional): Center of the error function. Defaults to 0.0.</span>
<a id=__codelineno-0-381 name=__codelineno-0-381></a><a href=#__codelineno-0-381><span class=linenos data-linenos="381 "></span></a><span class=sd>        sigma (float, optional): Sigma of the error function. Defaults to 1.0.</span>
<a id=__codelineno-0-382 name=__codelineno-0-382></a><a href=#__codelineno-0-382><span class=linenos data-linenos="382 "></span></a>
<a id=__codelineno-0-383 name=__codelineno-0-383></a><a href=#__codelineno-0-383><span class=linenos data-linenos="383 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-384 name=__codelineno-0-384></a><a href=#__codelineno-0-384><span class=linenos data-linenos="384 "></span></a><span class=sd>        NDArray[np.float64]: Error function of `x` given.</span>
<a id=__codelineno-0-385 name=__codelineno-0-385></a><a href=#__codelineno-0-385><span class=linenos data-linenos="385 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-386 name=__codelineno-0-386></a><a href=#__codelineno-0-386><span class=linenos data-linenos="386 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-387 name=__codelineno-0-387></a><a href=#__codelineno-0-387><span class=linenos data-linenos="387 "></span></a>        <span class=n>amplitude</span> <span class=o>*</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>erf</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)))</span>
<a id=__codelineno-0-388 name=__codelineno-0-388></a><a href=#__codelineno-0-388><span class=linenos data-linenos="388 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.exponential class="doc doc-heading"> <code class="highlight language-python"><span class=n>exponential</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>decay</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>intercept</span><span class=o>=</span><span class=mf>0.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.exponential class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional exponential decay.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the exponential function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>decay</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Decay of the exponential function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>intercept</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Intercept of the exponential function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Exponential decay of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-266 name=__codelineno-0-266></a><a href=#__codelineno-0-266><span class=linenos data-linenos="266 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-267 name=__codelineno-0-267></a><a href=#__codelineno-0-267><span class=linenos data-linenos="267 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>exponential</span><span class=p>(</span>
<a id=__codelineno-0-268 name=__codelineno-0-268></a><a href=#__codelineno-0-268><span class=linenos data-linenos="268 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-269 name=__codelineno-0-269></a><a href=#__codelineno-0-269><span class=linenos data-linenos="269 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-270 name=__codelineno-0-270></a><a href=#__codelineno-0-270><span class=linenos data-linenos="270 "></span></a>    <span class=n>decay</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-271 name=__codelineno-0-271></a><a href=#__codelineno-0-271><span class=linenos data-linenos="271 "></span></a>    <span class=n>intercept</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-272 name=__codelineno-0-272></a><a href=#__codelineno-0-272><span class=linenos data-linenos="272 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-273 name=__codelineno-0-273></a><a href=#__codelineno-0-273><span class=linenos data-linenos="273 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional exponential decay.</span>
<a id=__codelineno-0-274 name=__codelineno-0-274></a><a href=#__codelineno-0-274><span class=linenos data-linenos="274 "></span></a>
<a id=__codelineno-0-275 name=__codelineno-0-275></a><a href=#__codelineno-0-275><span class=linenos data-linenos="275 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-276 name=__codelineno-0-276></a><a href=#__codelineno-0-276><span class=linenos data-linenos="276 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-277 name=__codelineno-0-277></a><a href=#__codelineno-0-277><span class=linenos data-linenos="277 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the exponential function.</span>
<a id=__codelineno-0-278 name=__codelineno-0-278></a><a href=#__codelineno-0-278><span class=linenos data-linenos="278 "></span></a><span class=sd>             Defaults to 1.0.</span>
<a id=__codelineno-0-279 name=__codelineno-0-279></a><a href=#__codelineno-0-279><span class=linenos data-linenos="279 "></span></a><span class=sd>        decay (float, optional): Decay of the exponential function. Defaults to 1.0.</span>
<a id=__codelineno-0-280 name=__codelineno-0-280></a><a href=#__codelineno-0-280><span class=linenos data-linenos="280 "></span></a><span class=sd>        intercept (float, optional): Intercept of the exponential function.</span>
<a id=__codelineno-0-281 name=__codelineno-0-281></a><a href=#__codelineno-0-281><span class=linenos data-linenos="281 "></span></a><span class=sd>             Defaults to 0.0.</span>
<a id=__codelineno-0-282 name=__codelineno-0-282></a><a href=#__codelineno-0-282><span class=linenos data-linenos="282 "></span></a>
<a id=__codelineno-0-283 name=__codelineno-0-283></a><a href=#__codelineno-0-283><span class=linenos data-linenos="283 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-284 name=__codelineno-0-284></a><a href=#__codelineno-0-284><span class=linenos data-linenos="284 "></span></a><span class=sd>        NDArray[np.float64]: Exponential decay of `x` given.</span>
<a id=__codelineno-0-285 name=__codelineno-0-285></a><a href=#__codelineno-0-285><span class=linenos data-linenos="285 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-286 name=__codelineno-0-286></a><a href=#__codelineno-0-286><span class=linenos data-linenos="286 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=n>x</span> <span class=o>/</span> <span class=n>decay</span><span class=p>)</span> <span class=o>+</span> <span class=n>intercept</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.gaussian class="doc doc-heading"> <code class="highlight language-python"><span class=n>gaussian</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>fwhmg</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.gaussian class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> distribution.</p> <pre class=arithmatex>\[
{\displaystyle g(x)={\frac {1}{\sigma {\sqrt {2\pi }}}}\exp
(  -{\frac {1}{2}}{\frac {(x-\mu )^{2}}{\sigma ^{2}}} ) }
\]</pre> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> distribution. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>center</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> distribution. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>fwhmg</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Full width at half maximum (<abbr title="Full Width at Half Maximum; a measure of the width of a peak function (e.g., fwhmg, fwhml)">FWHM</abbr>) of the <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> distribution. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> distribution of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>gaussian</span><span class=p>(</span>
<a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a>    <span class=n>fwhmg</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Gaussian distribution.</span>
<a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a>
<a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=sd>    {\displaystyle g(x)={\frac {1}{\sigma {\sqrt {2\pi }}}}\exp</span>
<a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=sd>    (  -{\frac {1}{2}}{\frac {(x-\mu )^{2}}{\sigma ^{2}}} ) }</span>
<a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a>
<a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the Gaussian distribution.</span>
<a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=sd>             Defaults to 1.0.</span>
<a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=sd>        center (float, optional): Center of the Gaussian distribution.</span>
<a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=sd>             Defaults to 0.0.</span>
<a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a><span class=sd>        fwhmg (float, optional): Full width at half maximum (FWHM) of the Gaussian</span>
<a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=sd>            distribution. Defaults to 1.0.</span>
<a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>
<a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=sd>        NDArray[np.float64]: Gaussian distribution of `x` given.</span>
<a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a>    <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmg</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmg2sig</span>
<a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a>    <span class=n>norm_factor</span> <span class=o>=</span> <span class=n>amplitude</span> <span class=o>/</span> <span class=p>(</span><span class=n>Constants</span><span class=o>.</span><span class=n>sq2pi</span> <span class=o>*</span> <span class=n>sigma</span><span class=p>)</span>
<a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a>    <span class=k>return</span> <span class=n>norm_factor</span> <span class=o>*</span> <span class=n>DistributionModels</span><span class=o>.</span><span class=n>_gaussian_core</span><span class=p>(</span>
<a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a>        <span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=n>center</span><span class=p>,</span> <span class=n>scale</span><span class=o>=</span><span class=n>sigma</span>
<a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.heaviside class="doc doc-heading"> <code class="highlight language-python"><span class=n>heaviside</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.heaviside class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional Heaviside step function.</p> <p>$$ f(x) = begin{cases} 0 &amp; x &lt; 0 \ 0.5 &amp; x = 0 \ 1 &amp; x &gt; 0 end{cases} $$ Args: x (NDArray[np.float64]): <code class="language-text highlight">x</code>-values of the data. amplitude (float, optional): <abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the Heaviside step function. Defaults to 1.0. center (float, optional): <abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the Heaviside step function. Defaults to 0.0. sigma (float, optional): Sigma of the Heaviside step function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Heaviside step function of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-390 name=__codelineno-0-390></a><a href=#__codelineno-0-390><span class=linenos data-linenos="390 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-391 name=__codelineno-0-391></a><a href=#__codelineno-0-391><span class=linenos data-linenos="391 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>heaviside</span><span class=p>(</span>
<a id=__codelineno-0-392 name=__codelineno-0-392></a><a href=#__codelineno-0-392><span class=linenos data-linenos="392 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-393 name=__codelineno-0-393></a><a href=#__codelineno-0-393><span class=linenos data-linenos="393 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-394 name=__codelineno-0-394></a><a href=#__codelineno-0-394><span class=linenos data-linenos="394 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-395 name=__codelineno-0-395></a><a href=#__codelineno-0-395><span class=linenos data-linenos="395 "></span></a>    <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-396 name=__codelineno-0-396></a><a href=#__codelineno-0-396><span class=linenos data-linenos="396 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-397 name=__codelineno-0-397></a><a href=#__codelineno-0-397><span class=linenos data-linenos="397 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Heaviside step function.</span>
<a id=__codelineno-0-398 name=__codelineno-0-398></a><a href=#__codelineno-0-398><span class=linenos data-linenos="398 "></span></a>
<a id=__codelineno-0-399 name=__codelineno-0-399></a><a href=#__codelineno-0-399><span class=linenos data-linenos="399 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-400 name=__codelineno-0-400></a><a href=#__codelineno-0-400><span class=linenos data-linenos="400 "></span></a><span class=sd>    f(x) = \begin{cases}</span>
<a id=__codelineno-0-401 name=__codelineno-0-401></a><a href=#__codelineno-0-401><span class=linenos data-linenos="401 "></span></a><span class=sd>    0 &amp; x &lt; 0 \\</span>
<a id=__codelineno-0-402 name=__codelineno-0-402></a><a href=#__codelineno-0-402><span class=linenos data-linenos="402 "></span></a><span class=sd>    0.5 &amp; x = 0 \\</span>
<a id=__codelineno-0-403 name=__codelineno-0-403></a><a href=#__codelineno-0-403><span class=linenos data-linenos="403 "></span></a><span class=sd>    1 &amp; x &gt; 0</span>
<a id=__codelineno-0-404 name=__codelineno-0-404></a><a href=#__codelineno-0-404><span class=linenos data-linenos="404 "></span></a><span class=sd>    \end{cases}</span>
<a id=__codelineno-0-405 name=__codelineno-0-405></a><a href=#__codelineno-0-405><span class=linenos data-linenos="405 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-406 name=__codelineno-0-406></a><a href=#__codelineno-0-406><span class=linenos data-linenos="406 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-407 name=__codelineno-0-407></a><a href=#__codelineno-0-407><span class=linenos data-linenos="407 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-408 name=__codelineno-0-408></a><a href=#__codelineno-0-408><span class=linenos data-linenos="408 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the Heaviside step function.</span>
<a id=__codelineno-0-409 name=__codelineno-0-409></a><a href=#__codelineno-0-409><span class=linenos data-linenos="409 "></span></a><span class=sd>                Defaults to 1.0.</span>
<a id=__codelineno-0-410 name=__codelineno-0-410></a><a href=#__codelineno-0-410><span class=linenos data-linenos="410 "></span></a><span class=sd>        center (float, optional): Center of the Heaviside step function.</span>
<a id=__codelineno-0-411 name=__codelineno-0-411></a><a href=#__codelineno-0-411><span class=linenos data-linenos="411 "></span></a><span class=sd>             Defaults to 0.0.</span>
<a id=__codelineno-0-412 name=__codelineno-0-412></a><a href=#__codelineno-0-412><span class=linenos data-linenos="412 "></span></a><span class=sd>        sigma (float, optional): Sigma of the Heaviside step function.</span>
<a id=__codelineno-0-413 name=__codelineno-0-413></a><a href=#__codelineno-0-413><span class=linenos data-linenos="413 "></span></a><span class=sd>             Defaults to 1.0.</span>
<a id=__codelineno-0-414 name=__codelineno-0-414></a><a href=#__codelineno-0-414><span class=linenos data-linenos="414 "></span></a>
<a id=__codelineno-0-415 name=__codelineno-0-415></a><a href=#__codelineno-0-415><span class=linenos data-linenos="415 "></span></a>
<a id=__codelineno-0-416 name=__codelineno-0-416></a><a href=#__codelineno-0-416><span class=linenos data-linenos="416 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-417 name=__codelineno-0-417></a><a href=#__codelineno-0-417><span class=linenos data-linenos="417 "></span></a><span class=sd>        NDArray[np.float64]: Heaviside step function of `x` given.</span>
<a id=__codelineno-0-418 name=__codelineno-0-418></a><a href=#__codelineno-0-418><span class=linenos data-linenos="418 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-419 name=__codelineno-0-419></a><a href=#__codelineno-0-419><span class=linenos data-linenos="419 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-420 name=__codelineno-0-420></a><a href=#__codelineno-0-420><span class=linenos data-linenos="420 "></span></a>        <span class=n>amplitude</span> <span class=o>*</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>sign</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)))</span>
<a id=__codelineno-0-421 name=__codelineno-0-421></a><a href=#__codelineno-0-421><span class=linenos data-linenos="421 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.linear class="doc doc-heading"> <code class="highlight language-python"><span class=n>linear</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>slope</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>intercept</span><span class=o>=</span><span class=mf>0.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.linear class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional linear function.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>slope</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Slope of the linear function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>intercept</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Intercept of the linear function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Linear function of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-310 name=__codelineno-0-310></a><a href=#__codelineno-0-310><span class=linenos data-linenos="310 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-311 name=__codelineno-0-311></a><a href=#__codelineno-0-311><span class=linenos data-linenos="311 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>linear</span><span class=p>(</span>
<a id=__codelineno-0-312 name=__codelineno-0-312></a><a href=#__codelineno-0-312><span class=linenos data-linenos="312 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-313 name=__codelineno-0-313></a><a href=#__codelineno-0-313><span class=linenos data-linenos="313 "></span></a>    <span class=n>slope</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-314 name=__codelineno-0-314></a><a href=#__codelineno-0-314><span class=linenos data-linenos="314 "></span></a>    <span class=n>intercept</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-315 name=__codelineno-0-315></a><a href=#__codelineno-0-315><span class=linenos data-linenos="315 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-316 name=__codelineno-0-316></a><a href=#__codelineno-0-316><span class=linenos data-linenos="316 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional linear function.</span>
<a id=__codelineno-0-317 name=__codelineno-0-317></a><a href=#__codelineno-0-317><span class=linenos data-linenos="317 "></span></a>
<a id=__codelineno-0-318 name=__codelineno-0-318></a><a href=#__codelineno-0-318><span class=linenos data-linenos="318 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-319 name=__codelineno-0-319></a><a href=#__codelineno-0-319><span class=linenos data-linenos="319 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-320 name=__codelineno-0-320></a><a href=#__codelineno-0-320><span class=linenos data-linenos="320 "></span></a><span class=sd>        slope (float, optional): Slope of the linear function. Defaults to 1.0.</span>
<a id=__codelineno-0-321 name=__codelineno-0-321></a><a href=#__codelineno-0-321><span class=linenos data-linenos="321 "></span></a><span class=sd>        intercept (float, optional): Intercept of the linear function.</span>
<a id=__codelineno-0-322 name=__codelineno-0-322></a><a href=#__codelineno-0-322><span class=linenos data-linenos="322 "></span></a><span class=sd>             Defaults to 0.0.</span>
<a id=__codelineno-0-323 name=__codelineno-0-323></a><a href=#__codelineno-0-323><span class=linenos data-linenos="323 "></span></a>
<a id=__codelineno-0-324 name=__codelineno-0-324></a><a href=#__codelineno-0-324><span class=linenos data-linenos="324 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-325 name=__codelineno-0-325></a><a href=#__codelineno-0-325><span class=linenos data-linenos="325 "></span></a><span class=sd>        NDArray[np.float64]: Linear function of `x` given.</span>
<a id=__codelineno-0-326 name=__codelineno-0-326></a><a href=#__codelineno-0-326><span class=linenos data-linenos="326 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-327 name=__codelineno-0-327></a><a href=#__codelineno-0-327><span class=linenos data-linenos="327 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>slope</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=n>intercept</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.log class="doc doc-heading"> <code class="highlight language-python"><span class=n>log</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.log class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional logarithmic step function.</p> <pre class=arithmatex>\[
f(x) = \frac{1}{1 + e^{-\frac{x - c}{s}}}
\]</pre> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the logarithmic step function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>center</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the logarithmic step function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>sigma</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Sigma of the logarithmic step function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Logarithmic step function of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-454 name=__codelineno-0-454></a><a href=#__codelineno-0-454><span class=linenos data-linenos="454 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-455 name=__codelineno-0-455></a><a href=#__codelineno-0-455><span class=linenos data-linenos="455 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>log</span><span class=p>(</span>
<a id=__codelineno-0-456 name=__codelineno-0-456></a><a href=#__codelineno-0-456><span class=linenos data-linenos="456 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-457 name=__codelineno-0-457></a><a href=#__codelineno-0-457><span class=linenos data-linenos="457 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-458 name=__codelineno-0-458></a><a href=#__codelineno-0-458><span class=linenos data-linenos="458 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-459 name=__codelineno-0-459></a><a href=#__codelineno-0-459><span class=linenos data-linenos="459 "></span></a>    <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-460 name=__codelineno-0-460></a><a href=#__codelineno-0-460><span class=linenos data-linenos="460 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-461 name=__codelineno-0-461></a><a href=#__codelineno-0-461><span class=linenos data-linenos="461 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional logarithmic step function.</span>
<a id=__codelineno-0-462 name=__codelineno-0-462></a><a href=#__codelineno-0-462><span class=linenos data-linenos="462 "></span></a>
<a id=__codelineno-0-463 name=__codelineno-0-463></a><a href=#__codelineno-0-463><span class=linenos data-linenos="463 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-464 name=__codelineno-0-464></a><a href=#__codelineno-0-464><span class=linenos data-linenos="464 "></span></a><span class=sd>    f(x) = \frac{1}{1 + e^{-\frac{x - c}{s}}}</span>
<a id=__codelineno-0-465 name=__codelineno-0-465></a><a href=#__codelineno-0-465><span class=linenos data-linenos="465 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-466 name=__codelineno-0-466></a><a href=#__codelineno-0-466><span class=linenos data-linenos="466 "></span></a>
<a id=__codelineno-0-467 name=__codelineno-0-467></a><a href=#__codelineno-0-467><span class=linenos data-linenos="467 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-468 name=__codelineno-0-468></a><a href=#__codelineno-0-468><span class=linenos data-linenos="468 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-469 name=__codelineno-0-469></a><a href=#__codelineno-0-469><span class=linenos data-linenos="469 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the logarithmic step function.</span>
<a id=__codelineno-0-470 name=__codelineno-0-470></a><a href=#__codelineno-0-470><span class=linenos data-linenos="470 "></span></a><span class=sd>                Defaults to 1.0.</span>
<a id=__codelineno-0-471 name=__codelineno-0-471></a><a href=#__codelineno-0-471><span class=linenos data-linenos="471 "></span></a><span class=sd>        center (float, optional): Center of the logarithmic step function.</span>
<a id=__codelineno-0-472 name=__codelineno-0-472></a><a href=#__codelineno-0-472><span class=linenos data-linenos="472 "></span></a><span class=sd>             Defaults to 0.0.</span>
<a id=__codelineno-0-473 name=__codelineno-0-473></a><a href=#__codelineno-0-473><span class=linenos data-linenos="473 "></span></a><span class=sd>        sigma (float, optional): Sigma of the logarithmic step function.</span>
<a id=__codelineno-0-474 name=__codelineno-0-474></a><a href=#__codelineno-0-474><span class=linenos data-linenos="474 "></span></a><span class=sd>             Defaults to 1.0.</span>
<a id=__codelineno-0-475 name=__codelineno-0-475></a><a href=#__codelineno-0-475><span class=linenos data-linenos="475 "></span></a>
<a id=__codelineno-0-476 name=__codelineno-0-476></a><a href=#__codelineno-0-476><span class=linenos data-linenos="476 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-477 name=__codelineno-0-477></a><a href=#__codelineno-0-477><span class=linenos data-linenos="477 "></span></a><span class=sd>        NDArray[np.float64]: Logarithmic step function of `x` given.</span>
<a id=__codelineno-0-478 name=__codelineno-0-478></a><a href=#__codelineno-0-478><span class=linenos data-linenos="478 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-479 name=__codelineno-0-479></a><a href=#__codelineno-0-479><span class=linenos data-linenos="479 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-480 name=__codelineno-0-480></a><a href=#__codelineno-0-480><span class=linenos data-linenos="480 "></span></a>        <span class=n>amplitude</span>
<a id=__codelineno-0-481 name=__codelineno-0-481></a><a href=#__codelineno-0-481><span class=linenos data-linenos="481 "></span></a>        <span class=o>*</span> <span class=mf>0.5</span>
<a id=__codelineno-0-482 name=__codelineno-0-482></a><a href=#__codelineno-0-482><span class=linenos data-linenos="482 "></span></a>        <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>DistributionModels</span><span class=o>.</span><span class=n>_norm</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=p>,</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>/</span> <span class=n>pi</span><span class=p>)</span>
<a id=__codelineno-0-483 name=__codelineno-0-483></a><a href=#__codelineno-0-483><span class=linenos data-linenos="483 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.lorentzian class="doc doc-heading"> <code class="highlight language-python"><span class=n>lorentzian</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>fwhml</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.lorentzian class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional <abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr> distribution.</p> <pre class=arithmatex>\[
f(x;x_{0},\gamma )={\frac  {1}{\pi \gamma
[ 1+ ( {\frac  {x-x_{0}}{\gamma }})^{2} ]
}} ={1 \over \pi \gamma } [ {\gamma ^{2} \over (x-x_{0})^{2}+\gamma ^{2}} ]
\]</pre> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the <abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr> distribution. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>center</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the <abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr> distribution. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>fwhml</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Full width at half maximum (<abbr title="Full Width at Half Maximum; a measure of the width of a peak function (e.g., fwhmg, fwhml)">FWHM</abbr>) of the <abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr> distribution. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>Union[NDArray[np.float64], float]: <abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr> distribution of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>lorentzian</span><span class=p>(</span>
<a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a>    <span class=n>fwhml</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Lorentzian distribution.</span>
<a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a>
<a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a><span class=sd>    f(x;x_{0},\gamma )={\frac  {1}{\pi \gamma</span>
<a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a><span class=sd>    [ 1+ ( {\frac  {x-x_{0}}{\gamma }})^{2} ]</span>
<a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=sd>    }} ={1 \over \pi \gamma } [ {\gamma ^{2} \over (x-x_{0})^{2}+\gamma ^{2}} ]</span>
<a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a>
<a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the Lorentzian distribution.</span>
<a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a><span class=sd>            Defaults to 1.0.</span>
<a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a><span class=sd>        center (float, optional): Center of the Lorentzian distribution. Defaults to</span>
<a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a><span class=sd>            0.0.</span>
<a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a><span class=sd>        fwhml (float, optional): Full width at half maximum (FWHM) of the Lorentzian</span>
<a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a><span class=sd>            distribution. Defaults to 1.0.</span>
<a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a>
<a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a><span class=sd>        Union[NDArray[np.float64], float]: Lorentzian distribution of `x` given.</span>
<a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a>    <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhml</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhml2sig</span>
<a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a>        <span class=n>amplitude</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=p>((</span><span class=mf>1.0</span> <span class=o>*</span> <span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>pi</span> <span class=o>*</span> <span class=n>sigma</span><span class=p>),</span>
<a id=__codelineno-0-176 name=__codelineno-0-176></a><a href=#__codelineno-0-176><span class=linenos data-linenos="176 "></span></a>        <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>,</span>
<a id=__codelineno-0-177 name=__codelineno-0-177></a><a href=#__codelineno-0-177><span class=linenos data-linenos="177 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.orcagaussian class="doc doc-heading"> <code class="highlight language-python"><span class=n>orcagaussian</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.orcagaussian class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> distribution as implemented in the <abbr title="A computational chemistry software package for quantum chemistry calculations">ORCA</abbr> program.</p> <pre class=arithmatex>\[
{\displaystyle g(x)= A \cdot \exp
(  -{\frac {(x-x_0)^{2}}{2 \cdot width^{2}}} ) }
\]</pre> <p>Unlike the standard gaussian function, this implementation uses the width parameter directly without conversion to sigma, which is consistent with the <abbr title="A computational chemistry software package for quantum chemistry calculations">ORCA</abbr> quantum chemistry program's approach<sup id=spectrafit.models.DistributionModels.orcagaussian--fnref:1><a class=footnote-ref href=#spectrafit.models.DistributionModels.orcagaussian--fn:1>1</a></sup>.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <div class=footnote> <hr> <ol> <li id=spectrafit.models.DistributionModels.orcagaussian--fn:1> <p><a href=https://www.faccts.de/docs/orca/6.0/manual/contents/detailed/utilities.html>www.faccts.de/docs/orca/6.0/manual/contents/detailed/utilities.html</a>&#160;<a class=footnote-backref href=#spectrafit.models.DistributionModels.orcagaussian--fnref:1 title="Jump back to footnote 1 in the text">&#8617;</a></p> </li> </ol> </div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> distribution. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>center</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> distribution. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>width</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="General term for the extent of a peak, often quantified by FWHM or sigma">Width</abbr> parameter of the <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> distribution as used in the <abbr title="A computational chemistry software package for quantum chemistry calculations">ORCA</abbr> program. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> distribution of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>orcagaussian</span><span class=p>(</span>
<a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>    <span class=n>width</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Gaussian distribution as implemented in the ORCA program.</span>
<a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a>
<a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=sd>    {\displaystyle g(x)= A \cdot \exp</span>
<a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a><span class=sd>    (  -{\frac {(x-x_0)^{2}}{2 \cdot width^{2}}} ) }</span>
<a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a>
<a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=sd>    Unlike the standard gaussian function, this implementation uses the width parameter</span>
<a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=sd>    directly without conversion to sigma, which is consistent with the ORCA quantum</span>
<a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=sd>    chemistry program&#39;s approach[^1].</span>
<a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a>
<a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=sd>    [^1]: https://www.faccts.de/docs/orca/6.0/manual/contents/detailed/utilities.html</span>
<a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a>
<a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the Gaussian distribution.</span>
<a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=sd>             Defaults to 1.0.</span>
<a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=sd>        center (float, optional): Center of the Gaussian distribution.</span>
<a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a><span class=sd>             Defaults to 0.0.</span>
<a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a><span class=sd>        width (float, optional): Width parameter of the Gaussian distribution as used</span>
<a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=sd>             in the ORCA program. Defaults to 1.0.</span>
<a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>
<a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=sd>        NDArray[np.float64]: Gaussian distribution of `x` given.</span>
<a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a>    <span class=k>return</span> <span class=n>DistributionModels</span><span class=o>.</span><span class=n>_gaussian_core</span><span class=p>(</span>
<a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=n>amplitude</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=n>center</span><span class=p>,</span> <span class=n>scale</span><span class=o>=</span><span class=n>width</span>
<a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.pearson1 class="doc doc-heading"> <code class="highlight language-python"><span class=n>pearson1</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>exponent</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.pearson1 class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional Pearson type I distribution.</p> <pre class=arithmatex>\[
f(x) = \frac{A}{\sigma \sqrt{2 \pi}} \left[1 + \frac{(x - c)^2}{\sigma^2}
\right]^{-\frac{1}{\nu}}
\]</pre> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the Pearson type I function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>center</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the Pearson type I function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>sigma</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Sigma of the Pearson type I function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>exponent</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Exponent of the Pearson type I function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Pearson type I function of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-636 name=__codelineno-0-636></a><a href=#__codelineno-0-636><span class=linenos data-linenos="636 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-637 name=__codelineno-0-637></a><a href=#__codelineno-0-637><span class=linenos data-linenos="637 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>pearson1</span><span class=p>(</span>
<a id=__codelineno-0-638 name=__codelineno-0-638></a><a href=#__codelineno-0-638><span class=linenos data-linenos="638 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-639 name=__codelineno-0-639></a><a href=#__codelineno-0-639><span class=linenos data-linenos="639 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-640 name=__codelineno-0-640></a><a href=#__codelineno-0-640><span class=linenos data-linenos="640 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-641 name=__codelineno-0-641></a><a href=#__codelineno-0-641><span class=linenos data-linenos="641 "></span></a>    <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-642 name=__codelineno-0-642></a><a href=#__codelineno-0-642><span class=linenos data-linenos="642 "></span></a>    <span class=n>exponent</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-643 name=__codelineno-0-643></a><a href=#__codelineno-0-643><span class=linenos data-linenos="643 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-644 name=__codelineno-0-644></a><a href=#__codelineno-0-644><span class=linenos data-linenos="644 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Pearson type I distribution.</span>
<a id=__codelineno-0-645 name=__codelineno-0-645></a><a href=#__codelineno-0-645><span class=linenos data-linenos="645 "></span></a>
<a id=__codelineno-0-646 name=__codelineno-0-646></a><a href=#__codelineno-0-646><span class=linenos data-linenos="646 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-647 name=__codelineno-0-647></a><a href=#__codelineno-0-647><span class=linenos data-linenos="647 "></span></a><span class=sd>    f(x) = \frac{A}{\sigma \sqrt{2 \pi}} \left[1 + \frac{(x - c)^2}{\sigma^2}</span>
<a id=__codelineno-0-648 name=__codelineno-0-648></a><a href=#__codelineno-0-648><span class=linenos data-linenos="648 "></span></a><span class=sd>    \right]^{-\frac{1}{\nu}}</span>
<a id=__codelineno-0-649 name=__codelineno-0-649></a><a href=#__codelineno-0-649><span class=linenos data-linenos="649 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-650 name=__codelineno-0-650></a><a href=#__codelineno-0-650><span class=linenos data-linenos="650 "></span></a>
<a id=__codelineno-0-651 name=__codelineno-0-651></a><a href=#__codelineno-0-651><span class=linenos data-linenos="651 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-652 name=__codelineno-0-652></a><a href=#__codelineno-0-652><span class=linenos data-linenos="652 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-653 name=__codelineno-0-653></a><a href=#__codelineno-0-653><span class=linenos data-linenos="653 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the Pearson type I function.</span>
<a id=__codelineno-0-654 name=__codelineno-0-654></a><a href=#__codelineno-0-654><span class=linenos data-linenos="654 "></span></a><span class=sd>                Defaults to 1.0.</span>
<a id=__codelineno-0-655 name=__codelineno-0-655></a><a href=#__codelineno-0-655><span class=linenos data-linenos="655 "></span></a><span class=sd>        center (float, optional): Center of the Pearson type I function.</span>
<a id=__codelineno-0-656 name=__codelineno-0-656></a><a href=#__codelineno-0-656><span class=linenos data-linenos="656 "></span></a><span class=sd>             Defaults to 0.0.</span>
<a id=__codelineno-0-657 name=__codelineno-0-657></a><a href=#__codelineno-0-657><span class=linenos data-linenos="657 "></span></a><span class=sd>        sigma (float, optional): Sigma of the Pearson type I function.</span>
<a id=__codelineno-0-658 name=__codelineno-0-658></a><a href=#__codelineno-0-658><span class=linenos data-linenos="658 "></span></a><span class=sd>             Defaults to 1.0.</span>
<a id=__codelineno-0-659 name=__codelineno-0-659></a><a href=#__codelineno-0-659><span class=linenos data-linenos="659 "></span></a><span class=sd>        exponent (float, optional): Exponent of the Pearson type I function.</span>
<a id=__codelineno-0-660 name=__codelineno-0-660></a><a href=#__codelineno-0-660><span class=linenos data-linenos="660 "></span></a><span class=sd>             Defaults to 1.0.</span>
<a id=__codelineno-0-661 name=__codelineno-0-661></a><a href=#__codelineno-0-661><span class=linenos data-linenos="661 "></span></a>
<a id=__codelineno-0-662 name=__codelineno-0-662></a><a href=#__codelineno-0-662><span class=linenos data-linenos="662 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-663 name=__codelineno-0-663></a><a href=#__codelineno-0-663><span class=linenos data-linenos="663 "></span></a><span class=sd>        NDArray[np.float64]: Pearson type I function of `x` given.</span>
<a id=__codelineno-0-664 name=__codelineno-0-664></a><a href=#__codelineno-0-664><span class=linenos data-linenos="664 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-665 name=__codelineno-0-665></a><a href=#__codelineno-0-665><span class=linenos data-linenos="665 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-666 name=__codelineno-0-666></a><a href=#__codelineno-0-666><span class=linenos data-linenos="666 "></span></a>        <span class=n>amplitude</span>
<a id=__codelineno-0-667 name=__codelineno-0-667></a><a href=#__codelineno-0-667><span class=linenos data-linenos="667 "></span></a>        <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>))</span>
<a id=__codelineno-0-668 name=__codelineno-0-668></a><a href=#__codelineno-0-668><span class=linenos data-linenos="668 "></span></a>        <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span> <span class=o>/</span> <span class=n>exponent</span><span class=p>)</span>
<a id=__codelineno-0-669 name=__codelineno-0-669></a><a href=#__codelineno-0-669><span class=linenos data-linenos="669 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.pearson2 class="doc doc-heading"> <code class="highlight language-python"><span class=n>pearson2</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>exponent</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.pearson2 class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional Pearson type II distribution.</p> <pre class=arithmatex>\[
f(x) = \frac{A}{\sigma \sqrt{2 \pi}} \left[1 + \frac{(x - c)^2}{2 \sigma^2}
\right]^{-\nu}
\]</pre> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the Pearson type II function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>center</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the Pearson type II function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>sigma</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Sigma of the Pearson type II function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>exponent</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Exponent of the Pearson type II function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Pearson type II function of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-671 name=__codelineno-0-671></a><a href=#__codelineno-0-671><span class=linenos data-linenos="671 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-672 name=__codelineno-0-672></a><a href=#__codelineno-0-672><span class=linenos data-linenos="672 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>pearson2</span><span class=p>(</span>
<a id=__codelineno-0-673 name=__codelineno-0-673></a><a href=#__codelineno-0-673><span class=linenos data-linenos="673 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-674 name=__codelineno-0-674></a><a href=#__codelineno-0-674><span class=linenos data-linenos="674 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-675 name=__codelineno-0-675></a><a href=#__codelineno-0-675><span class=linenos data-linenos="675 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-676 name=__codelineno-0-676></a><a href=#__codelineno-0-676><span class=linenos data-linenos="676 "></span></a>    <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-677 name=__codelineno-0-677></a><a href=#__codelineno-0-677><span class=linenos data-linenos="677 "></span></a>    <span class=n>exponent</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-678 name=__codelineno-0-678></a><a href=#__codelineno-0-678><span class=linenos data-linenos="678 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-679 name=__codelineno-0-679></a><a href=#__codelineno-0-679><span class=linenos data-linenos="679 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Pearson type II distribution.</span>
<a id=__codelineno-0-680 name=__codelineno-0-680></a><a href=#__codelineno-0-680><span class=linenos data-linenos="680 "></span></a>
<a id=__codelineno-0-681 name=__codelineno-0-681></a><a href=#__codelineno-0-681><span class=linenos data-linenos="681 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-682 name=__codelineno-0-682></a><a href=#__codelineno-0-682><span class=linenos data-linenos="682 "></span></a><span class=sd>    f(x) = \frac{A}{\sigma \sqrt{2 \pi}} \left[1 + \frac{(x - c)^2}{2 \sigma^2}</span>
<a id=__codelineno-0-683 name=__codelineno-0-683></a><a href=#__codelineno-0-683><span class=linenos data-linenos="683 "></span></a><span class=sd>    \right]^{-\nu}</span>
<a id=__codelineno-0-684 name=__codelineno-0-684></a><a href=#__codelineno-0-684><span class=linenos data-linenos="684 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-685 name=__codelineno-0-685></a><a href=#__codelineno-0-685><span class=linenos data-linenos="685 "></span></a>
<a id=__codelineno-0-686 name=__codelineno-0-686></a><a href=#__codelineno-0-686><span class=linenos data-linenos="686 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-687 name=__codelineno-0-687></a><a href=#__codelineno-0-687><span class=linenos data-linenos="687 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-688 name=__codelineno-0-688></a><a href=#__codelineno-0-688><span class=linenos data-linenos="688 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the Pearson type II function.</span>
<a id=__codelineno-0-689 name=__codelineno-0-689></a><a href=#__codelineno-0-689><span class=linenos data-linenos="689 "></span></a><span class=sd>                Defaults to 1.0.</span>
<a id=__codelineno-0-690 name=__codelineno-0-690></a><a href=#__codelineno-0-690><span class=linenos data-linenos="690 "></span></a><span class=sd>        center (float, optional): Center of the Pearson type II function.</span>
<a id=__codelineno-0-691 name=__codelineno-0-691></a><a href=#__codelineno-0-691><span class=linenos data-linenos="691 "></span></a><span class=sd>             Defaults to 0.0.</span>
<a id=__codelineno-0-692 name=__codelineno-0-692></a><a href=#__codelineno-0-692><span class=linenos data-linenos="692 "></span></a><span class=sd>        sigma (float, optional): Sigma of the Pearson type II function.</span>
<a id=__codelineno-0-693 name=__codelineno-0-693></a><a href=#__codelineno-0-693><span class=linenos data-linenos="693 "></span></a><span class=sd>             Defaults to 1.0.</span>
<a id=__codelineno-0-694 name=__codelineno-0-694></a><a href=#__codelineno-0-694><span class=linenos data-linenos="694 "></span></a><span class=sd>        exponent (float, optional): Exponent of the Pearson type II function.</span>
<a id=__codelineno-0-695 name=__codelineno-0-695></a><a href=#__codelineno-0-695><span class=linenos data-linenos="695 "></span></a><span class=sd>             Defaults to 1.0.</span>
<a id=__codelineno-0-696 name=__codelineno-0-696></a><a href=#__codelineno-0-696><span class=linenos data-linenos="696 "></span></a>
<a id=__codelineno-0-697 name=__codelineno-0-697></a><a href=#__codelineno-0-697><span class=linenos data-linenos="697 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-698 name=__codelineno-0-698></a><a href=#__codelineno-0-698><span class=linenos data-linenos="698 "></span></a><span class=sd>        NDArray[np.float64]: Pearson type II function of `x` given.</span>
<a id=__codelineno-0-699 name=__codelineno-0-699></a><a href=#__codelineno-0-699><span class=linenos data-linenos="699 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-700 name=__codelineno-0-700></a><a href=#__codelineno-0-700><span class=linenos data-linenos="700 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-701 name=__codelineno-0-701></a><a href=#__codelineno-0-701><span class=linenos data-linenos="701 "></span></a>        <span class=n>amplitude</span>
<a id=__codelineno-0-702 name=__codelineno-0-702></a><a href=#__codelineno-0-702><span class=linenos data-linenos="702 "></span></a>        <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span><span class=p>))</span>
<a id=__codelineno-0-703 name=__codelineno-0-703></a><a href=#__codelineno-0-703><span class=linenos data-linenos="703 "></span></a>        <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>**</span> <span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=n>exponent</span><span class=p>)</span>
<a id=__codelineno-0-704 name=__codelineno-0-704></a><a href=#__codelineno-0-704><span class=linenos data-linenos="704 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.pearson3 class="doc doc-heading"> <code class="highlight language-python"><span class=n>pearson3</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>exponent</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>skewness</span><span class=o>=</span><span class=mf>0.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.pearson3 class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional Pearson type III distribution.</p> <pre class=arithmatex>\[
f(x) = \frac{A}{\sigma \sqrt{2 \pi}} \left[1 + \frac{(x - c)^2}{2 \sigma^2}
\right]^{-\nu} \left[1 + \frac{\gamma}{\nu}
\frac{x - c}{\sigma} \right]^{-\nu - 1}
\]</pre> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the Pearson type III function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>center</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the Pearson type III function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>sigma</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Sigma of the Pearson type III function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>exponent</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Exponent of the Pearson type III function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>skewness</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Skewness of the Pearson type III function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Pearson type III function of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-706 name=__codelineno-0-706></a><a href=#__codelineno-0-706><span class=linenos data-linenos="706 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-707 name=__codelineno-0-707></a><a href=#__codelineno-0-707><span class=linenos data-linenos="707 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>pearson3</span><span class=p>(</span>
<a id=__codelineno-0-708 name=__codelineno-0-708></a><a href=#__codelineno-0-708><span class=linenos data-linenos="708 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-709 name=__codelineno-0-709></a><a href=#__codelineno-0-709><span class=linenos data-linenos="709 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-710 name=__codelineno-0-710></a><a href=#__codelineno-0-710><span class=linenos data-linenos="710 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-711 name=__codelineno-0-711></a><a href=#__codelineno-0-711><span class=linenos data-linenos="711 "></span></a>    <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-712 name=__codelineno-0-712></a><a href=#__codelineno-0-712><span class=linenos data-linenos="712 "></span></a>    <span class=n>exponent</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-713 name=__codelineno-0-713></a><a href=#__codelineno-0-713><span class=linenos data-linenos="713 "></span></a>    <span class=n>skewness</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-714 name=__codelineno-0-714></a><a href=#__codelineno-0-714><span class=linenos data-linenos="714 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-715 name=__codelineno-0-715></a><a href=#__codelineno-0-715><span class=linenos data-linenos="715 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Pearson type III distribution.</span>
<a id=__codelineno-0-716 name=__codelineno-0-716></a><a href=#__codelineno-0-716><span class=linenos data-linenos="716 "></span></a>
<a id=__codelineno-0-717 name=__codelineno-0-717></a><a href=#__codelineno-0-717><span class=linenos data-linenos="717 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-718 name=__codelineno-0-718></a><a href=#__codelineno-0-718><span class=linenos data-linenos="718 "></span></a><span class=sd>    f(x) = \frac{A}{\sigma \sqrt{2 \pi}} \left[1 + \frac{(x - c)^2}{2 \sigma^2}</span>
<a id=__codelineno-0-719 name=__codelineno-0-719></a><a href=#__codelineno-0-719><span class=linenos data-linenos="719 "></span></a><span class=sd>    \right]^{-\nu} \left[1 + \frac{\gamma}{\nu}</span>
<a id=__codelineno-0-720 name=__codelineno-0-720></a><a href=#__codelineno-0-720><span class=linenos data-linenos="720 "></span></a><span class=sd>    \frac{x - c}{\sigma} \right]^{-\nu - 1}</span>
<a id=__codelineno-0-721 name=__codelineno-0-721></a><a href=#__codelineno-0-721><span class=linenos data-linenos="721 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-722 name=__codelineno-0-722></a><a href=#__codelineno-0-722><span class=linenos data-linenos="722 "></span></a>
<a id=__codelineno-0-723 name=__codelineno-0-723></a><a href=#__codelineno-0-723><span class=linenos data-linenos="723 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-724 name=__codelineno-0-724></a><a href=#__codelineno-0-724><span class=linenos data-linenos="724 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-725 name=__codelineno-0-725></a><a href=#__codelineno-0-725><span class=linenos data-linenos="725 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the Pearson type III function.</span>
<a id=__codelineno-0-726 name=__codelineno-0-726></a><a href=#__codelineno-0-726><span class=linenos data-linenos="726 "></span></a><span class=sd>                Defaults to 1.0.</span>
<a id=__codelineno-0-727 name=__codelineno-0-727></a><a href=#__codelineno-0-727><span class=linenos data-linenos="727 "></span></a><span class=sd>        center (float, optional): Center of the Pearson type III function.</span>
<a id=__codelineno-0-728 name=__codelineno-0-728></a><a href=#__codelineno-0-728><span class=linenos data-linenos="728 "></span></a><span class=sd>             Defaults to 0.0.</span>
<a id=__codelineno-0-729 name=__codelineno-0-729></a><a href=#__codelineno-0-729><span class=linenos data-linenos="729 "></span></a><span class=sd>        sigma (float, optional): Sigma of the Pearson type III function.</span>
<a id=__codelineno-0-730 name=__codelineno-0-730></a><a href=#__codelineno-0-730><span class=linenos data-linenos="730 "></span></a><span class=sd>             Defaults to 1.0.</span>
<a id=__codelineno-0-731 name=__codelineno-0-731></a><a href=#__codelineno-0-731><span class=linenos data-linenos="731 "></span></a><span class=sd>        exponent (float, optional): Exponent of the Pearson type III function.</span>
<a id=__codelineno-0-732 name=__codelineno-0-732></a><a href=#__codelineno-0-732><span class=linenos data-linenos="732 "></span></a><span class=sd>             Defaults to 1.0.</span>
<a id=__codelineno-0-733 name=__codelineno-0-733></a><a href=#__codelineno-0-733><span class=linenos data-linenos="733 "></span></a><span class=sd>        skewness (float, optional): Skewness of the Pearson type III function.</span>
<a id=__codelineno-0-734 name=__codelineno-0-734></a><a href=#__codelineno-0-734><span class=linenos data-linenos="734 "></span></a><span class=sd>             Defaults to 0.0.</span>
<a id=__codelineno-0-735 name=__codelineno-0-735></a><a href=#__codelineno-0-735><span class=linenos data-linenos="735 "></span></a>
<a id=__codelineno-0-736 name=__codelineno-0-736></a><a href=#__codelineno-0-736><span class=linenos data-linenos="736 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-737 name=__codelineno-0-737></a><a href=#__codelineno-0-737><span class=linenos data-linenos="737 "></span></a><span class=sd>        NDArray[np.float64]: Pearson type III function of `x` given.</span>
<a id=__codelineno-0-738 name=__codelineno-0-738></a><a href=#__codelineno-0-738><span class=linenos data-linenos="738 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-739 name=__codelineno-0-739></a><a href=#__codelineno-0-739><span class=linenos data-linenos="739 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-740 name=__codelineno-0-740></a><a href=#__codelineno-0-740><span class=linenos data-linenos="740 "></span></a>        <span class=n>amplitude</span>
<a id=__codelineno-0-741 name=__codelineno-0-741></a><a href=#__codelineno-0-741><span class=linenos data-linenos="741 "></span></a>        <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span><span class=p>))</span>
<a id=__codelineno-0-742 name=__codelineno-0-742></a><a href=#__codelineno-0-742><span class=linenos data-linenos="742 "></span></a>        <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>**</span> <span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=n>exponent</span><span class=p>)</span>
<a id=__codelineno-0-743 name=__codelineno-0-743></a><a href=#__codelineno-0-743><span class=linenos data-linenos="743 "></span></a>        <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span>
<a id=__codelineno-0-744 name=__codelineno-0-744></a><a href=#__codelineno-0-744><span class=linenos data-linenos="744 "></span></a>            <span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>skewness</span> <span class=o>/</span> <span class=n>exponent</span><span class=p>)</span> <span class=o>*</span> <span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>),</span> <span class=o>-</span><span class=n>exponent</span> <span class=o>-</span> <span class=mi>1</span>
<a id=__codelineno-0-745 name=__codelineno-0-745></a><a href=#__codelineno-0-745><span class=linenos data-linenos="745 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-746 name=__codelineno-0-746></a><a href=#__codelineno-0-746><span class=linenos data-linenos="746 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.pearson4 class="doc doc-heading"> <code class="highlight language-python"><span class=n>pearson4</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>sigma</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>exponent</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>skewness</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>kurtosis</span><span class=o>=</span><span class=mf>0.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.pearson4 class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional Pearson type IV distribution.</p> <pre class=arithmatex>\[
f(x) = \frac{A}{\sigma \sqrt{2 \pi}} \left[1 + \frac{(x - c)^2}{2 \sigma^2}
\right]^{-\nu} \left[1 + \frac{\gamma}{\nu}
\frac{x - c}{\sigma} \right]^{-\nu - 1}
\left[1 + \frac{\delta}{\nu}
\left(\frac{x - c}{\sigma}\right)^2 \right]^{-\nu - 1/2}
\]</pre> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the Pearson type IV function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>center</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the Pearson type IV function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>sigma</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Sigma of the Pearson type IV function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>exponent</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Exponent of the Pearson type IV function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>skewness</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Skewness of the Pearson type IV function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>kurtosis</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Kurtosis of the Pearson type IV function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Pearson type IV function of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-748 name=__codelineno-0-748></a><a href=#__codelineno-0-748><span class=linenos data-linenos="748 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-749 name=__codelineno-0-749></a><a href=#__codelineno-0-749><span class=linenos data-linenos="749 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>pearson4</span><span class=p>(</span>
<a id=__codelineno-0-750 name=__codelineno-0-750></a><a href=#__codelineno-0-750><span class=linenos data-linenos="750 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-751 name=__codelineno-0-751></a><a href=#__codelineno-0-751><span class=linenos data-linenos="751 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-752 name=__codelineno-0-752></a><a href=#__codelineno-0-752><span class=linenos data-linenos="752 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-753 name=__codelineno-0-753></a><a href=#__codelineno-0-753><span class=linenos data-linenos="753 "></span></a>    <span class=n>sigma</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-754 name=__codelineno-0-754></a><a href=#__codelineno-0-754><span class=linenos data-linenos="754 "></span></a>    <span class=n>exponent</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-755 name=__codelineno-0-755></a><a href=#__codelineno-0-755><span class=linenos data-linenos="755 "></span></a>    <span class=n>skewness</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-756 name=__codelineno-0-756></a><a href=#__codelineno-0-756><span class=linenos data-linenos="756 "></span></a>    <span class=n>kurtosis</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-757 name=__codelineno-0-757></a><a href=#__codelineno-0-757><span class=linenos data-linenos="757 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-758 name=__codelineno-0-758></a><a href=#__codelineno-0-758><span class=linenos data-linenos="758 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Pearson type IV distribution.</span>
<a id=__codelineno-0-759 name=__codelineno-0-759></a><a href=#__codelineno-0-759><span class=linenos data-linenos="759 "></span></a>
<a id=__codelineno-0-760 name=__codelineno-0-760></a><a href=#__codelineno-0-760><span class=linenos data-linenos="760 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-761 name=__codelineno-0-761></a><a href=#__codelineno-0-761><span class=linenos data-linenos="761 "></span></a><span class=sd>    f(x) = \frac{A}{\sigma \sqrt{2 \pi}} \left[1 + \frac{(x - c)^2}{2 \sigma^2}</span>
<a id=__codelineno-0-762 name=__codelineno-0-762></a><a href=#__codelineno-0-762><span class=linenos data-linenos="762 "></span></a><span class=sd>    \right]^{-\nu} \left[1 + \frac{\gamma}{\nu}</span>
<a id=__codelineno-0-763 name=__codelineno-0-763></a><a href=#__codelineno-0-763><span class=linenos data-linenos="763 "></span></a><span class=sd>    \frac{x - c}{\sigma} \right]^{-\nu - 1}</span>
<a id=__codelineno-0-764 name=__codelineno-0-764></a><a href=#__codelineno-0-764><span class=linenos data-linenos="764 "></span></a><span class=sd>    \left[1 + \frac{\delta}{\nu}</span>
<a id=__codelineno-0-765 name=__codelineno-0-765></a><a href=#__codelineno-0-765><span class=linenos data-linenos="765 "></span></a><span class=sd>    \left(\frac{x - c}{\sigma}\right)^2 \right]^{-\nu - 1/2}</span>
<a id=__codelineno-0-766 name=__codelineno-0-766></a><a href=#__codelineno-0-766><span class=linenos data-linenos="766 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-767 name=__codelineno-0-767></a><a href=#__codelineno-0-767><span class=linenos data-linenos="767 "></span></a>
<a id=__codelineno-0-768 name=__codelineno-0-768></a><a href=#__codelineno-0-768><span class=linenos data-linenos="768 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-769 name=__codelineno-0-769></a><a href=#__codelineno-0-769><span class=linenos data-linenos="769 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-770 name=__codelineno-0-770></a><a href=#__codelineno-0-770><span class=linenos data-linenos="770 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the Pearson type IV function.</span>
<a id=__codelineno-0-771 name=__codelineno-0-771></a><a href=#__codelineno-0-771><span class=linenos data-linenos="771 "></span></a><span class=sd>                Defaults to 1.0.</span>
<a id=__codelineno-0-772 name=__codelineno-0-772></a><a href=#__codelineno-0-772><span class=linenos data-linenos="772 "></span></a><span class=sd>        center (float, optional): Center of the Pearson type IV function.</span>
<a id=__codelineno-0-773 name=__codelineno-0-773></a><a href=#__codelineno-0-773><span class=linenos data-linenos="773 "></span></a><span class=sd>             Defaults to 0.0.</span>
<a id=__codelineno-0-774 name=__codelineno-0-774></a><a href=#__codelineno-0-774><span class=linenos data-linenos="774 "></span></a><span class=sd>        sigma (float, optional): Sigma of the Pearson type IV function.</span>
<a id=__codelineno-0-775 name=__codelineno-0-775></a><a href=#__codelineno-0-775><span class=linenos data-linenos="775 "></span></a><span class=sd>             Defaults to 1.0.</span>
<a id=__codelineno-0-776 name=__codelineno-0-776></a><a href=#__codelineno-0-776><span class=linenos data-linenos="776 "></span></a><span class=sd>        exponent (float, optional): Exponent of the Pearson type IV function.</span>
<a id=__codelineno-0-777 name=__codelineno-0-777></a><a href=#__codelineno-0-777><span class=linenos data-linenos="777 "></span></a><span class=sd>             Defaults to 1.0.</span>
<a id=__codelineno-0-778 name=__codelineno-0-778></a><a href=#__codelineno-0-778><span class=linenos data-linenos="778 "></span></a><span class=sd>        skewness (float, optional): Skewness of the Pearson type IV function.</span>
<a id=__codelineno-0-779 name=__codelineno-0-779></a><a href=#__codelineno-0-779><span class=linenos data-linenos="779 "></span></a><span class=sd>             Defaults to 0.0.</span>
<a id=__codelineno-0-780 name=__codelineno-0-780></a><a href=#__codelineno-0-780><span class=linenos data-linenos="780 "></span></a><span class=sd>        kurtosis (float, optional): Kurtosis of the Pearson type IV function.</span>
<a id=__codelineno-0-781 name=__codelineno-0-781></a><a href=#__codelineno-0-781><span class=linenos data-linenos="781 "></span></a><span class=sd>             Defaults to 0.0.</span>
<a id=__codelineno-0-782 name=__codelineno-0-782></a><a href=#__codelineno-0-782><span class=linenos data-linenos="782 "></span></a>
<a id=__codelineno-0-783 name=__codelineno-0-783></a><a href=#__codelineno-0-783><span class=linenos data-linenos="783 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-784 name=__codelineno-0-784></a><a href=#__codelineno-0-784><span class=linenos data-linenos="784 "></span></a><span class=sd>        NDArray[np.float64]: Pearson type IV function of `x` given.</span>
<a id=__codelineno-0-785 name=__codelineno-0-785></a><a href=#__codelineno-0-785><span class=linenos data-linenos="785 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-786 name=__codelineno-0-786></a><a href=#__codelineno-0-786><span class=linenos data-linenos="786 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-787 name=__codelineno-0-787></a><a href=#__codelineno-0-787><span class=linenos data-linenos="787 "></span></a>        <span class=n>amplitude</span>
<a id=__codelineno-0-788 name=__codelineno-0-788></a><a href=#__codelineno-0-788><span class=linenos data-linenos="788 "></span></a>        <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>pi</span><span class=p>))</span>
<a id=__codelineno-0-789 name=__codelineno-0-789></a><a href=#__codelineno-0-789><span class=linenos data-linenos="789 "></span></a>        <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>sigma</span><span class=p>))</span> <span class=o>**</span> <span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=n>exponent</span><span class=p>)</span>
<a id=__codelineno-0-790 name=__codelineno-0-790></a><a href=#__codelineno-0-790><span class=linenos data-linenos="790 "></span></a>        <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span>
<a id=__codelineno-0-791 name=__codelineno-0-791></a><a href=#__codelineno-0-791><span class=linenos data-linenos="791 "></span></a>            <span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>skewness</span> <span class=o>/</span> <span class=n>exponent</span><span class=p>)</span> <span class=o>*</span> <span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>),</span> <span class=o>-</span><span class=n>exponent</span> <span class=o>-</span> <span class=mi>1</span>
<a id=__codelineno-0-792 name=__codelineno-0-792></a><a href=#__codelineno-0-792><span class=linenos data-linenos="792 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-793 name=__codelineno-0-793></a><a href=#__codelineno-0-793><span class=linenos data-linenos="793 "></span></a>        <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span>
<a id=__codelineno-0-794 name=__codelineno-0-794></a><a href=#__codelineno-0-794><span class=linenos data-linenos="794 "></span></a>            <span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>kurtosis</span> <span class=o>/</span> <span class=n>exponent</span><span class=p>)</span> <span class=o>*</span> <span class=p>((</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-0-795 name=__codelineno-0-795></a><a href=#__codelineno-0-795><span class=linenos data-linenos="795 "></span></a>            <span class=o>-</span><span class=n>exponent</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span>
<a id=__codelineno-0-796 name=__codelineno-0-796></a><a href=#__codelineno-0-796><span class=linenos data-linenos="796 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-797 name=__codelineno-0-797></a><a href=#__codelineno-0-797><span class=linenos data-linenos="797 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.polynom2 class="doc doc-heading"> <code class="highlight language-python"><span class=n>polynom2</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>coefficient0</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>coefficient1</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>coefficient2</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.polynom2 class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional second order polynomial function.</p> <pre class=arithmatex>\[
f(x) = c_2 x^2 + c_1 x + c_0
\]</pre> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>coefficient0</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Zeroth coefficient of the polynomial function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>coefficient1</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>First coefficient of the polynomial function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>coefficient2</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Second coefficient of the polynomial function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Third order polynomial function of <code class="language-text highlight">x</code></p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-577 name=__codelineno-0-577></a><a href=#__codelineno-0-577><span class=linenos data-linenos="577 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-578 name=__codelineno-0-578></a><a href=#__codelineno-0-578><span class=linenos data-linenos="578 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>polynom2</span><span class=p>(</span>
<a id=__codelineno-0-579 name=__codelineno-0-579></a><a href=#__codelineno-0-579><span class=linenos data-linenos="579 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-580 name=__codelineno-0-580></a><a href=#__codelineno-0-580><span class=linenos data-linenos="580 "></span></a>    <span class=n>coefficient0</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-581 name=__codelineno-0-581></a><a href=#__codelineno-0-581><span class=linenos data-linenos="581 "></span></a>    <span class=n>coefficient1</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-582 name=__codelineno-0-582></a><a href=#__codelineno-0-582><span class=linenos data-linenos="582 "></span></a>    <span class=n>coefficient2</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-583 name=__codelineno-0-583></a><a href=#__codelineno-0-583><span class=linenos data-linenos="583 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-584 name=__codelineno-0-584></a><a href=#__codelineno-0-584><span class=linenos data-linenos="584 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional second order polynomial function.</span>
<a id=__codelineno-0-585 name=__codelineno-0-585></a><a href=#__codelineno-0-585><span class=linenos data-linenos="585 "></span></a>
<a id=__codelineno-0-586 name=__codelineno-0-586></a><a href=#__codelineno-0-586><span class=linenos data-linenos="586 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-587 name=__codelineno-0-587></a><a href=#__codelineno-0-587><span class=linenos data-linenos="587 "></span></a><span class=sd>    f(x) = c_2 x^2 + c_1 x + c_0</span>
<a id=__codelineno-0-588 name=__codelineno-0-588></a><a href=#__codelineno-0-588><span class=linenos data-linenos="588 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-589 name=__codelineno-0-589></a><a href=#__codelineno-0-589><span class=linenos data-linenos="589 "></span></a>
<a id=__codelineno-0-590 name=__codelineno-0-590></a><a href=#__codelineno-0-590><span class=linenos data-linenos="590 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-591 name=__codelineno-0-591></a><a href=#__codelineno-0-591><span class=linenos data-linenos="591 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data</span>
<a id=__codelineno-0-592 name=__codelineno-0-592></a><a href=#__codelineno-0-592><span class=linenos data-linenos="592 "></span></a><span class=sd>        coefficient0 (float, optional): Zeroth coefficient of the</span>
<a id=__codelineno-0-593 name=__codelineno-0-593></a><a href=#__codelineno-0-593><span class=linenos data-linenos="593 "></span></a><span class=sd>             polynomial function. Defaults to 1.0.</span>
<a id=__codelineno-0-594 name=__codelineno-0-594></a><a href=#__codelineno-0-594><span class=linenos data-linenos="594 "></span></a><span class=sd>        coefficient1 (float, optional): First coefficient of the</span>
<a id=__codelineno-0-595 name=__codelineno-0-595></a><a href=#__codelineno-0-595><span class=linenos data-linenos="595 "></span></a><span class=sd>             polynomial function. Defaults to 1.0.</span>
<a id=__codelineno-0-596 name=__codelineno-0-596></a><a href=#__codelineno-0-596><span class=linenos data-linenos="596 "></span></a><span class=sd>        coefficient2 (float, optional): Second coefficient of the</span>
<a id=__codelineno-0-597 name=__codelineno-0-597></a><a href=#__codelineno-0-597><span class=linenos data-linenos="597 "></span></a><span class=sd>             polynomial function. Defaults to 1.0.</span>
<a id=__codelineno-0-598 name=__codelineno-0-598></a><a href=#__codelineno-0-598><span class=linenos data-linenos="598 "></span></a>
<a id=__codelineno-0-599 name=__codelineno-0-599></a><a href=#__codelineno-0-599><span class=linenos data-linenos="599 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-600 name=__codelineno-0-600></a><a href=#__codelineno-0-600><span class=linenos data-linenos="600 "></span></a><span class=sd>        NDArray[np.float64]: Third order polynomial function of `x`</span>
<a id=__codelineno-0-601 name=__codelineno-0-601></a><a href=#__codelineno-0-601><span class=linenos data-linenos="601 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-602 name=__codelineno-0-602></a><a href=#__codelineno-0-602><span class=linenos data-linenos="602 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>coefficient0</span> <span class=o>+</span> <span class=n>coefficient1</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=n>coefficient2</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.polynom3 class="doc doc-heading"> <code class="highlight language-python"><span class=n>polynom3</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>coefficient0</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>coefficient1</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>coefficient2</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>coefficient3</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.polynom3 class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional third order polynomial function.</p> <pre class=arithmatex>\[
f(x) = c_3 x^3 + c_2 x^2 + c_1 x + c_0
\]</pre> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>coefficient0</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Zeroth coefficient of the polynomial function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>coefficient1</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>First coefficient of the polynomial function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>coefficient2</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Second coefficient of the polynomial function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>coefficient3</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Third coefficient of the polynomial function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: Third order polynomial function of <code class="language-text highlight">x</code></p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-604 name=__codelineno-0-604></a><a href=#__codelineno-0-604><span class=linenos data-linenos="604 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-605 name=__codelineno-0-605></a><a href=#__codelineno-0-605><span class=linenos data-linenos="605 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>polynom3</span><span class=p>(</span>
<a id=__codelineno-0-606 name=__codelineno-0-606></a><a href=#__codelineno-0-606><span class=linenos data-linenos="606 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-607 name=__codelineno-0-607></a><a href=#__codelineno-0-607><span class=linenos data-linenos="607 "></span></a>    <span class=n>coefficient0</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-608 name=__codelineno-0-608></a><a href=#__codelineno-0-608><span class=linenos data-linenos="608 "></span></a>    <span class=n>coefficient1</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-609 name=__codelineno-0-609></a><a href=#__codelineno-0-609><span class=linenos data-linenos="609 "></span></a>    <span class=n>coefficient2</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-610 name=__codelineno-0-610></a><a href=#__codelineno-0-610><span class=linenos data-linenos="610 "></span></a>    <span class=n>coefficient3</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-611 name=__codelineno-0-611></a><a href=#__codelineno-0-611><span class=linenos data-linenos="611 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-612 name=__codelineno-0-612></a><a href=#__codelineno-0-612><span class=linenos data-linenos="612 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional third order polynomial function.</span>
<a id=__codelineno-0-613 name=__codelineno-0-613></a><a href=#__codelineno-0-613><span class=linenos data-linenos="613 "></span></a>
<a id=__codelineno-0-614 name=__codelineno-0-614></a><a href=#__codelineno-0-614><span class=linenos data-linenos="614 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-615 name=__codelineno-0-615></a><a href=#__codelineno-0-615><span class=linenos data-linenos="615 "></span></a><span class=sd>    f(x) = c_3 x^3 + c_2 x^2 + c_1 x + c_0</span>
<a id=__codelineno-0-616 name=__codelineno-0-616></a><a href=#__codelineno-0-616><span class=linenos data-linenos="616 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-617 name=__codelineno-0-617></a><a href=#__codelineno-0-617><span class=linenos data-linenos="617 "></span></a>
<a id=__codelineno-0-618 name=__codelineno-0-618></a><a href=#__codelineno-0-618><span class=linenos data-linenos="618 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-619 name=__codelineno-0-619></a><a href=#__codelineno-0-619><span class=linenos data-linenos="619 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data</span>
<a id=__codelineno-0-620 name=__codelineno-0-620></a><a href=#__codelineno-0-620><span class=linenos data-linenos="620 "></span></a><span class=sd>        coefficient0 (float, optional): Zeroth coefficient of the</span>
<a id=__codelineno-0-621 name=__codelineno-0-621></a><a href=#__codelineno-0-621><span class=linenos data-linenos="621 "></span></a><span class=sd>             polynomial function. Defaults to 1.0.</span>
<a id=__codelineno-0-622 name=__codelineno-0-622></a><a href=#__codelineno-0-622><span class=linenos data-linenos="622 "></span></a><span class=sd>        coefficient1 (float, optional): First coefficient of the</span>
<a id=__codelineno-0-623 name=__codelineno-0-623></a><a href=#__codelineno-0-623><span class=linenos data-linenos="623 "></span></a><span class=sd>             polynomial function. Defaults to 1.0.</span>
<a id=__codelineno-0-624 name=__codelineno-0-624></a><a href=#__codelineno-0-624><span class=linenos data-linenos="624 "></span></a><span class=sd>        coefficient2 (float, optional): Second coefficient of the</span>
<a id=__codelineno-0-625 name=__codelineno-0-625></a><a href=#__codelineno-0-625><span class=linenos data-linenos="625 "></span></a><span class=sd>             polynomial function. Defaults to 1.0.</span>
<a id=__codelineno-0-626 name=__codelineno-0-626></a><a href=#__codelineno-0-626><span class=linenos data-linenos="626 "></span></a><span class=sd>        coefficient3 (float, optional): Third coefficient of the</span>
<a id=__codelineno-0-627 name=__codelineno-0-627></a><a href=#__codelineno-0-627><span class=linenos data-linenos="627 "></span></a><span class=sd>             polynomial function. Defaults to 1.0.</span>
<a id=__codelineno-0-628 name=__codelineno-0-628></a><a href=#__codelineno-0-628><span class=linenos data-linenos="628 "></span></a>
<a id=__codelineno-0-629 name=__codelineno-0-629></a><a href=#__codelineno-0-629><span class=linenos data-linenos="629 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-630 name=__codelineno-0-630></a><a href=#__codelineno-0-630><span class=linenos data-linenos="630 "></span></a><span class=sd>        NDArray[np.float64]: Third order polynomial function of `x`</span>
<a id=__codelineno-0-631 name=__codelineno-0-631></a><a href=#__codelineno-0-631><span class=linenos data-linenos="631 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-632 name=__codelineno-0-632></a><a href=#__codelineno-0-632><span class=linenos data-linenos="632 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-633 name=__codelineno-0-633></a><a href=#__codelineno-0-633><span class=linenos data-linenos="633 "></span></a>        <span class=n>coefficient0</span> <span class=o>+</span> <span class=n>coefficient1</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=n>coefficient2</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span> <span class=o>+</span> <span class=n>coefficient3</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mi>3</span>
<a id=__codelineno-0-634 name=__codelineno-0-634></a><a href=#__codelineno-0-634><span class=linenos data-linenos="634 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.power class="doc doc-heading"> <code class="highlight language-python"><span class=n>power</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>exponent</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>intercept</span><span class=o>=</span><span class=mf>0.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.power class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional power function.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the power function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>exponent</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Exponent of the power function. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>intercept</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Intercept of the power function. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: power function of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-288 name=__codelineno-0-288></a><a href=#__codelineno-0-288><span class=linenos data-linenos="288 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-289 name=__codelineno-0-289></a><a href=#__codelineno-0-289><span class=linenos data-linenos="289 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>power</span><span class=p>(</span>
<a id=__codelineno-0-290 name=__codelineno-0-290></a><a href=#__codelineno-0-290><span class=linenos data-linenos="290 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-291 name=__codelineno-0-291></a><a href=#__codelineno-0-291><span class=linenos data-linenos="291 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-292 name=__codelineno-0-292></a><a href=#__codelineno-0-292><span class=linenos data-linenos="292 "></span></a>    <span class=n>exponent</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-293 name=__codelineno-0-293></a><a href=#__codelineno-0-293><span class=linenos data-linenos="293 "></span></a>    <span class=n>intercept</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-294 name=__codelineno-0-294></a><a href=#__codelineno-0-294><span class=linenos data-linenos="294 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-295 name=__codelineno-0-295></a><a href=#__codelineno-0-295><span class=linenos data-linenos="295 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional power function.</span>
<a id=__codelineno-0-296 name=__codelineno-0-296></a><a href=#__codelineno-0-296><span class=linenos data-linenos="296 "></span></a>
<a id=__codelineno-0-297 name=__codelineno-0-297></a><a href=#__codelineno-0-297><span class=linenos data-linenos="297 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-298 name=__codelineno-0-298></a><a href=#__codelineno-0-298><span class=linenos data-linenos="298 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-299 name=__codelineno-0-299></a><a href=#__codelineno-0-299><span class=linenos data-linenos="299 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the power function. Defaults to</span>
<a id=__codelineno-0-300 name=__codelineno-0-300></a><a href=#__codelineno-0-300><span class=linenos data-linenos="300 "></span></a><span class=sd>            1.0.</span>
<a id=__codelineno-0-301 name=__codelineno-0-301></a><a href=#__codelineno-0-301><span class=linenos data-linenos="301 "></span></a><span class=sd>        exponent (float, optional): Exponent of the power function. Defaults to 1.0.</span>
<a id=__codelineno-0-302 name=__codelineno-0-302></a><a href=#__codelineno-0-302><span class=linenos data-linenos="302 "></span></a><span class=sd>        intercept (float, optional): Intercept of the power function. Defaults to</span>
<a id=__codelineno-0-303 name=__codelineno-0-303></a><a href=#__codelineno-0-303><span class=linenos data-linenos="303 "></span></a><span class=sd>            0.0.</span>
<a id=__codelineno-0-304 name=__codelineno-0-304></a><a href=#__codelineno-0-304><span class=linenos data-linenos="304 "></span></a>
<a id=__codelineno-0-305 name=__codelineno-0-305></a><a href=#__codelineno-0-305><span class=linenos data-linenos="305 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-306 name=__codelineno-0-306></a><a href=#__codelineno-0-306><span class=linenos data-linenos="306 "></span></a><span class=sd>        NDArray[np.float64]: power function of `x` given.</span>
<a id=__codelineno-0-307 name=__codelineno-0-307></a><a href=#__codelineno-0-307><span class=linenos data-linenos="307 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-308 name=__codelineno-0-308></a><a href=#__codelineno-0-308><span class=linenos data-linenos="308 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>amplitude</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>exponent</span><span class=p>)</span> <span class=o>+</span> <span class=n>intercept</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.pseudovoigt class="doc doc-heading"> <code class="highlight language-python"><span class=n>pseudovoigt</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>fwhmg</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>fwhml</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.pseudovoigt class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional <abbr title="A peak function approximating the Voigt profile, calculated as a linear combination or sum of Gaussian and Lorentzian shapes">Pseudo-Voigt</abbr> distribution.</p> <div class="admonition note"> <p class=admonition-title>See also:</p> <p>J. Appl. Cryst. (2000). 33, 1311-1316 <a href=https://doi.org/10.1107/S0021889800010219>doi.org/10.1107/S0021889800010219</a></p> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>amplitude</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The height or maximum value of a peak function">Amplitude</abbr> of the <abbr title="A peak function approximating the Voigt profile, calculated as a linear combination or sum of Gaussian and Lorentzian shapes">Pseudo-Voigt</abbr> distribution. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>center</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the <abbr title="A peak function approximating the Voigt profile, calculated as a linear combination or sum of Gaussian and Lorentzian shapes">Pseudo-Voigt</abbr> distribution. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>fwhmg</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Full width half maximum of the <abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr> distribution in the <abbr title="A peak function approximating the Voigt profile, calculated as a linear combination or sum of Gaussian and Lorentzian shapes">Pseudo-Voigt</abbr> distribution. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>fwhml</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Full width half maximum of the <abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr> distribution in the <abbr title="A peak function approximating the Voigt profile, calculated as a linear combination or sum of Gaussian and Lorentzian shapes">Pseudo-Voigt</abbr> distribution. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: <abbr title="A peak function approximating the Voigt profile, calculated as a linear combination or sum of Gaussian and Lorentzian shapes">Pseudo-Voigt</abbr> distribution of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-212 name=__codelineno-0-212></a><a href=#__codelineno-0-212><span class=linenos data-linenos="212 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-213 name=__codelineno-0-213></a><a href=#__codelineno-0-213><span class=linenos data-linenos="213 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>pseudovoigt</span><span class=p>(</span>
<a id=__codelineno-0-214 name=__codelineno-0-214></a><a href=#__codelineno-0-214><span class=linenos data-linenos="214 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-215 name=__codelineno-0-215></a><a href=#__codelineno-0-215><span class=linenos data-linenos="215 "></span></a>    <span class=n>amplitude</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-216 name=__codelineno-0-216></a><a href=#__codelineno-0-216><span class=linenos data-linenos="216 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-217 name=__codelineno-0-217></a><a href=#__codelineno-0-217><span class=linenos data-linenos="217 "></span></a>    <span class=n>fwhmg</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-218 name=__codelineno-0-218></a><a href=#__codelineno-0-218><span class=linenos data-linenos="218 "></span></a>    <span class=n>fwhml</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-219 name=__codelineno-0-219></a><a href=#__codelineno-0-219><span class=linenos data-linenos="219 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-220 name=__codelineno-0-220></a><a href=#__codelineno-0-220><span class=linenos data-linenos="220 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Pseudo-Voigt distribution.</span>
<a id=__codelineno-0-221 name=__codelineno-0-221></a><a href=#__codelineno-0-221><span class=linenos data-linenos="221 "></span></a>
<a id=__codelineno-0-222 name=__codelineno-0-222></a><a href=#__codelineno-0-222><span class=linenos data-linenos="222 "></span></a><span class=sd>    !!! note &quot;See also:&quot;</span>
<a id=__codelineno-0-223 name=__codelineno-0-223></a><a href=#__codelineno-0-223><span class=linenos data-linenos="223 "></span></a>
<a id=__codelineno-0-224 name=__codelineno-0-224></a><a href=#__codelineno-0-224><span class=linenos data-linenos="224 "></span></a><span class=sd>        J. Appl. Cryst. (2000). 33, 1311-1316</span>
<a id=__codelineno-0-225 name=__codelineno-0-225></a><a href=#__codelineno-0-225><span class=linenos data-linenos="225 "></span></a><span class=sd>        https://doi.org/10.1107/S0021889800010219</span>
<a id=__codelineno-0-226 name=__codelineno-0-226></a><a href=#__codelineno-0-226><span class=linenos data-linenos="226 "></span></a>
<a id=__codelineno-0-227 name=__codelineno-0-227></a><a href=#__codelineno-0-227><span class=linenos data-linenos="227 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-228 name=__codelineno-0-228></a><a href=#__codelineno-0-228><span class=linenos data-linenos="228 "></span></a><span class=sd>        x (NDArray[np.float64]):  `x`-values of the data.</span>
<a id=__codelineno-0-229 name=__codelineno-0-229></a><a href=#__codelineno-0-229><span class=linenos data-linenos="229 "></span></a><span class=sd>        amplitude (float, optional): Amplitude of the Pseudo-Voigt distribution.</span>
<a id=__codelineno-0-230 name=__codelineno-0-230></a><a href=#__codelineno-0-230><span class=linenos data-linenos="230 "></span></a><span class=sd>            Defaults to 1.0.</span>
<a id=__codelineno-0-231 name=__codelineno-0-231></a><a href=#__codelineno-0-231><span class=linenos data-linenos="231 "></span></a><span class=sd>        center (float, optional): Center of the Pseudo-Voigt distribution.</span>
<a id=__codelineno-0-232 name=__codelineno-0-232></a><a href=#__codelineno-0-232><span class=linenos data-linenos="232 "></span></a><span class=sd>            Defaults to 0.0.</span>
<a id=__codelineno-0-233 name=__codelineno-0-233></a><a href=#__codelineno-0-233><span class=linenos data-linenos="233 "></span></a><span class=sd>        fwhmg (float, optional): Full width half maximum of the Gaussian</span>
<a id=__codelineno-0-234 name=__codelineno-0-234></a><a href=#__codelineno-0-234><span class=linenos data-linenos="234 "></span></a><span class=sd>            distribution in the Pseudo-Voigt distribution. Defaults to 1.0.</span>
<a id=__codelineno-0-235 name=__codelineno-0-235></a><a href=#__codelineno-0-235><span class=linenos data-linenos="235 "></span></a><span class=sd>        fwhml (float, optional): Full width half maximum of the Lorentzian</span>
<a id=__codelineno-0-236 name=__codelineno-0-236></a><a href=#__codelineno-0-236><span class=linenos data-linenos="236 "></span></a><span class=sd>            distribution in the Pseudo-Voigt distribution. Defaults to 1.0.</span>
<a id=__codelineno-0-237 name=__codelineno-0-237></a><a href=#__codelineno-0-237><span class=linenos data-linenos="237 "></span></a>
<a id=__codelineno-0-238 name=__codelineno-0-238></a><a href=#__codelineno-0-238><span class=linenos data-linenos="238 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-239 name=__codelineno-0-239></a><a href=#__codelineno-0-239><span class=linenos data-linenos="239 "></span></a><span class=sd>        NDArray[np.float64]: Pseudo-Voigt distribution of `x` given.</span>
<a id=__codelineno-0-240 name=__codelineno-0-240></a><a href=#__codelineno-0-240><span class=linenos data-linenos="240 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-241 name=__codelineno-0-241></a><a href=#__codelineno-0-241><span class=linenos data-linenos="241 "></span></a>    <span class=n>f</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span>
<a id=__codelineno-0-242 name=__codelineno-0-242></a><a href=#__codelineno-0-242><span class=linenos data-linenos="242 "></span></a>        <span class=n>fwhmg</span><span class=o>**</span><span class=mi>5</span>
<a id=__codelineno-0-243 name=__codelineno-0-243></a><a href=#__codelineno-0-243><span class=linenos data-linenos="243 "></span></a>        <span class=o>+</span> <span class=mf>2.69269</span> <span class=o>*</span> <span class=n>fwhmg</span><span class=o>**</span><span class=mi>4</span> <span class=o>*</span> <span class=n>fwhml</span>
<a id=__codelineno-0-244 name=__codelineno-0-244></a><a href=#__codelineno-0-244><span class=linenos data-linenos="244 "></span></a>        <span class=o>+</span> <span class=mf>2.42843</span> <span class=o>*</span> <span class=n>fwhmg</span><span class=o>**</span><span class=mi>3</span> <span class=o>*</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>2</span>
<a id=__codelineno-0-245 name=__codelineno-0-245></a><a href=#__codelineno-0-245><span class=linenos data-linenos="245 "></span></a>        <span class=o>+</span> <span class=mf>4.47163</span> <span class=o>*</span> <span class=n>fwhmg</span><span class=o>**</span><span class=mi>2</span> <span class=o>*</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>3</span>
<a id=__codelineno-0-246 name=__codelineno-0-246></a><a href=#__codelineno-0-246><span class=linenos data-linenos="246 "></span></a>        <span class=o>+</span> <span class=mf>0.07842</span> <span class=o>*</span> <span class=n>fwhmg</span> <span class=o>*</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>4</span>
<a id=__codelineno-0-247 name=__codelineno-0-247></a><a href=#__codelineno-0-247><span class=linenos data-linenos="247 "></span></a>        <span class=o>+</span> <span class=n>fwhml</span><span class=o>**</span><span class=mi>5</span><span class=p>,</span>
<a id=__codelineno-0-248 name=__codelineno-0-248></a><a href=#__codelineno-0-248><span class=linenos data-linenos="248 "></span></a>        <span class=mf>0.2</span><span class=p>,</span>
<a id=__codelineno-0-249 name=__codelineno-0-249></a><a href=#__codelineno-0-249><span class=linenos data-linenos="249 "></span></a>    <span class=p>)</span>
<a id=__codelineno-0-250 name=__codelineno-0-250></a><a href=#__codelineno-0-250><span class=linenos data-linenos="250 "></span></a>    <span class=n>n</span> <span class=o>=</span> <span class=p>(</span>
<a id=__codelineno-0-251 name=__codelineno-0-251></a><a href=#__codelineno-0-251><span class=linenos data-linenos="251 "></span></a>        <span class=mf>1.36603</span> <span class=o>*</span> <span class=p>(</span><span class=n>fwhml</span> <span class=o>/</span> <span class=n>f</span><span class=p>)</span>
<a id=__codelineno-0-252 name=__codelineno-0-252></a><a href=#__codelineno-0-252><span class=linenos data-linenos="252 "></span></a>        <span class=o>-</span> <span class=mf>0.47719</span> <span class=o>*</span> <span class=p>(</span><span class=n>fwhml</span> <span class=o>/</span> <span class=n>f</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span>
<a id=__codelineno-0-253 name=__codelineno-0-253></a><a href=#__codelineno-0-253><span class=linenos data-linenos="253 "></span></a>        <span class=o>+</span> <span class=mf>0.11116</span> <span class=o>*</span> <span class=p>(</span><span class=n>fwhml</span> <span class=o>/</span> <span class=n>f</span><span class=p>)</span> <span class=o>**</span> <span class=mi>3</span>
<a id=__codelineno-0-254 name=__codelineno-0-254></a><a href=#__codelineno-0-254><span class=linenos data-linenos="254 "></span></a>    <span class=p>)</span>
<a id=__codelineno-0-255 name=__codelineno-0-255></a><a href=#__codelineno-0-255><span class=linenos data-linenos="255 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
<a id=__codelineno-0-256 name=__codelineno-0-256></a><a href=#__codelineno-0-256><span class=linenos data-linenos="256 "></span></a>        <span class=n>n</span>
<a id=__codelineno-0-257 name=__codelineno-0-257></a><a href=#__codelineno-0-257><span class=linenos data-linenos="257 "></span></a>        <span class=o>*</span> <span class=n>DistributionModels</span><span class=o>.</span><span class=n>lorentzian</span><span class=p>(</span>
<a id=__codelineno-0-258 name=__codelineno-0-258></a><a href=#__codelineno-0-258><span class=linenos data-linenos="258 "></span></a>            <span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=n>amplitude</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=n>center</span><span class=p>,</span> <span class=n>fwhml</span><span class=o>=</span><span class=n>fwhml</span>
<a id=__codelineno-0-259 name=__codelineno-0-259></a><a href=#__codelineno-0-259><span class=linenos data-linenos="259 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-260 name=__codelineno-0-260></a><a href=#__codelineno-0-260><span class=linenos data-linenos="260 "></span></a>        <span class=o>+</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>n</span><span class=p>)</span>
<a id=__codelineno-0-261 name=__codelineno-0-261></a><a href=#__codelineno-0-261><span class=linenos data-linenos="261 "></span></a>        <span class=o>*</span> <span class=n>DistributionModels</span><span class=o>.</span><span class=n>gaussian</span><span class=p>(</span>
<a id=__codelineno-0-262 name=__codelineno-0-262></a><a href=#__codelineno-0-262><span class=linenos data-linenos="262 "></span></a>            <span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=p>,</span> <span class=n>amplitude</span><span class=o>=</span><span class=n>amplitude</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=n>center</span><span class=p>,</span> <span class=n>fwhmg</span><span class=o>=</span><span class=n>fwhmg</span>
<a id=__codelineno-0-263 name=__codelineno-0-263></a><a href=#__codelineno-0-263><span class=linenos data-linenos="263 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-264 name=__codelineno-0-264></a><a href=#__codelineno-0-264><span class=linenos data-linenos="264 "></span></a>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.DistributionModels.voigt class="doc doc-heading"> <code class="highlight language-python"><span class=n>voigt</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>fwhmv</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>gamma</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.DistributionModels.voigt class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a 1-dimensional <abbr title="A peak function resulting from the Convolution of a Gaussian and a Lorentzian profile">Voigt</abbr> distribution.</p> <pre class=arithmatex>\[
{\displaystyle V(x;\sigma ,\gamma )\equiv
\int_{-\infty }^{\infty }G(x';\sigma )
L(x-x';\gamma )\,dx'}
\]</pre> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>center</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="The position of the maximum of a peak function along the independent variable axis (e.g., energy, wavenumber)">Center</abbr> of the <abbr title="A peak function resulting from the Convolution of a Gaussian and a Lorentzian profile">Voigt</abbr> distribution. Defaults to 0.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>fwhmv</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Full width at half maximum (<abbr title="Full Width at Half Maximum; a measure of the width of a peak function (e.g., fwhmg, fwhml)">FWHM</abbr>) of the <abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr> distribution. Defaults to 1.0.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>1.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>gamma</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Scaling factor of the complex part of the <a href=https://en.wikipedia.org/wiki/Faddeeva_function>Faddeeva Function</a>. Defaults to None.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: <abbr title="A peak function resulting from the Convolution of a Gaussian and a Lorentzian profile">Voigt</abbr> distribution of <code class="language-text highlight">x</code> given.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-179 name=__codelineno-0-179></a><a href=#__codelineno-0-179><span class=linenos data-linenos="179 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-180 name=__codelineno-0-180></a><a href=#__codelineno-0-180><span class=linenos data-linenos="180 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>voigt</span><span class=p>(</span>
<a id=__codelineno-0-181 name=__codelineno-0-181></a><a href=#__codelineno-0-181><span class=linenos data-linenos="181 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-182 name=__codelineno-0-182></a><a href=#__codelineno-0-182><span class=linenos data-linenos="182 "></span></a>    <span class=n>center</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
<a id=__codelineno-0-183 name=__codelineno-0-183></a><a href=#__codelineno-0-183><span class=linenos data-linenos="183 "></span></a>    <span class=n>fwhmv</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span>
<a id=__codelineno-0-184 name=__codelineno-0-184></a><a href=#__codelineno-0-184><span class=linenos data-linenos="184 "></span></a>    <span class=n>gamma</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-185 name=__codelineno-0-185></a><a href=#__codelineno-0-185><span class=linenos data-linenos="185 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-186 name=__codelineno-0-186></a><a href=#__codelineno-0-186><span class=linenos data-linenos="186 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Return a 1-dimensional Voigt distribution.</span>
<a id=__codelineno-0-187 name=__codelineno-0-187></a><a href=#__codelineno-0-187><span class=linenos data-linenos="187 "></span></a>
<a id=__codelineno-0-188 name=__codelineno-0-188></a><a href=#__codelineno-0-188><span class=linenos data-linenos="188 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-189 name=__codelineno-0-189></a><a href=#__codelineno-0-189><span class=linenos data-linenos="189 "></span></a><span class=sd>    {\displaystyle V(x;\sigma ,\gamma )\equiv</span>
<a id=__codelineno-0-190 name=__codelineno-0-190></a><a href=#__codelineno-0-190><span class=linenos data-linenos="190 "></span></a><span class=sd>    \int_{-\infty }^{\infty }G(x&#39;;\sigma )</span>
<a id=__codelineno-0-191 name=__codelineno-0-191></a><a href=#__codelineno-0-191><span class=linenos data-linenos="191 "></span></a><span class=sd>    L(x-x&#39;;\gamma )\,dx&#39;}</span>
<a id=__codelineno-0-192 name=__codelineno-0-192></a><a href=#__codelineno-0-192><span class=linenos data-linenos="192 "></span></a><span class=sd>    $$</span>
<a id=__codelineno-0-193 name=__codelineno-0-193></a><a href=#__codelineno-0-193><span class=linenos data-linenos="193 "></span></a>
<a id=__codelineno-0-194 name=__codelineno-0-194></a><a href=#__codelineno-0-194><span class=linenos data-linenos="194 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-195 name=__codelineno-0-195></a><a href=#__codelineno-0-195><span class=linenos data-linenos="195 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-196 name=__codelineno-0-196></a><a href=#__codelineno-0-196><span class=linenos data-linenos="196 "></span></a><span class=sd>        center (float, optional): Center of the Voigt distribution. Defaults to 0.0.</span>
<a id=__codelineno-0-197 name=__codelineno-0-197></a><a href=#__codelineno-0-197><span class=linenos data-linenos="197 "></span></a><span class=sd>        fwhmv (float, optional): Full width at half maximum (FWHM) of the Lorentzian</span>
<a id=__codelineno-0-198 name=__codelineno-0-198></a><a href=#__codelineno-0-198><span class=linenos data-linenos="198 "></span></a><span class=sd>            distribution. Defaults to 1.0.</span>
<a id=__codelineno-0-199 name=__codelineno-0-199></a><a href=#__codelineno-0-199><span class=linenos data-linenos="199 "></span></a><span class=sd>        gamma (float, optional): Scaling factor of the complex part of the</span>
<a id=__codelineno-0-200 name=__codelineno-0-200></a><a href=#__codelineno-0-200><span class=linenos data-linenos="200 "></span></a><span class=sd>            [Faddeeva Function](https://en.wikipedia.org/wiki/Faddeeva_function).</span>
<a id=__codelineno-0-201 name=__codelineno-0-201></a><a href=#__codelineno-0-201><span class=linenos data-linenos="201 "></span></a><span class=sd>            Defaults to None.</span>
<a id=__codelineno-0-202 name=__codelineno-0-202></a><a href=#__codelineno-0-202><span class=linenos data-linenos="202 "></span></a>
<a id=__codelineno-0-203 name=__codelineno-0-203></a><a href=#__codelineno-0-203><span class=linenos data-linenos="203 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-204 name=__codelineno-0-204></a><a href=#__codelineno-0-204><span class=linenos data-linenos="204 "></span></a><span class=sd>        NDArray[np.float64]: Voigt distribution of `x` given.</span>
<a id=__codelineno-0-205 name=__codelineno-0-205></a><a href=#__codelineno-0-205><span class=linenos data-linenos="205 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-206 name=__codelineno-0-206></a><a href=#__codelineno-0-206><span class=linenos data-linenos="206 "></span></a>    <span class=n>sigma</span> <span class=o>=</span> <span class=n>fwhmv</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>fwhmv2sig</span>
<a id=__codelineno-0-207 name=__codelineno-0-207></a><a href=#__codelineno-0-207><span class=linenos data-linenos="207 "></span></a>    <span class=k>if</span> <span class=n>gamma</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-208 name=__codelineno-0-208></a><a href=#__codelineno-0-208><span class=linenos data-linenos="208 "></span></a>        <span class=n>gamma</span> <span class=o>=</span> <span class=n>sigma</span>
<a id=__codelineno-0-209 name=__codelineno-0-209></a><a href=#__codelineno-0-209><span class=linenos data-linenos="209 "></span></a>    <span class=n>z</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>center</span> <span class=o>+</span> <span class=mi>1</span><span class=n>j</span> <span class=o>*</span> <span class=n>gamma</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>sq2</span><span class=p>)</span>
<a id=__codelineno-0-210 name=__codelineno-0-210></a><a href=#__codelineno-0-210><span class=linenos data-linenos="210 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>wofz</span><span class=p>(</span><span class=n>z</span><span class=p>)</span><span class=o>.</span><span class=n>real</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>*</span> <span class=n>Constants</span><span class=o>.</span><span class=n>sq2pi</span><span class=p>))</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=spectrafit.models.ModelParameters class="doc doc-heading"> <code>ModelParameters</code> <a href=#spectrafit.models.ModelParameters class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="<code>AutoPeakDetection</code> (<code>spectrafit.models.AutoPeakDetection</code>)" href=#spectrafit.models.AutoPeakDetection>AutoPeakDetection</a></code></p> <p>Class to define the model parameters.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1182 name=__codelineno-0-1182></a><a href=#__codelineno-0-1182><span class=linenos data-linenos="1182 "></span></a><span class=k>class</span><span class=w> </span><span class=nc>ModelParameters</span><span class=p>(</span><span class=n>AutoPeakDetection</span><span class=p>):</span>
<a id=__codelineno-0-1183 name=__codelineno-0-1183></a><a href=#__codelineno-0-1183><span class=linenos data-linenos="1183 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Class to define the model parameters.&quot;&quot;&quot;</span>
<a id=__codelineno-0-1184 name=__codelineno-0-1184></a><a href=#__codelineno-0-1184><span class=linenos data-linenos="1184 "></span></a>
<a id=__codelineno-0-1185 name=__codelineno-0-1185></a><a href=#__codelineno-0-1185><span class=linenos data-linenos="1185 "></span></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1186 name=__codelineno-0-1186></a><a href=#__codelineno-0-1186><span class=linenos data-linenos="1186 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Initialize the model parameters.</span>
<a id=__codelineno-0-1187 name=__codelineno-0-1187></a><a href=#__codelineno-0-1187><span class=linenos data-linenos="1187 "></span></a>
<a id=__codelineno-0-1188 name=__codelineno-0-1188></a><a href=#__codelineno-0-1188><span class=linenos data-linenos="1188 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-1189 name=__codelineno-0-1189></a><a href=#__codelineno-0-1189><span class=linenos data-linenos="1189 "></span></a><span class=sd>            df (pd.DataFrame): DataFrame containing the input data (`x` and `data`).</span>
<a id=__codelineno-0-1190 name=__codelineno-0-1190></a><a href=#__codelineno-0-1190><span class=linenos data-linenos="1190 "></span></a><span class=sd>            args (Dict[str, Any]):</span>
<a id=__codelineno-0-1191 name=__codelineno-0-1191></a><a href=#__codelineno-0-1191><span class=linenos data-linenos="1191 "></span></a><span class=sd>                 Nested arguments dictionary for the model based on **one** or **two**</span>
<a id=__codelineno-0-1192 name=__codelineno-0-1192></a><a href=#__codelineno-0-1192><span class=linenos data-linenos="1192 "></span></a><span class=sd>                 `int` keys depending if global fitting parameters, will explicit</span>
<a id=__codelineno-0-1193 name=__codelineno-0-1193></a><a href=#__codelineno-0-1193><span class=linenos data-linenos="1193 "></span></a><span class=sd>                 defined or not.</span>
<a id=__codelineno-0-1194 name=__codelineno-0-1194></a><a href=#__codelineno-0-1194><span class=linenos data-linenos="1194 "></span></a>
<a id=__codelineno-0-1195 name=__codelineno-0-1195></a><a href=#__codelineno-0-1195><span class=linenos data-linenos="1195 "></span></a><span class=sd>        !!! note &quot;About `args` for models&quot;</span>
<a id=__codelineno-0-1196 name=__codelineno-0-1196></a><a href=#__codelineno-0-1196><span class=linenos data-linenos="1196 "></span></a>
<a id=__codelineno-0-1197 name=__codelineno-0-1197></a><a href=#__codelineno-0-1197><span class=linenos data-linenos="1197 "></span></a><span class=sd>            The `args` dictionary is used to define the model parameters. And the total</span>
<a id=__codelineno-0-1198 name=__codelineno-0-1198></a><a href=#__codelineno-0-1198><span class=linenos data-linenos="1198 "></span></a><span class=sd>            nested dictionary structure is as follows:</span>
<a id=__codelineno-0-1199 name=__codelineno-0-1199></a><a href=#__codelineno-0-1199><span class=linenos data-linenos="1199 "></span></a>
<a id=__codelineno-0-1200 name=__codelineno-0-1200></a><a href=#__codelineno-0-1200><span class=linenos data-linenos="1200 "></span></a><span class=sd>            ```python</span>
<a id=__codelineno-0-1201 name=__codelineno-0-1201></a><a href=#__codelineno-0-1201><span class=linenos data-linenos="1201 "></span></a><span class=sd>            args: Dict[str, Dict[int, Dict[str, Dict[str, Union[str, int, float]]]]]</span>
<a id=__codelineno-0-1202 name=__codelineno-0-1202></a><a href=#__codelineno-0-1202><span class=linenos data-linenos="1202 "></span></a><span class=sd>            ```</span>
<a id=__codelineno-0-1203 name=__codelineno-0-1203></a><a href=#__codelineno-0-1203><span class=linenos data-linenos="1203 "></span></a>
<a id=__codelineno-0-1204 name=__codelineno-0-1204></a><a href=#__codelineno-0-1204><span class=linenos data-linenos="1204 "></span></a><span class=sd>        !!! info &quot;About the fitting options&quot;</span>
<a id=__codelineno-0-1205 name=__codelineno-0-1205></a><a href=#__codelineno-0-1205><span class=linenos data-linenos="1205 "></span></a>
<a id=__codelineno-0-1206 name=__codelineno-0-1206></a><a href=#__codelineno-0-1206><span class=linenos data-linenos="1206 "></span></a><span class=sd>            In general, there are two option for the fitting possible:</span>
<a id=__codelineno-0-1207 name=__codelineno-0-1207></a><a href=#__codelineno-0-1207><span class=linenos data-linenos="1207 "></span></a>
<a id=__codelineno-0-1208 name=__codelineno-0-1208></a><a href=#__codelineno-0-1208><span class=linenos data-linenos="1208 "></span></a><span class=sd>            1. `Classic fitting` or `local fitting`, where the parameters are defined</span>
<a id=__codelineno-0-1209 name=__codelineno-0-1209></a><a href=#__codelineno-0-1209><span class=linenos data-linenos="1209 "></span></a><span class=sd>                for a 2D spectrum.</span>
<a id=__codelineno-0-1210 name=__codelineno-0-1210></a><a href=#__codelineno-0-1210><span class=linenos data-linenos="1210 "></span></a><span class=sd>            2. `Global fitting`, where the parameters are defined for a 3D spectrum.</span>
<a id=__codelineno-0-1211 name=__codelineno-0-1211></a><a href=#__codelineno-0-1211><span class=linenos data-linenos="1211 "></span></a><span class=sd>                Here, the parameters can be automatically defined for each column on the</span>
<a id=__codelineno-0-1212 name=__codelineno-0-1212></a><a href=#__codelineno-0-1212><span class=linenos data-linenos="1212 "></span></a><span class=sd>                basis of the initial parameters or they can be completley defined by the</span>
<a id=__codelineno-0-1213 name=__codelineno-0-1213></a><a href=#__codelineno-0-1213><span class=linenos data-linenos="1213 "></span></a><span class=sd>                user. The `global fitting` definition starts at `1` similiar to the</span>
<a id=__codelineno-0-1214 name=__codelineno-0-1214></a><a href=#__codelineno-0-1214><span class=linenos data-linenos="1214 "></span></a><span class=sd>                peaks attributes notation.</span>
<a id=__codelineno-0-1215 name=__codelineno-0-1215></a><a href=#__codelineno-0-1215><span class=linenos data-linenos="1215 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1216 name=__codelineno-0-1216></a><a href=#__codelineno-0-1216><span class=linenos data-linenos="1216 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>col_len</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span>
<a id=__codelineno-0-1217 name=__codelineno-0-1217></a><a href=#__codelineno-0-1217><span class=linenos data-linenos="1217 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>args</span> <span class=o>=</span> <span class=n>args</span>
<a id=__codelineno-0-1218 name=__codelineno-0-1218></a><a href=#__codelineno-0-1218><span class=linenos data-linenos="1218 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>params</span> <span class=o>=</span> <span class=n>Parameters</span><span class=p>()</span>
<a id=__codelineno-0-1219 name=__codelineno-0-1219></a><a href=#__codelineno-0-1219><span class=linenos data-linenos="1219 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>df_to_numvalues</span><span class=p>(</span><span class=n>df</span><span class=o>=</span><span class=n>df</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=n>args</span><span class=p>)</span>
<a id=__codelineno-0-1220 name=__codelineno-0-1220></a><a href=#__codelineno-0-1220><span class=linenos data-linenos="1220 "></span></a>
<a id=__codelineno-0-1221 name=__codelineno-0-1221></a><a href=#__codelineno-0-1221><span class=linenos data-linenos="1221 "></span></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>)</span>
<a id=__codelineno-0-1222 name=__codelineno-0-1222></a><a href=#__codelineno-0-1222><span class=linenos data-linenos="1222 "></span></a>
<a id=__codelineno-0-1223 name=__codelineno-0-1223></a><a href=#__codelineno-0-1223><span class=linenos data-linenos="1223 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>df_to_numvalues</span><span class=p>(</span>
<a id=__codelineno-0-1224 name=__codelineno-0-1224></a><a href=#__codelineno-0-1224><span class=linenos data-linenos="1224 "></span></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
<a id=__codelineno-0-1225 name=__codelineno-0-1225></a><a href=#__codelineno-0-1225><span class=linenos data-linenos="1225 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]]:</span>
<a id=__codelineno-0-1226 name=__codelineno-0-1226></a><a href=#__codelineno-0-1226><span class=linenos data-linenos="1226 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Transform the dataframe to numeric values of `x` and `data`.</span>
<a id=__codelineno-0-1227 name=__codelineno-0-1227></a><a href=#__codelineno-0-1227><span class=linenos data-linenos="1227 "></span></a>
<a id=__codelineno-0-1228 name=__codelineno-0-1228></a><a href=#__codelineno-0-1228><span class=linenos data-linenos="1228 "></span></a><span class=sd>        !!! note &quot;About the dataframe to numeric values&quot;</span>
<a id=__codelineno-0-1229 name=__codelineno-0-1229></a><a href=#__codelineno-0-1229><span class=linenos data-linenos="1229 "></span></a>
<a id=__codelineno-0-1230 name=__codelineno-0-1230></a><a href=#__codelineno-0-1230><span class=linenos data-linenos="1230 "></span></a><span class=sd>            The transformation is done by the `value` property of pandas. The dataframe</span>
<a id=__codelineno-0-1231 name=__codelineno-0-1231></a><a href=#__codelineno-0-1231><span class=linenos data-linenos="1231 "></span></a><span class=sd>            is separated into the `x` and `data` columns and the `x` column is</span>
<a id=__codelineno-0-1232 name=__codelineno-0-1232></a><a href=#__codelineno-0-1232><span class=linenos data-linenos="1232 "></span></a><span class=sd>            transformed to the energy values and the `data` column is transformed to</span>
<a id=__codelineno-0-1233 name=__codelineno-0-1233></a><a href=#__codelineno-0-1233><span class=linenos data-linenos="1233 "></span></a><span class=sd>            the intensity values depending on the `args` dictionary. In terms of global</span>
<a id=__codelineno-0-1234 name=__codelineno-0-1234></a><a href=#__codelineno-0-1234><span class=linenos data-linenos="1234 "></span></a><span class=sd>            fitting, the `data` contains the intensity values for each column.</span>
<a id=__codelineno-0-1235 name=__codelineno-0-1235></a><a href=#__codelineno-0-1235><span class=linenos data-linenos="1235 "></span></a>
<a id=__codelineno-0-1236 name=__codelineno-0-1236></a><a href=#__codelineno-0-1236><span class=linenos data-linenos="1236 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-1237 name=__codelineno-0-1237></a><a href=#__codelineno-0-1237><span class=linenos data-linenos="1237 "></span></a><span class=sd>            df (pd.DataFrame): DataFrame containing the input data (`x` and `data`).</span>
<a id=__codelineno-0-1238 name=__codelineno-0-1238></a><a href=#__codelineno-0-1238><span class=linenos data-linenos="1238 "></span></a><span class=sd>            args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<a id=__codelineno-0-1239 name=__codelineno-0-1239></a><a href=#__codelineno-0-1239><span class=linenos data-linenos="1239 "></span></a><span class=sd>                 additional information beyond the command line arguments.</span>
<a id=__codelineno-0-1240 name=__codelineno-0-1240></a><a href=#__codelineno-0-1240><span class=linenos data-linenos="1240 "></span></a>
<a id=__codelineno-0-1241 name=__codelineno-0-1241></a><a href=#__codelineno-0-1241><span class=linenos data-linenos="1241 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-1242 name=__codelineno-0-1242></a><a href=#__codelineno-0-1242><span class=linenos data-linenos="1242 "></span></a><span class=sd>            Tuple[NDArray[np.float64], NDArray[np.float64]]: Tuple of `x` and</span>
<a id=__codelineno-0-1243 name=__codelineno-0-1243></a><a href=#__codelineno-0-1243><span class=linenos data-linenos="1243 "></span></a><span class=sd>                 `data` as numpy arrays.</span>
<a id=__codelineno-0-1244 name=__codelineno-0-1244></a><a href=#__codelineno-0-1244><span class=linenos data-linenos="1244 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1245 name=__codelineno-0-1245></a><a href=#__codelineno-0-1245><span class=linenos data-linenos="1245 "></span></a>        <span class=k>if</span> <span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]:</span>
<a id=__codelineno-0-1246 name=__codelineno-0-1246></a><a href=#__codelineno-0-1246><span class=linenos data-linenos="1246 "></span></a>            <span class=k>return</span> <span class=p>(</span>
<a id=__codelineno-0-1247 name=__codelineno-0-1247></a><a href=#__codelineno-0-1247><span class=linenos data-linenos="1247 "></span></a>                <span class=n>df</span><span class=p>[</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(),</span>
<a id=__codelineno-0-1248 name=__codelineno-0-1248></a><a href=#__codelineno-0-1248><span class=linenos data-linenos="1248 "></span></a>                <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span> <span class=o>!=</span> <span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(),</span>
<a id=__codelineno-0-1249 name=__codelineno-0-1249></a><a href=#__codelineno-0-1249><span class=linenos data-linenos="1249 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1250 name=__codelineno-0-1250></a><a href=#__codelineno-0-1250><span class=linenos data-linenos="1250 "></span></a>        <span class=k>return</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(),</span> <span class=n>df</span><span class=p>[</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>1</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>())</span>
<a id=__codelineno-0-1251 name=__codelineno-0-1251></a><a href=#__codelineno-0-1251><span class=linenos data-linenos="1251 "></span></a>
<a id=__codelineno-0-1252 name=__codelineno-0-1252></a><a href=#__codelineno-0-1252><span class=linenos data-linenos="1252 "></span></a>    <span class=nd>@property</span>
<a id=__codelineno-0-1253 name=__codelineno-0-1253></a><a href=#__codelineno-0-1253><span class=linenos data-linenos="1253 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>return_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Parameters</span><span class=p>:</span>
<a id=__codelineno-0-1254 name=__codelineno-0-1254></a><a href=#__codelineno-0-1254><span class=linenos data-linenos="1254 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Return the `class` representation of the model parameters.</span>
<a id=__codelineno-0-1255 name=__codelineno-0-1255></a><a href=#__codelineno-0-1255><span class=linenos data-linenos="1255 "></span></a>
<a id=__codelineno-0-1256 name=__codelineno-0-1256></a><a href=#__codelineno-0-1256><span class=linenos data-linenos="1256 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-1257 name=__codelineno-0-1257></a><a href=#__codelineno-0-1257><span class=linenos data-linenos="1257 "></span></a><span class=sd>            Parameters: Model parameters class.</span>
<a id=__codelineno-0-1258 name=__codelineno-0-1258></a><a href=#__codelineno-0-1258><span class=linenos data-linenos="1258 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1259 name=__codelineno-0-1259></a><a href=#__codelineno-0-1259><span class=linenos data-linenos="1259 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>__perform__</span><span class=p>()</span>
<a id=__codelineno-0-1260 name=__codelineno-0-1260></a><a href=#__codelineno-0-1260><span class=linenos data-linenos="1260 "></span></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span>
<a id=__codelineno-0-1261 name=__codelineno-0-1261></a><a href=#__codelineno-0-1261><span class=linenos data-linenos="1261 "></span></a>
<a id=__codelineno-0-1262 name=__codelineno-0-1262></a><a href=#__codelineno-0-1262><span class=linenos data-linenos="1262 "></span></a>    <span class=k>def</span><span class=w> </span><span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-0-1263 name=__codelineno-0-1263></a><a href=#__codelineno-0-1263><span class=linenos data-linenos="1263 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Return the `string` representation of the model parameters.</span>
<a id=__codelineno-0-1264 name=__codelineno-0-1264></a><a href=#__codelineno-0-1264><span class=linenos data-linenos="1264 "></span></a>
<a id=__codelineno-0-1265 name=__codelineno-0-1265></a><a href=#__codelineno-0-1265><span class=linenos data-linenos="1265 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-1266 name=__codelineno-0-1266></a><a href=#__codelineno-0-1266><span class=linenos data-linenos="1266 "></span></a><span class=sd>            str: String representation of the model parameters.</span>
<a id=__codelineno-0-1267 name=__codelineno-0-1267></a><a href=#__codelineno-0-1267><span class=linenos data-linenos="1267 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1268 name=__codelineno-0-1268></a><a href=#__codelineno-0-1268><span class=linenos data-linenos="1268 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>__perform__</span><span class=p>()</span>
<a id=__codelineno-0-1269 name=__codelineno-0-1269></a><a href=#__codelineno-0-1269><span class=linenos data-linenos="1269 "></span></a>        <span class=k>return</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>)</span>
<a id=__codelineno-0-1270 name=__codelineno-0-1270></a><a href=#__codelineno-0-1270><span class=linenos data-linenos="1270 "></span></a>
<a id=__codelineno-0-1271 name=__codelineno-0-1271></a><a href=#__codelineno-0-1271><span class=linenos data-linenos="1271 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>__perform__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1272 name=__codelineno-0-1272></a><a href=#__codelineno-0-1272><span class=linenos data-linenos="1272 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Perform the model parameter definition.</span>
<a id=__codelineno-0-1273 name=__codelineno-0-1273></a><a href=#__codelineno-0-1273><span class=linenos data-linenos="1273 "></span></a>
<a id=__codelineno-0-1274 name=__codelineno-0-1274></a><a href=#__codelineno-0-1274><span class=linenos data-linenos="1274 "></span></a><span class=sd>        Raises:</span>
<a id=__codelineno-0-1275 name=__codelineno-0-1275></a><a href=#__codelineno-0-1275><span class=linenos data-linenos="1275 "></span></a><span class=sd>            KeyError: Global fitting is combination with automatic peak detection is</span>
<a id=__codelineno-0-1276 name=__codelineno-0-1276></a><a href=#__codelineno-0-1276><span class=linenos data-linenos="1276 "></span></a><span class=sd>                 not implemented yet.</span>
<a id=__codelineno-0-1277 name=__codelineno-0-1277></a><a href=#__codelineno-0-1277><span class=linenos data-linenos="1277 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1278 name=__codelineno-0-1278></a><a href=#__codelineno-0-1278><span class=linenos data-linenos="1278 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]:</span>
<a id=__codelineno-0-1279 name=__codelineno-0-1279></a><a href=#__codelineno-0-1279><span class=linenos data-linenos="1279 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters</span><span class=p>()</span>
<a id=__codelineno-0-1280 name=__codelineno-0-1280></a><a href=#__codelineno-0-1280><span class=linenos data-linenos="1280 "></span></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span> <span class=ow>and</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]:</span>
<a id=__codelineno-0-1281 name=__codelineno-0-1281></a><a href=#__codelineno-0-1281><span class=linenos data-linenos="1281 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_global</span><span class=p>()</span>
<a id=__codelineno-0-1282 name=__codelineno-0-1282></a><a href=#__codelineno-0-1282><span class=linenos data-linenos="1282 "></span></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>2</span> <span class=ow>and</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]:</span>
<a id=__codelineno-0-1283 name=__codelineno-0-1283></a><a href=#__codelineno-0-1283><span class=linenos data-linenos="1283 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_global_pre</span><span class=p>()</span>
<a id=__codelineno-0-1284 name=__codelineno-0-1284></a><a href=#__codelineno-0-1284><span class=linenos data-linenos="1284 "></span></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-0-1285 name=__codelineno-0-1285></a><a href=#__codelineno-0-1285><span class=linenos data-linenos="1285 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>initialize_peak_detection</span><span class=p>()</span>
<a id=__codelineno-0-1286 name=__codelineno-0-1286></a><a href=#__codelineno-0-1286><span class=linenos data-linenos="1286 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_auto</span><span class=p>()</span>
<a id=__codelineno-0-1287 name=__codelineno-0-1287></a><a href=#__codelineno-0-1287><span class=linenos data-linenos="1287 "></span></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]:</span>
<a id=__codelineno-0-1288 name=__codelineno-0-1288></a><a href=#__codelineno-0-1288><span class=linenos data-linenos="1288 "></span></a>            <span class=k>raise</span> <span class=ne>KeyError</span><span class=p>(</span>
<a id=__codelineno-0-1289 name=__codelineno-0-1289></a><a href=#__codelineno-0-1289><span class=linenos data-linenos="1289 "></span></a>                <span class=s2>&quot;Global fitting mode with automatic peak detection &quot;</span>
<a id=__codelineno-0-1290 name=__codelineno-0-1290></a><a href=#__codelineno-0-1290><span class=linenos data-linenos="1290 "></span></a>                <span class=s2>&quot;is not supported yet.&quot;</span>
<a id=__codelineno-0-1291 name=__codelineno-0-1291></a><a href=#__codelineno-0-1291><span class=linenos data-linenos="1291 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1292 name=__codelineno-0-1292></a><a href=#__codelineno-0-1292><span class=linenos data-linenos="1292 "></span></a>
<a id=__codelineno-0-1293 name=__codelineno-0-1293></a><a href=#__codelineno-0-1293><span class=linenos data-linenos="1293 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>define_parameters_auto</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1294 name=__codelineno-0-1294></a><a href=#__codelineno-0-1294><span class=linenos data-linenos="1294 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Auto define the model parameters for local fitting.&quot;&quot;&quot;</span>
<a id=__codelineno-0-1295 name=__codelineno-0-1295></a><a href=#__codelineno-0-1295><span class=linenos data-linenos="1295 "></span></a>        <span class=n>positions</span><span class=p>,</span> <span class=n>properties</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>__autodetect__</span><span class=p>()</span>
<a id=__codelineno-0-1296 name=__codelineno-0-1296></a><a href=#__codelineno-0-1296><span class=linenos data-linenos="1296 "></span></a>        <span class=k>if</span> <span class=p>(</span>
<a id=__codelineno-0-1297 name=__codelineno-0-1297></a><a href=#__codelineno-0-1297><span class=linenos data-linenos="1297 "></span></a>            <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>],</span> <span class=nb>bool</span><span class=p>)</span>
<a id=__codelineno-0-1298 name=__codelineno-0-1298></a><a href=#__codelineno-0-1298><span class=linenos data-linenos="1298 "></span></a>            <span class=ow>and</span> <span class=s2>&quot;modeltype&quot;</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]</span>
<a id=__codelineno-0-1299 name=__codelineno-0-1299></a><a href=#__codelineno-0-1299><span class=linenos data-linenos="1299 "></span></a>        <span class=p>):</span>
<a id=__codelineno-0-1300 name=__codelineno-0-1300></a><a href=#__codelineno-0-1300><span class=linenos data-linenos="1300 "></span></a>            <span class=n>_model</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>][</span><span class=s2>&quot;modeltype&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
<a id=__codelineno-0-1301 name=__codelineno-0-1301></a><a href=#__codelineno-0-1301><span class=linenos data-linenos="1301 "></span></a>            <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>automodel_check</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>_model</span><span class=p>)</span>
<a id=__codelineno-0-1302 name=__codelineno-0-1302></a><a href=#__codelineno-0-1302><span class=linenos data-linenos="1302 "></span></a>            <span class=n>models</span> <span class=o>=</span> <span class=n>_model</span>
<a id=__codelineno-0-1303 name=__codelineno-0-1303></a><a href=#__codelineno-0-1303><span class=linenos data-linenos="1303 "></span></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-1304 name=__codelineno-0-1304></a><a href=#__codelineno-0-1304><span class=linenos data-linenos="1304 "></span></a>            <span class=n>models</span> <span class=o>=</span> <span class=s2>&quot;gaussian&quot;</span>
<a id=__codelineno-0-1305 name=__codelineno-0-1305></a><a href=#__codelineno-0-1305><span class=linenos data-linenos="1305 "></span></a>
<a id=__codelineno-0-1306 name=__codelineno-0-1306></a><a href=#__codelineno-0-1306><span class=linenos data-linenos="1306 "></span></a>        <span class=k>if</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;gaussian&quot;</span><span class=p>:</span>
<a id=__codelineno-0-1307 name=__codelineno-0-1307></a><a href=#__codelineno-0-1307><span class=linenos data-linenos="1307 "></span></a>            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
<a id=__codelineno-0-1308 name=__codelineno-0-1308></a><a href=#__codelineno-0-1308><span class=linenos data-linenos="1308 "></span></a>                <span class=nb>zip</span><span class=p>(</span>
<a id=__codelineno-0-1309 name=__codelineno-0-1309></a><a href=#__codelineno-0-1309><span class=linenos data-linenos="1309 "></span></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
<a id=__codelineno-0-1310 name=__codelineno-0-1310></a><a href=#__codelineno-0-1310><span class=linenos data-linenos="1310 "></span></a>                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1311 name=__codelineno-0-1311></a><a href=#__codelineno-0-1311><span class=linenos data-linenos="1311 "></span></a>                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1312 name=__codelineno-0-1312></a><a href=#__codelineno-0-1312><span class=linenos data-linenos="1312 "></span></a>                <span class=p>),</span>
<a id=__codelineno-0-1313 name=__codelineno-0-1313></a><a href=#__codelineno-0-1313><span class=linenos data-linenos="1313 "></span></a>                <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-1314 name=__codelineno-0-1314></a><a href=#__codelineno-0-1314><span class=linenos data-linenos="1314 "></span></a>            <span class=p>):</span>
<a id=__codelineno-0-1315 name=__codelineno-0-1315></a><a href=#__codelineno-0-1315><span class=linenos data-linenos="1315 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1316 name=__codelineno-0-1316></a><a href=#__codelineno-0-1316><span class=linenos data-linenos="1316 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1317 name=__codelineno-0-1317></a><a href=#__codelineno-0-1317><span class=linenos data-linenos="1317 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
<a id=__codelineno-0-1318 name=__codelineno-0-1318></a><a href=#__codelineno-0-1318><span class=linenos data-linenos="1318 "></span></a>                    <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1319 name=__codelineno-0-1319></a><a href=#__codelineno-0-1319><span class=linenos data-linenos="1319 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1320 name=__codelineno-0-1320></a><a href=#__codelineno-0-1320><span class=linenos data-linenos="1320 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1321 name=__codelineno-0-1321></a><a href=#__codelineno-0-1321><span class=linenos data-linenos="1321 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1322 name=__codelineno-0-1322></a><a href=#__codelineno-0-1322><span class=linenos data-linenos="1322 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1323 name=__codelineno-0-1323></a><a href=#__codelineno-0-1323><span class=linenos data-linenos="1323 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1324 name=__codelineno-0-1324></a><a href=#__codelineno-0-1324><span class=linenos data-linenos="1324 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1325 name=__codelineno-0-1325></a><a href=#__codelineno-0-1325><span class=linenos data-linenos="1325 "></span></a>                    <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1326 name=__codelineno-0-1326></a><a href=#__codelineno-0-1326><span class=linenos data-linenos="1326 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1327 name=__codelineno-0-1327></a><a href=#__codelineno-0-1327><span class=linenos data-linenos="1327 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1328 name=__codelineno-0-1328></a><a href=#__codelineno-0-1328><span class=linenos data-linenos="1328 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1329 name=__codelineno-0-1329></a><a href=#__codelineno-0-1329><span class=linenos data-linenos="1329 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1330 name=__codelineno-0-1330></a><a href=#__codelineno-0-1330><span class=linenos data-linenos="1330 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhmg_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1331 name=__codelineno-0-1331></a><a href=#__codelineno-0-1331><span class=linenos data-linenos="1331 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1332 name=__codelineno-0-1332></a><a href=#__codelineno-0-1332><span class=linenos data-linenos="1332 "></span></a>                    <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-0-1333 name=__codelineno-0-1333></a><a href=#__codelineno-0-1333><span class=linenos data-linenos="1333 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1334 name=__codelineno-0-1334></a><a href=#__codelineno-0-1334><span class=linenos data-linenos="1334 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1335 name=__codelineno-0-1335></a><a href=#__codelineno-0-1335><span class=linenos data-linenos="1335 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1336 name=__codelineno-0-1336></a><a href=#__codelineno-0-1336><span class=linenos data-linenos="1336 "></span></a>        <span class=k>elif</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;orcagaussian&quot;</span><span class=p>:</span>
<a id=__codelineno-0-1337 name=__codelineno-0-1337></a><a href=#__codelineno-0-1337><span class=linenos data-linenos="1337 "></span></a>            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_width</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
<a id=__codelineno-0-1338 name=__codelineno-0-1338></a><a href=#__codelineno-0-1338><span class=linenos data-linenos="1338 "></span></a>                <span class=nb>zip</span><span class=p>(</span>
<a id=__codelineno-0-1339 name=__codelineno-0-1339></a><a href=#__codelineno-0-1339><span class=linenos data-linenos="1339 "></span></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
<a id=__codelineno-0-1340 name=__codelineno-0-1340></a><a href=#__codelineno-0-1340><span class=linenos data-linenos="1340 "></span></a>                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1341 name=__codelineno-0-1341></a><a href=#__codelineno-0-1341><span class=linenos data-linenos="1341 "></span></a>                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1342 name=__codelineno-0-1342></a><a href=#__codelineno-0-1342><span class=linenos data-linenos="1342 "></span></a>                <span class=p>),</span>
<a id=__codelineno-0-1343 name=__codelineno-0-1343></a><a href=#__codelineno-0-1343><span class=linenos data-linenos="1343 "></span></a>                <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-1344 name=__codelineno-0-1344></a><a href=#__codelineno-0-1344><span class=linenos data-linenos="1344 "></span></a>            <span class=p>):</span>
<a id=__codelineno-0-1345 name=__codelineno-0-1345></a><a href=#__codelineno-0-1345><span class=linenos data-linenos="1345 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1346 name=__codelineno-0-1346></a><a href=#__codelineno-0-1346><span class=linenos data-linenos="1346 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1347 name=__codelineno-0-1347></a><a href=#__codelineno-0-1347><span class=linenos data-linenos="1347 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
<a id=__codelineno-0-1348 name=__codelineno-0-1348></a><a href=#__codelineno-0-1348><span class=linenos data-linenos="1348 "></span></a>                    <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1349 name=__codelineno-0-1349></a><a href=#__codelineno-0-1349><span class=linenos data-linenos="1349 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1350 name=__codelineno-0-1350></a><a href=#__codelineno-0-1350><span class=linenos data-linenos="1350 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1351 name=__codelineno-0-1351></a><a href=#__codelineno-0-1351><span class=linenos data-linenos="1351 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1352 name=__codelineno-0-1352></a><a href=#__codelineno-0-1352><span class=linenos data-linenos="1352 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1353 name=__codelineno-0-1353></a><a href=#__codelineno-0-1353><span class=linenos data-linenos="1353 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1354 name=__codelineno-0-1354></a><a href=#__codelineno-0-1354><span class=linenos data-linenos="1354 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1355 name=__codelineno-0-1355></a><a href=#__codelineno-0-1355><span class=linenos data-linenos="1355 "></span></a>                    <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1356 name=__codelineno-0-1356></a><a href=#__codelineno-0-1356><span class=linenos data-linenos="1356 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1357 name=__codelineno-0-1357></a><a href=#__codelineno-0-1357><span class=linenos data-linenos="1357 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1358 name=__codelineno-0-1358></a><a href=#__codelineno-0-1358><span class=linenos data-linenos="1358 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1359 name=__codelineno-0-1359></a><a href=#__codelineno-0-1359><span class=linenos data-linenos="1359 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1360 name=__codelineno-0-1360></a><a href=#__codelineno-0-1360><span class=linenos data-linenos="1360 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_width_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1361 name=__codelineno-0-1361></a><a href=#__codelineno-0-1361><span class=linenos data-linenos="1361 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=n>_width</span><span class=p>,</span>
<a id=__codelineno-0-1362 name=__codelineno-0-1362></a><a href=#__codelineno-0-1362><span class=linenos data-linenos="1362 "></span></a>                    <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-0-1363 name=__codelineno-0-1363></a><a href=#__codelineno-0-1363><span class=linenos data-linenos="1363 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_width</span><span class=p>,</span>
<a id=__codelineno-0-1364 name=__codelineno-0-1364></a><a href=#__codelineno-0-1364><span class=linenos data-linenos="1364 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1365 name=__codelineno-0-1365></a><a href=#__codelineno-0-1365><span class=linenos data-linenos="1365 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1366 name=__codelineno-0-1366></a><a href=#__codelineno-0-1366><span class=linenos data-linenos="1366 "></span></a>        <span class=k>elif</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;lorentzian&quot;</span><span class=p>:</span>
<a id=__codelineno-0-1367 name=__codelineno-0-1367></a><a href=#__codelineno-0-1367><span class=linenos data-linenos="1367 "></span></a>            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
<a id=__codelineno-0-1368 name=__codelineno-0-1368></a><a href=#__codelineno-0-1368><span class=linenos data-linenos="1368 "></span></a>                <span class=nb>zip</span><span class=p>(</span>
<a id=__codelineno-0-1369 name=__codelineno-0-1369></a><a href=#__codelineno-0-1369><span class=linenos data-linenos="1369 "></span></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
<a id=__codelineno-0-1370 name=__codelineno-0-1370></a><a href=#__codelineno-0-1370><span class=linenos data-linenos="1370 "></span></a>                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1371 name=__codelineno-0-1371></a><a href=#__codelineno-0-1371><span class=linenos data-linenos="1371 "></span></a>                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1372 name=__codelineno-0-1372></a><a href=#__codelineno-0-1372><span class=linenos data-linenos="1372 "></span></a>                <span class=p>),</span>
<a id=__codelineno-0-1373 name=__codelineno-0-1373></a><a href=#__codelineno-0-1373><span class=linenos data-linenos="1373 "></span></a>                <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-1374 name=__codelineno-0-1374></a><a href=#__codelineno-0-1374><span class=linenos data-linenos="1374 "></span></a>            <span class=p>):</span>
<a id=__codelineno-0-1375 name=__codelineno-0-1375></a><a href=#__codelineno-0-1375><span class=linenos data-linenos="1375 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1376 name=__codelineno-0-1376></a><a href=#__codelineno-0-1376><span class=linenos data-linenos="1376 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1377 name=__codelineno-0-1377></a><a href=#__codelineno-0-1377><span class=linenos data-linenos="1377 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
<a id=__codelineno-0-1378 name=__codelineno-0-1378></a><a href=#__codelineno-0-1378><span class=linenos data-linenos="1378 "></span></a>                    <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1379 name=__codelineno-0-1379></a><a href=#__codelineno-0-1379><span class=linenos data-linenos="1379 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1380 name=__codelineno-0-1380></a><a href=#__codelineno-0-1380><span class=linenos data-linenos="1380 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1381 name=__codelineno-0-1381></a><a href=#__codelineno-0-1381><span class=linenos data-linenos="1381 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1382 name=__codelineno-0-1382></a><a href=#__codelineno-0-1382><span class=linenos data-linenos="1382 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1383 name=__codelineno-0-1383></a><a href=#__codelineno-0-1383><span class=linenos data-linenos="1383 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1384 name=__codelineno-0-1384></a><a href=#__codelineno-0-1384><span class=linenos data-linenos="1384 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1385 name=__codelineno-0-1385></a><a href=#__codelineno-0-1385><span class=linenos data-linenos="1385 "></span></a>                    <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1386 name=__codelineno-0-1386></a><a href=#__codelineno-0-1386><span class=linenos data-linenos="1386 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1387 name=__codelineno-0-1387></a><a href=#__codelineno-0-1387><span class=linenos data-linenos="1387 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1388 name=__codelineno-0-1388></a><a href=#__codelineno-0-1388><span class=linenos data-linenos="1388 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1389 name=__codelineno-0-1389></a><a href=#__codelineno-0-1389><span class=linenos data-linenos="1389 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1390 name=__codelineno-0-1390></a><a href=#__codelineno-0-1390><span class=linenos data-linenos="1390 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhml_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1391 name=__codelineno-0-1391></a><a href=#__codelineno-0-1391><span class=linenos data-linenos="1391 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1392 name=__codelineno-0-1392></a><a href=#__codelineno-0-1392><span class=linenos data-linenos="1392 "></span></a>                    <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-0-1393 name=__codelineno-0-1393></a><a href=#__codelineno-0-1393><span class=linenos data-linenos="1393 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1394 name=__codelineno-0-1394></a><a href=#__codelineno-0-1394><span class=linenos data-linenos="1394 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1395 name=__codelineno-0-1395></a><a href=#__codelineno-0-1395><span class=linenos data-linenos="1395 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1396 name=__codelineno-0-1396></a><a href=#__codelineno-0-1396><span class=linenos data-linenos="1396 "></span></a>        <span class=k>elif</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;voigt&quot;</span><span class=p>:</span>
<a id=__codelineno-0-1397 name=__codelineno-0-1397></a><a href=#__codelineno-0-1397><span class=linenos data-linenos="1397 "></span></a>            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
<a id=__codelineno-0-1398 name=__codelineno-0-1398></a><a href=#__codelineno-0-1398><span class=linenos data-linenos="1398 "></span></a>                <span class=nb>zip</span><span class=p>(</span>
<a id=__codelineno-0-1399 name=__codelineno-0-1399></a><a href=#__codelineno-0-1399><span class=linenos data-linenos="1399 "></span></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
<a id=__codelineno-0-1400 name=__codelineno-0-1400></a><a href=#__codelineno-0-1400><span class=linenos data-linenos="1400 "></span></a>                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1401 name=__codelineno-0-1401></a><a href=#__codelineno-0-1401><span class=linenos data-linenos="1401 "></span></a>                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1402 name=__codelineno-0-1402></a><a href=#__codelineno-0-1402><span class=linenos data-linenos="1402 "></span></a>                <span class=p>),</span>
<a id=__codelineno-0-1403 name=__codelineno-0-1403></a><a href=#__codelineno-0-1403><span class=linenos data-linenos="1403 "></span></a>                <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-1404 name=__codelineno-0-1404></a><a href=#__codelineno-0-1404><span class=linenos data-linenos="1404 "></span></a>            <span class=p>):</span>
<a id=__codelineno-0-1405 name=__codelineno-0-1405></a><a href=#__codelineno-0-1405><span class=linenos data-linenos="1405 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1406 name=__codelineno-0-1406></a><a href=#__codelineno-0-1406><span class=linenos data-linenos="1406 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1407 name=__codelineno-0-1407></a><a href=#__codelineno-0-1407><span class=linenos data-linenos="1407 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
<a id=__codelineno-0-1408 name=__codelineno-0-1408></a><a href=#__codelineno-0-1408><span class=linenos data-linenos="1408 "></span></a>                    <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1409 name=__codelineno-0-1409></a><a href=#__codelineno-0-1409><span class=linenos data-linenos="1409 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1410 name=__codelineno-0-1410></a><a href=#__codelineno-0-1410><span class=linenos data-linenos="1410 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1411 name=__codelineno-0-1411></a><a href=#__codelineno-0-1411><span class=linenos data-linenos="1411 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1412 name=__codelineno-0-1412></a><a href=#__codelineno-0-1412><span class=linenos data-linenos="1412 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1413 name=__codelineno-0-1413></a><a href=#__codelineno-0-1413><span class=linenos data-linenos="1413 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1414 name=__codelineno-0-1414></a><a href=#__codelineno-0-1414><span class=linenos data-linenos="1414 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1415 name=__codelineno-0-1415></a><a href=#__codelineno-0-1415><span class=linenos data-linenos="1415 "></span></a>                    <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1416 name=__codelineno-0-1416></a><a href=#__codelineno-0-1416><span class=linenos data-linenos="1416 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1417 name=__codelineno-0-1417></a><a href=#__codelineno-0-1417><span class=linenos data-linenos="1417 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1418 name=__codelineno-0-1418></a><a href=#__codelineno-0-1418><span class=linenos data-linenos="1418 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1419 name=__codelineno-0-1419></a><a href=#__codelineno-0-1419><span class=linenos data-linenos="1419 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1420 name=__codelineno-0-1420></a><a href=#__codelineno-0-1420><span class=linenos data-linenos="1420 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhmv_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1421 name=__codelineno-0-1421></a><a href=#__codelineno-0-1421><span class=linenos data-linenos="1421 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1422 name=__codelineno-0-1422></a><a href=#__codelineno-0-1422><span class=linenos data-linenos="1422 "></span></a>                    <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-0-1423 name=__codelineno-0-1423></a><a href=#__codelineno-0-1423><span class=linenos data-linenos="1423 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1424 name=__codelineno-0-1424></a><a href=#__codelineno-0-1424><span class=linenos data-linenos="1424 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1425 name=__codelineno-0-1425></a><a href=#__codelineno-0-1425><span class=linenos data-linenos="1425 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1426 name=__codelineno-0-1426></a><a href=#__codelineno-0-1426><span class=linenos data-linenos="1426 "></span></a>        <span class=k>elif</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;pseudovoigt&quot;</span><span class=p>:</span>
<a id=__codelineno-0-1427 name=__codelineno-0-1427></a><a href=#__codelineno-0-1427><span class=linenos data-linenos="1427 "></span></a>            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
<a id=__codelineno-0-1428 name=__codelineno-0-1428></a><a href=#__codelineno-0-1428><span class=linenos data-linenos="1428 "></span></a>                <span class=nb>zip</span><span class=p>(</span>
<a id=__codelineno-0-1429 name=__codelineno-0-1429></a><a href=#__codelineno-0-1429><span class=linenos data-linenos="1429 "></span></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
<a id=__codelineno-0-1430 name=__codelineno-0-1430></a><a href=#__codelineno-0-1430><span class=linenos data-linenos="1430 "></span></a>                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1431 name=__codelineno-0-1431></a><a href=#__codelineno-0-1431><span class=linenos data-linenos="1431 "></span></a>                    <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1432 name=__codelineno-0-1432></a><a href=#__codelineno-0-1432><span class=linenos data-linenos="1432 "></span></a>                <span class=p>),</span>
<a id=__codelineno-0-1433 name=__codelineno-0-1433></a><a href=#__codelineno-0-1433><span class=linenos data-linenos="1433 "></span></a>                <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-1434 name=__codelineno-0-1434></a><a href=#__codelineno-0-1434><span class=linenos data-linenos="1434 "></span></a>            <span class=p>):</span>
<a id=__codelineno-0-1435 name=__codelineno-0-1435></a><a href=#__codelineno-0-1435><span class=linenos data-linenos="1435 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1436 name=__codelineno-0-1436></a><a href=#__codelineno-0-1436><span class=linenos data-linenos="1436 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1437 name=__codelineno-0-1437></a><a href=#__codelineno-0-1437><span class=linenos data-linenos="1437 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
<a id=__codelineno-0-1438 name=__codelineno-0-1438></a><a href=#__codelineno-0-1438><span class=linenos data-linenos="1438 "></span></a>                    <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1439 name=__codelineno-0-1439></a><a href=#__codelineno-0-1439><span class=linenos data-linenos="1439 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1440 name=__codelineno-0-1440></a><a href=#__codelineno-0-1440><span class=linenos data-linenos="1440 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1441 name=__codelineno-0-1441></a><a href=#__codelineno-0-1441><span class=linenos data-linenos="1441 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1442 name=__codelineno-0-1442></a><a href=#__codelineno-0-1442><span class=linenos data-linenos="1442 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1443 name=__codelineno-0-1443></a><a href=#__codelineno-0-1443><span class=linenos data-linenos="1443 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1444 name=__codelineno-0-1444></a><a href=#__codelineno-0-1444><span class=linenos data-linenos="1444 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1445 name=__codelineno-0-1445></a><a href=#__codelineno-0-1445><span class=linenos data-linenos="1445 "></span></a>                    <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1446 name=__codelineno-0-1446></a><a href=#__codelineno-0-1446><span class=linenos data-linenos="1446 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1447 name=__codelineno-0-1447></a><a href=#__codelineno-0-1447><span class=linenos data-linenos="1447 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1448 name=__codelineno-0-1448></a><a href=#__codelineno-0-1448><span class=linenos data-linenos="1448 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1449 name=__codelineno-0-1449></a><a href=#__codelineno-0-1449><span class=linenos data-linenos="1449 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1450 name=__codelineno-0-1450></a><a href=#__codelineno-0-1450><span class=linenos data-linenos="1450 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhmg_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1451 name=__codelineno-0-1451></a><a href=#__codelineno-0-1451><span class=linenos data-linenos="1451 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1452 name=__codelineno-0-1452></a><a href=#__codelineno-0-1452><span class=linenos data-linenos="1452 "></span></a>                    <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-0-1453 name=__codelineno-0-1453></a><a href=#__codelineno-0-1453><span class=linenos data-linenos="1453 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1454 name=__codelineno-0-1454></a><a href=#__codelineno-0-1454><span class=linenos data-linenos="1454 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1455 name=__codelineno-0-1455></a><a href=#__codelineno-0-1455><span class=linenos data-linenos="1455 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1456 name=__codelineno-0-1456></a><a href=#__codelineno-0-1456><span class=linenos data-linenos="1456 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1457 name=__codelineno-0-1457></a><a href=#__codelineno-0-1457><span class=linenos data-linenos="1457 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhml_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1458 name=__codelineno-0-1458></a><a href=#__codelineno-0-1458><span class=linenos data-linenos="1458 "></span></a>                    <span class=n>value</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1459 name=__codelineno-0-1459></a><a href=#__codelineno-0-1459><span class=linenos data-linenos="1459 "></span></a>                    <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-0-1460 name=__codelineno-0-1460></a><a href=#__codelineno-0-1460><span class=linenos data-linenos="1460 "></span></a>                    <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1461 name=__codelineno-0-1461></a><a href=#__codelineno-0-1461><span class=linenos data-linenos="1461 "></span></a>                    <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1462 name=__codelineno-0-1462></a><a href=#__codelineno-0-1462><span class=linenos data-linenos="1462 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1463 name=__codelineno-0-1463></a><a href=#__codelineno-0-1463><span class=linenos data-linenos="1463 "></span></a>
<a id=__codelineno-0-1464 name=__codelineno-0-1464></a><a href=#__codelineno-0-1464><span class=linenos data-linenos="1464 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;auto_generated_models&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-0-1465 name=__codelineno-0-1465></a><a href=#__codelineno-0-1465><span class=linenos data-linenos="1465 "></span></a>            <span class=s2>&quot;models&quot;</span><span class=p>:</span> <span class=p>{</span>
<a id=__codelineno-0-1466 name=__codelineno-0-1466></a><a href=#__codelineno-0-1466><span class=linenos data-linenos="1466 "></span></a>                <span class=n>key</span><span class=p>:</span> <span class=p>{</span>
<a id=__codelineno-0-1467 name=__codelineno-0-1467></a><a href=#__codelineno-0-1467><span class=linenos data-linenos="1467 "></span></a>                    <span class=s2>&quot;value&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
<a id=__codelineno-0-1468 name=__codelineno-0-1468></a><a href=#__codelineno-0-1468><span class=linenos data-linenos="1468 "></span></a>                    <span class=s2>&quot;min&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>,</span>
<a id=__codelineno-0-1469 name=__codelineno-0-1469></a><a href=#__codelineno-0-1469><span class=linenos data-linenos="1469 "></span></a>                    <span class=s2>&quot;max&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>,</span>
<a id=__codelineno-0-1470 name=__codelineno-0-1470></a><a href=#__codelineno-0-1470><span class=linenos data-linenos="1470 "></span></a>                    <span class=s2>&quot;vary&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>vary</span><span class=p>,</span>
<a id=__codelineno-0-1471 name=__codelineno-0-1471></a><a href=#__codelineno-0-1471><span class=linenos data-linenos="1471 "></span></a>                <span class=p>}</span>
<a id=__codelineno-0-1472 name=__codelineno-0-1472></a><a href=#__codelineno-0-1472><span class=linenos data-linenos="1472 "></span></a>                <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span>
<a id=__codelineno-0-1473 name=__codelineno-0-1473></a><a href=#__codelineno-0-1473><span class=linenos data-linenos="1473 "></span></a>            <span class=p>},</span>
<a id=__codelineno-0-1474 name=__codelineno-0-1474></a><a href=#__codelineno-0-1474><span class=linenos data-linenos="1474 "></span></a>            <span class=s2>&quot;positions&quot;</span><span class=p>:</span> <span class=n>positions</span><span class=o>.</span><span class=n>tolist</span><span class=p>(),</span>
<a id=__codelineno-0-1475 name=__codelineno-0-1475></a><a href=#__codelineno-0-1475><span class=linenos data-linenos="1475 "></span></a>            <span class=s2>&quot;properties&quot;</span><span class=p>:</span> <span class=p>{</span><span class=n>key</span><span class=p>:</span> <span class=n>value</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>properties</span><span class=o>.</span><span class=n>items</span><span class=p>()},</span>
<a id=__codelineno-0-1476 name=__codelineno-0-1476></a><a href=#__codelineno-0-1476><span class=linenos data-linenos="1476 "></span></a>        <span class=p>}</span>
<a id=__codelineno-0-1477 name=__codelineno-0-1477></a><a href=#__codelineno-0-1477><span class=linenos data-linenos="1477 "></span></a>
<a id=__codelineno-0-1478 name=__codelineno-0-1478></a><a href=#__codelineno-0-1478><span class=linenos data-linenos="1478 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>define_parameters</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1479 name=__codelineno-0-1479></a><a href=#__codelineno-0-1479><span class=linenos data-linenos="1479 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Define the input parameters for a `params`-dictionary for classic fitting.&quot;&quot;&quot;</span>
<a id=__codelineno-0-1480 name=__codelineno-0-1480></a><a href=#__codelineno-0-1480><span class=linenos data-linenos="1480 "></span></a>        <span class=k>for</span> <span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;peaks&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1481 name=__codelineno-0-1481></a><a href=#__codelineno-0-1481><span class=linenos data-linenos="1481 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_loop</span><span class=p>(</span><span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span><span class=o>=</span><span class=n>value_1</span><span class=p>)</span>
<a id=__codelineno-0-1482 name=__codelineno-0-1482></a><a href=#__codelineno-0-1482><span class=linenos data-linenos="1482 "></span></a>
<a id=__codelineno-0-1483 name=__codelineno-0-1483></a><a href=#__codelineno-0-1483><span class=linenos data-linenos="1483 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>define_parameters_loop</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key_1</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value_1</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1484 name=__codelineno-0-1484></a><a href=#__codelineno-0-1484><span class=linenos data-linenos="1484 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Loop through the input parameters for a `params`-dictionary.</span>
<a id=__codelineno-0-1485 name=__codelineno-0-1485></a><a href=#__codelineno-0-1485><span class=linenos data-linenos="1485 "></span></a>
<a id=__codelineno-0-1486 name=__codelineno-0-1486></a><a href=#__codelineno-0-1486><span class=linenos data-linenos="1486 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-1487 name=__codelineno-0-1487></a><a href=#__codelineno-0-1487><span class=linenos data-linenos="1487 "></span></a><span class=sd>            key_1 (str): The key of the first level of the input dictionary.</span>
<a id=__codelineno-0-1488 name=__codelineno-0-1488></a><a href=#__codelineno-0-1488><span class=linenos data-linenos="1488 "></span></a><span class=sd>            value_1 (Dict[str, Any]): The value of the first level of the input</span>
<a id=__codelineno-0-1489 name=__codelineno-0-1489></a><a href=#__codelineno-0-1489><span class=linenos data-linenos="1489 "></span></a><span class=sd>                 dictionary.</span>
<a id=__codelineno-0-1490 name=__codelineno-0-1490></a><a href=#__codelineno-0-1490><span class=linenos data-linenos="1490 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1491 name=__codelineno-0-1491></a><a href=#__codelineno-0-1491><span class=linenos data-linenos="1491 "></span></a>        <span class=k>for</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span> <span class=ow>in</span> <span class=n>value_1</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1492 name=__codelineno-0-1492></a><a href=#__codelineno-0-1492><span class=linenos data-linenos="1492 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_loop_2</span><span class=p>(</span><span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span> <span class=n>key_2</span><span class=o>=</span><span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span><span class=o>=</span><span class=n>value_2</span><span class=p>)</span>
<a id=__codelineno-0-1493 name=__codelineno-0-1493></a><a href=#__codelineno-0-1493><span class=linenos data-linenos="1493 "></span></a>
<a id=__codelineno-0-1494 name=__codelineno-0-1494></a><a href=#__codelineno-0-1494><span class=linenos data-linenos="1494 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>define_parameters_loop_2</span><span class=p>(</span>
<a id=__codelineno-0-1495 name=__codelineno-0-1495></a><a href=#__codelineno-0-1495><span class=linenos data-linenos="1495 "></span></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>key_1</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_2</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value_2</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
<a id=__codelineno-0-1496 name=__codelineno-0-1496></a><a href=#__codelineno-0-1496><span class=linenos data-linenos="1496 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1497 name=__codelineno-0-1497></a><a href=#__codelineno-0-1497><span class=linenos data-linenos="1497 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Loop through the input parameters for a `params`-dictionary.</span>
<a id=__codelineno-0-1498 name=__codelineno-0-1498></a><a href=#__codelineno-0-1498><span class=linenos data-linenos="1498 "></span></a>
<a id=__codelineno-0-1499 name=__codelineno-0-1499></a><a href=#__codelineno-0-1499><span class=linenos data-linenos="1499 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-1500 name=__codelineno-0-1500></a><a href=#__codelineno-0-1500><span class=linenos data-linenos="1500 "></span></a><span class=sd>            key_1 (str): The key of the first level of the input dictionary.</span>
<a id=__codelineno-0-1501 name=__codelineno-0-1501></a><a href=#__codelineno-0-1501><span class=linenos data-linenos="1501 "></span></a><span class=sd>            key_2 (str): The key of the second level of the input dictionary.</span>
<a id=__codelineno-0-1502 name=__codelineno-0-1502></a><a href=#__codelineno-0-1502><span class=linenos data-linenos="1502 "></span></a><span class=sd>            value_2 (Dict[str, Any]): The value of the second level of the input</span>
<a id=__codelineno-0-1503 name=__codelineno-0-1503></a><a href=#__codelineno-0-1503><span class=linenos data-linenos="1503 "></span></a><span class=sd>                 dictionary.</span>
<a id=__codelineno-0-1504 name=__codelineno-0-1504></a><a href=#__codelineno-0-1504><span class=linenos data-linenos="1504 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1505 name=__codelineno-0-1505></a><a href=#__codelineno-0-1505><span class=linenos data-linenos="1505 "></span></a>        <span class=k>for</span> <span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span> <span class=ow>in</span> <span class=n>value_2</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1506 name=__codelineno-0-1506></a><a href=#__codelineno-0-1506><span class=linenos data-linenos="1506 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_loop_3</span><span class=p>(</span>
<a id=__codelineno-0-1507 name=__codelineno-0-1507></a><a href=#__codelineno-0-1507><span class=linenos data-linenos="1507 "></span></a>                <span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span> <span class=n>key_2</span><span class=o>=</span><span class=n>key_2</span><span class=p>,</span> <span class=n>key_3</span><span class=o>=</span><span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span><span class=o>=</span><span class=n>value_3</span>
<a id=__codelineno-0-1508 name=__codelineno-0-1508></a><a href=#__codelineno-0-1508><span class=linenos data-linenos="1508 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1509 name=__codelineno-0-1509></a><a href=#__codelineno-0-1509><span class=linenos data-linenos="1509 "></span></a>
<a id=__codelineno-0-1510 name=__codelineno-0-1510></a><a href=#__codelineno-0-1510><span class=linenos data-linenos="1510 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>define_parameters_loop_3</span><span class=p>(</span>
<a id=__codelineno-0-1511 name=__codelineno-0-1511></a><a href=#__codelineno-0-1511><span class=linenos data-linenos="1511 "></span></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>key_1</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_2</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_3</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value_3</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
<a id=__codelineno-0-1512 name=__codelineno-0-1512></a><a href=#__codelineno-0-1512><span class=linenos data-linenos="1512 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1513 name=__codelineno-0-1513></a><a href=#__codelineno-0-1513><span class=linenos data-linenos="1513 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Loop through the input parameters for a `params`-dictionary.</span>
<a id=__codelineno-0-1514 name=__codelineno-0-1514></a><a href=#__codelineno-0-1514><span class=linenos data-linenos="1514 "></span></a>
<a id=__codelineno-0-1515 name=__codelineno-0-1515></a><a href=#__codelineno-0-1515><span class=linenos data-linenos="1515 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-1516 name=__codelineno-0-1516></a><a href=#__codelineno-0-1516><span class=linenos data-linenos="1516 "></span></a><span class=sd>            key_1 (str): The key of the first level of the input dictionary.</span>
<a id=__codelineno-0-1517 name=__codelineno-0-1517></a><a href=#__codelineno-0-1517><span class=linenos data-linenos="1517 "></span></a><span class=sd>            key_2 (str): The key of the second level of the input dictionary.</span>
<a id=__codelineno-0-1518 name=__codelineno-0-1518></a><a href=#__codelineno-0-1518><span class=linenos data-linenos="1518 "></span></a><span class=sd>            key_3 (str): The key of the third level of the input dictionary.</span>
<a id=__codelineno-0-1519 name=__codelineno-0-1519></a><a href=#__codelineno-0-1519><span class=linenos data-linenos="1519 "></span></a><span class=sd>            value_3 (Dict[str, Any]): The value of the third level of the input</span>
<a id=__codelineno-0-1520 name=__codelineno-0-1520></a><a href=#__codelineno-0-1520><span class=linenos data-linenos="1520 "></span></a><span class=sd>                 dictionary.</span>
<a id=__codelineno-0-1521 name=__codelineno-0-1521></a><a href=#__codelineno-0-1521><span class=linenos data-linenos="1521 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1522 name=__codelineno-0-1522></a><a href=#__codelineno-0-1522><span class=linenos data-linenos="1522 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>value_3</span><span class=p>)</span>
<a id=__codelineno-0-1523 name=__codelineno-0-1523></a><a href=#__codelineno-0-1523><span class=linenos data-linenos="1523 "></span></a>
<a id=__codelineno-0-1524 name=__codelineno-0-1524></a><a href=#__codelineno-0-1524><span class=linenos data-linenos="1524 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>define_parameters_global</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1525 name=__codelineno-0-1525></a><a href=#__codelineno-0-1525><span class=linenos data-linenos="1525 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Define the input parameters for a `params`-dictionary for global fitting.&quot;&quot;&quot;</span>
<a id=__codelineno-0-1526 name=__codelineno-0-1526></a><a href=#__codelineno-0-1526><span class=linenos data-linenos="1526 "></span></a>        <span class=k>for</span> <span class=n>col_i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>col_len</span><span class=p>):</span>
<a id=__codelineno-0-1527 name=__codelineno-0-1527></a><a href=#__codelineno-0-1527><span class=linenos data-linenos="1527 "></span></a>            <span class=k>for</span> <span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;peaks&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1528 name=__codelineno-0-1528></a><a href=#__codelineno-0-1528><span class=linenos data-linenos="1528 "></span></a>                <span class=k>for</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span> <span class=ow>in</span> <span class=n>value_1</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1529 name=__codelineno-0-1529></a><a href=#__codelineno-0-1529><span class=linenos data-linenos="1529 "></span></a>                    <span class=k>for</span> <span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span> <span class=ow>in</span> <span class=n>value_2</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1530 name=__codelineno-0-1530></a><a href=#__codelineno-0-1530><span class=linenos data-linenos="1530 "></span></a>                        <span class=bp>self</span><span class=o>.</span><span class=n>_define_parameter</span><span class=p>(</span>
<a id=__codelineno-0-1531 name=__codelineno-0-1531></a><a href=#__codelineno-0-1531><span class=linenos data-linenos="1531 "></span></a>                            <span class=n>col_i</span><span class=o>=</span><span class=n>col_i</span><span class=p>,</span>
<a id=__codelineno-0-1532 name=__codelineno-0-1532></a><a href=#__codelineno-0-1532><span class=linenos data-linenos="1532 "></span></a>                            <span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span>
<a id=__codelineno-0-1533 name=__codelineno-0-1533></a><a href=#__codelineno-0-1533><span class=linenos data-linenos="1533 "></span></a>                            <span class=n>key_2</span><span class=o>=</span><span class=n>key_2</span><span class=p>,</span>
<a id=__codelineno-0-1534 name=__codelineno-0-1534></a><a href=#__codelineno-0-1534><span class=linenos data-linenos="1534 "></span></a>                            <span class=n>key_3</span><span class=o>=</span><span class=n>key_3</span><span class=p>,</span>
<a id=__codelineno-0-1535 name=__codelineno-0-1535></a><a href=#__codelineno-0-1535><span class=linenos data-linenos="1535 "></span></a>                            <span class=n>value_3</span><span class=o>=</span><span class=n>value_3</span><span class=p>,</span>
<a id=__codelineno-0-1536 name=__codelineno-0-1536></a><a href=#__codelineno-0-1536><span class=linenos data-linenos="1536 "></span></a>                        <span class=p>)</span>
<a id=__codelineno-0-1537 name=__codelineno-0-1537></a><a href=#__codelineno-0-1537><span class=linenos data-linenos="1537 "></span></a>
<a id=__codelineno-0-1538 name=__codelineno-0-1538></a><a href=#__codelineno-0-1538><span class=linenos data-linenos="1538 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>_define_parameter</span><span class=p>(</span>
<a id=__codelineno-0-1539 name=__codelineno-0-1539></a><a href=#__codelineno-0-1539><span class=linenos data-linenos="1539 "></span></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>col_i</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>key_1</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_2</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_3</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value_3</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
<a id=__codelineno-0-1540 name=__codelineno-0-1540></a><a href=#__codelineno-0-1540><span class=linenos data-linenos="1540 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1541 name=__codelineno-0-1541></a><a href=#__codelineno-0-1541><span class=linenos data-linenos="1541 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Define the input parameters for a `params`-dictionary for global fitting.</span>
<a id=__codelineno-0-1542 name=__codelineno-0-1542></a><a href=#__codelineno-0-1542><span class=linenos data-linenos="1542 "></span></a>
<a id=__codelineno-0-1543 name=__codelineno-0-1543></a><a href=#__codelineno-0-1543><span class=linenos data-linenos="1543 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-1544 name=__codelineno-0-1544></a><a href=#__codelineno-0-1544><span class=linenos data-linenos="1544 "></span></a><span class=sd>            col_i (int): The column index.</span>
<a id=__codelineno-0-1545 name=__codelineno-0-1545></a><a href=#__codelineno-0-1545><span class=linenos data-linenos="1545 "></span></a><span class=sd>            key_1 (str): The key of the first level of the input dictionary.</span>
<a id=__codelineno-0-1546 name=__codelineno-0-1546></a><a href=#__codelineno-0-1546><span class=linenos data-linenos="1546 "></span></a><span class=sd>            key_2 (str): The key of the second level of the input dictionary.</span>
<a id=__codelineno-0-1547 name=__codelineno-0-1547></a><a href=#__codelineno-0-1547><span class=linenos data-linenos="1547 "></span></a><span class=sd>            key_3 (str): The key of the third level of the input dictionary.</span>
<a id=__codelineno-0-1548 name=__codelineno-0-1548></a><a href=#__codelineno-0-1548><span class=linenos data-linenos="1548 "></span></a><span class=sd>            value_3 (Dict[str, Any]): The value of the third level of the input</span>
<a id=__codelineno-0-1549 name=__codelineno-0-1549></a><a href=#__codelineno-0-1549><span class=linenos data-linenos="1549 "></span></a><span class=sd>                 dictionary.</span>
<a id=__codelineno-0-1550 name=__codelineno-0-1550></a><a href=#__codelineno-0-1550><span class=linenos data-linenos="1550 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1551 name=__codelineno-0-1551></a><a href=#__codelineno-0-1551><span class=linenos data-linenos="1551 "></span></a>        <span class=k>if</span> <span class=n>col_i</span><span class=p>:</span>
<a id=__codelineno-0-1552 name=__codelineno-0-1552></a><a href=#__codelineno-0-1552><span class=linenos data-linenos="1552 "></span></a>            <span class=k>if</span> <span class=n>key_3</span> <span class=o>!=</span> <span class=s2>&quot;amplitude&quot;</span><span class=p>:</span>
<a id=__codelineno-0-1553 name=__codelineno-0-1553></a><a href=#__codelineno-0-1553><span class=linenos data-linenos="1553 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1554 name=__codelineno-0-1554></a><a href=#__codelineno-0-1554><span class=linenos data-linenos="1554 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>col_i</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1555 name=__codelineno-0-1555></a><a href=#__codelineno-0-1555><span class=linenos data-linenos="1555 "></span></a>                    <span class=n>expr</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>_1&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1556 name=__codelineno-0-1556></a><a href=#__codelineno-0-1556><span class=linenos data-linenos="1556 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1557 name=__codelineno-0-1557></a><a href=#__codelineno-0-1557><span class=linenos data-linenos="1557 "></span></a>            <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-1558 name=__codelineno-0-1558></a><a href=#__codelineno-0-1558><span class=linenos data-linenos="1558 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1559 name=__codelineno-0-1559></a><a href=#__codelineno-0-1559><span class=linenos data-linenos="1559 "></span></a>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>col_i</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1560 name=__codelineno-0-1560></a><a href=#__codelineno-0-1560><span class=linenos data-linenos="1560 "></span></a>                    <span class=o>**</span><span class=n>value_3</span><span class=p>,</span>
<a id=__codelineno-0-1561 name=__codelineno-0-1561></a><a href=#__codelineno-0-1561><span class=linenos data-linenos="1561 "></span></a>                <span class=p>)</span>
<a id=__codelineno-0-1562 name=__codelineno-0-1562></a><a href=#__codelineno-0-1562><span class=linenos data-linenos="1562 "></span></a>
<a id=__codelineno-0-1563 name=__codelineno-0-1563></a><a href=#__codelineno-0-1563><span class=linenos data-linenos="1563 "></span></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-1564 name=__codelineno-0-1564></a><a href=#__codelineno-0-1564><span class=linenos data-linenos="1564 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>_1&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>value_3</span><span class=p>)</span>
<a id=__codelineno-0-1565 name=__codelineno-0-1565></a><a href=#__codelineno-0-1565><span class=linenos data-linenos="1565 "></span></a>
<a id=__codelineno-0-1566 name=__codelineno-0-1566></a><a href=#__codelineno-0-1566><span class=linenos data-linenos="1566 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>define_parameters_global_pre</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1567 name=__codelineno-0-1567></a><a href=#__codelineno-0-1567><span class=linenos data-linenos="1567 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Define the input parameters for a `params`-dictionary for global fitting.</span>
<a id=__codelineno-0-1568 name=__codelineno-0-1568></a><a href=#__codelineno-0-1568><span class=linenos data-linenos="1568 "></span></a>
<a id=__codelineno-0-1569 name=__codelineno-0-1569></a><a href=#__codelineno-0-1569><span class=linenos data-linenos="1569 "></span></a><span class=sd>        !!! warning &quot;About `params` for global fitting&quot;</span>
<a id=__codelineno-0-1570 name=__codelineno-0-1570></a><a href=#__codelineno-0-1570><span class=linenos data-linenos="1570 "></span></a>
<a id=__codelineno-0-1571 name=__codelineno-0-1571></a><a href=#__codelineno-0-1571><span class=linenos data-linenos="1571 "></span></a><span class=sd>            `define_parameters_global_pre` requires fully defined `params`-dictionary</span>
<a id=__codelineno-0-1572 name=__codelineno-0-1572></a><a href=#__codelineno-0-1572><span class=linenos data-linenos="1572 "></span></a><span class=sd>            in the json, toml, or yaml file input. This means:</span>
<a id=__codelineno-0-1573 name=__codelineno-0-1573></a><a href=#__codelineno-0-1573><span class=linenos data-linenos="1573 "></span></a>
<a id=__codelineno-0-1574 name=__codelineno-0-1574></a><a href=#__codelineno-0-1574><span class=linenos data-linenos="1574 "></span></a><span class=sd>            1. Number of the spectra must be defined.</span>
<a id=__codelineno-0-1575 name=__codelineno-0-1575></a><a href=#__codelineno-0-1575><span class=linenos data-linenos="1575 "></span></a><span class=sd>            2. Number of the peaks must be defined.</span>
<a id=__codelineno-0-1576 name=__codelineno-0-1576></a><a href=#__codelineno-0-1576><span class=linenos data-linenos="1576 "></span></a><span class=sd>            3. Number of the parameters must be defined.</span>
<a id=__codelineno-0-1577 name=__codelineno-0-1577></a><a href=#__codelineno-0-1577><span class=linenos data-linenos="1577 "></span></a><span class=sd>            4. The parameters must be defined.</span>
<a id=__codelineno-0-1578 name=__codelineno-0-1578></a><a href=#__codelineno-0-1578><span class=linenos data-linenos="1578 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1579 name=__codelineno-0-1579></a><a href=#__codelineno-0-1579><span class=linenos data-linenos="1579 "></span></a>        <span class=k>for</span> <span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;peaks&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1580 name=__codelineno-0-1580></a><a href=#__codelineno-0-1580><span class=linenos data-linenos="1580 "></span></a>            <span class=k>for</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span> <span class=ow>in</span> <span class=n>value_1</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1581 name=__codelineno-0-1581></a><a href=#__codelineno-0-1581><span class=linenos data-linenos="1581 "></span></a>                <span class=k>for</span> <span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span> <span class=ow>in</span> <span class=n>value_2</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1582 name=__codelineno-0-1582></a><a href=#__codelineno-0-1582><span class=linenos data-linenos="1582 "></span></a>                    <span class=k>for</span> <span class=n>key_4</span><span class=p>,</span> <span class=n>value_4</span> <span class=ow>in</span> <span class=n>value_3</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1583 name=__codelineno-0-1583></a><a href=#__codelineno-0-1583><span class=linenos data-linenos="1583 "></span></a>                        <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_4</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>value_4</span><span class=p>)</span>
</code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 id=spectrafit.models.ModelParameters.return_params class="doc doc-heading"> <code class="highlight language-python"><span class=n>return_params</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#spectrafit.models.ModelParameters.return_params class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return the <code class="language-perl6 highlight"><span class=k>class</span></code> representation of the model parameters.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>Parameters</code></td> <td> <code><span title=lmfit.Parameters>Parameters</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="A mathematical function used to describe the data, often composed of one or more peak functions and a baseline, implemented using lmfit Models">Model</abbr> parameters class.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>args</span><span class=p>)</span></code> <a href=#spectrafit.models.ModelParameters.__init__ class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Initialize the model parameters.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>df</code> </td> <td> <code><span title=pandas.DataFrame>DataFrame</span></code> </td> <td> <div class=doc-md-description> <p>DataFrame containing the input data (<code class="language-text highlight">x</code> and <code class="language-text highlight">data</code>).</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>args</code> </td> <td> <code><span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>Nested arguments dictionary for the model based on <strong>one</strong> or <strong>two</strong> <code class="language-text highlight">int</code> keys depending if global fitting parameters, will explicit defined or not.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <div class="admonition note"> <p class=admonition-title>About <code class="language-text highlight">args</code> for models</p> <p>The <code class="language-text highlight">args</code> dictionary is used to define the model parameters. And the total nested dictionary structure is as follows:</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="1 "></span></a><span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>,</span> <span class=nb>float</span><span class=p>]]]]]</span>
</code></pre></div> </div> <div class="admonition info"> <p class=admonition-title>About the fitting options</p> <p>In general, there are two option for the fitting possible:</p> <ol> <li><code class="language-text highlight">Classic fitting</code> or <code class="language-text highlight">local fitting</code>, where the parameters are defined for a 2D spectrum.</li> <li><code class="language-text highlight">Global fitting</code>, where the parameters are defined for a 3D spectrum. Here, the parameters can be automatically defined for each column on the basis of the initial parameters or they can be completley defined by the user. The <code class="language-text highlight">global fitting</code> definition starts at <code class="language-cbmbas highlight"><span class=mf>1</span></code> similiar to the peaks attributes notation.</li> </ol> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1185 name=__codelineno-0-1185></a><a href=#__codelineno-0-1185><span class=linenos data-linenos="1185 "></span></a><span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1186 name=__codelineno-0-1186></a><a href=#__codelineno-0-1186><span class=linenos data-linenos="1186 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the model parameters.</span>
<a id=__codelineno-0-1187 name=__codelineno-0-1187></a><a href=#__codelineno-0-1187><span class=linenos data-linenos="1187 "></span></a>
<a id=__codelineno-0-1188 name=__codelineno-0-1188></a><a href=#__codelineno-0-1188><span class=linenos data-linenos="1188 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-1189 name=__codelineno-0-1189></a><a href=#__codelineno-0-1189><span class=linenos data-linenos="1189 "></span></a><span class=sd>        df (pd.DataFrame): DataFrame containing the input data (`x` and `data`).</span>
<a id=__codelineno-0-1190 name=__codelineno-0-1190></a><a href=#__codelineno-0-1190><span class=linenos data-linenos="1190 "></span></a><span class=sd>        args (Dict[str, Any]):</span>
<a id=__codelineno-0-1191 name=__codelineno-0-1191></a><a href=#__codelineno-0-1191><span class=linenos data-linenos="1191 "></span></a><span class=sd>             Nested arguments dictionary for the model based on **one** or **two**</span>
<a id=__codelineno-0-1192 name=__codelineno-0-1192></a><a href=#__codelineno-0-1192><span class=linenos data-linenos="1192 "></span></a><span class=sd>             `int` keys depending if global fitting parameters, will explicit</span>
<a id=__codelineno-0-1193 name=__codelineno-0-1193></a><a href=#__codelineno-0-1193><span class=linenos data-linenos="1193 "></span></a><span class=sd>             defined or not.</span>
<a id=__codelineno-0-1194 name=__codelineno-0-1194></a><a href=#__codelineno-0-1194><span class=linenos data-linenos="1194 "></span></a>
<a id=__codelineno-0-1195 name=__codelineno-0-1195></a><a href=#__codelineno-0-1195><span class=linenos data-linenos="1195 "></span></a><span class=sd>    !!! note &quot;About `args` for models&quot;</span>
<a id=__codelineno-0-1196 name=__codelineno-0-1196></a><a href=#__codelineno-0-1196><span class=linenos data-linenos="1196 "></span></a>
<a id=__codelineno-0-1197 name=__codelineno-0-1197></a><a href=#__codelineno-0-1197><span class=linenos data-linenos="1197 "></span></a><span class=sd>        The `args` dictionary is used to define the model parameters. And the total</span>
<a id=__codelineno-0-1198 name=__codelineno-0-1198></a><a href=#__codelineno-0-1198><span class=linenos data-linenos="1198 "></span></a><span class=sd>        nested dictionary structure is as follows:</span>
<a id=__codelineno-0-1199 name=__codelineno-0-1199></a><a href=#__codelineno-0-1199><span class=linenos data-linenos="1199 "></span></a>
<a id=__codelineno-0-1200 name=__codelineno-0-1200></a><a href=#__codelineno-0-1200><span class=linenos data-linenos="1200 "></span></a><span class=sd>        ```python</span>
<a id=__codelineno-0-1201 name=__codelineno-0-1201></a><a href=#__codelineno-0-1201><span class=linenos data-linenos="1201 "></span></a><span class=sd>        args: Dict[str, Dict[int, Dict[str, Dict[str, Union[str, int, float]]]]]</span>
<a id=__codelineno-0-1202 name=__codelineno-0-1202></a><a href=#__codelineno-0-1202><span class=linenos data-linenos="1202 "></span></a><span class=sd>        ```</span>
<a id=__codelineno-0-1203 name=__codelineno-0-1203></a><a href=#__codelineno-0-1203><span class=linenos data-linenos="1203 "></span></a>
<a id=__codelineno-0-1204 name=__codelineno-0-1204></a><a href=#__codelineno-0-1204><span class=linenos data-linenos="1204 "></span></a><span class=sd>    !!! info &quot;About the fitting options&quot;</span>
<a id=__codelineno-0-1205 name=__codelineno-0-1205></a><a href=#__codelineno-0-1205><span class=linenos data-linenos="1205 "></span></a>
<a id=__codelineno-0-1206 name=__codelineno-0-1206></a><a href=#__codelineno-0-1206><span class=linenos data-linenos="1206 "></span></a><span class=sd>        In general, there are two option for the fitting possible:</span>
<a id=__codelineno-0-1207 name=__codelineno-0-1207></a><a href=#__codelineno-0-1207><span class=linenos data-linenos="1207 "></span></a>
<a id=__codelineno-0-1208 name=__codelineno-0-1208></a><a href=#__codelineno-0-1208><span class=linenos data-linenos="1208 "></span></a><span class=sd>        1. `Classic fitting` or `local fitting`, where the parameters are defined</span>
<a id=__codelineno-0-1209 name=__codelineno-0-1209></a><a href=#__codelineno-0-1209><span class=linenos data-linenos="1209 "></span></a><span class=sd>            for a 2D spectrum.</span>
<a id=__codelineno-0-1210 name=__codelineno-0-1210></a><a href=#__codelineno-0-1210><span class=linenos data-linenos="1210 "></span></a><span class=sd>        2. `Global fitting`, where the parameters are defined for a 3D spectrum.</span>
<a id=__codelineno-0-1211 name=__codelineno-0-1211></a><a href=#__codelineno-0-1211><span class=linenos data-linenos="1211 "></span></a><span class=sd>            Here, the parameters can be automatically defined for each column on the</span>
<a id=__codelineno-0-1212 name=__codelineno-0-1212></a><a href=#__codelineno-0-1212><span class=linenos data-linenos="1212 "></span></a><span class=sd>            basis of the initial parameters or they can be completley defined by the</span>
<a id=__codelineno-0-1213 name=__codelineno-0-1213></a><a href=#__codelineno-0-1213><span class=linenos data-linenos="1213 "></span></a><span class=sd>            user. The `global fitting` definition starts at `1` similiar to the</span>
<a id=__codelineno-0-1214 name=__codelineno-0-1214></a><a href=#__codelineno-0-1214><span class=linenos data-linenos="1214 "></span></a><span class=sd>            peaks attributes notation.</span>
<a id=__codelineno-0-1215 name=__codelineno-0-1215></a><a href=#__codelineno-0-1215><span class=linenos data-linenos="1215 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1216 name=__codelineno-0-1216></a><a href=#__codelineno-0-1216><span class=linenos data-linenos="1216 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>col_len</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span>
<a id=__codelineno-0-1217 name=__codelineno-0-1217></a><a href=#__codelineno-0-1217><span class=linenos data-linenos="1217 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>args</span> <span class=o>=</span> <span class=n>args</span>
<a id=__codelineno-0-1218 name=__codelineno-0-1218></a><a href=#__codelineno-0-1218><span class=linenos data-linenos="1218 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>params</span> <span class=o>=</span> <span class=n>Parameters</span><span class=p>()</span>
<a id=__codelineno-0-1219 name=__codelineno-0-1219></a><a href=#__codelineno-0-1219><span class=linenos data-linenos="1219 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>df_to_numvalues</span><span class=p>(</span><span class=n>df</span><span class=o>=</span><span class=n>df</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=n>args</span><span class=p>)</span>
<a id=__codelineno-0-1220 name=__codelineno-0-1220></a><a href=#__codelineno-0-1220><span class=linenos data-linenos="1220 "></span></a>
<a id=__codelineno-0-1221 name=__codelineno-0-1221></a><a href=#__codelineno-0-1221><span class=linenos data-linenos="1221 "></span></a>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.__perform__ class="doc doc-heading"> <code class="highlight language-python"><span class=n>__perform__</span><span class=p>()</span></code> <a href=#spectrafit.models.ModelParameters.__perform__ class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Perform the model parameter definition.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=KeyError>KeyError</span></code> </td> <td> <div class=doc-md-description> <p>Global fitting is combination with automatic peak detection is not implemented yet.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1271 name=__codelineno-0-1271></a><a href=#__codelineno-0-1271><span class=linenos data-linenos="1271 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>__perform__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1272 name=__codelineno-0-1272></a><a href=#__codelineno-0-1272><span class=linenos data-linenos="1272 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Perform the model parameter definition.</span>
<a id=__codelineno-0-1273 name=__codelineno-0-1273></a><a href=#__codelineno-0-1273><span class=linenos data-linenos="1273 "></span></a>
<a id=__codelineno-0-1274 name=__codelineno-0-1274></a><a href=#__codelineno-0-1274><span class=linenos data-linenos="1274 "></span></a><span class=sd>    Raises:</span>
<a id=__codelineno-0-1275 name=__codelineno-0-1275></a><a href=#__codelineno-0-1275><span class=linenos data-linenos="1275 "></span></a><span class=sd>        KeyError: Global fitting is combination with automatic peak detection is</span>
<a id=__codelineno-0-1276 name=__codelineno-0-1276></a><a href=#__codelineno-0-1276><span class=linenos data-linenos="1276 "></span></a><span class=sd>             not implemented yet.</span>
<a id=__codelineno-0-1277 name=__codelineno-0-1277></a><a href=#__codelineno-0-1277><span class=linenos data-linenos="1277 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1278 name=__codelineno-0-1278></a><a href=#__codelineno-0-1278><span class=linenos data-linenos="1278 "></span></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]:</span>
<a id=__codelineno-0-1279 name=__codelineno-0-1279></a><a href=#__codelineno-0-1279><span class=linenos data-linenos="1279 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters</span><span class=p>()</span>
<a id=__codelineno-0-1280 name=__codelineno-0-1280></a><a href=#__codelineno-0-1280><span class=linenos data-linenos="1280 "></span></a>    <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span> <span class=ow>and</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]:</span>
<a id=__codelineno-0-1281 name=__codelineno-0-1281></a><a href=#__codelineno-0-1281><span class=linenos data-linenos="1281 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_global</span><span class=p>()</span>
<a id=__codelineno-0-1282 name=__codelineno-0-1282></a><a href=#__codelineno-0-1282><span class=linenos data-linenos="1282 "></span></a>    <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>2</span> <span class=ow>and</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]:</span>
<a id=__codelineno-0-1283 name=__codelineno-0-1283></a><a href=#__codelineno-0-1283><span class=linenos data-linenos="1283 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_global_pre</span><span class=p>()</span>
<a id=__codelineno-0-1284 name=__codelineno-0-1284></a><a href=#__codelineno-0-1284><span class=linenos data-linenos="1284 "></span></a>    <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-0-1285 name=__codelineno-0-1285></a><a href=#__codelineno-0-1285><span class=linenos data-linenos="1285 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>initialize_peak_detection</span><span class=p>()</span>
<a id=__codelineno-0-1286 name=__codelineno-0-1286></a><a href=#__codelineno-0-1286><span class=linenos data-linenos="1286 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_auto</span><span class=p>()</span>
<a id=__codelineno-0-1287 name=__codelineno-0-1287></a><a href=#__codelineno-0-1287><span class=linenos data-linenos="1287 "></span></a>    <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]:</span>
<a id=__codelineno-0-1288 name=__codelineno-0-1288></a><a href=#__codelineno-0-1288><span class=linenos data-linenos="1288 "></span></a>        <span class=k>raise</span> <span class=ne>KeyError</span><span class=p>(</span>
<a id=__codelineno-0-1289 name=__codelineno-0-1289></a><a href=#__codelineno-0-1289><span class=linenos data-linenos="1289 "></span></a>            <span class=s2>&quot;Global fitting mode with automatic peak detection &quot;</span>
<a id=__codelineno-0-1290 name=__codelineno-0-1290></a><a href=#__codelineno-0-1290><span class=linenos data-linenos="1290 "></span></a>            <span class=s2>&quot;is not supported yet.&quot;</span>
<a id=__codelineno-0-1291 name=__codelineno-0-1291></a><a href=#__codelineno-0-1291><span class=linenos data-linenos="1291 "></span></a>        <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.__str__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__str__</span><span class=p>()</span></code> <a href=#spectrafit.models.ModelParameters.__str__ class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return the <code class="language-text highlight">string</code> representation of the model parameters.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>str</code></td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>String representation of the model parameters.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1262 name=__codelineno-0-1262></a><a href=#__codelineno-0-1262><span class=linenos data-linenos="1262 "></span></a><span class=k>def</span><span class=w> </span><span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-0-1263 name=__codelineno-0-1263></a><a href=#__codelineno-0-1263><span class=linenos data-linenos="1263 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return the `string` representation of the model parameters.</span>
<a id=__codelineno-0-1264 name=__codelineno-0-1264></a><a href=#__codelineno-0-1264><span class=linenos data-linenos="1264 "></span></a>
<a id=__codelineno-0-1265 name=__codelineno-0-1265></a><a href=#__codelineno-0-1265><span class=linenos data-linenos="1265 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-1266 name=__codelineno-0-1266></a><a href=#__codelineno-0-1266><span class=linenos data-linenos="1266 "></span></a><span class=sd>        str: String representation of the model parameters.</span>
<a id=__codelineno-0-1267 name=__codelineno-0-1267></a><a href=#__codelineno-0-1267><span class=linenos data-linenos="1267 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1268 name=__codelineno-0-1268></a><a href=#__codelineno-0-1268><span class=linenos data-linenos="1268 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>__perform__</span><span class=p>()</span>
<a id=__codelineno-0-1269 name=__codelineno-0-1269></a><a href=#__codelineno-0-1269><span class=linenos data-linenos="1269 "></span></a>    <span class=k>return</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.define_parameters class="doc doc-heading"> <code class="highlight language-python"><span class=n>define_parameters</span><span class=p>()</span></code> <a href=#spectrafit.models.ModelParameters.define_parameters class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Define the input parameters for a <code class="language-text highlight">params</code>-dictionary for classic fitting.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1478 name=__codelineno-0-1478></a><a href=#__codelineno-0-1478><span class=linenos data-linenos="1478 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>define_parameters</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1479 name=__codelineno-0-1479></a><a href=#__codelineno-0-1479><span class=linenos data-linenos="1479 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Define the input parameters for a `params`-dictionary for classic fitting.&quot;&quot;&quot;</span>
<a id=__codelineno-0-1480 name=__codelineno-0-1480></a><a href=#__codelineno-0-1480><span class=linenos data-linenos="1480 "></span></a>    <span class=k>for</span> <span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;peaks&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1481 name=__codelineno-0-1481></a><a href=#__codelineno-0-1481><span class=linenos data-linenos="1481 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_loop</span><span class=p>(</span><span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span><span class=o>=</span><span class=n>value_1</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.define_parameters_auto class="doc doc-heading"> <code class="highlight language-python"><span class=n>define_parameters_auto</span><span class=p>()</span></code> <a href=#spectrafit.models.ModelParameters.define_parameters_auto class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Auto define the model parameters for local fitting.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1293 name=__codelineno-0-1293></a><a href=#__codelineno-0-1293><span class=linenos data-linenos="1293 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>define_parameters_auto</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1294 name=__codelineno-0-1294></a><a href=#__codelineno-0-1294><span class=linenos data-linenos="1294 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Auto define the model parameters for local fitting.&quot;&quot;&quot;</span>
<a id=__codelineno-0-1295 name=__codelineno-0-1295></a><a href=#__codelineno-0-1295><span class=linenos data-linenos="1295 "></span></a>    <span class=n>positions</span><span class=p>,</span> <span class=n>properties</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>__autodetect__</span><span class=p>()</span>
<a id=__codelineno-0-1296 name=__codelineno-0-1296></a><a href=#__codelineno-0-1296><span class=linenos data-linenos="1296 "></span></a>    <span class=k>if</span> <span class=p>(</span>
<a id=__codelineno-0-1297 name=__codelineno-0-1297></a><a href=#__codelineno-0-1297><span class=linenos data-linenos="1297 "></span></a>        <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>],</span> <span class=nb>bool</span><span class=p>)</span>
<a id=__codelineno-0-1298 name=__codelineno-0-1298></a><a href=#__codelineno-0-1298><span class=linenos data-linenos="1298 "></span></a>        <span class=ow>and</span> <span class=s2>&quot;modeltype&quot;</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>]</span>
<a id=__codelineno-0-1299 name=__codelineno-0-1299></a><a href=#__codelineno-0-1299><span class=linenos data-linenos="1299 "></span></a>    <span class=p>):</span>
<a id=__codelineno-0-1300 name=__codelineno-0-1300></a><a href=#__codelineno-0-1300><span class=linenos data-linenos="1300 "></span></a>        <span class=n>_model</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;autopeak&quot;</span><span class=p>][</span><span class=s2>&quot;modeltype&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
<a id=__codelineno-0-1301 name=__codelineno-0-1301></a><a href=#__codelineno-0-1301><span class=linenos data-linenos="1301 "></span></a>        <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>automodel_check</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>_model</span><span class=p>)</span>
<a id=__codelineno-0-1302 name=__codelineno-0-1302></a><a href=#__codelineno-0-1302><span class=linenos data-linenos="1302 "></span></a>        <span class=n>models</span> <span class=o>=</span> <span class=n>_model</span>
<a id=__codelineno-0-1303 name=__codelineno-0-1303></a><a href=#__codelineno-0-1303><span class=linenos data-linenos="1303 "></span></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-1304 name=__codelineno-0-1304></a><a href=#__codelineno-0-1304><span class=linenos data-linenos="1304 "></span></a>        <span class=n>models</span> <span class=o>=</span> <span class=s2>&quot;gaussian&quot;</span>
<a id=__codelineno-0-1305 name=__codelineno-0-1305></a><a href=#__codelineno-0-1305><span class=linenos data-linenos="1305 "></span></a>
<a id=__codelineno-0-1306 name=__codelineno-0-1306></a><a href=#__codelineno-0-1306><span class=linenos data-linenos="1306 "></span></a>    <span class=k>if</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;gaussian&quot;</span><span class=p>:</span>
<a id=__codelineno-0-1307 name=__codelineno-0-1307></a><a href=#__codelineno-0-1307><span class=linenos data-linenos="1307 "></span></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
<a id=__codelineno-0-1308 name=__codelineno-0-1308></a><a href=#__codelineno-0-1308><span class=linenos data-linenos="1308 "></span></a>            <span class=nb>zip</span><span class=p>(</span>
<a id=__codelineno-0-1309 name=__codelineno-0-1309></a><a href=#__codelineno-0-1309><span class=linenos data-linenos="1309 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
<a id=__codelineno-0-1310 name=__codelineno-0-1310></a><a href=#__codelineno-0-1310><span class=linenos data-linenos="1310 "></span></a>                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1311 name=__codelineno-0-1311></a><a href=#__codelineno-0-1311><span class=linenos data-linenos="1311 "></span></a>                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1312 name=__codelineno-0-1312></a><a href=#__codelineno-0-1312><span class=linenos data-linenos="1312 "></span></a>            <span class=p>),</span>
<a id=__codelineno-0-1313 name=__codelineno-0-1313></a><a href=#__codelineno-0-1313><span class=linenos data-linenos="1313 "></span></a>            <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-1314 name=__codelineno-0-1314></a><a href=#__codelineno-0-1314><span class=linenos data-linenos="1314 "></span></a>        <span class=p>):</span>
<a id=__codelineno-0-1315 name=__codelineno-0-1315></a><a href=#__codelineno-0-1315><span class=linenos data-linenos="1315 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1316 name=__codelineno-0-1316></a><a href=#__codelineno-0-1316><span class=linenos data-linenos="1316 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1317 name=__codelineno-0-1317></a><a href=#__codelineno-0-1317><span class=linenos data-linenos="1317 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
<a id=__codelineno-0-1318 name=__codelineno-0-1318></a><a href=#__codelineno-0-1318><span class=linenos data-linenos="1318 "></span></a>                <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1319 name=__codelineno-0-1319></a><a href=#__codelineno-0-1319><span class=linenos data-linenos="1319 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1320 name=__codelineno-0-1320></a><a href=#__codelineno-0-1320><span class=linenos data-linenos="1320 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1321 name=__codelineno-0-1321></a><a href=#__codelineno-0-1321><span class=linenos data-linenos="1321 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1322 name=__codelineno-0-1322></a><a href=#__codelineno-0-1322><span class=linenos data-linenos="1322 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1323 name=__codelineno-0-1323></a><a href=#__codelineno-0-1323><span class=linenos data-linenos="1323 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1324 name=__codelineno-0-1324></a><a href=#__codelineno-0-1324><span class=linenos data-linenos="1324 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1325 name=__codelineno-0-1325></a><a href=#__codelineno-0-1325><span class=linenos data-linenos="1325 "></span></a>                <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1326 name=__codelineno-0-1326></a><a href=#__codelineno-0-1326><span class=linenos data-linenos="1326 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1327 name=__codelineno-0-1327></a><a href=#__codelineno-0-1327><span class=linenos data-linenos="1327 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1328 name=__codelineno-0-1328></a><a href=#__codelineno-0-1328><span class=linenos data-linenos="1328 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1329 name=__codelineno-0-1329></a><a href=#__codelineno-0-1329><span class=linenos data-linenos="1329 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1330 name=__codelineno-0-1330></a><a href=#__codelineno-0-1330><span class=linenos data-linenos="1330 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhmg_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1331 name=__codelineno-0-1331></a><a href=#__codelineno-0-1331><span class=linenos data-linenos="1331 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1332 name=__codelineno-0-1332></a><a href=#__codelineno-0-1332><span class=linenos data-linenos="1332 "></span></a>                <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-0-1333 name=__codelineno-0-1333></a><a href=#__codelineno-0-1333><span class=linenos data-linenos="1333 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1334 name=__codelineno-0-1334></a><a href=#__codelineno-0-1334><span class=linenos data-linenos="1334 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1335 name=__codelineno-0-1335></a><a href=#__codelineno-0-1335><span class=linenos data-linenos="1335 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1336 name=__codelineno-0-1336></a><a href=#__codelineno-0-1336><span class=linenos data-linenos="1336 "></span></a>    <span class=k>elif</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;orcagaussian&quot;</span><span class=p>:</span>
<a id=__codelineno-0-1337 name=__codelineno-0-1337></a><a href=#__codelineno-0-1337><span class=linenos data-linenos="1337 "></span></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_width</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
<a id=__codelineno-0-1338 name=__codelineno-0-1338></a><a href=#__codelineno-0-1338><span class=linenos data-linenos="1338 "></span></a>            <span class=nb>zip</span><span class=p>(</span>
<a id=__codelineno-0-1339 name=__codelineno-0-1339></a><a href=#__codelineno-0-1339><span class=linenos data-linenos="1339 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
<a id=__codelineno-0-1340 name=__codelineno-0-1340></a><a href=#__codelineno-0-1340><span class=linenos data-linenos="1340 "></span></a>                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1341 name=__codelineno-0-1341></a><a href=#__codelineno-0-1341><span class=linenos data-linenos="1341 "></span></a>                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1342 name=__codelineno-0-1342></a><a href=#__codelineno-0-1342><span class=linenos data-linenos="1342 "></span></a>            <span class=p>),</span>
<a id=__codelineno-0-1343 name=__codelineno-0-1343></a><a href=#__codelineno-0-1343><span class=linenos data-linenos="1343 "></span></a>            <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-1344 name=__codelineno-0-1344></a><a href=#__codelineno-0-1344><span class=linenos data-linenos="1344 "></span></a>        <span class=p>):</span>
<a id=__codelineno-0-1345 name=__codelineno-0-1345></a><a href=#__codelineno-0-1345><span class=linenos data-linenos="1345 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1346 name=__codelineno-0-1346></a><a href=#__codelineno-0-1346><span class=linenos data-linenos="1346 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1347 name=__codelineno-0-1347></a><a href=#__codelineno-0-1347><span class=linenos data-linenos="1347 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
<a id=__codelineno-0-1348 name=__codelineno-0-1348></a><a href=#__codelineno-0-1348><span class=linenos data-linenos="1348 "></span></a>                <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1349 name=__codelineno-0-1349></a><a href=#__codelineno-0-1349><span class=linenos data-linenos="1349 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1350 name=__codelineno-0-1350></a><a href=#__codelineno-0-1350><span class=linenos data-linenos="1350 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1351 name=__codelineno-0-1351></a><a href=#__codelineno-0-1351><span class=linenos data-linenos="1351 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1352 name=__codelineno-0-1352></a><a href=#__codelineno-0-1352><span class=linenos data-linenos="1352 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1353 name=__codelineno-0-1353></a><a href=#__codelineno-0-1353><span class=linenos data-linenos="1353 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1354 name=__codelineno-0-1354></a><a href=#__codelineno-0-1354><span class=linenos data-linenos="1354 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1355 name=__codelineno-0-1355></a><a href=#__codelineno-0-1355><span class=linenos data-linenos="1355 "></span></a>                <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1356 name=__codelineno-0-1356></a><a href=#__codelineno-0-1356><span class=linenos data-linenos="1356 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1357 name=__codelineno-0-1357></a><a href=#__codelineno-0-1357><span class=linenos data-linenos="1357 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1358 name=__codelineno-0-1358></a><a href=#__codelineno-0-1358><span class=linenos data-linenos="1358 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1359 name=__codelineno-0-1359></a><a href=#__codelineno-0-1359><span class=linenos data-linenos="1359 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1360 name=__codelineno-0-1360></a><a href=#__codelineno-0-1360><span class=linenos data-linenos="1360 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_width_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1361 name=__codelineno-0-1361></a><a href=#__codelineno-0-1361><span class=linenos data-linenos="1361 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=n>_width</span><span class=p>,</span>
<a id=__codelineno-0-1362 name=__codelineno-0-1362></a><a href=#__codelineno-0-1362><span class=linenos data-linenos="1362 "></span></a>                <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-0-1363 name=__codelineno-0-1363></a><a href=#__codelineno-0-1363><span class=linenos data-linenos="1363 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_width</span><span class=p>,</span>
<a id=__codelineno-0-1364 name=__codelineno-0-1364></a><a href=#__codelineno-0-1364><span class=linenos data-linenos="1364 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1365 name=__codelineno-0-1365></a><a href=#__codelineno-0-1365><span class=linenos data-linenos="1365 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1366 name=__codelineno-0-1366></a><a href=#__codelineno-0-1366><span class=linenos data-linenos="1366 "></span></a>    <span class=k>elif</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;lorentzian&quot;</span><span class=p>:</span>
<a id=__codelineno-0-1367 name=__codelineno-0-1367></a><a href=#__codelineno-0-1367><span class=linenos data-linenos="1367 "></span></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
<a id=__codelineno-0-1368 name=__codelineno-0-1368></a><a href=#__codelineno-0-1368><span class=linenos data-linenos="1368 "></span></a>            <span class=nb>zip</span><span class=p>(</span>
<a id=__codelineno-0-1369 name=__codelineno-0-1369></a><a href=#__codelineno-0-1369><span class=linenos data-linenos="1369 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
<a id=__codelineno-0-1370 name=__codelineno-0-1370></a><a href=#__codelineno-0-1370><span class=linenos data-linenos="1370 "></span></a>                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1371 name=__codelineno-0-1371></a><a href=#__codelineno-0-1371><span class=linenos data-linenos="1371 "></span></a>                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1372 name=__codelineno-0-1372></a><a href=#__codelineno-0-1372><span class=linenos data-linenos="1372 "></span></a>            <span class=p>),</span>
<a id=__codelineno-0-1373 name=__codelineno-0-1373></a><a href=#__codelineno-0-1373><span class=linenos data-linenos="1373 "></span></a>            <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-1374 name=__codelineno-0-1374></a><a href=#__codelineno-0-1374><span class=linenos data-linenos="1374 "></span></a>        <span class=p>):</span>
<a id=__codelineno-0-1375 name=__codelineno-0-1375></a><a href=#__codelineno-0-1375><span class=linenos data-linenos="1375 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1376 name=__codelineno-0-1376></a><a href=#__codelineno-0-1376><span class=linenos data-linenos="1376 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1377 name=__codelineno-0-1377></a><a href=#__codelineno-0-1377><span class=linenos data-linenos="1377 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
<a id=__codelineno-0-1378 name=__codelineno-0-1378></a><a href=#__codelineno-0-1378><span class=linenos data-linenos="1378 "></span></a>                <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1379 name=__codelineno-0-1379></a><a href=#__codelineno-0-1379><span class=linenos data-linenos="1379 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1380 name=__codelineno-0-1380></a><a href=#__codelineno-0-1380><span class=linenos data-linenos="1380 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1381 name=__codelineno-0-1381></a><a href=#__codelineno-0-1381><span class=linenos data-linenos="1381 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1382 name=__codelineno-0-1382></a><a href=#__codelineno-0-1382><span class=linenos data-linenos="1382 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1383 name=__codelineno-0-1383></a><a href=#__codelineno-0-1383><span class=linenos data-linenos="1383 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1384 name=__codelineno-0-1384></a><a href=#__codelineno-0-1384><span class=linenos data-linenos="1384 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1385 name=__codelineno-0-1385></a><a href=#__codelineno-0-1385><span class=linenos data-linenos="1385 "></span></a>                <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1386 name=__codelineno-0-1386></a><a href=#__codelineno-0-1386><span class=linenos data-linenos="1386 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1387 name=__codelineno-0-1387></a><a href=#__codelineno-0-1387><span class=linenos data-linenos="1387 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1388 name=__codelineno-0-1388></a><a href=#__codelineno-0-1388><span class=linenos data-linenos="1388 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1389 name=__codelineno-0-1389></a><a href=#__codelineno-0-1389><span class=linenos data-linenos="1389 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1390 name=__codelineno-0-1390></a><a href=#__codelineno-0-1390><span class=linenos data-linenos="1390 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhml_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1391 name=__codelineno-0-1391></a><a href=#__codelineno-0-1391><span class=linenos data-linenos="1391 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1392 name=__codelineno-0-1392></a><a href=#__codelineno-0-1392><span class=linenos data-linenos="1392 "></span></a>                <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-0-1393 name=__codelineno-0-1393></a><a href=#__codelineno-0-1393><span class=linenos data-linenos="1393 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1394 name=__codelineno-0-1394></a><a href=#__codelineno-0-1394><span class=linenos data-linenos="1394 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1395 name=__codelineno-0-1395></a><a href=#__codelineno-0-1395><span class=linenos data-linenos="1395 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1396 name=__codelineno-0-1396></a><a href=#__codelineno-0-1396><span class=linenos data-linenos="1396 "></span></a>    <span class=k>elif</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;voigt&quot;</span><span class=p>:</span>
<a id=__codelineno-0-1397 name=__codelineno-0-1397></a><a href=#__codelineno-0-1397><span class=linenos data-linenos="1397 "></span></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
<a id=__codelineno-0-1398 name=__codelineno-0-1398></a><a href=#__codelineno-0-1398><span class=linenos data-linenos="1398 "></span></a>            <span class=nb>zip</span><span class=p>(</span>
<a id=__codelineno-0-1399 name=__codelineno-0-1399></a><a href=#__codelineno-0-1399><span class=linenos data-linenos="1399 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
<a id=__codelineno-0-1400 name=__codelineno-0-1400></a><a href=#__codelineno-0-1400><span class=linenos data-linenos="1400 "></span></a>                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1401 name=__codelineno-0-1401></a><a href=#__codelineno-0-1401><span class=linenos data-linenos="1401 "></span></a>                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1402 name=__codelineno-0-1402></a><a href=#__codelineno-0-1402><span class=linenos data-linenos="1402 "></span></a>            <span class=p>),</span>
<a id=__codelineno-0-1403 name=__codelineno-0-1403></a><a href=#__codelineno-0-1403><span class=linenos data-linenos="1403 "></span></a>            <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-1404 name=__codelineno-0-1404></a><a href=#__codelineno-0-1404><span class=linenos data-linenos="1404 "></span></a>        <span class=p>):</span>
<a id=__codelineno-0-1405 name=__codelineno-0-1405></a><a href=#__codelineno-0-1405><span class=linenos data-linenos="1405 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1406 name=__codelineno-0-1406></a><a href=#__codelineno-0-1406><span class=linenos data-linenos="1406 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1407 name=__codelineno-0-1407></a><a href=#__codelineno-0-1407><span class=linenos data-linenos="1407 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
<a id=__codelineno-0-1408 name=__codelineno-0-1408></a><a href=#__codelineno-0-1408><span class=linenos data-linenos="1408 "></span></a>                <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1409 name=__codelineno-0-1409></a><a href=#__codelineno-0-1409><span class=linenos data-linenos="1409 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1410 name=__codelineno-0-1410></a><a href=#__codelineno-0-1410><span class=linenos data-linenos="1410 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1411 name=__codelineno-0-1411></a><a href=#__codelineno-0-1411><span class=linenos data-linenos="1411 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1412 name=__codelineno-0-1412></a><a href=#__codelineno-0-1412><span class=linenos data-linenos="1412 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1413 name=__codelineno-0-1413></a><a href=#__codelineno-0-1413><span class=linenos data-linenos="1413 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1414 name=__codelineno-0-1414></a><a href=#__codelineno-0-1414><span class=linenos data-linenos="1414 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1415 name=__codelineno-0-1415></a><a href=#__codelineno-0-1415><span class=linenos data-linenos="1415 "></span></a>                <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1416 name=__codelineno-0-1416></a><a href=#__codelineno-0-1416><span class=linenos data-linenos="1416 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1417 name=__codelineno-0-1417></a><a href=#__codelineno-0-1417><span class=linenos data-linenos="1417 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1418 name=__codelineno-0-1418></a><a href=#__codelineno-0-1418><span class=linenos data-linenos="1418 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1419 name=__codelineno-0-1419></a><a href=#__codelineno-0-1419><span class=linenos data-linenos="1419 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1420 name=__codelineno-0-1420></a><a href=#__codelineno-0-1420><span class=linenos data-linenos="1420 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhmv_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1421 name=__codelineno-0-1421></a><a href=#__codelineno-0-1421><span class=linenos data-linenos="1421 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1422 name=__codelineno-0-1422></a><a href=#__codelineno-0-1422><span class=linenos data-linenos="1422 "></span></a>                <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-0-1423 name=__codelineno-0-1423></a><a href=#__codelineno-0-1423><span class=linenos data-linenos="1423 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1424 name=__codelineno-0-1424></a><a href=#__codelineno-0-1424><span class=linenos data-linenos="1424 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1425 name=__codelineno-0-1425></a><a href=#__codelineno-0-1425><span class=linenos data-linenos="1425 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1426 name=__codelineno-0-1426></a><a href=#__codelineno-0-1426><span class=linenos data-linenos="1426 "></span></a>    <span class=k>elif</span> <span class=n>models</span> <span class=o>==</span> <span class=s2>&quot;pseudovoigt&quot;</span><span class=p>:</span>
<a id=__codelineno-0-1427 name=__codelineno-0-1427></a><a href=#__codelineno-0-1427><span class=linenos data-linenos="1427 "></span></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>_cent</span><span class=p>,</span> <span class=n>_amp</span><span class=p>,</span> <span class=n>_fhmw</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
<a id=__codelineno-0-1428 name=__codelineno-0-1428></a><a href=#__codelineno-0-1428><span class=linenos data-linenos="1428 "></span></a>            <span class=nb>zip</span><span class=p>(</span>
<a id=__codelineno-0-1429 name=__codelineno-0-1429></a><a href=#__codelineno-0-1429><span class=linenos data-linenos="1429 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>[</span><span class=n>positions</span><span class=p>],</span>
<a id=__codelineno-0-1430 name=__codelineno-0-1430></a><a href=#__codelineno-0-1430><span class=linenos data-linenos="1430 "></span></a>                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;peak_heights&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1431 name=__codelineno-0-1431></a><a href=#__codelineno-0-1431><span class=linenos data-linenos="1431 "></span></a>                <span class=n>properties</span><span class=p>[</span><span class=s2>&quot;widths&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1432 name=__codelineno-0-1432></a><a href=#__codelineno-0-1432><span class=linenos data-linenos="1432 "></span></a>            <span class=p>),</span>
<a id=__codelineno-0-1433 name=__codelineno-0-1433></a><a href=#__codelineno-0-1433><span class=linenos data-linenos="1433 "></span></a>            <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-1434 name=__codelineno-0-1434></a><a href=#__codelineno-0-1434><span class=linenos data-linenos="1434 "></span></a>        <span class=p>):</span>
<a id=__codelineno-0-1435 name=__codelineno-0-1435></a><a href=#__codelineno-0-1435><span class=linenos data-linenos="1435 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1436 name=__codelineno-0-1436></a><a href=#__codelineno-0-1436><span class=linenos data-linenos="1436 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_amplitude_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1437 name=__codelineno-0-1437></a><a href=#__codelineno-0-1437><span class=linenos data-linenos="1437 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=n>_amp</span><span class=p>,</span>
<a id=__codelineno-0-1438 name=__codelineno-0-1438></a><a href=#__codelineno-0-1438><span class=linenos data-linenos="1438 "></span></a>                <span class=nb>min</span><span class=o>=-</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1439 name=__codelineno-0-1439></a><a href=#__codelineno-0-1439><span class=linenos data-linenos="1439 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=mf>1.25</span> <span class=o>*</span> <span class=n>_amp</span><span class=p>),</span>
<a id=__codelineno-0-1440 name=__codelineno-0-1440></a><a href=#__codelineno-0-1440><span class=linenos data-linenos="1440 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1441 name=__codelineno-0-1441></a><a href=#__codelineno-0-1441><span class=linenos data-linenos="1441 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1442 name=__codelineno-0-1442></a><a href=#__codelineno-0-1442><span class=linenos data-linenos="1442 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1443 name=__codelineno-0-1443></a><a href=#__codelineno-0-1443><span class=linenos data-linenos="1443 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_center_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1444 name=__codelineno-0-1444></a><a href=#__codelineno-0-1444><span class=linenos data-linenos="1444 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1445 name=__codelineno-0-1445></a><a href=#__codelineno-0-1445><span class=linenos data-linenos="1445 "></span></a>                <span class=nb>min</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1446 name=__codelineno-0-1446></a><a href=#__codelineno-0-1446><span class=linenos data-linenos="1446 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_cent</span><span class=p>,</span>
<a id=__codelineno-0-1447 name=__codelineno-0-1447></a><a href=#__codelineno-0-1447><span class=linenos data-linenos="1447 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1448 name=__codelineno-0-1448></a><a href=#__codelineno-0-1448><span class=linenos data-linenos="1448 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1449 name=__codelineno-0-1449></a><a href=#__codelineno-0-1449><span class=linenos data-linenos="1449 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1450 name=__codelineno-0-1450></a><a href=#__codelineno-0-1450><span class=linenos data-linenos="1450 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhmg_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1451 name=__codelineno-0-1451></a><a href=#__codelineno-0-1451><span class=linenos data-linenos="1451 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1452 name=__codelineno-0-1452></a><a href=#__codelineno-0-1452><span class=linenos data-linenos="1452 "></span></a>                <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-0-1453 name=__codelineno-0-1453></a><a href=#__codelineno-0-1453><span class=linenos data-linenos="1453 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1454 name=__codelineno-0-1454></a><a href=#__codelineno-0-1454><span class=linenos data-linenos="1454 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1455 name=__codelineno-0-1455></a><a href=#__codelineno-0-1455><span class=linenos data-linenos="1455 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1456 name=__codelineno-0-1456></a><a href=#__codelineno-0-1456><span class=linenos data-linenos="1456 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
<a id=__codelineno-0-1457 name=__codelineno-0-1457></a><a href=#__codelineno-0-1457><span class=linenos data-linenos="1457 "></span></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>models</span><span class=si>}</span><span class=s2>_fwhml_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1458 name=__codelineno-0-1458></a><a href=#__codelineno-0-1458><span class=linenos data-linenos="1458 "></span></a>                <span class=n>value</span><span class=o>=</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1459 name=__codelineno-0-1459></a><a href=#__codelineno-0-1459><span class=linenos data-linenos="1459 "></span></a>                <span class=nb>min</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-0-1460 name=__codelineno-0-1460></a><a href=#__codelineno-0-1460><span class=linenos data-linenos="1460 "></span></a>                <span class=nb>max</span><span class=o>=</span><span class=mi>2</span> <span class=o>*</span> <span class=n>_fhmw</span><span class=p>,</span>
<a id=__codelineno-0-1461 name=__codelineno-0-1461></a><a href=#__codelineno-0-1461><span class=linenos data-linenos="1461 "></span></a>                <span class=n>vary</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1462 name=__codelineno-0-1462></a><a href=#__codelineno-0-1462><span class=linenos data-linenos="1462 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1463 name=__codelineno-0-1463></a><a href=#__codelineno-0-1463><span class=linenos data-linenos="1463 "></span></a>
<a id=__codelineno-0-1464 name=__codelineno-0-1464></a><a href=#__codelineno-0-1464><span class=linenos data-linenos="1464 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;auto_generated_models&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-0-1465 name=__codelineno-0-1465></a><a href=#__codelineno-0-1465><span class=linenos data-linenos="1465 "></span></a>        <span class=s2>&quot;models&quot;</span><span class=p>:</span> <span class=p>{</span>
<a id=__codelineno-0-1466 name=__codelineno-0-1466></a><a href=#__codelineno-0-1466><span class=linenos data-linenos="1466 "></span></a>            <span class=n>key</span><span class=p>:</span> <span class=p>{</span>
<a id=__codelineno-0-1467 name=__codelineno-0-1467></a><a href=#__codelineno-0-1467><span class=linenos data-linenos="1467 "></span></a>                <span class=s2>&quot;value&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
<a id=__codelineno-0-1468 name=__codelineno-0-1468></a><a href=#__codelineno-0-1468><span class=linenos data-linenos="1468 "></span></a>                <span class=s2>&quot;min&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>,</span>
<a id=__codelineno-0-1469 name=__codelineno-0-1469></a><a href=#__codelineno-0-1469><span class=linenos data-linenos="1469 "></span></a>                <span class=s2>&quot;max&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>,</span>
<a id=__codelineno-0-1470 name=__codelineno-0-1470></a><a href=#__codelineno-0-1470><span class=linenos data-linenos="1470 "></span></a>                <span class=s2>&quot;vary&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>vary</span><span class=p>,</span>
<a id=__codelineno-0-1471 name=__codelineno-0-1471></a><a href=#__codelineno-0-1471><span class=linenos data-linenos="1471 "></span></a>            <span class=p>}</span>
<a id=__codelineno-0-1472 name=__codelineno-0-1472></a><a href=#__codelineno-0-1472><span class=linenos data-linenos="1472 "></span></a>            <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>params</span>
<a id=__codelineno-0-1473 name=__codelineno-0-1473></a><a href=#__codelineno-0-1473><span class=linenos data-linenos="1473 "></span></a>        <span class=p>},</span>
<a id=__codelineno-0-1474 name=__codelineno-0-1474></a><a href=#__codelineno-0-1474><span class=linenos data-linenos="1474 "></span></a>        <span class=s2>&quot;positions&quot;</span><span class=p>:</span> <span class=n>positions</span><span class=o>.</span><span class=n>tolist</span><span class=p>(),</span>
<a id=__codelineno-0-1475 name=__codelineno-0-1475></a><a href=#__codelineno-0-1475><span class=linenos data-linenos="1475 "></span></a>        <span class=s2>&quot;properties&quot;</span><span class=p>:</span> <span class=p>{</span><span class=n>key</span><span class=p>:</span> <span class=n>value</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>properties</span><span class=o>.</span><span class=n>items</span><span class=p>()},</span>
<a id=__codelineno-0-1476 name=__codelineno-0-1476></a><a href=#__codelineno-0-1476><span class=linenos data-linenos="1476 "></span></a>    <span class=p>}</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.define_parameters_global class="doc doc-heading"> <code class="highlight language-python"><span class=n>define_parameters_global</span><span class=p>()</span></code> <a href=#spectrafit.models.ModelParameters.define_parameters_global class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Define the input parameters for a <code class="language-text highlight">params</code>-dictionary for global fitting.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1524 name=__codelineno-0-1524></a><a href=#__codelineno-0-1524><span class=linenos data-linenos="1524 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>define_parameters_global</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1525 name=__codelineno-0-1525></a><a href=#__codelineno-0-1525><span class=linenos data-linenos="1525 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Define the input parameters for a `params`-dictionary for global fitting.&quot;&quot;&quot;</span>
<a id=__codelineno-0-1526 name=__codelineno-0-1526></a><a href=#__codelineno-0-1526><span class=linenos data-linenos="1526 "></span></a>    <span class=k>for</span> <span class=n>col_i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>col_len</span><span class=p>):</span>
<a id=__codelineno-0-1527 name=__codelineno-0-1527></a><a href=#__codelineno-0-1527><span class=linenos data-linenos="1527 "></span></a>        <span class=k>for</span> <span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;peaks&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1528 name=__codelineno-0-1528></a><a href=#__codelineno-0-1528><span class=linenos data-linenos="1528 "></span></a>            <span class=k>for</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span> <span class=ow>in</span> <span class=n>value_1</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1529 name=__codelineno-0-1529></a><a href=#__codelineno-0-1529><span class=linenos data-linenos="1529 "></span></a>                <span class=k>for</span> <span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span> <span class=ow>in</span> <span class=n>value_2</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1530 name=__codelineno-0-1530></a><a href=#__codelineno-0-1530><span class=linenos data-linenos="1530 "></span></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>_define_parameter</span><span class=p>(</span>
<a id=__codelineno-0-1531 name=__codelineno-0-1531></a><a href=#__codelineno-0-1531><span class=linenos data-linenos="1531 "></span></a>                        <span class=n>col_i</span><span class=o>=</span><span class=n>col_i</span><span class=p>,</span>
<a id=__codelineno-0-1532 name=__codelineno-0-1532></a><a href=#__codelineno-0-1532><span class=linenos data-linenos="1532 "></span></a>                        <span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span>
<a id=__codelineno-0-1533 name=__codelineno-0-1533></a><a href=#__codelineno-0-1533><span class=linenos data-linenos="1533 "></span></a>                        <span class=n>key_2</span><span class=o>=</span><span class=n>key_2</span><span class=p>,</span>
<a id=__codelineno-0-1534 name=__codelineno-0-1534></a><a href=#__codelineno-0-1534><span class=linenos data-linenos="1534 "></span></a>                        <span class=n>key_3</span><span class=o>=</span><span class=n>key_3</span><span class=p>,</span>
<a id=__codelineno-0-1535 name=__codelineno-0-1535></a><a href=#__codelineno-0-1535><span class=linenos data-linenos="1535 "></span></a>                        <span class=n>value_3</span><span class=o>=</span><span class=n>value_3</span><span class=p>,</span>
<a id=__codelineno-0-1536 name=__codelineno-0-1536></a><a href=#__codelineno-0-1536><span class=linenos data-linenos="1536 "></span></a>                    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.define_parameters_global_pre class="doc doc-heading"> <code class="highlight language-python"><span class=n>define_parameters_global_pre</span><span class=p>()</span></code> <a href=#spectrafit.models.ModelParameters.define_parameters_global_pre class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Define the input parameters for a <code class="language-text highlight">params</code>-dictionary for global fitting.</p> <div class="admonition warning"> <p class=admonition-title>About <code class="language-text highlight">params</code> for global fitting</p> <p><code class="language-scdoc highlight">define_parameters_global_pre</code> requires fully defined <code class="language-text highlight">params</code>-dictionary in the json, toml, or yaml file input. This means:</p> <ol> <li>Number of the spectra must be defined.</li> <li>Number of the peaks must be defined.</li> <li>Number of the parameters must be defined.</li> <li>The parameters must be defined.</li> </ol> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1566 name=__codelineno-0-1566></a><a href=#__codelineno-0-1566><span class=linenos data-linenos="1566 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>define_parameters_global_pre</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1567 name=__codelineno-0-1567></a><a href=#__codelineno-0-1567><span class=linenos data-linenos="1567 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Define the input parameters for a `params`-dictionary for global fitting.</span>
<a id=__codelineno-0-1568 name=__codelineno-0-1568></a><a href=#__codelineno-0-1568><span class=linenos data-linenos="1568 "></span></a>
<a id=__codelineno-0-1569 name=__codelineno-0-1569></a><a href=#__codelineno-0-1569><span class=linenos data-linenos="1569 "></span></a><span class=sd>    !!! warning &quot;About `params` for global fitting&quot;</span>
<a id=__codelineno-0-1570 name=__codelineno-0-1570></a><a href=#__codelineno-0-1570><span class=linenos data-linenos="1570 "></span></a>
<a id=__codelineno-0-1571 name=__codelineno-0-1571></a><a href=#__codelineno-0-1571><span class=linenos data-linenos="1571 "></span></a><span class=sd>        `define_parameters_global_pre` requires fully defined `params`-dictionary</span>
<a id=__codelineno-0-1572 name=__codelineno-0-1572></a><a href=#__codelineno-0-1572><span class=linenos data-linenos="1572 "></span></a><span class=sd>        in the json, toml, or yaml file input. This means:</span>
<a id=__codelineno-0-1573 name=__codelineno-0-1573></a><a href=#__codelineno-0-1573><span class=linenos data-linenos="1573 "></span></a>
<a id=__codelineno-0-1574 name=__codelineno-0-1574></a><a href=#__codelineno-0-1574><span class=linenos data-linenos="1574 "></span></a><span class=sd>        1. Number of the spectra must be defined.</span>
<a id=__codelineno-0-1575 name=__codelineno-0-1575></a><a href=#__codelineno-0-1575><span class=linenos data-linenos="1575 "></span></a><span class=sd>        2. Number of the peaks must be defined.</span>
<a id=__codelineno-0-1576 name=__codelineno-0-1576></a><a href=#__codelineno-0-1576><span class=linenos data-linenos="1576 "></span></a><span class=sd>        3. Number of the parameters must be defined.</span>
<a id=__codelineno-0-1577 name=__codelineno-0-1577></a><a href=#__codelineno-0-1577><span class=linenos data-linenos="1577 "></span></a><span class=sd>        4. The parameters must be defined.</span>
<a id=__codelineno-0-1578 name=__codelineno-0-1578></a><a href=#__codelineno-0-1578><span class=linenos data-linenos="1578 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1579 name=__codelineno-0-1579></a><a href=#__codelineno-0-1579><span class=linenos data-linenos="1579 "></span></a>    <span class=k>for</span> <span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;peaks&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1580 name=__codelineno-0-1580></a><a href=#__codelineno-0-1580><span class=linenos data-linenos="1580 "></span></a>        <span class=k>for</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span> <span class=ow>in</span> <span class=n>value_1</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1581 name=__codelineno-0-1581></a><a href=#__codelineno-0-1581><span class=linenos data-linenos="1581 "></span></a>            <span class=k>for</span> <span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span> <span class=ow>in</span> <span class=n>value_2</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1582 name=__codelineno-0-1582></a><a href=#__codelineno-0-1582><span class=linenos data-linenos="1582 "></span></a>                <span class=k>for</span> <span class=n>key_4</span><span class=p>,</span> <span class=n>value_4</span> <span class=ow>in</span> <span class=n>value_3</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1583 name=__codelineno-0-1583></a><a href=#__codelineno-0-1583><span class=linenos data-linenos="1583 "></span></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_4</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>value_4</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.define_parameters_loop class="doc doc-heading"> <code class="highlight language-python"><span class=n>define_parameters_loop</span><span class=p>(</span><span class=n>key_1</span><span class=p>,</span> <span class=n>value_1</span><span class=p>)</span></code> <a href=#spectrafit.models.ModelParameters.define_parameters_loop class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Loop through the input parameters for a <code class="language-text highlight">params</code>-dictionary.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>key_1</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The key of the first level of the input dictionary.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>value_1</code> </td> <td> <code><span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>The value of the first level of the input dictionary.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1483 name=__codelineno-0-1483></a><a href=#__codelineno-0-1483><span class=linenos data-linenos="1483 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>define_parameters_loop</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key_1</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value_1</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1484 name=__codelineno-0-1484></a><a href=#__codelineno-0-1484><span class=linenos data-linenos="1484 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Loop through the input parameters for a `params`-dictionary.</span>
<a id=__codelineno-0-1485 name=__codelineno-0-1485></a><a href=#__codelineno-0-1485><span class=linenos data-linenos="1485 "></span></a>
<a id=__codelineno-0-1486 name=__codelineno-0-1486></a><a href=#__codelineno-0-1486><span class=linenos data-linenos="1486 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-1487 name=__codelineno-0-1487></a><a href=#__codelineno-0-1487><span class=linenos data-linenos="1487 "></span></a><span class=sd>        key_1 (str): The key of the first level of the input dictionary.</span>
<a id=__codelineno-0-1488 name=__codelineno-0-1488></a><a href=#__codelineno-0-1488><span class=linenos data-linenos="1488 "></span></a><span class=sd>        value_1 (Dict[str, Any]): The value of the first level of the input</span>
<a id=__codelineno-0-1489 name=__codelineno-0-1489></a><a href=#__codelineno-0-1489><span class=linenos data-linenos="1489 "></span></a><span class=sd>             dictionary.</span>
<a id=__codelineno-0-1490 name=__codelineno-0-1490></a><a href=#__codelineno-0-1490><span class=linenos data-linenos="1490 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1491 name=__codelineno-0-1491></a><a href=#__codelineno-0-1491><span class=linenos data-linenos="1491 "></span></a>    <span class=k>for</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span> <span class=ow>in</span> <span class=n>value_1</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1492 name=__codelineno-0-1492></a><a href=#__codelineno-0-1492><span class=linenos data-linenos="1492 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_loop_2</span><span class=p>(</span><span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span> <span class=n>key_2</span><span class=o>=</span><span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span><span class=o>=</span><span class=n>value_2</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.define_parameters_loop_2 class="doc doc-heading"> <code class="highlight language-python"><span class=n>define_parameters_loop_2</span><span class=p>(</span><span class=n>key_1</span><span class=p>,</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>value_2</span><span class=p>)</span></code> <a href=#spectrafit.models.ModelParameters.define_parameters_loop_2 class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Loop through the input parameters for a <code class="language-text highlight">params</code>-dictionary.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>key_1</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The key of the first level of the input dictionary.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>key_2</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The key of the second level of the input dictionary.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>value_2</code> </td> <td> <code><span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>The value of the second level of the input dictionary.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1494 name=__codelineno-0-1494></a><a href=#__codelineno-0-1494><span class=linenos data-linenos="1494 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>define_parameters_loop_2</span><span class=p>(</span>
<a id=__codelineno-0-1495 name=__codelineno-0-1495></a><a href=#__codelineno-0-1495><span class=linenos data-linenos="1495 "></span></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>key_1</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_2</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value_2</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
<a id=__codelineno-0-1496 name=__codelineno-0-1496></a><a href=#__codelineno-0-1496><span class=linenos data-linenos="1496 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1497 name=__codelineno-0-1497></a><a href=#__codelineno-0-1497><span class=linenos data-linenos="1497 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Loop through the input parameters for a `params`-dictionary.</span>
<a id=__codelineno-0-1498 name=__codelineno-0-1498></a><a href=#__codelineno-0-1498><span class=linenos data-linenos="1498 "></span></a>
<a id=__codelineno-0-1499 name=__codelineno-0-1499></a><a href=#__codelineno-0-1499><span class=linenos data-linenos="1499 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-1500 name=__codelineno-0-1500></a><a href=#__codelineno-0-1500><span class=linenos data-linenos="1500 "></span></a><span class=sd>        key_1 (str): The key of the first level of the input dictionary.</span>
<a id=__codelineno-0-1501 name=__codelineno-0-1501></a><a href=#__codelineno-0-1501><span class=linenos data-linenos="1501 "></span></a><span class=sd>        key_2 (str): The key of the second level of the input dictionary.</span>
<a id=__codelineno-0-1502 name=__codelineno-0-1502></a><a href=#__codelineno-0-1502><span class=linenos data-linenos="1502 "></span></a><span class=sd>        value_2 (Dict[str, Any]): The value of the second level of the input</span>
<a id=__codelineno-0-1503 name=__codelineno-0-1503></a><a href=#__codelineno-0-1503><span class=linenos data-linenos="1503 "></span></a><span class=sd>             dictionary.</span>
<a id=__codelineno-0-1504 name=__codelineno-0-1504></a><a href=#__codelineno-0-1504><span class=linenos data-linenos="1504 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1505 name=__codelineno-0-1505></a><a href=#__codelineno-0-1505><span class=linenos data-linenos="1505 "></span></a>    <span class=k>for</span> <span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span> <span class=ow>in</span> <span class=n>value_2</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1506 name=__codelineno-0-1506></a><a href=#__codelineno-0-1506><span class=linenos data-linenos="1506 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>define_parameters_loop_3</span><span class=p>(</span>
<a id=__codelineno-0-1507 name=__codelineno-0-1507></a><a href=#__codelineno-0-1507><span class=linenos data-linenos="1507 "></span></a>            <span class=n>key_1</span><span class=o>=</span><span class=n>key_1</span><span class=p>,</span> <span class=n>key_2</span><span class=o>=</span><span class=n>key_2</span><span class=p>,</span> <span class=n>key_3</span><span class=o>=</span><span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span><span class=o>=</span><span class=n>value_3</span>
<a id=__codelineno-0-1508 name=__codelineno-0-1508></a><a href=#__codelineno-0-1508><span class=linenos data-linenos="1508 "></span></a>        <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.define_parameters_loop_3 class="doc doc-heading"> <code class="highlight language-python"><span class=n>define_parameters_loop_3</span><span class=p>(</span><span class=n>key_1</span><span class=p>,</span> <span class=n>key_2</span><span class=p>,</span> <span class=n>key_3</span><span class=p>,</span> <span class=n>value_3</span><span class=p>)</span></code> <a href=#spectrafit.models.ModelParameters.define_parameters_loop_3 class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Loop through the input parameters for a <code class="language-text highlight">params</code>-dictionary.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>key_1</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The key of the first level of the input dictionary.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>key_2</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The key of the second level of the input dictionary.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>key_3</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The key of the third level of the input dictionary.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>value_3</code> </td> <td> <code><span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>The value of the third level of the input dictionary.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1510 name=__codelineno-0-1510></a><a href=#__codelineno-0-1510><span class=linenos data-linenos="1510 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>define_parameters_loop_3</span><span class=p>(</span>
<a id=__codelineno-0-1511 name=__codelineno-0-1511></a><a href=#__codelineno-0-1511><span class=linenos data-linenos="1511 "></span></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>key_1</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_2</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key_3</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value_3</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
<a id=__codelineno-0-1512 name=__codelineno-0-1512></a><a href=#__codelineno-0-1512><span class=linenos data-linenos="1512 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1513 name=__codelineno-0-1513></a><a href=#__codelineno-0-1513><span class=linenos data-linenos="1513 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Loop through the input parameters for a `params`-dictionary.</span>
<a id=__codelineno-0-1514 name=__codelineno-0-1514></a><a href=#__codelineno-0-1514><span class=linenos data-linenos="1514 "></span></a>
<a id=__codelineno-0-1515 name=__codelineno-0-1515></a><a href=#__codelineno-0-1515><span class=linenos data-linenos="1515 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-1516 name=__codelineno-0-1516></a><a href=#__codelineno-0-1516><span class=linenos data-linenos="1516 "></span></a><span class=sd>        key_1 (str): The key of the first level of the input dictionary.</span>
<a id=__codelineno-0-1517 name=__codelineno-0-1517></a><a href=#__codelineno-0-1517><span class=linenos data-linenos="1517 "></span></a><span class=sd>        key_2 (str): The key of the second level of the input dictionary.</span>
<a id=__codelineno-0-1518 name=__codelineno-0-1518></a><a href=#__codelineno-0-1518><span class=linenos data-linenos="1518 "></span></a><span class=sd>        key_3 (str): The key of the third level of the input dictionary.</span>
<a id=__codelineno-0-1519 name=__codelineno-0-1519></a><a href=#__codelineno-0-1519><span class=linenos data-linenos="1519 "></span></a><span class=sd>        value_3 (Dict[str, Any]): The value of the third level of the input</span>
<a id=__codelineno-0-1520 name=__codelineno-0-1520></a><a href=#__codelineno-0-1520><span class=linenos data-linenos="1520 "></span></a><span class=sd>             dictionary.</span>
<a id=__codelineno-0-1521 name=__codelineno-0-1521></a><a href=#__codelineno-0-1521><span class=linenos data-linenos="1521 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1522 name=__codelineno-0-1522></a><a href=#__codelineno-0-1522><span class=linenos data-linenos="1522 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key_2</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_3</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key_1</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>value_3</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ModelParameters.df_to_numvalues class="doc doc-heading"> <code class="highlight language-python"><span class=n>df_to_numvalues</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>args</span><span class=p>)</span></code> <a href=#spectrafit.models.ModelParameters.df_to_numvalues class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Transform the dataframe to numeric values of <code class="language-text highlight">x</code> and <code class="language-text highlight">data</code>.</p> <div class="admonition note"> <p class=admonition-title>About the dataframe to numeric values</p> <p>The transformation is done by the <code class="language-text highlight">value</code> property of pandas. The dataframe is separated into the <code class="language-text highlight">x</code> and <code class="language-text highlight">data</code> columns and the <code class="language-text highlight">x</code> column is transformed to the energy values and the <code class="language-text highlight">data</code> column is transformed to the intensity values depending on the <code class="language-text highlight">args</code> dictionary. In terms of global fitting, the <code class="language-text highlight">data</code> contains the intensity values for each column.</p> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>df</code> </td> <td> <code><span title=pandas.DataFrame>DataFrame</span></code> </td> <td> <div class=doc-md-description> <p>DataFrame containing the input data (<code class="language-text highlight">x</code> and <code class="language-text highlight">data</code>).</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>args</code> </td> <td> <code><span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>The input file arguments as a dictionary with additional information beyond the command line arguments.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Tuple>Tuple</span>[<span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>], <span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]]</code> </td> <td> <div class=doc-md-description> <p>Tuple[NDArray[np.float64], NDArray[np.float64]]: Tuple of <code class="language-text highlight">x</code> and <code class="language-text highlight">data</code> as numpy arrays.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1223 name=__codelineno-0-1223></a><a href=#__codelineno-0-1223><span class=linenos data-linenos="1223 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>df_to_numvalues</span><span class=p>(</span>
<a id=__codelineno-0-1224 name=__codelineno-0-1224></a><a href=#__codelineno-0-1224><span class=linenos data-linenos="1224 "></span></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
<a id=__codelineno-0-1225 name=__codelineno-0-1225></a><a href=#__codelineno-0-1225><span class=linenos data-linenos="1225 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]]:</span>
<a id=__codelineno-0-1226 name=__codelineno-0-1226></a><a href=#__codelineno-0-1226><span class=linenos data-linenos="1226 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Transform the dataframe to numeric values of `x` and `data`.</span>
<a id=__codelineno-0-1227 name=__codelineno-0-1227></a><a href=#__codelineno-0-1227><span class=linenos data-linenos="1227 "></span></a>
<a id=__codelineno-0-1228 name=__codelineno-0-1228></a><a href=#__codelineno-0-1228><span class=linenos data-linenos="1228 "></span></a><span class=sd>    !!! note &quot;About the dataframe to numeric values&quot;</span>
<a id=__codelineno-0-1229 name=__codelineno-0-1229></a><a href=#__codelineno-0-1229><span class=linenos data-linenos="1229 "></span></a>
<a id=__codelineno-0-1230 name=__codelineno-0-1230></a><a href=#__codelineno-0-1230><span class=linenos data-linenos="1230 "></span></a><span class=sd>        The transformation is done by the `value` property of pandas. The dataframe</span>
<a id=__codelineno-0-1231 name=__codelineno-0-1231></a><a href=#__codelineno-0-1231><span class=linenos data-linenos="1231 "></span></a><span class=sd>        is separated into the `x` and `data` columns and the `x` column is</span>
<a id=__codelineno-0-1232 name=__codelineno-0-1232></a><a href=#__codelineno-0-1232><span class=linenos data-linenos="1232 "></span></a><span class=sd>        transformed to the energy values and the `data` column is transformed to</span>
<a id=__codelineno-0-1233 name=__codelineno-0-1233></a><a href=#__codelineno-0-1233><span class=linenos data-linenos="1233 "></span></a><span class=sd>        the intensity values depending on the `args` dictionary. In terms of global</span>
<a id=__codelineno-0-1234 name=__codelineno-0-1234></a><a href=#__codelineno-0-1234><span class=linenos data-linenos="1234 "></span></a><span class=sd>        fitting, the `data` contains the intensity values for each column.</span>
<a id=__codelineno-0-1235 name=__codelineno-0-1235></a><a href=#__codelineno-0-1235><span class=linenos data-linenos="1235 "></span></a>
<a id=__codelineno-0-1236 name=__codelineno-0-1236></a><a href=#__codelineno-0-1236><span class=linenos data-linenos="1236 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-1237 name=__codelineno-0-1237></a><a href=#__codelineno-0-1237><span class=linenos data-linenos="1237 "></span></a><span class=sd>        df (pd.DataFrame): DataFrame containing the input data (`x` and `data`).</span>
<a id=__codelineno-0-1238 name=__codelineno-0-1238></a><a href=#__codelineno-0-1238><span class=linenos data-linenos="1238 "></span></a><span class=sd>        args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<a id=__codelineno-0-1239 name=__codelineno-0-1239></a><a href=#__codelineno-0-1239><span class=linenos data-linenos="1239 "></span></a><span class=sd>             additional information beyond the command line arguments.</span>
<a id=__codelineno-0-1240 name=__codelineno-0-1240></a><a href=#__codelineno-0-1240><span class=linenos data-linenos="1240 "></span></a>
<a id=__codelineno-0-1241 name=__codelineno-0-1241></a><a href=#__codelineno-0-1241><span class=linenos data-linenos="1241 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-1242 name=__codelineno-0-1242></a><a href=#__codelineno-0-1242><span class=linenos data-linenos="1242 "></span></a><span class=sd>        Tuple[NDArray[np.float64], NDArray[np.float64]]: Tuple of `x` and</span>
<a id=__codelineno-0-1243 name=__codelineno-0-1243></a><a href=#__codelineno-0-1243><span class=linenos data-linenos="1243 "></span></a><span class=sd>             `data` as numpy arrays.</span>
<a id=__codelineno-0-1244 name=__codelineno-0-1244></a><a href=#__codelineno-0-1244><span class=linenos data-linenos="1244 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1245 name=__codelineno-0-1245></a><a href=#__codelineno-0-1245><span class=linenos data-linenos="1245 "></span></a>    <span class=k>if</span> <span class=n>args</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]:</span>
<a id=__codelineno-0-1246 name=__codelineno-0-1246></a><a href=#__codelineno-0-1246><span class=linenos data-linenos="1246 "></span></a>        <span class=k>return</span> <span class=p>(</span>
<a id=__codelineno-0-1247 name=__codelineno-0-1247></a><a href=#__codelineno-0-1247><span class=linenos data-linenos="1247 "></span></a>            <span class=n>df</span><span class=p>[</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(),</span>
<a id=__codelineno-0-1248 name=__codelineno-0-1248></a><a href=#__codelineno-0-1248><span class=linenos data-linenos="1248 "></span></a>            <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span> <span class=o>!=</span> <span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(),</span>
<a id=__codelineno-0-1249 name=__codelineno-0-1249></a><a href=#__codelineno-0-1249><span class=linenos data-linenos="1249 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-1250 name=__codelineno-0-1250></a><a href=#__codelineno-0-1250><span class=linenos data-linenos="1250 "></span></a>    <span class=k>return</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>(),</span> <span class=n>df</span><span class=p>[</span><span class=n>args</span><span class=p>[</span><span class=s2>&quot;column&quot;</span><span class=p>][</span><span class=mi>1</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>())</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=spectrafit.models.ReferenceKeys class="doc doc-heading"> <code>ReferenceKeys</code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small> </span> <a href=#spectrafit.models.ReferenceKeys class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p>Reference keys for model fitting and peak detection.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-800 name=__codelineno-0-800></a><a href=#__codelineno-0-800><span class=linenos data-linenos="800 "></span></a><span class=nd>@dataclass</span><span class=p>(</span><span class=n>frozen</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-0-801 name=__codelineno-0-801></a><a href=#__codelineno-0-801><span class=linenos data-linenos="801 "></span></a><span class=k>class</span><span class=w> </span><span class=nc>ReferenceKeys</span><span class=p>:</span>
<a id=__codelineno-0-802 name=__codelineno-0-802></a><a href=#__codelineno-0-802><span class=linenos data-linenos="802 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Reference keys for model fitting and peak detection.&quot;&quot;&quot;</span>
<a id=__codelineno-0-803 name=__codelineno-0-803></a><a href=#__codelineno-0-803><span class=linenos data-linenos="803 "></span></a>
<a id=__codelineno-0-804 name=__codelineno-0-804></a><a href=#__codelineno-0-804><span class=linenos data-linenos="804 "></span></a>    <span class=n>__models__</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>DistributionModelAPI</span><span class=o>.</span><span class=n>model_json_schema</span><span class=p>()[</span><span class=s2>&quot;properties&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
<a id=__codelineno-0-805 name=__codelineno-0-805></a><a href=#__codelineno-0-805><span class=linenos data-linenos="805 "></span></a>
<a id=__codelineno-0-806 name=__codelineno-0-806></a><a href=#__codelineno-0-806><span class=linenos data-linenos="806 "></span></a>    <span class=n>__automodels__</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-0-807 name=__codelineno-0-807></a><a href=#__codelineno-0-807><span class=linenos data-linenos="807 "></span></a>        <span class=s2>&quot;gaussian&quot;</span><span class=p>,</span>
<a id=__codelineno-0-808 name=__codelineno-0-808></a><a href=#__codelineno-0-808><span class=linenos data-linenos="808 "></span></a>        <span class=s2>&quot;orcagaussian&quot;</span><span class=p>,</span>
<a id=__codelineno-0-809 name=__codelineno-0-809></a><a href=#__codelineno-0-809><span class=linenos data-linenos="809 "></span></a>        <span class=s2>&quot;lorentzian&quot;</span><span class=p>,</span>
<a id=__codelineno-0-810 name=__codelineno-0-810></a><a href=#__codelineno-0-810><span class=linenos data-linenos="810 "></span></a>        <span class=s2>&quot;voigt&quot;</span><span class=p>,</span>
<a id=__codelineno-0-811 name=__codelineno-0-811></a><a href=#__codelineno-0-811><span class=linenos data-linenos="811 "></span></a>        <span class=s2>&quot;pseudovoigt&quot;</span><span class=p>,</span>
<a id=__codelineno-0-812 name=__codelineno-0-812></a><a href=#__codelineno-0-812><span class=linenos data-linenos="812 "></span></a>    <span class=p>]</span>
<a id=__codelineno-0-813 name=__codelineno-0-813></a><a href=#__codelineno-0-813><span class=linenos data-linenos="813 "></span></a>
<a id=__codelineno-0-814 name=__codelineno-0-814></a><a href=#__codelineno-0-814><span class=linenos data-linenos="814 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>model_check</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-815 name=__codelineno-0-815></a><a href=#__codelineno-0-815><span class=linenos data-linenos="815 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Check if model is available.</span>
<a id=__codelineno-0-816 name=__codelineno-0-816></a><a href=#__codelineno-0-816><span class=linenos data-linenos="816 "></span></a>
<a id=__codelineno-0-817 name=__codelineno-0-817></a><a href=#__codelineno-0-817><span class=linenos data-linenos="817 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-818 name=__codelineno-0-818></a><a href=#__codelineno-0-818><span class=linenos data-linenos="818 "></span></a><span class=sd>            model (str): Model name.</span>
<a id=__codelineno-0-819 name=__codelineno-0-819></a><a href=#__codelineno-0-819><span class=linenos data-linenos="819 "></span></a>
<a id=__codelineno-0-820 name=__codelineno-0-820></a><a href=#__codelineno-0-820><span class=linenos data-linenos="820 "></span></a><span class=sd>        Raises:</span>
<a id=__codelineno-0-821 name=__codelineno-0-821></a><a href=#__codelineno-0-821><span class=linenos data-linenos="821 "></span></a><span class=sd>            NotImplementedError: If the model is not implemented.</span>
<a id=__codelineno-0-822 name=__codelineno-0-822></a><a href=#__codelineno-0-822><span class=linenos data-linenos="822 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-823 name=__codelineno-0-823></a><a href=#__codelineno-0-823><span class=linenos data-linenos="823 "></span></a>        <span class=k>if</span> <span class=n>model</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;_&quot;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>__models__</span><span class=p>:</span>
<a id=__codelineno-0-824 name=__codelineno-0-824></a><a href=#__codelineno-0-824><span class=linenos data-linenos="824 "></span></a>            <span class=k>raise</span> <span class=ne>NotImplementedError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>model</span><span class=si>}</span><span class=s2> is not supported!&quot;</span><span class=p>)</span>
<a id=__codelineno-0-825 name=__codelineno-0-825></a><a href=#__codelineno-0-825><span class=linenos data-linenos="825 "></span></a>
<a id=__codelineno-0-826 name=__codelineno-0-826></a><a href=#__codelineno-0-826><span class=linenos data-linenos="826 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>automodel_check</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-827 name=__codelineno-0-827></a><a href=#__codelineno-0-827><span class=linenos data-linenos="827 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Check if model is available.</span>
<a id=__codelineno-0-828 name=__codelineno-0-828></a><a href=#__codelineno-0-828><span class=linenos data-linenos="828 "></span></a>
<a id=__codelineno-0-829 name=__codelineno-0-829></a><a href=#__codelineno-0-829><span class=linenos data-linenos="829 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-830 name=__codelineno-0-830></a><a href=#__codelineno-0-830><span class=linenos data-linenos="830 "></span></a><span class=sd>            model (str): Auto Model name (gaussian, orcagaussian,</span>
<a id=__codelineno-0-831 name=__codelineno-0-831></a><a href=#__codelineno-0-831><span class=linenos data-linenos="831 "></span></a><span class=sd>                lorentzian, voigt, or pseudovoigt).</span>
<a id=__codelineno-0-832 name=__codelineno-0-832></a><a href=#__codelineno-0-832><span class=linenos data-linenos="832 "></span></a>
<a id=__codelineno-0-833 name=__codelineno-0-833></a><a href=#__codelineno-0-833><span class=linenos data-linenos="833 "></span></a><span class=sd>        Raises:</span>
<a id=__codelineno-0-834 name=__codelineno-0-834></a><a href=#__codelineno-0-834><span class=linenos data-linenos="834 "></span></a><span class=sd>            KeyError: If the model is not supported.</span>
<a id=__codelineno-0-835 name=__codelineno-0-835></a><a href=#__codelineno-0-835><span class=linenos data-linenos="835 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-836 name=__codelineno-0-836></a><a href=#__codelineno-0-836><span class=linenos data-linenos="836 "></span></a>        <span class=k>if</span> <span class=n>model</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>__automodels__</span><span class=p>:</span>
<a id=__codelineno-0-837 name=__codelineno-0-837></a><a href=#__codelineno-0-837><span class=linenos data-linenos="837 "></span></a>            <span class=k>raise</span> <span class=ne>KeyError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>model</span><span class=si>}</span><span class=s2> is not supported!&quot;</span><span class=p>)</span>
<a id=__codelineno-0-838 name=__codelineno-0-838></a><a href=#__codelineno-0-838><span class=linenos data-linenos="838 "></span></a>
<a id=__codelineno-0-839 name=__codelineno-0-839></a><a href=#__codelineno-0-839><span class=linenos data-linenos="839 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>detection_check</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-840 name=__codelineno-0-840></a><a href=#__codelineno-0-840><span class=linenos data-linenos="840 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Check if detection is available.</span>
<a id=__codelineno-0-841 name=__codelineno-0-841></a><a href=#__codelineno-0-841><span class=linenos data-linenos="841 "></span></a>
<a id=__codelineno-0-842 name=__codelineno-0-842></a><a href=#__codelineno-0-842><span class=linenos data-linenos="842 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-843 name=__codelineno-0-843></a><a href=#__codelineno-0-843><span class=linenos data-linenos="843 "></span></a><span class=sd>            args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<a id=__codelineno-0-844 name=__codelineno-0-844></a><a href=#__codelineno-0-844><span class=linenos data-linenos="844 "></span></a><span class=sd>                 additional information beyond the command line arguments.</span>
<a id=__codelineno-0-845 name=__codelineno-0-845></a><a href=#__codelineno-0-845><span class=linenos data-linenos="845 "></span></a>
<a id=__codelineno-0-846 name=__codelineno-0-846></a><a href=#__codelineno-0-846><span class=linenos data-linenos="846 "></span></a><span class=sd>        Raises:</span>
<a id=__codelineno-0-847 name=__codelineno-0-847></a><a href=#__codelineno-0-847><span class=linenos data-linenos="847 "></span></a><span class=sd>            KeyError: If the key is not parameter of the `scipy.signal.find_peaks`</span>
<a id=__codelineno-0-848 name=__codelineno-0-848></a><a href=#__codelineno-0-848><span class=linenos data-linenos="848 "></span></a><span class=sd>                function. This will be checked via `pydantic` in `spectrafit.api`.</span>
<a id=__codelineno-0-849 name=__codelineno-0-849></a><a href=#__codelineno-0-849><span class=linenos data-linenos="849 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-850 name=__codelineno-0-850></a><a href=#__codelineno-0-850><span class=linenos data-linenos="850 "></span></a>        <span class=n>AutopeakAPI</span><span class=p>(</span><span class=o>**</span><span class=n>args</span><span class=p>)</span>
</code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ReferenceKeys.automodel_check class="doc doc-heading"> <code class="highlight language-python"><span class=n>automodel_check</span><span class=p>(</span><span class=n>model</span><span class=p>)</span></code> <a href=#spectrafit.models.ReferenceKeys.automodel_check class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Check if model is available.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>model</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Auto <abbr title="A mathematical function used to describe the data, often composed of one or more peak functions and a baseline, implemented using lmfit Models">Model</abbr> name (gaussian, orcagaussian, lorentzian, voigt, or pseudovoigt).</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=KeyError>KeyError</span></code> </td> <td> <div class=doc-md-description> <p>If the model is not supported.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-826 name=__codelineno-0-826></a><a href=#__codelineno-0-826><span class=linenos data-linenos="826 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>automodel_check</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-827 name=__codelineno-0-827></a><a href=#__codelineno-0-827><span class=linenos data-linenos="827 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Check if model is available.</span>
<a id=__codelineno-0-828 name=__codelineno-0-828></a><a href=#__codelineno-0-828><span class=linenos data-linenos="828 "></span></a>
<a id=__codelineno-0-829 name=__codelineno-0-829></a><a href=#__codelineno-0-829><span class=linenos data-linenos="829 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-830 name=__codelineno-0-830></a><a href=#__codelineno-0-830><span class=linenos data-linenos="830 "></span></a><span class=sd>        model (str): Auto Model name (gaussian, orcagaussian,</span>
<a id=__codelineno-0-831 name=__codelineno-0-831></a><a href=#__codelineno-0-831><span class=linenos data-linenos="831 "></span></a><span class=sd>            lorentzian, voigt, or pseudovoigt).</span>
<a id=__codelineno-0-832 name=__codelineno-0-832></a><a href=#__codelineno-0-832><span class=linenos data-linenos="832 "></span></a>
<a id=__codelineno-0-833 name=__codelineno-0-833></a><a href=#__codelineno-0-833><span class=linenos data-linenos="833 "></span></a><span class=sd>    Raises:</span>
<a id=__codelineno-0-834 name=__codelineno-0-834></a><a href=#__codelineno-0-834><span class=linenos data-linenos="834 "></span></a><span class=sd>        KeyError: If the model is not supported.</span>
<a id=__codelineno-0-835 name=__codelineno-0-835></a><a href=#__codelineno-0-835><span class=linenos data-linenos="835 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-836 name=__codelineno-0-836></a><a href=#__codelineno-0-836><span class=linenos data-linenos="836 "></span></a>    <span class=k>if</span> <span class=n>model</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>__automodels__</span><span class=p>:</span>
<a id=__codelineno-0-837 name=__codelineno-0-837></a><a href=#__codelineno-0-837><span class=linenos data-linenos="837 "></span></a>        <span class=k>raise</span> <span class=ne>KeyError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>model</span><span class=si>}</span><span class=s2> is not supported!&quot;</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ReferenceKeys.detection_check class="doc doc-heading"> <code class="highlight language-python"><span class=n>detection_check</span><span class=p>(</span><span class=n>args</span><span class=p>)</span></code> <a href=#spectrafit.models.ReferenceKeys.detection_check class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Check if detection is available.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>args</code> </td> <td> <code><span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>The input file arguments as a dictionary with additional information beyond the command line arguments.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=KeyError>KeyError</span></code> </td> <td> <div class=doc-md-description> <p>If the key is not parameter of the <code class="language-gdscript highlight"><span class=n>scipy</span><span class=o>.</span><span class=k>signal</span><span class=o>.</span><span class=n>find_peaks</span></code> function. This will be checked via <code class="language-text highlight">pydantic</code> in <code class="language-text highlight">spectrafit.api</code>.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-839 name=__codelineno-0-839></a><a href=#__codelineno-0-839><span class=linenos data-linenos="839 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>detection_check</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-840 name=__codelineno-0-840></a><a href=#__codelineno-0-840><span class=linenos data-linenos="840 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Check if detection is available.</span>
<a id=__codelineno-0-841 name=__codelineno-0-841></a><a href=#__codelineno-0-841><span class=linenos data-linenos="841 "></span></a>
<a id=__codelineno-0-842 name=__codelineno-0-842></a><a href=#__codelineno-0-842><span class=linenos data-linenos="842 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-843 name=__codelineno-0-843></a><a href=#__codelineno-0-843><span class=linenos data-linenos="843 "></span></a><span class=sd>        args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<a id=__codelineno-0-844 name=__codelineno-0-844></a><a href=#__codelineno-0-844><span class=linenos data-linenos="844 "></span></a><span class=sd>             additional information beyond the command line arguments.</span>
<a id=__codelineno-0-845 name=__codelineno-0-845></a><a href=#__codelineno-0-845><span class=linenos data-linenos="845 "></span></a>
<a id=__codelineno-0-846 name=__codelineno-0-846></a><a href=#__codelineno-0-846><span class=linenos data-linenos="846 "></span></a><span class=sd>    Raises:</span>
<a id=__codelineno-0-847 name=__codelineno-0-847></a><a href=#__codelineno-0-847><span class=linenos data-linenos="847 "></span></a><span class=sd>        KeyError: If the key is not parameter of the `scipy.signal.find_peaks`</span>
<a id=__codelineno-0-848 name=__codelineno-0-848></a><a href=#__codelineno-0-848><span class=linenos data-linenos="848 "></span></a><span class=sd>            function. This will be checked via `pydantic` in `spectrafit.api`.</span>
<a id=__codelineno-0-849 name=__codelineno-0-849></a><a href=#__codelineno-0-849><span class=linenos data-linenos="849 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-850 name=__codelineno-0-850></a><a href=#__codelineno-0-850><span class=linenos data-linenos="850 "></span></a>    <span class=n>AutopeakAPI</span><span class=p>(</span><span class=o>**</span><span class=n>args</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.ReferenceKeys.model_check class="doc doc-heading"> <code class="highlight language-python"><span class=n>model_check</span><span class=p>(</span><span class=n>model</span><span class=p>)</span></code> <a href=#spectrafit.models.ReferenceKeys.model_check class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Check if model is available.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>model</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p><abbr title="A mathematical function used to describe the data, often composed of one or more peak functions and a baseline, implemented using lmfit Models">Model</abbr> name.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=NotImplementedError>NotImplementedError</span></code> </td> <td> <div class=doc-md-description> <p>If the model is not implemented.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-814 name=__codelineno-0-814></a><a href=#__codelineno-0-814><span class=linenos data-linenos="814 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>model_check</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-815 name=__codelineno-0-815></a><a href=#__codelineno-0-815><span class=linenos data-linenos="815 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Check if model is available.</span>
<a id=__codelineno-0-816 name=__codelineno-0-816></a><a href=#__codelineno-0-816><span class=linenos data-linenos="816 "></span></a>
<a id=__codelineno-0-817 name=__codelineno-0-817></a><a href=#__codelineno-0-817><span class=linenos data-linenos="817 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-818 name=__codelineno-0-818></a><a href=#__codelineno-0-818><span class=linenos data-linenos="818 "></span></a><span class=sd>        model (str): Model name.</span>
<a id=__codelineno-0-819 name=__codelineno-0-819></a><a href=#__codelineno-0-819><span class=linenos data-linenos="819 "></span></a>
<a id=__codelineno-0-820 name=__codelineno-0-820></a><a href=#__codelineno-0-820><span class=linenos data-linenos="820 "></span></a><span class=sd>    Raises:</span>
<a id=__codelineno-0-821 name=__codelineno-0-821></a><a href=#__codelineno-0-821><span class=linenos data-linenos="821 "></span></a><span class=sd>        NotImplementedError: If the model is not implemented.</span>
<a id=__codelineno-0-822 name=__codelineno-0-822></a><a href=#__codelineno-0-822><span class=linenos data-linenos="822 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-823 name=__codelineno-0-823></a><a href=#__codelineno-0-823><span class=linenos data-linenos="823 "></span></a>    <span class=k>if</span> <span class=n>model</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;_&quot;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>__models__</span><span class=p>:</span>
<a id=__codelineno-0-824 name=__codelineno-0-824></a><a href=#__codelineno-0-824><span class=linenos data-linenos="824 "></span></a>        <span class=k>raise</span> <span class=ne>NotImplementedError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>model</span><span class=si>}</span><span class=s2> is not supported!&quot;</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=spectrafit.models.SolverModels class="doc doc-heading"> <code>SolverModels</code> <a href=#spectrafit.models.SolverModels class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="<code>ModelParameters</code> (<code>spectrafit.models.ModelParameters</code>)" href=#spectrafit.models.ModelParameters>ModelParameters</a></code></p> <p>Solving models for 2D and 3D data sets.</p> <div class="admonition hint"> <p class=admonition-title>Solver Modes</p> <ul> <li><code class="language-text highlight">&quot;2D&quot;</code>: Solve 2D models via the classic <code class="language-text highlight">lmfit</code> function.</li> <li><code class="language-text highlight">&quot;3D&quot;</code>: Solve 3D models via global git. For the <code class="language-text highlight">global-fitting</code> procedure, the <code class="language-text highlight">lmfit</code> function is used to solve the models with an extended set of parameters. the <code class="language-text highlight">lmfit</code> function is used.</li> </ul> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1586 name=__codelineno-0-1586></a><a href=#__codelineno-0-1586><span class=linenos data-linenos="1586 "></span></a><span class=k>class</span><span class=w> </span><span class=nc>SolverModels</span><span class=p>(</span><span class=n>ModelParameters</span><span class=p>):</span>
<a id=__codelineno-0-1587 name=__codelineno-0-1587></a><a href=#__codelineno-0-1587><span class=linenos data-linenos="1587 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Solving models for 2D and 3D data sets.</span>
<a id=__codelineno-0-1588 name=__codelineno-0-1588></a><a href=#__codelineno-0-1588><span class=linenos data-linenos="1588 "></span></a>
<a id=__codelineno-0-1589 name=__codelineno-0-1589></a><a href=#__codelineno-0-1589><span class=linenos data-linenos="1589 "></span></a><span class=sd>    !!! hint &quot;Solver Modes&quot;</span>
<a id=__codelineno-0-1590 name=__codelineno-0-1590></a><a href=#__codelineno-0-1590><span class=linenos data-linenos="1590 "></span></a><span class=sd>        * `&quot;2D&quot;`: Solve 2D models via the classic `lmfit` function.</span>
<a id=__codelineno-0-1591 name=__codelineno-0-1591></a><a href=#__codelineno-0-1591><span class=linenos data-linenos="1591 "></span></a><span class=sd>        * `&quot;3D&quot;`: Solve 3D models via global git. For the `global-fitting` procedure,</span>
<a id=__codelineno-0-1592 name=__codelineno-0-1592></a><a href=#__codelineno-0-1592><span class=linenos data-linenos="1592 "></span></a><span class=sd>             the `lmfit` function is used to solve the models with an extended set of</span>
<a id=__codelineno-0-1593 name=__codelineno-0-1593></a><a href=#__codelineno-0-1593><span class=linenos data-linenos="1593 "></span></a><span class=sd>             parameters.</span>
<a id=__codelineno-0-1594 name=__codelineno-0-1594></a><a href=#__codelineno-0-1594><span class=linenos data-linenos="1594 "></span></a><span class=sd>          the `lmfit` function is used.</span>
<a id=__codelineno-0-1595 name=__codelineno-0-1595></a><a href=#__codelineno-0-1595><span class=linenos data-linenos="1595 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1596 name=__codelineno-0-1596></a><a href=#__codelineno-0-1596><span class=linenos data-linenos="1596 "></span></a>
<a id=__codelineno-0-1597 name=__codelineno-0-1597></a><a href=#__codelineno-0-1597><span class=linenos data-linenos="1597 "></span></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1598 name=__codelineno-0-1598></a><a href=#__codelineno-0-1598><span class=linenos data-linenos="1598 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Initialize the solver modes.</span>
<a id=__codelineno-0-1599 name=__codelineno-0-1599></a><a href=#__codelineno-0-1599><span class=linenos data-linenos="1599 "></span></a>
<a id=__codelineno-0-1600 name=__codelineno-0-1600></a><a href=#__codelineno-0-1600><span class=linenos data-linenos="1600 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-1601 name=__codelineno-0-1601></a><a href=#__codelineno-0-1601><span class=linenos data-linenos="1601 "></span></a><span class=sd>            df (pd.DataFrame): DataFrame containing the input data (`x` and `data`).</span>
<a id=__codelineno-0-1602 name=__codelineno-0-1602></a><a href=#__codelineno-0-1602><span class=linenos data-linenos="1602 "></span></a><span class=sd>            args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<a id=__codelineno-0-1603 name=__codelineno-0-1603></a><a href=#__codelineno-0-1603><span class=linenos data-linenos="1603 "></span></a><span class=sd>                 additional information beyond the command line arguments.</span>
<a id=__codelineno-0-1604 name=__codelineno-0-1604></a><a href=#__codelineno-0-1604><span class=linenos data-linenos="1604 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1605 name=__codelineno-0-1605></a><a href=#__codelineno-0-1605><span class=linenos data-linenos="1605 "></span></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>df</span><span class=o>=</span><span class=n>df</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=n>args</span><span class=p>)</span>
<a id=__codelineno-0-1606 name=__codelineno-0-1606></a><a href=#__codelineno-0-1606><span class=linenos data-linenos="1606 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span> <span class=o>=</span> <span class=n>SolverModelsAPI</span><span class=p>(</span><span class=o>**</span><span class=n>args</span><span class=p>)</span><span class=o>.</span><span class=n>model_dump</span><span class=p>()</span>
<a id=__codelineno-0-1607 name=__codelineno-0-1607></a><a href=#__codelineno-0-1607><span class=linenos data-linenos="1607 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>args_global</span> <span class=o>=</span> <span class=n>GlobalFittingAPI</span><span class=p>(</span><span class=o>**</span><span class=n>args</span><span class=p>)</span><span class=o>.</span><span class=n>model_dump</span><span class=p>()</span>
<a id=__codelineno-0-1608 name=__codelineno-0-1608></a><a href=#__codelineno-0-1608><span class=linenos data-linenos="1608 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>return_params</span>
<a id=__codelineno-0-1609 name=__codelineno-0-1609></a><a href=#__codelineno-0-1609><span class=linenos data-linenos="1609 "></span></a>
<a id=__codelineno-0-1610 name=__codelineno-0-1610></a><a href=#__codelineno-0-1610><span class=linenos data-linenos="1610 "></span></a>    <span class=k>def</span><span class=w> </span><span class=fm>__call__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>Minimizer</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
<a id=__codelineno-0-1611 name=__codelineno-0-1611></a><a href=#__codelineno-0-1611><span class=linenos data-linenos="1611 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Solve the fitting model.</span>
<a id=__codelineno-0-1612 name=__codelineno-0-1612></a><a href=#__codelineno-0-1612><span class=linenos data-linenos="1612 "></span></a>
<a id=__codelineno-0-1613 name=__codelineno-0-1613></a><a href=#__codelineno-0-1613><span class=linenos data-linenos="1613 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-1614 name=__codelineno-0-1614></a><a href=#__codelineno-0-1614><span class=linenos data-linenos="1614 "></span></a><span class=sd>            Tuple[Minimizer, Any]: Minimizer class and the fitting results.</span>
<a id=__codelineno-0-1615 name=__codelineno-0-1615></a><a href=#__codelineno-0-1615><span class=linenos data-linenos="1615 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1616 name=__codelineno-0-1616></a><a href=#__codelineno-0-1616><span class=linenos data-linenos="1616 "></span></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>args_global</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]:</span>
<a id=__codelineno-0-1617 name=__codelineno-0-1617></a><a href=#__codelineno-0-1617><span class=linenos data-linenos="1617 "></span></a>            <span class=n>minimizer</span> <span class=o>=</span> <span class=n>Minimizer</span><span class=p>(</span>
<a id=__codelineno-0-1618 name=__codelineno-0-1618></a><a href=#__codelineno-0-1618><span class=linenos data-linenos="1618 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>solve_global_fitting</span><span class=p>,</span>
<a id=__codelineno-0-1619 name=__codelineno-0-1619></a><a href=#__codelineno-0-1619><span class=linenos data-linenos="1619 "></span></a>                <span class=n>params</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>,</span>
<a id=__codelineno-0-1620 name=__codelineno-0-1620></a><a href=#__codelineno-0-1620><span class=linenos data-linenos="1620 "></span></a>                <span class=n>fcn_args</span><span class=o>=</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>),</span>
<a id=__codelineno-0-1621 name=__codelineno-0-1621></a><a href=#__codelineno-0-1621><span class=linenos data-linenos="1621 "></span></a>                <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span><span class=p>[</span><span class=s2>&quot;minimizer&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1622 name=__codelineno-0-1622></a><a href=#__codelineno-0-1622><span class=linenos data-linenos="1622 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1623 name=__codelineno-0-1623></a><a href=#__codelineno-0-1623><span class=linenos data-linenos="1623 "></span></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-1624 name=__codelineno-0-1624></a><a href=#__codelineno-0-1624><span class=linenos data-linenos="1624 "></span></a>            <span class=n>minimizer</span> <span class=o>=</span> <span class=n>Minimizer</span><span class=p>(</span>
<a id=__codelineno-0-1625 name=__codelineno-0-1625></a><a href=#__codelineno-0-1625><span class=linenos data-linenos="1625 "></span></a>                <span class=bp>self</span><span class=o>.</span><span class=n>solve_local_fitting</span><span class=p>,</span>
<a id=__codelineno-0-1626 name=__codelineno-0-1626></a><a href=#__codelineno-0-1626><span class=linenos data-linenos="1626 "></span></a>                <span class=n>params</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>,</span>
<a id=__codelineno-0-1627 name=__codelineno-0-1627></a><a href=#__codelineno-0-1627><span class=linenos data-linenos="1627 "></span></a>                <span class=n>fcn_args</span><span class=o>=</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>),</span>
<a id=__codelineno-0-1628 name=__codelineno-0-1628></a><a href=#__codelineno-0-1628><span class=linenos data-linenos="1628 "></span></a>                <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span><span class=p>[</span><span class=s2>&quot;minimizer&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1629 name=__codelineno-0-1629></a><a href=#__codelineno-0-1629><span class=linenos data-linenos="1629 "></span></a>            <span class=p>)</span>
<a id=__codelineno-0-1630 name=__codelineno-0-1630></a><a href=#__codelineno-0-1630><span class=linenos data-linenos="1630 "></span></a>
<a id=__codelineno-0-1631 name=__codelineno-0-1631></a><a href=#__codelineno-0-1631><span class=linenos data-linenos="1631 "></span></a>        <span class=n>result</span> <span class=o>=</span> <span class=n>minimizer</span><span class=o>.</span><span class=n>minimize</span><span class=p>(</span>
<a id=__codelineno-0-1632 name=__codelineno-0-1632></a><a href=#__codelineno-0-1632><span class=linenos data-linenos="1632 "></span></a>            <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span><span class=p>[</span><span class=s2>&quot;optimizer&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1633 name=__codelineno-0-1633></a><a href=#__codelineno-0-1633><span class=linenos data-linenos="1633 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-1634 name=__codelineno-0-1634></a><a href=#__codelineno-0-1634><span class=linenos data-linenos="1634 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span><span class=p>[</span><span class=s2>&quot;optimizer&quot;</span><span class=p>][</span><span class=s2>&quot;max_nfev&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>minimizer</span><span class=o>.</span><span class=n>max_nfev</span>
<a id=__codelineno-0-1635 name=__codelineno-0-1635></a><a href=#__codelineno-0-1635><span class=linenos data-linenos="1635 "></span></a>        <span class=k>return</span> <span class=n>minimizer</span><span class=p>,</span> <span class=n>result</span>
<a id=__codelineno-0-1636 name=__codelineno-0-1636></a><a href=#__codelineno-0-1636><span class=linenos data-linenos="1636 "></span></a>
<a id=__codelineno-0-1637 name=__codelineno-0-1637></a><a href=#__codelineno-0-1637><span class=linenos data-linenos="1637 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-1638 name=__codelineno-0-1638></a><a href=#__codelineno-0-1638><span class=linenos data-linenos="1638 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>solve_local_fitting</span><span class=p>(</span>
<a id=__codelineno-0-1639 name=__codelineno-0-1639></a><a href=#__codelineno-0-1639><span class=linenos data-linenos="1639 "></span></a>        <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Parameters</span><span class=p>],</span>
<a id=__codelineno-0-1640 name=__codelineno-0-1640></a><a href=#__codelineno-0-1640><span class=linenos data-linenos="1640 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-1641 name=__codelineno-0-1641></a><a href=#__codelineno-0-1641><span class=linenos data-linenos="1641 "></span></a>        <span class=n>data</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-1642 name=__codelineno-0-1642></a><a href=#__codelineno-0-1642><span class=linenos data-linenos="1642 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-1643 name=__codelineno-0-1643></a><a href=#__codelineno-0-1643><span class=linenos data-linenos="1643 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Solving the fitting problem.</span>
<a id=__codelineno-0-1644 name=__codelineno-0-1644></a><a href=#__codelineno-0-1644><span class=linenos data-linenos="1644 "></span></a>
<a id=__codelineno-0-1645 name=__codelineno-0-1645></a><a href=#__codelineno-0-1645><span class=linenos data-linenos="1645 "></span></a><span class=sd>        !!! note &quot;About implemented models&quot;</span>
<a id=__codelineno-0-1646 name=__codelineno-0-1646></a><a href=#__codelineno-0-1646><span class=linenos data-linenos="1646 "></span></a><span class=sd>            `solve_local_fitting` is a wrapper function for the calling the implemented</span>
<a id=__codelineno-0-1647 name=__codelineno-0-1647></a><a href=#__codelineno-0-1647><span class=linenos data-linenos="1647 "></span></a><span class=sd>            moldels. Based on the `params` dictionary, the function calls the</span>
<a id=__codelineno-0-1648 name=__codelineno-0-1648></a><a href=#__codelineno-0-1648><span class=linenos data-linenos="1648 "></span></a><span class=sd>            corresponding models and merge them to the general model with will be</span>
<a id=__codelineno-0-1649 name=__codelineno-0-1649></a><a href=#__codelineno-0-1649><span class=linenos data-linenos="1649 "></span></a><span class=sd>            optimized by the `lmfit`-optimizer.</span>
<a id=__codelineno-0-1650 name=__codelineno-0-1650></a><a href=#__codelineno-0-1650><span class=linenos data-linenos="1650 "></span></a><span class=sd>            Currently the following models are supported:</span>
<a id=__codelineno-0-1651 name=__codelineno-0-1651></a><a href=#__codelineno-0-1651><span class=linenos data-linenos="1651 "></span></a>
<a id=__codelineno-0-1652 name=__codelineno-0-1652></a><a href=#__codelineno-0-1652><span class=linenos data-linenos="1652 "></span></a><span class=sd>            - [Gaussian](https://en.wikipedia.org/wiki/Gaussian_function)</span>
<a id=__codelineno-0-1653 name=__codelineno-0-1653></a><a href=#__codelineno-0-1653><span class=linenos data-linenos="1653 "></span></a><span class=sd>            - [Lorentzian](https://en.wikipedia.org/wiki/Cauchy_distribution)</span>
<a id=__codelineno-0-1654 name=__codelineno-0-1654></a><a href=#__codelineno-0-1654><span class=linenos data-linenos="1654 "></span></a><span class=sd>                also known as Cauchy distribution</span>
<a id=__codelineno-0-1655 name=__codelineno-0-1655></a><a href=#__codelineno-0-1655><span class=linenos data-linenos="1655 "></span></a><span class=sd>            - [Voigt](https://en.wikipedia.org/wiki/Voigt_profile)</span>
<a id=__codelineno-0-1656 name=__codelineno-0-1656></a><a href=#__codelineno-0-1656><span class=linenos data-linenos="1656 "></span></a><span class=sd>            - [Pseudo Voigt][1]</span>
<a id=__codelineno-0-1657 name=__codelineno-0-1657></a><a href=#__codelineno-0-1657><span class=linenos data-linenos="1657 "></span></a><span class=sd>            - Exponential</span>
<a id=__codelineno-0-1658 name=__codelineno-0-1658></a><a href=#__codelineno-0-1658><span class=linenos data-linenos="1658 "></span></a><span class=sd>            - [power][2] (also known as Log-parabola or just power)</span>
<a id=__codelineno-0-1659 name=__codelineno-0-1659></a><a href=#__codelineno-0-1659><span class=linenos data-linenos="1659 "></span></a><span class=sd>            - Linear</span>
<a id=__codelineno-0-1660 name=__codelineno-0-1660></a><a href=#__codelineno-0-1660><span class=linenos data-linenos="1660 "></span></a><span class=sd>            - Constant</span>
<a id=__codelineno-0-1661 name=__codelineno-0-1661></a><a href=#__codelineno-0-1661><span class=linenos data-linenos="1661 "></span></a><span class=sd>            - [Error Function](https://en.wikipedia.org/wiki/Error_function)</span>
<a id=__codelineno-0-1662 name=__codelineno-0-1662></a><a href=#__codelineno-0-1662><span class=linenos data-linenos="1662 "></span></a><span class=sd>            - [Arcus Tangens][3]</span>
<a id=__codelineno-0-1663 name=__codelineno-0-1663></a><a href=#__codelineno-0-1663><span class=linenos data-linenos="1663 "></span></a><span class=sd>            - Logarithmic</span>
<a id=__codelineno-0-1664 name=__codelineno-0-1664></a><a href=#__codelineno-0-1664><span class=linenos data-linenos="1664 "></span></a>
<a id=__codelineno-0-1665 name=__codelineno-0-1665></a><a href=#__codelineno-0-1665><span class=linenos data-linenos="1665 "></span></a><span class=sd>            [1]: https://en.wikipedia.org/wiki/Voigt_profile#Pseudo-Voigt_approximation</span>
<a id=__codelineno-0-1666 name=__codelineno-0-1666></a><a href=#__codelineno-0-1666><span class=linenos data-linenos="1666 "></span></a><span class=sd>            [2]: https://en.wikipedia.org/wiki/Power_law</span>
<a id=__codelineno-0-1667 name=__codelineno-0-1667></a><a href=#__codelineno-0-1667><span class=linenos data-linenos="1667 "></span></a><span class=sd>            [3]: https://en.wikipedia.org/wiki/Inverse_trigonometric_functions</span>
<a id=__codelineno-0-1668 name=__codelineno-0-1668></a><a href=#__codelineno-0-1668><span class=linenos data-linenos="1668 "></span></a>
<a id=__codelineno-0-1669 name=__codelineno-0-1669></a><a href=#__codelineno-0-1669><span class=linenos data-linenos="1669 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-1670 name=__codelineno-0-1670></a><a href=#__codelineno-0-1670><span class=linenos data-linenos="1670 "></span></a><span class=sd>            params (Dict[str, Parameters]): The best optimized parameters of the fit.</span>
<a id=__codelineno-0-1671 name=__codelineno-0-1671></a><a href=#__codelineno-0-1671><span class=linenos data-linenos="1671 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-1672 name=__codelineno-0-1672></a><a href=#__codelineno-0-1672><span class=linenos data-linenos="1672 "></span></a><span class=sd>            data (NDArray[np.float64]): `y`-values of the data as 1d-array.</span>
<a id=__codelineno-0-1673 name=__codelineno-0-1673></a><a href=#__codelineno-0-1673><span class=linenos data-linenos="1673 "></span></a>
<a id=__codelineno-0-1674 name=__codelineno-0-1674></a><a href=#__codelineno-0-1674><span class=linenos data-linenos="1674 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-1675 name=__codelineno-0-1675></a><a href=#__codelineno-0-1675><span class=linenos data-linenos="1675 "></span></a><span class=sd>            NDArray[np.float64]: The best-fitted data based on the proposed model.</span>
<a id=__codelineno-0-1676 name=__codelineno-0-1676></a><a href=#__codelineno-0-1676><span class=linenos data-linenos="1676 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1677 name=__codelineno-0-1677></a><a href=#__codelineno-0-1677><span class=linenos data-linenos="1677 "></span></a>        <span class=n>val</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
<a id=__codelineno-0-1678 name=__codelineno-0-1678></a><a href=#__codelineno-0-1678><span class=linenos data-linenos="1678 "></span></a>        <span class=n>peak_kwargs</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span> <span class=n>Parameters</span><span class=p>]</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>
<a id=__codelineno-0-1679 name=__codelineno-0-1679></a><a href=#__codelineno-0-1679><span class=linenos data-linenos="1679 "></span></a>
<a id=__codelineno-0-1680 name=__codelineno-0-1680></a><a href=#__codelineno-0-1680><span class=linenos data-linenos="1680 "></span></a>        <span class=k>for</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>params</span><span class=p>:</span>
<a id=__codelineno-0-1681 name=__codelineno-0-1681></a><a href=#__codelineno-0-1681><span class=linenos data-linenos="1681 "></span></a>            <span class=n>model</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
<a id=__codelineno-0-1682 name=__codelineno-0-1682></a><a href=#__codelineno-0-1682><span class=linenos data-linenos="1682 "></span></a>            <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>model_check</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>)</span>
<a id=__codelineno-0-1683 name=__codelineno-0-1683></a><a href=#__codelineno-0-1683><span class=linenos data-linenos="1683 "></span></a>            <span class=n>c_name</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;_&quot;</span><span class=p>)</span>
<a id=__codelineno-0-1684 name=__codelineno-0-1684></a><a href=#__codelineno-0-1684><span class=linenos data-linenos="1684 "></span></a>            <span class=n>peak_kwargs</span><span class=p>[(</span><span class=n>c_name</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>c_name</span><span class=p>[</span><span class=mi>2</span><span class=p>])][</span><span class=n>c_name</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=n>model</span><span class=p>]</span>
<a id=__codelineno-0-1685 name=__codelineno-0-1685></a><a href=#__codelineno-0-1685><span class=linenos data-linenos="1685 "></span></a>
<a id=__codelineno-0-1686 name=__codelineno-0-1686></a><a href=#__codelineno-0-1686><span class=linenos data-linenos="1686 "></span></a>        <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>_kwarg</span> <span class=ow>in</span> <span class=n>peak_kwargs</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1687 name=__codelineno-0-1687></a><a href=#__codelineno-0-1687><span class=linenos data-linenos="1687 "></span></a>            <span class=n>val</span> <span class=o>+=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>DistributionModels</span><span class=p>(),</span> <span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])(</span><span class=n>x</span><span class=p>,</span> <span class=o>**</span><span class=n>_kwarg</span><span class=p>)</span>
<a id=__codelineno-0-1688 name=__codelineno-0-1688></a><a href=#__codelineno-0-1688><span class=linenos data-linenos="1688 "></span></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>val</span> <span class=o>-</span> <span class=n>data</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>)</span>
<a id=__codelineno-0-1689 name=__codelineno-0-1689></a><a href=#__codelineno-0-1689><span class=linenos data-linenos="1689 "></span></a>
<a id=__codelineno-0-1690 name=__codelineno-0-1690></a><a href=#__codelineno-0-1690><span class=linenos data-linenos="1690 "></span></a>    <span class=nd>@staticmethod</span>
<a id=__codelineno-0-1691 name=__codelineno-0-1691></a><a href=#__codelineno-0-1691><span class=linenos data-linenos="1691 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>solve_global_fitting</span><span class=p>(</span>
<a id=__codelineno-0-1692 name=__codelineno-0-1692></a><a href=#__codelineno-0-1692><span class=linenos data-linenos="1692 "></span></a>        <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Parameters</span><span class=p>],</span>
<a id=__codelineno-0-1693 name=__codelineno-0-1693></a><a href=#__codelineno-0-1693><span class=linenos data-linenos="1693 "></span></a>        <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-1694 name=__codelineno-0-1694></a><a href=#__codelineno-0-1694><span class=linenos data-linenos="1694 "></span></a>        <span class=n>data</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-1695 name=__codelineno-0-1695></a><a href=#__codelineno-0-1695><span class=linenos data-linenos="1695 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-1696 name=__codelineno-0-1696></a><a href=#__codelineno-0-1696><span class=linenos data-linenos="1696 "></span></a><span class=w>        </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Solving the fitting for global problem.</span>
<a id=__codelineno-0-1697 name=__codelineno-0-1697></a><a href=#__codelineno-0-1697><span class=linenos data-linenos="1697 "></span></a>
<a id=__codelineno-0-1698 name=__codelineno-0-1698></a><a href=#__codelineno-0-1698><span class=linenos data-linenos="1698 "></span></a><span class=sd>        !!! note &quot;About implemented models&quot;</span>
<a id=__codelineno-0-1699 name=__codelineno-0-1699></a><a href=#__codelineno-0-1699><span class=linenos data-linenos="1699 "></span></a><span class=sd>            `solve_global_fitting` is the global solution of `solve_local_fitting` a</span>
<a id=__codelineno-0-1700 name=__codelineno-0-1700></a><a href=#__codelineno-0-1700><span class=linenos data-linenos="1700 "></span></a><span class=sd>            wrapper function for the calling the implemented moldels. For the kind of</span>
<a id=__codelineno-0-1701 name=__codelineno-0-1701></a><a href=#__codelineno-0-1701><span class=linenos data-linenos="1701 "></span></a><span class=sd>            supported models see `solve_local_fitting`.</span>
<a id=__codelineno-0-1702 name=__codelineno-0-1702></a><a href=#__codelineno-0-1702><span class=linenos data-linenos="1702 "></span></a>
<a id=__codelineno-0-1703 name=__codelineno-0-1703></a><a href=#__codelineno-0-1703><span class=linenos data-linenos="1703 "></span></a><span class=sd>        !!! note &quot;About the global solution&quot;</span>
<a id=__codelineno-0-1704 name=__codelineno-0-1704></a><a href=#__codelineno-0-1704><span class=linenos data-linenos="1704 "></span></a><span class=sd>            The global solution is a solution for the problem, where the `x`-values is</span>
<a id=__codelineno-0-1705 name=__codelineno-0-1705></a><a href=#__codelineno-0-1705><span class=linenos data-linenos="1705 "></span></a><span class=sd>            the energy, but the y-values are the intensities, which has to be fitted as</span>
<a id=__codelineno-0-1706 name=__codelineno-0-1706></a><a href=#__codelineno-0-1706><span class=linenos data-linenos="1706 "></span></a><span class=sd>            one unit. For this reason, the residual is calculated as the difference</span>
<a id=__codelineno-0-1707 name=__codelineno-0-1707></a><a href=#__codelineno-0-1707><span class=linenos data-linenos="1707 "></span></a><span class=sd>            between all the y-values and the global proposed solution. Later the</span>
<a id=__codelineno-0-1708 name=__codelineno-0-1708></a><a href=#__codelineno-0-1708><span class=linenos data-linenos="1708 "></span></a><span class=sd>            residual has to be flattened to a 1-dimensional array and minimized by the</span>
<a id=__codelineno-0-1709 name=__codelineno-0-1709></a><a href=#__codelineno-0-1709><span class=linenos data-linenos="1709 "></span></a><span class=sd>            `lmfit`-optimizer.</span>
<a id=__codelineno-0-1710 name=__codelineno-0-1710></a><a href=#__codelineno-0-1710><span class=linenos data-linenos="1710 "></span></a>
<a id=__codelineno-0-1711 name=__codelineno-0-1711></a><a href=#__codelineno-0-1711><span class=linenos data-linenos="1711 "></span></a>
<a id=__codelineno-0-1712 name=__codelineno-0-1712></a><a href=#__codelineno-0-1712><span class=linenos data-linenos="1712 "></span></a><span class=sd>        Args:</span>
<a id=__codelineno-0-1713 name=__codelineno-0-1713></a><a href=#__codelineno-0-1713><span class=linenos data-linenos="1713 "></span></a><span class=sd>            params (Dict[str, Parameters]): The best optimized parameters of the fit.</span>
<a id=__codelineno-0-1714 name=__codelineno-0-1714></a><a href=#__codelineno-0-1714><span class=linenos data-linenos="1714 "></span></a><span class=sd>            x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-1715 name=__codelineno-0-1715></a><a href=#__codelineno-0-1715><span class=linenos data-linenos="1715 "></span></a><span class=sd>            data (NDArray[np.float64]): `y`-values of the data as 2D-array.</span>
<a id=__codelineno-0-1716 name=__codelineno-0-1716></a><a href=#__codelineno-0-1716><span class=linenos data-linenos="1716 "></span></a>
<a id=__codelineno-0-1717 name=__codelineno-0-1717></a><a href=#__codelineno-0-1717><span class=linenos data-linenos="1717 "></span></a><span class=sd>        Returns:</span>
<a id=__codelineno-0-1718 name=__codelineno-0-1718></a><a href=#__codelineno-0-1718><span class=linenos data-linenos="1718 "></span></a><span class=sd>            NDArray[np.float64]: The best-fitted data based on the proposed model.</span>
<a id=__codelineno-0-1719 name=__codelineno-0-1719></a><a href=#__codelineno-0-1719><span class=linenos data-linenos="1719 "></span></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-0-1720 name=__codelineno-0-1720></a><a href=#__codelineno-0-1720><span class=linenos data-linenos="1720 "></span></a>        <span class=n>val</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
<a id=__codelineno-0-1721 name=__codelineno-0-1721></a><a href=#__codelineno-0-1721><span class=linenos data-linenos="1721 "></span></a>        <span class=n>peak_kwargs</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span> <span class=n>Parameters</span><span class=p>]</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>
<a id=__codelineno-0-1722 name=__codelineno-0-1722></a><a href=#__codelineno-0-1722><span class=linenos data-linenos="1722 "></span></a>
<a id=__codelineno-0-1723 name=__codelineno-0-1723></a><a href=#__codelineno-0-1723><span class=linenos data-linenos="1723 "></span></a>        <span class=k>for</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>params</span><span class=p>:</span>
<a id=__codelineno-0-1724 name=__codelineno-0-1724></a><a href=#__codelineno-0-1724><span class=linenos data-linenos="1724 "></span></a>            <span class=n>model</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
<a id=__codelineno-0-1725 name=__codelineno-0-1725></a><a href=#__codelineno-0-1725><span class=linenos data-linenos="1725 "></span></a>            <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>model_check</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>)</span>
<a id=__codelineno-0-1726 name=__codelineno-0-1726></a><a href=#__codelineno-0-1726><span class=linenos data-linenos="1726 "></span></a>            <span class=n>c_name</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;_&quot;</span><span class=p>)</span>
<a id=__codelineno-0-1727 name=__codelineno-0-1727></a><a href=#__codelineno-0-1727><span class=linenos data-linenos="1727 "></span></a>            <span class=n>peak_kwargs</span><span class=p>[(</span><span class=n>c_name</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>c_name</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=n>c_name</span><span class=p>[</span><span class=mi>3</span><span class=p>])][</span><span class=n>c_name</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=n>model</span><span class=p>]</span>
<a id=__codelineno-0-1728 name=__codelineno-0-1728></a><a href=#__codelineno-0-1728><span class=linenos data-linenos="1728 "></span></a>        <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>_kwarg</span> <span class=ow>in</span> <span class=n>peak_kwargs</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1729 name=__codelineno-0-1729></a><a href=#__codelineno-0-1729><span class=linenos data-linenos="1729 "></span></a>            <span class=n>i</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=o>-</span> <span class=mi>1</span>
<a id=__codelineno-0-1730 name=__codelineno-0-1730></a><a href=#__codelineno-0-1730><span class=linenos data-linenos="1730 "></span></a>            <span class=n>val</span><span class=p>[:,</span> <span class=n>i</span><span class=p>]</span> <span class=o>+=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>DistributionModels</span><span class=p>(),</span> <span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])(</span><span class=n>x</span><span class=p>,</span> <span class=o>**</span><span class=n>_kwarg</span><span class=p>)</span>
<a id=__codelineno-0-1731 name=__codelineno-0-1731></a><a href=#__codelineno-0-1731><span class=linenos data-linenos="1731 "></span></a>
<a id=__codelineno-0-1732 name=__codelineno-0-1732></a><a href=#__codelineno-0-1732><span class=linenos data-linenos="1732 "></span></a>        <span class=n>val</span> <span class=o>-=</span> <span class=n>data</span>
<a id=__codelineno-0-1733 name=__codelineno-0-1733></a><a href=#__codelineno-0-1733><span class=linenos data-linenos="1733 "></span></a>        <span class=k>return</span> <span class=n>val</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</code></pre></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.SolverModels.__call__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__call__</span><span class=p>()</span></code> <a href=#spectrafit.models.SolverModels.__call__ class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Solve the fitting model.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Tuple>Tuple</span>[<span title=lmfit.Minimizer>Minimizer</span>, <span title=typing.Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>Tuple[<abbr title="The lmfit class used for defining and performing the optimization (fitting) problem">Minimizer</abbr>, Any]: <abbr title="The lmfit class used for defining and performing the optimization (fitting) problem">Minimizer</abbr> class and the fitting results.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1610 name=__codelineno-0-1610></a><a href=#__codelineno-0-1610><span class=linenos data-linenos="1610 "></span></a><span class=k>def</span><span class=w> </span><span class=fm>__call__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>Minimizer</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
<a id=__codelineno-0-1611 name=__codelineno-0-1611></a><a href=#__codelineno-0-1611><span class=linenos data-linenos="1611 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Solve the fitting model.</span>
<a id=__codelineno-0-1612 name=__codelineno-0-1612></a><a href=#__codelineno-0-1612><span class=linenos data-linenos="1612 "></span></a>
<a id=__codelineno-0-1613 name=__codelineno-0-1613></a><a href=#__codelineno-0-1613><span class=linenos data-linenos="1613 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-1614 name=__codelineno-0-1614></a><a href=#__codelineno-0-1614><span class=linenos data-linenos="1614 "></span></a><span class=sd>        Tuple[Minimizer, Any]: Minimizer class and the fitting results.</span>
<a id=__codelineno-0-1615 name=__codelineno-0-1615></a><a href=#__codelineno-0-1615><span class=linenos data-linenos="1615 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1616 name=__codelineno-0-1616></a><a href=#__codelineno-0-1616><span class=linenos data-linenos="1616 "></span></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>args_global</span><span class=p>[</span><span class=s2>&quot;global_&quot;</span><span class=p>]:</span>
<a id=__codelineno-0-1617 name=__codelineno-0-1617></a><a href=#__codelineno-0-1617><span class=linenos data-linenos="1617 "></span></a>        <span class=n>minimizer</span> <span class=o>=</span> <span class=n>Minimizer</span><span class=p>(</span>
<a id=__codelineno-0-1618 name=__codelineno-0-1618></a><a href=#__codelineno-0-1618><span class=linenos data-linenos="1618 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>solve_global_fitting</span><span class=p>,</span>
<a id=__codelineno-0-1619 name=__codelineno-0-1619></a><a href=#__codelineno-0-1619><span class=linenos data-linenos="1619 "></span></a>            <span class=n>params</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>,</span>
<a id=__codelineno-0-1620 name=__codelineno-0-1620></a><a href=#__codelineno-0-1620><span class=linenos data-linenos="1620 "></span></a>            <span class=n>fcn_args</span><span class=o>=</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>),</span>
<a id=__codelineno-0-1621 name=__codelineno-0-1621></a><a href=#__codelineno-0-1621><span class=linenos data-linenos="1621 "></span></a>            <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span><span class=p>[</span><span class=s2>&quot;minimizer&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1622 name=__codelineno-0-1622></a><a href=#__codelineno-0-1622><span class=linenos data-linenos="1622 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-1623 name=__codelineno-0-1623></a><a href=#__codelineno-0-1623><span class=linenos data-linenos="1623 "></span></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-1624 name=__codelineno-0-1624></a><a href=#__codelineno-0-1624><span class=linenos data-linenos="1624 "></span></a>        <span class=n>minimizer</span> <span class=o>=</span> <span class=n>Minimizer</span><span class=p>(</span>
<a id=__codelineno-0-1625 name=__codelineno-0-1625></a><a href=#__codelineno-0-1625><span class=linenos data-linenos="1625 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>solve_local_fitting</span><span class=p>,</span>
<a id=__codelineno-0-1626 name=__codelineno-0-1626></a><a href=#__codelineno-0-1626><span class=linenos data-linenos="1626 "></span></a>            <span class=n>params</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>params</span><span class=p>,</span>
<a id=__codelineno-0-1627 name=__codelineno-0-1627></a><a href=#__codelineno-0-1627><span class=linenos data-linenos="1627 "></span></a>            <span class=n>fcn_args</span><span class=o>=</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data</span><span class=p>),</span>
<a id=__codelineno-0-1628 name=__codelineno-0-1628></a><a href=#__codelineno-0-1628><span class=linenos data-linenos="1628 "></span></a>            <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span><span class=p>[</span><span class=s2>&quot;minimizer&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1629 name=__codelineno-0-1629></a><a href=#__codelineno-0-1629><span class=linenos data-linenos="1629 "></span></a>        <span class=p>)</span>
<a id=__codelineno-0-1630 name=__codelineno-0-1630></a><a href=#__codelineno-0-1630><span class=linenos data-linenos="1630 "></span></a>
<a id=__codelineno-0-1631 name=__codelineno-0-1631></a><a href=#__codelineno-0-1631><span class=linenos data-linenos="1631 "></span></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>minimizer</span><span class=o>.</span><span class=n>minimize</span><span class=p>(</span>
<a id=__codelineno-0-1632 name=__codelineno-0-1632></a><a href=#__codelineno-0-1632><span class=linenos data-linenos="1632 "></span></a>        <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span><span class=p>[</span><span class=s2>&quot;optimizer&quot;</span><span class=p>],</span>
<a id=__codelineno-0-1633 name=__codelineno-0-1633></a><a href=#__codelineno-0-1633><span class=linenos data-linenos="1633 "></span></a>    <span class=p>)</span>
<a id=__codelineno-0-1634 name=__codelineno-0-1634></a><a href=#__codelineno-0-1634><span class=linenos data-linenos="1634 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span><span class=p>[</span><span class=s2>&quot;optimizer&quot;</span><span class=p>][</span><span class=s2>&quot;max_nfev&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>minimizer</span><span class=o>.</span><span class=n>max_nfev</span>
<a id=__codelineno-0-1635 name=__codelineno-0-1635></a><a href=#__codelineno-0-1635><span class=linenos data-linenos="1635 "></span></a>    <span class=k>return</span> <span class=n>minimizer</span><span class=p>,</span> <span class=n>result</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.SolverModels.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>args</span><span class=p>)</span></code> <a href=#spectrafit.models.SolverModels.__init__ class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Initialize the solver modes.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>df</code> </td> <td> <code><span title=pandas.DataFrame>DataFrame</span></code> </td> <td> <div class=doc-md-description> <p>DataFrame containing the input data (<code class="language-text highlight">x</code> and <code class="language-text highlight">data</code>).</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>args</code> </td> <td> <code><span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>The input file arguments as a dictionary with additional information beyond the command line arguments.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1597 name=__codelineno-0-1597></a><a href=#__codelineno-0-1597><span class=linenos data-linenos="1597 "></span></a><span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1598 name=__codelineno-0-1598></a><a href=#__codelineno-0-1598><span class=linenos data-linenos="1598 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the solver modes.</span>
<a id=__codelineno-0-1599 name=__codelineno-0-1599></a><a href=#__codelineno-0-1599><span class=linenos data-linenos="1599 "></span></a>
<a id=__codelineno-0-1600 name=__codelineno-0-1600></a><a href=#__codelineno-0-1600><span class=linenos data-linenos="1600 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-1601 name=__codelineno-0-1601></a><a href=#__codelineno-0-1601><span class=linenos data-linenos="1601 "></span></a><span class=sd>        df (pd.DataFrame): DataFrame containing the input data (`x` and `data`).</span>
<a id=__codelineno-0-1602 name=__codelineno-0-1602></a><a href=#__codelineno-0-1602><span class=linenos data-linenos="1602 "></span></a><span class=sd>        args (Dict[str, Any]): The input file arguments as a dictionary with</span>
<a id=__codelineno-0-1603 name=__codelineno-0-1603></a><a href=#__codelineno-0-1603><span class=linenos data-linenos="1603 "></span></a><span class=sd>             additional information beyond the command line arguments.</span>
<a id=__codelineno-0-1604 name=__codelineno-0-1604></a><a href=#__codelineno-0-1604><span class=linenos data-linenos="1604 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1605 name=__codelineno-0-1605></a><a href=#__codelineno-0-1605><span class=linenos data-linenos="1605 "></span></a>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>df</span><span class=o>=</span><span class=n>df</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=n>args</span><span class=p>)</span>
<a id=__codelineno-0-1606 name=__codelineno-0-1606></a><a href=#__codelineno-0-1606><span class=linenos data-linenos="1606 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>args_solver</span> <span class=o>=</span> <span class=n>SolverModelsAPI</span><span class=p>(</span><span class=o>**</span><span class=n>args</span><span class=p>)</span><span class=o>.</span><span class=n>model_dump</span><span class=p>()</span>
<a id=__codelineno-0-1607 name=__codelineno-0-1607></a><a href=#__codelineno-0-1607><span class=linenos data-linenos="1607 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>args_global</span> <span class=o>=</span> <span class=n>GlobalFittingAPI</span><span class=p>(</span><span class=o>**</span><span class=n>args</span><span class=p>)</span><span class=o>.</span><span class=n>model_dump</span><span class=p>()</span>
<a id=__codelineno-0-1608 name=__codelineno-0-1608></a><a href=#__codelineno-0-1608><span class=linenos data-linenos="1608 "></span></a>    <span class=bp>self</span><span class=o>.</span><span class=n>params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>return_params</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.SolverModels.solve_global_fitting class="doc doc-heading"> <code class="highlight language-python"><span class=n>solve_global_fitting</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.SolverModels.solve_global_fitting class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Solving the fitting for global problem.</p> <div class="admonition note"> <p class=admonition-title>About implemented models</p> <p><code class="language-scdoc highlight">solve_global_fitting</code> is the global solution of <code class="language-scdoc highlight">solve_local_fitting</code> a wrapper function for the calling the implemented moldels. For the kind of supported models see <code class="language-scdoc highlight">solve_local_fitting</code>.</p> </div> <div class="admonition note"> <p class=admonition-title>About the global solution</p> <p>The global solution is a solution for the problem, where the <code class="language-text highlight">x</code>-values is the energy, but the y-values are the intensities, which has to be fitted as one unit. For this reason, the residual is calculated as the difference between all the y-values and the global proposed solution. Later the residual has to be flattened to a 1-dimensional array and minimized by the <code class="language-text highlight">lmfit</code>-optimizer.</p> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>params</code> </td> <td> <code><span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=lmfit.Parameters>Parameters</span>]</code> </td> <td> <div class=doc-md-description> <p>The best optimized parameters of the fit.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">y</code>-values of the data as 2D-array.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: The best-fitted data based on the proposed model.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1690 name=__codelineno-0-1690></a><a href=#__codelineno-0-1690><span class=linenos data-linenos="1690 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-1691 name=__codelineno-0-1691></a><a href=#__codelineno-0-1691><span class=linenos data-linenos="1691 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>solve_global_fitting</span><span class=p>(</span>
<a id=__codelineno-0-1692 name=__codelineno-0-1692></a><a href=#__codelineno-0-1692><span class=linenos data-linenos="1692 "></span></a>    <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Parameters</span><span class=p>],</span>
<a id=__codelineno-0-1693 name=__codelineno-0-1693></a><a href=#__codelineno-0-1693><span class=linenos data-linenos="1693 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-1694 name=__codelineno-0-1694></a><a href=#__codelineno-0-1694><span class=linenos data-linenos="1694 "></span></a>    <span class=n>data</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-1695 name=__codelineno-0-1695></a><a href=#__codelineno-0-1695><span class=linenos data-linenos="1695 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-1696 name=__codelineno-0-1696></a><a href=#__codelineno-0-1696><span class=linenos data-linenos="1696 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Solving the fitting for global problem.</span>
<a id=__codelineno-0-1697 name=__codelineno-0-1697></a><a href=#__codelineno-0-1697><span class=linenos data-linenos="1697 "></span></a>
<a id=__codelineno-0-1698 name=__codelineno-0-1698></a><a href=#__codelineno-0-1698><span class=linenos data-linenos="1698 "></span></a><span class=sd>    !!! note &quot;About implemented models&quot;</span>
<a id=__codelineno-0-1699 name=__codelineno-0-1699></a><a href=#__codelineno-0-1699><span class=linenos data-linenos="1699 "></span></a><span class=sd>        `solve_global_fitting` is the global solution of `solve_local_fitting` a</span>
<a id=__codelineno-0-1700 name=__codelineno-0-1700></a><a href=#__codelineno-0-1700><span class=linenos data-linenos="1700 "></span></a><span class=sd>        wrapper function for the calling the implemented moldels. For the kind of</span>
<a id=__codelineno-0-1701 name=__codelineno-0-1701></a><a href=#__codelineno-0-1701><span class=linenos data-linenos="1701 "></span></a><span class=sd>        supported models see `solve_local_fitting`.</span>
<a id=__codelineno-0-1702 name=__codelineno-0-1702></a><a href=#__codelineno-0-1702><span class=linenos data-linenos="1702 "></span></a>
<a id=__codelineno-0-1703 name=__codelineno-0-1703></a><a href=#__codelineno-0-1703><span class=linenos data-linenos="1703 "></span></a><span class=sd>    !!! note &quot;About the global solution&quot;</span>
<a id=__codelineno-0-1704 name=__codelineno-0-1704></a><a href=#__codelineno-0-1704><span class=linenos data-linenos="1704 "></span></a><span class=sd>        The global solution is a solution for the problem, where the `x`-values is</span>
<a id=__codelineno-0-1705 name=__codelineno-0-1705></a><a href=#__codelineno-0-1705><span class=linenos data-linenos="1705 "></span></a><span class=sd>        the energy, but the y-values are the intensities, which has to be fitted as</span>
<a id=__codelineno-0-1706 name=__codelineno-0-1706></a><a href=#__codelineno-0-1706><span class=linenos data-linenos="1706 "></span></a><span class=sd>        one unit. For this reason, the residual is calculated as the difference</span>
<a id=__codelineno-0-1707 name=__codelineno-0-1707></a><a href=#__codelineno-0-1707><span class=linenos data-linenos="1707 "></span></a><span class=sd>        between all the y-values and the global proposed solution. Later the</span>
<a id=__codelineno-0-1708 name=__codelineno-0-1708></a><a href=#__codelineno-0-1708><span class=linenos data-linenos="1708 "></span></a><span class=sd>        residual has to be flattened to a 1-dimensional array and minimized by the</span>
<a id=__codelineno-0-1709 name=__codelineno-0-1709></a><a href=#__codelineno-0-1709><span class=linenos data-linenos="1709 "></span></a><span class=sd>        `lmfit`-optimizer.</span>
<a id=__codelineno-0-1710 name=__codelineno-0-1710></a><a href=#__codelineno-0-1710><span class=linenos data-linenos="1710 "></span></a>
<a id=__codelineno-0-1711 name=__codelineno-0-1711></a><a href=#__codelineno-0-1711><span class=linenos data-linenos="1711 "></span></a>
<a id=__codelineno-0-1712 name=__codelineno-0-1712></a><a href=#__codelineno-0-1712><span class=linenos data-linenos="1712 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-1713 name=__codelineno-0-1713></a><a href=#__codelineno-0-1713><span class=linenos data-linenos="1713 "></span></a><span class=sd>        params (Dict[str, Parameters]): The best optimized parameters of the fit.</span>
<a id=__codelineno-0-1714 name=__codelineno-0-1714></a><a href=#__codelineno-0-1714><span class=linenos data-linenos="1714 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-1715 name=__codelineno-0-1715></a><a href=#__codelineno-0-1715><span class=linenos data-linenos="1715 "></span></a><span class=sd>        data (NDArray[np.float64]): `y`-values of the data as 2D-array.</span>
<a id=__codelineno-0-1716 name=__codelineno-0-1716></a><a href=#__codelineno-0-1716><span class=linenos data-linenos="1716 "></span></a>
<a id=__codelineno-0-1717 name=__codelineno-0-1717></a><a href=#__codelineno-0-1717><span class=linenos data-linenos="1717 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-1718 name=__codelineno-0-1718></a><a href=#__codelineno-0-1718><span class=linenos data-linenos="1718 "></span></a><span class=sd>        NDArray[np.float64]: The best-fitted data based on the proposed model.</span>
<a id=__codelineno-0-1719 name=__codelineno-0-1719></a><a href=#__codelineno-0-1719><span class=linenos data-linenos="1719 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1720 name=__codelineno-0-1720></a><a href=#__codelineno-0-1720><span class=linenos data-linenos="1720 "></span></a>    <span class=n>val</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
<a id=__codelineno-0-1721 name=__codelineno-0-1721></a><a href=#__codelineno-0-1721><span class=linenos data-linenos="1721 "></span></a>    <span class=n>peak_kwargs</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span> <span class=n>Parameters</span><span class=p>]</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>
<a id=__codelineno-0-1722 name=__codelineno-0-1722></a><a href=#__codelineno-0-1722><span class=linenos data-linenos="1722 "></span></a>
<a id=__codelineno-0-1723 name=__codelineno-0-1723></a><a href=#__codelineno-0-1723><span class=linenos data-linenos="1723 "></span></a>    <span class=k>for</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>params</span><span class=p>:</span>
<a id=__codelineno-0-1724 name=__codelineno-0-1724></a><a href=#__codelineno-0-1724><span class=linenos data-linenos="1724 "></span></a>        <span class=n>model</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
<a id=__codelineno-0-1725 name=__codelineno-0-1725></a><a href=#__codelineno-0-1725><span class=linenos data-linenos="1725 "></span></a>        <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>model_check</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>)</span>
<a id=__codelineno-0-1726 name=__codelineno-0-1726></a><a href=#__codelineno-0-1726><span class=linenos data-linenos="1726 "></span></a>        <span class=n>c_name</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;_&quot;</span><span class=p>)</span>
<a id=__codelineno-0-1727 name=__codelineno-0-1727></a><a href=#__codelineno-0-1727><span class=linenos data-linenos="1727 "></span></a>        <span class=n>peak_kwargs</span><span class=p>[(</span><span class=n>c_name</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>c_name</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=n>c_name</span><span class=p>[</span><span class=mi>3</span><span class=p>])][</span><span class=n>c_name</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=n>model</span><span class=p>]</span>
<a id=__codelineno-0-1728 name=__codelineno-0-1728></a><a href=#__codelineno-0-1728><span class=linenos data-linenos="1728 "></span></a>    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>_kwarg</span> <span class=ow>in</span> <span class=n>peak_kwargs</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1729 name=__codelineno-0-1729></a><a href=#__codelineno-0-1729><span class=linenos data-linenos="1729 "></span></a>        <span class=n>i</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=o>-</span> <span class=mi>1</span>
<a id=__codelineno-0-1730 name=__codelineno-0-1730></a><a href=#__codelineno-0-1730><span class=linenos data-linenos="1730 "></span></a>        <span class=n>val</span><span class=p>[:,</span> <span class=n>i</span><span class=p>]</span> <span class=o>+=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>DistributionModels</span><span class=p>(),</span> <span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])(</span><span class=n>x</span><span class=p>,</span> <span class=o>**</span><span class=n>_kwarg</span><span class=p>)</span>
<a id=__codelineno-0-1731 name=__codelineno-0-1731></a><a href=#__codelineno-0-1731><span class=linenos data-linenos="1731 "></span></a>
<a id=__codelineno-0-1732 name=__codelineno-0-1732></a><a href=#__codelineno-0-1732><span class=linenos data-linenos="1732 "></span></a>    <span class=n>val</span> <span class=o>-=</span> <span class=n>data</span>
<a id=__codelineno-0-1733 name=__codelineno-0-1733></a><a href=#__codelineno-0-1733><span class=linenos data-linenos="1733 "></span></a>    <span class=k>return</span> <span class=n>val</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=spectrafit.models.SolverModels.solve_local_fitting class="doc doc-heading"> <code class="highlight language-python"><span class=n>solve_local_fitting</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> <a href=#spectrafit.models.SolverModels.solve_local_fitting class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Solving the fitting problem.</p> <div class="admonition note"> <p class=admonition-title>About implemented models</p> <p><code class="language-scdoc highlight">solve_local_fitting</code> is a wrapper function for the calling the implemented moldels. Based on the <code class="language-text highlight">params</code> dictionary, the function calls the corresponding models and merge them to the general model with will be optimized by the <code class="language-text highlight">lmfit</code>-optimizer. Currently the following models are supported:</p> <ul> <li><a href=https://en.wikipedia.org/wiki/Gaussian_function><abbr title="A common bell-shaped peak function used in curve fitting">Gaussian</abbr></a></li> <li><a href=https://en.wikipedia.org/wiki/Cauchy_distribution><abbr title="A common peak function, also known as the Cauchy distribution, used in curve fitting">Lorentzian</abbr></a> also known as Cauchy distribution</li> <li><a href=https://en.wikipedia.org/wiki/Voigt_profile><abbr title="A peak function resulting from the Convolution of a Gaussian and a Lorentzian profile">Voigt</abbr></a></li> <li><a href=https://en.wikipedia.org/wiki/Voigt_profile#Pseudo-Voigt_approximation>Pseudo <abbr title="A peak function resulting from the Convolution of a Gaussian and a Lorentzian profile">Voigt</abbr></a></li> <li>Exponential</li> <li><a href=https://en.wikipedia.org/wiki/Power_law>power</a> (also known as Log-parabola or just power)</li> <li>Linear</li> <li>Constant</li> <li><a href=https://en.wikipedia.org/wiki/Error_function>Error Function</a></li> <li><a href=https://en.wikipedia.org/wiki/Inverse_trigonometric_functions>Arcus Tangens</a></li> <li>Logarithmic</li> </ul> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>params</code> </td> <td> <code><span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=lmfit.Parameters>Parameters</span>]</code> </td> <td> <div class=doc-md-description> <p>The best optimized parameters of the fit.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">y</code>-values of the data as 1d-array.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p>NDArray[np.float64]: The best-fitted data based on the proposed model.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1637 name=__codelineno-0-1637></a><a href=#__codelineno-0-1637><span class=linenos data-linenos="1637 "></span></a><span class=nd>@staticmethod</span>
<a id=__codelineno-0-1638 name=__codelineno-0-1638></a><a href=#__codelineno-0-1638><span class=linenos data-linenos="1638 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>solve_local_fitting</span><span class=p>(</span>
<a id=__codelineno-0-1639 name=__codelineno-0-1639></a><a href=#__codelineno-0-1639><span class=linenos data-linenos="1639 "></span></a>    <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Parameters</span><span class=p>],</span>
<a id=__codelineno-0-1640 name=__codelineno-0-1640></a><a href=#__codelineno-0-1640><span class=linenos data-linenos="1640 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-1641 name=__codelineno-0-1641></a><a href=#__codelineno-0-1641><span class=linenos data-linenos="1641 "></span></a>    <span class=n>data</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-1642 name=__codelineno-0-1642></a><a href=#__codelineno-0-1642><span class=linenos data-linenos="1642 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>]:</span>
<a id=__codelineno-0-1643 name=__codelineno-0-1643></a><a href=#__codelineno-0-1643><span class=linenos data-linenos="1643 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Solving the fitting problem.</span>
<a id=__codelineno-0-1644 name=__codelineno-0-1644></a><a href=#__codelineno-0-1644><span class=linenos data-linenos="1644 "></span></a>
<a id=__codelineno-0-1645 name=__codelineno-0-1645></a><a href=#__codelineno-0-1645><span class=linenos data-linenos="1645 "></span></a><span class=sd>    !!! note &quot;About implemented models&quot;</span>
<a id=__codelineno-0-1646 name=__codelineno-0-1646></a><a href=#__codelineno-0-1646><span class=linenos data-linenos="1646 "></span></a><span class=sd>        `solve_local_fitting` is a wrapper function for the calling the implemented</span>
<a id=__codelineno-0-1647 name=__codelineno-0-1647></a><a href=#__codelineno-0-1647><span class=linenos data-linenos="1647 "></span></a><span class=sd>        moldels. Based on the `params` dictionary, the function calls the</span>
<a id=__codelineno-0-1648 name=__codelineno-0-1648></a><a href=#__codelineno-0-1648><span class=linenos data-linenos="1648 "></span></a><span class=sd>        corresponding models and merge them to the general model with will be</span>
<a id=__codelineno-0-1649 name=__codelineno-0-1649></a><a href=#__codelineno-0-1649><span class=linenos data-linenos="1649 "></span></a><span class=sd>        optimized by the `lmfit`-optimizer.</span>
<a id=__codelineno-0-1650 name=__codelineno-0-1650></a><a href=#__codelineno-0-1650><span class=linenos data-linenos="1650 "></span></a><span class=sd>        Currently the following models are supported:</span>
<a id=__codelineno-0-1651 name=__codelineno-0-1651></a><a href=#__codelineno-0-1651><span class=linenos data-linenos="1651 "></span></a>
<a id=__codelineno-0-1652 name=__codelineno-0-1652></a><a href=#__codelineno-0-1652><span class=linenos data-linenos="1652 "></span></a><span class=sd>        - [Gaussian](https://en.wikipedia.org/wiki/Gaussian_function)</span>
<a id=__codelineno-0-1653 name=__codelineno-0-1653></a><a href=#__codelineno-0-1653><span class=linenos data-linenos="1653 "></span></a><span class=sd>        - [Lorentzian](https://en.wikipedia.org/wiki/Cauchy_distribution)</span>
<a id=__codelineno-0-1654 name=__codelineno-0-1654></a><a href=#__codelineno-0-1654><span class=linenos data-linenos="1654 "></span></a><span class=sd>            also known as Cauchy distribution</span>
<a id=__codelineno-0-1655 name=__codelineno-0-1655></a><a href=#__codelineno-0-1655><span class=linenos data-linenos="1655 "></span></a><span class=sd>        - [Voigt](https://en.wikipedia.org/wiki/Voigt_profile)</span>
<a id=__codelineno-0-1656 name=__codelineno-0-1656></a><a href=#__codelineno-0-1656><span class=linenos data-linenos="1656 "></span></a><span class=sd>        - [Pseudo Voigt][1]</span>
<a id=__codelineno-0-1657 name=__codelineno-0-1657></a><a href=#__codelineno-0-1657><span class=linenos data-linenos="1657 "></span></a><span class=sd>        - Exponential</span>
<a id=__codelineno-0-1658 name=__codelineno-0-1658></a><a href=#__codelineno-0-1658><span class=linenos data-linenos="1658 "></span></a><span class=sd>        - [power][2] (also known as Log-parabola or just power)</span>
<a id=__codelineno-0-1659 name=__codelineno-0-1659></a><a href=#__codelineno-0-1659><span class=linenos data-linenos="1659 "></span></a><span class=sd>        - Linear</span>
<a id=__codelineno-0-1660 name=__codelineno-0-1660></a><a href=#__codelineno-0-1660><span class=linenos data-linenos="1660 "></span></a><span class=sd>        - Constant</span>
<a id=__codelineno-0-1661 name=__codelineno-0-1661></a><a href=#__codelineno-0-1661><span class=linenos data-linenos="1661 "></span></a><span class=sd>        - [Error Function](https://en.wikipedia.org/wiki/Error_function)</span>
<a id=__codelineno-0-1662 name=__codelineno-0-1662></a><a href=#__codelineno-0-1662><span class=linenos data-linenos="1662 "></span></a><span class=sd>        - [Arcus Tangens][3]</span>
<a id=__codelineno-0-1663 name=__codelineno-0-1663></a><a href=#__codelineno-0-1663><span class=linenos data-linenos="1663 "></span></a><span class=sd>        - Logarithmic</span>
<a id=__codelineno-0-1664 name=__codelineno-0-1664></a><a href=#__codelineno-0-1664><span class=linenos data-linenos="1664 "></span></a>
<a id=__codelineno-0-1665 name=__codelineno-0-1665></a><a href=#__codelineno-0-1665><span class=linenos data-linenos="1665 "></span></a><span class=sd>        [1]: https://en.wikipedia.org/wiki/Voigt_profile#Pseudo-Voigt_approximation</span>
<a id=__codelineno-0-1666 name=__codelineno-0-1666></a><a href=#__codelineno-0-1666><span class=linenos data-linenos="1666 "></span></a><span class=sd>        [2]: https://en.wikipedia.org/wiki/Power_law</span>
<a id=__codelineno-0-1667 name=__codelineno-0-1667></a><a href=#__codelineno-0-1667><span class=linenos data-linenos="1667 "></span></a><span class=sd>        [3]: https://en.wikipedia.org/wiki/Inverse_trigonometric_functions</span>
<a id=__codelineno-0-1668 name=__codelineno-0-1668></a><a href=#__codelineno-0-1668><span class=linenos data-linenos="1668 "></span></a>
<a id=__codelineno-0-1669 name=__codelineno-0-1669></a><a href=#__codelineno-0-1669><span class=linenos data-linenos="1669 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-1670 name=__codelineno-0-1670></a><a href=#__codelineno-0-1670><span class=linenos data-linenos="1670 "></span></a><span class=sd>        params (Dict[str, Parameters]): The best optimized parameters of the fit.</span>
<a id=__codelineno-0-1671 name=__codelineno-0-1671></a><a href=#__codelineno-0-1671><span class=linenos data-linenos="1671 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-1672 name=__codelineno-0-1672></a><a href=#__codelineno-0-1672><span class=linenos data-linenos="1672 "></span></a><span class=sd>        data (NDArray[np.float64]): `y`-values of the data as 1d-array.</span>
<a id=__codelineno-0-1673 name=__codelineno-0-1673></a><a href=#__codelineno-0-1673><span class=linenos data-linenos="1673 "></span></a>
<a id=__codelineno-0-1674 name=__codelineno-0-1674></a><a href=#__codelineno-0-1674><span class=linenos data-linenos="1674 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-1675 name=__codelineno-0-1675></a><a href=#__codelineno-0-1675><span class=linenos data-linenos="1675 "></span></a><span class=sd>        NDArray[np.float64]: The best-fitted data based on the proposed model.</span>
<a id=__codelineno-0-1676 name=__codelineno-0-1676></a><a href=#__codelineno-0-1676><span class=linenos data-linenos="1676 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1677 name=__codelineno-0-1677></a><a href=#__codelineno-0-1677><span class=linenos data-linenos="1677 "></span></a>    <span class=n>val</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
<a id=__codelineno-0-1678 name=__codelineno-0-1678></a><a href=#__codelineno-0-1678><span class=linenos data-linenos="1678 "></span></a>    <span class=n>peak_kwargs</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span> <span class=n>Parameters</span><span class=p>]</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>
<a id=__codelineno-0-1679 name=__codelineno-0-1679></a><a href=#__codelineno-0-1679><span class=linenos data-linenos="1679 "></span></a>
<a id=__codelineno-0-1680 name=__codelineno-0-1680></a><a href=#__codelineno-0-1680><span class=linenos data-linenos="1680 "></span></a>    <span class=k>for</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>params</span><span class=p>:</span>
<a id=__codelineno-0-1681 name=__codelineno-0-1681></a><a href=#__codelineno-0-1681><span class=linenos data-linenos="1681 "></span></a>        <span class=n>model</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
<a id=__codelineno-0-1682 name=__codelineno-0-1682></a><a href=#__codelineno-0-1682><span class=linenos data-linenos="1682 "></span></a>        <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>model_check</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>)</span>
<a id=__codelineno-0-1683 name=__codelineno-0-1683></a><a href=#__codelineno-0-1683><span class=linenos data-linenos="1683 "></span></a>        <span class=n>c_name</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;_&quot;</span><span class=p>)</span>
<a id=__codelineno-0-1684 name=__codelineno-0-1684></a><a href=#__codelineno-0-1684><span class=linenos data-linenos="1684 "></span></a>        <span class=n>peak_kwargs</span><span class=p>[(</span><span class=n>c_name</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>c_name</span><span class=p>[</span><span class=mi>2</span><span class=p>])][</span><span class=n>c_name</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=n>model</span><span class=p>]</span>
<a id=__codelineno-0-1685 name=__codelineno-0-1685></a><a href=#__codelineno-0-1685><span class=linenos data-linenos="1685 "></span></a>
<a id=__codelineno-0-1686 name=__codelineno-0-1686></a><a href=#__codelineno-0-1686><span class=linenos data-linenos="1686 "></span></a>    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>_kwarg</span> <span class=ow>in</span> <span class=n>peak_kwargs</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1687 name=__codelineno-0-1687></a><a href=#__codelineno-0-1687><span class=linenos data-linenos="1687 "></span></a>        <span class=n>val</span> <span class=o>+=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>DistributionModels</span><span class=p>(),</span> <span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])(</span><span class=n>x</span><span class=p>,</span> <span class=o>**</span><span class=n>_kwarg</span><span class=p>)</span>
<a id=__codelineno-0-1688 name=__codelineno-0-1688></a><a href=#__codelineno-0-1688><span class=linenos data-linenos="1688 "></span></a>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>val</span> <span class=o>-</span> <span class=n>data</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-function"> <h2 id=spectrafit.models.calculated_model class="doc doc-heading"> <code class="highlight language-python"><span class=n>calculated_model</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>df</span><span class=p>,</span> <span class=n>global_fit</span><span class=p>)</span></code> <a href=#spectrafit.models.calculated_model class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p>Calculate the single contributions of the models and add them to the dataframe.</p> <div class="admonition note"> <p class=admonition-title>About calculated models</p> <p><code class="language-scdoc highlight">calculated_model</code> are also wrapper functions similar to <code class="language-scdoc highlight">solve_model</code>. The overall goal is to extract from the best parameters the single contributions in the model. Currently, <code class="language-text highlight">lmfit</code> provides only a single model, so the best-fit.</p> </div> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>params</code> </td> <td> <code><span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=lmfit.Parameters>Parameters</span>]</code> </td> <td> <div class=doc-md-description> <p>The best optimized parameters of the fit.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>x</code> </td> <td> <code><span title=numpy.typing.NDArray>NDArray</span>[<span title=numpy.float64>float64</span>]</code> </td> <td> <div class=doc-md-description> <p><code class="language-text highlight">x</code>-values of the data.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>df</code> </td> <td> <code><span title=pandas.DataFrame>DataFrame</span></code> </td> <td> <div class=doc-md-description> <p>DataFrame containing the input data (<code class="language-text highlight">x</code> and <code class="language-text highlight">data</code>), as well as the best fit and the corresponding residuum. Hence, it will be extended by the single contribution of the model.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>global_fit</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>If 1 or 2, the model is calculated for the global fit.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=pandas.DataFrame>DataFrame</span></code> </td> <td> <div class=doc-md-description> <p>pd.DataFrame: Extended dataframe containing the single contributions of the models.</p> <!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>spectrafit/models.py</code></summary> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><a id=__codelineno-0-1736 name=__codelineno-0-1736></a><a href=#__codelineno-0-1736><span class=linenos data-linenos="1736 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculated_model</span><span class=p>(</span>
<a id=__codelineno-0-1737 name=__codelineno-0-1737></a><a href=#__codelineno-0-1737><span class=linenos data-linenos="1737 "></span></a>    <span class=n>params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Parameters</span><span class=p>],</span>
<a id=__codelineno-0-1738 name=__codelineno-0-1738></a><a href=#__codelineno-0-1738><span class=linenos data-linenos="1738 "></span></a>    <span class=n>x</span><span class=p>:</span> <span class=n>NDArray</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>],</span>
<a id=__codelineno-0-1739 name=__codelineno-0-1739></a><a href=#__codelineno-0-1739><span class=linenos data-linenos="1739 "></span></a>    <span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span>
<a id=__codelineno-0-1740 name=__codelineno-0-1740></a><a href=#__codelineno-0-1740><span class=linenos data-linenos="1740 "></span></a>    <span class=n>global_fit</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<a id=__codelineno-0-1741 name=__codelineno-0-1741></a><a href=#__codelineno-0-1741><span class=linenos data-linenos="1741 "></span></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
<a id=__codelineno-0-1742 name=__codelineno-0-1742></a><a href=#__codelineno-0-1742><span class=linenos data-linenos="1742 "></span></a><span class=w>    </span><span class=sa>r</span><span class=sd>&quot;&quot;&quot;Calculate the single contributions of the models and add them to the dataframe.</span>
<a id=__codelineno-0-1743 name=__codelineno-0-1743></a><a href=#__codelineno-0-1743><span class=linenos data-linenos="1743 "></span></a>
<a id=__codelineno-0-1744 name=__codelineno-0-1744></a><a href=#__codelineno-0-1744><span class=linenos data-linenos="1744 "></span></a><span class=sd>    !!! note &quot;About calculated models&quot;</span>
<a id=__codelineno-0-1745 name=__codelineno-0-1745></a><a href=#__codelineno-0-1745><span class=linenos data-linenos="1745 "></span></a><span class=sd>        `calculated_model` are also wrapper functions similar to `solve_model`. The</span>
<a id=__codelineno-0-1746 name=__codelineno-0-1746></a><a href=#__codelineno-0-1746><span class=linenos data-linenos="1746 "></span></a><span class=sd>        overall goal is to extract from the best parameters the single contributions in</span>
<a id=__codelineno-0-1747 name=__codelineno-0-1747></a><a href=#__codelineno-0-1747><span class=linenos data-linenos="1747 "></span></a><span class=sd>        the model. Currently, `lmfit` provides only a single model, so the best-fit.</span>
<a id=__codelineno-0-1748 name=__codelineno-0-1748></a><a href=#__codelineno-0-1748><span class=linenos data-linenos="1748 "></span></a>
<a id=__codelineno-0-1749 name=__codelineno-0-1749></a><a href=#__codelineno-0-1749><span class=linenos data-linenos="1749 "></span></a><span class=sd>    Args:</span>
<a id=__codelineno-0-1750 name=__codelineno-0-1750></a><a href=#__codelineno-0-1750><span class=linenos data-linenos="1750 "></span></a><span class=sd>        params (Dict[str, Parameters]): The best optimized parameters of the fit.</span>
<a id=__codelineno-0-1751 name=__codelineno-0-1751></a><a href=#__codelineno-0-1751><span class=linenos data-linenos="1751 "></span></a><span class=sd>        x (NDArray[np.float64]): `x`-values of the data.</span>
<a id=__codelineno-0-1752 name=__codelineno-0-1752></a><a href=#__codelineno-0-1752><span class=linenos data-linenos="1752 "></span></a><span class=sd>        df (pd.DataFrame): DataFrame containing the input data (`x` and `data`),</span>
<a id=__codelineno-0-1753 name=__codelineno-0-1753></a><a href=#__codelineno-0-1753><span class=linenos data-linenos="1753 "></span></a><span class=sd>             as well as the best fit and the corresponding residuum. Hence, it will be</span>
<a id=__codelineno-0-1754 name=__codelineno-0-1754></a><a href=#__codelineno-0-1754><span class=linenos data-linenos="1754 "></span></a><span class=sd>             extended by the single contribution of the model.</span>
<a id=__codelineno-0-1755 name=__codelineno-0-1755></a><a href=#__codelineno-0-1755><span class=linenos data-linenos="1755 "></span></a><span class=sd>        global_fit (int): If 1 or 2, the model is calculated for the global fit.</span>
<a id=__codelineno-0-1756 name=__codelineno-0-1756></a><a href=#__codelineno-0-1756><span class=linenos data-linenos="1756 "></span></a>
<a id=__codelineno-0-1757 name=__codelineno-0-1757></a><a href=#__codelineno-0-1757><span class=linenos data-linenos="1757 "></span></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-1758 name=__codelineno-0-1758></a><a href=#__codelineno-0-1758><span class=linenos data-linenos="1758 "></span></a><span class=sd>        pd.DataFrame: Extended dataframe containing the single contributions of the</span>
<a id=__codelineno-0-1759 name=__codelineno-0-1759></a><a href=#__codelineno-0-1759><span class=linenos data-linenos="1759 "></span></a><span class=sd>            models.</span>
<a id=__codelineno-0-1760 name=__codelineno-0-1760></a><a href=#__codelineno-0-1760><span class=linenos data-linenos="1760 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1761 name=__codelineno-0-1761></a><a href=#__codelineno-0-1761><span class=linenos data-linenos="1761 "></span></a>    <span class=n>peak_kwargs</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=n>Any</span><span class=p>,</span> <span class=n>Parameters</span><span class=p>]</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>dict</span><span class=p>)</span>
<a id=__codelineno-0-1762 name=__codelineno-0-1762></a><a href=#__codelineno-0-1762><span class=linenos data-linenos="1762 "></span></a>
<a id=__codelineno-0-1763 name=__codelineno-0-1763></a><a href=#__codelineno-0-1763><span class=linenos data-linenos="1763 "></span></a>    <span class=k>for</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>params</span><span class=p>:</span>
<a id=__codelineno-0-1764 name=__codelineno-0-1764></a><a href=#__codelineno-0-1764><span class=linenos data-linenos="1764 "></span></a>        <span class=n>model</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
<a id=__codelineno-0-1765 name=__codelineno-0-1765></a><a href=#__codelineno-0-1765><span class=linenos data-linenos="1765 "></span></a>        <span class=n>ReferenceKeys</span><span class=p>()</span><span class=o>.</span><span class=n>model_check</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>)</span>
<a id=__codelineno-0-1766 name=__codelineno-0-1766></a><a href=#__codelineno-0-1766><span class=linenos data-linenos="1766 "></span></a>        <span class=n>p_name</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;_&quot;</span><span class=p>)</span>
<a id=__codelineno-0-1767 name=__codelineno-0-1767></a><a href=#__codelineno-0-1767><span class=linenos data-linenos="1767 "></span></a>        <span class=k>if</span> <span class=n>global_fit</span><span class=p>:</span>
<a id=__codelineno-0-1768 name=__codelineno-0-1768></a><a href=#__codelineno-0-1768><span class=linenos data-linenos="1768 "></span></a>            <span class=n>peak_kwargs</span><span class=p>[(</span><span class=n>p_name</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>p_name</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=n>p_name</span><span class=p>[</span><span class=mi>3</span><span class=p>])][</span><span class=n>p_name</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=n>model</span><span class=p>]</span>
<a id=__codelineno-0-1769 name=__codelineno-0-1769></a><a href=#__codelineno-0-1769><span class=linenos data-linenos="1769 "></span></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-1770 name=__codelineno-0-1770></a><a href=#__codelineno-0-1770><span class=linenos data-linenos="1770 "></span></a>            <span class=n>peak_kwargs</span><span class=p>[(</span><span class=n>p_name</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>p_name</span><span class=p>[</span><span class=mi>2</span><span class=p>])][</span><span class=n>p_name</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=n>params</span><span class=p>[</span><span class=n>model</span><span class=p>]</span>
<a id=__codelineno-0-1771 name=__codelineno-0-1771></a><a href=#__codelineno-0-1771><span class=linenos data-linenos="1771 "></span></a>
<a id=__codelineno-0-1772 name=__codelineno-0-1772></a><a href=#__codelineno-0-1772><span class=linenos data-linenos="1772 "></span></a>    <span class=n>_df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-0-1773 name=__codelineno-0-1773></a><a href=#__codelineno-0-1773><span class=linenos data-linenos="1773 "></span></a>    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>_kwarg</span> <span class=ow>in</span> <span class=n>peak_kwargs</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1774 name=__codelineno-0-1774></a><a href=#__codelineno-0-1774><span class=linenos data-linenos="1774 "></span></a>        <span class=n>c_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>if</span> <span class=n>global_fit</span> <span class=k>else</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>key</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-0-1775 name=__codelineno-0-1775></a><a href=#__codelineno-0-1775><span class=linenos data-linenos="1775 "></span></a>        <span class=n>_df</span><span class=p>[</span><span class=n>c_name</span><span class=p>]</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>DistributionModels</span><span class=p>(),</span> <span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>])(</span><span class=n>x</span><span class=p>,</span> <span class=o>**</span><span class=n>_kwarg</span><span class=p>)</span>
<a id=__codelineno-0-1776 name=__codelineno-0-1776></a><a href=#__codelineno-0-1776><span class=linenos data-linenos="1776 "></span></a>
<a id=__codelineno-0-1777 name=__codelineno-0-1777></a><a href=#__codelineno-0-1777><span class=linenos data-linenos="1777 "></span></a>    <span class=k>return</span> <span class=n>_df</span>
</code></pre></div> </details> </div> </div> </div> </div> </div><!-- trunk-ignore-all(prettier) --> <!-- trunk-ignore(markdownlint/MD041) --> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="August 18, 2021 15:41:42"><span class=timeago datetime=2021-08-18T15:41:42+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="August 18, 2021 15:41:42">2021-08-18</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="August 18, 2021 15:41:42"><span class=timeago datetime=2021-08-18T15:41:42+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="August 18, 2021 15:41:42">2021-08-18</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../notebook_api/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Jupyter-Notebook"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Jupyter-Notebook </div> </div> </a> <a href=../reporting_api/ class="md-footer__link md-footer__link--next" aria-label="Next: Reporting"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Reporting </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021 - 2025 Anselm Hahn </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/Anselmoo target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://pypi.org/project/spectrafit/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["header.autohide", "content.code.annotate", "content.tabs.link", "content.action.view", "content.action.copy", "content.code.copy", "content.code.annotations", "content.action.edit", "content.action.view", "navigation.expand", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.footer", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.integrate", "toc.follow", "content.tooltips", "grid"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": {"enabled": true}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.c8b220af.min.js></script> <script src=../../js/timeago.min.js></script> <script src=../../js/timeago_mkdocs_material.js></script> <script src=../../assets/javascripts/config.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>